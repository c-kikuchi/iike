(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))a(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const w of d.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&a(w)}).observe(document,{childList:!0,subtree:!0});function i(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(u){if(u.ep)return;u.ep=!0;const d=i(u);fetch(u.href,d)}})();/**
* @vue/shared v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function oc(s,c){const i=new Set(s.split(","));return c?a=>i.has(a.toLowerCase()):a=>i.has(a)}const kt={},Or=[],An=()=>{},FR=()=>!1,va=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&(s.charCodeAt(2)>122||s.charCodeAt(2)<97),sc=s=>s.startsWith("onUpdate:"),en=Object.assign,ac=(s,c)=>{const i=s.indexOf(c);i>-1&&s.splice(i,1)},IR=Object.prototype.hasOwnProperty,pt=(s,c)=>IR.call(s,c),Xe=Array.isArray,kr=s=>Ho(s)==="[object Map]",Vr=s=>Ho(s)==="[object Set]",qg=s=>Ho(s)==="[object Date]",rt=s=>typeof s=="function",Gt=s=>typeof s=="string",Ri=s=>typeof s=="symbol",Ot=s=>s!==null&&typeof s=="object",qm=s=>(Ot(s)||rt(s))&&rt(s.then)&&rt(s.catch),Zm=Object.prototype.toString,Ho=s=>Zm.call(s),LR=s=>Ho(s).slice(8,-1),Xm=s=>Ho(s)==="[object Object]",lc=s=>Gt(s)&&s!=="NaN"&&s[0]!=="-"&&""+parseInt(s,10)===s,So=oc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ya=s=>{const c=Object.create(null);return i=>c[i]||(c[i]=s(i))},HR=/-(\w)/g,Jn=ya(s=>s.replace(HR,(c,i)=>i?i.toUpperCase():"")),NR=/\B([A-Z])/g,Wr=ya(s=>s.replace(NR,"-$1").toLowerCase()),wa=ya(s=>s.charAt(0).toUpperCase()+s.slice(1)),Pu=ya(s=>s?`on${wa(s)}`:""),Ai=(s,c)=>!Object.is(s,c),ra=(s,c)=>{for(let i=0;i<s.length;i++)s[i](c)},ca=(s,c,i)=>{Object.defineProperty(s,c,{configurable:!0,enumerable:!1,value:i})},uc=s=>{const c=parseFloat(s);return isNaN(c)?s:c};let Zg;const Ym=()=>Zg||(Zg=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function cc(s){if(Xe(s)){const c={};for(let i=0;i<s.length;i++){const a=s[i],u=Gt(a)?VR(a):cc(a);if(u)for(const d in u)c[d]=u[d]}return c}else if(Gt(s)||Ot(s))return s}const zR=/;(?![^(]*\))/g,jR=/:([^]+)/,UR=/\/\*[^]*?\*\//g;function VR(s){const c={};return s.replace(UR,"").split(zR).forEach(i=>{if(i){const a=i.split(jR);a.length>1&&(c[a[0].trim()]=a[1].trim())}}),c}function Ea(s){let c="";if(Gt(s))c=s;else if(Xe(s))for(let i=0;i<s.length;i++){const a=Ea(s[i]);a&&(c+=a+" ")}else if(Ot(s))for(const i in s)s[i]&&(c+=i+" ");return c.trim()}const WR="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",GR=oc(WR);function Km(s){return!!s||s===""}function qR(s,c){if(s.length!==c.length)return!1;let i=!0;for(let a=0;i&&a<s.length;a++)i=No(s[a],c[a]);return i}function No(s,c){if(s===c)return!0;let i=qg(s),a=qg(c);if(i||a)return i&&a?s.getTime()===c.getTime():!1;if(i=Ri(s),a=Ri(c),i||a)return s===c;if(i=Xe(s),a=Xe(c),i||a)return i&&a?qR(s,c):!1;if(i=Ot(s),a=Ot(c),i||a){if(!i||!a)return!1;const u=Object.keys(s).length,d=Object.keys(c).length;if(u!==d)return!1;for(const w in s){const p=s.hasOwnProperty(w),m=c.hasOwnProperty(w);if(p&&!m||!p&&m||!No(s[w],c[w]))return!1}}return String(s)===String(c)}function hc(s,c){return s.findIndex(i=>No(i,c))}const Mn=s=>Gt(s)?s:s==null?"":Xe(s)||Ot(s)&&(s.toString===Zm||!rt(s.toString))?JSON.stringify(s,Jm,2):String(s),Jm=(s,c)=>c&&c.__v_isRef?Jm(s,c.value):kr(c)?{[`Map(${c.size})`]:[...c.entries()].reduce((i,[a,u],d)=>(i[Ru(a,d)+" =>"]=u,i),{})}:Vr(c)?{[`Set(${c.size})`]:[...c.values()].map(i=>Ru(i))}:Ri(c)?Ru(c):Ot(c)&&!Xe(c)&&!Xm(c)?String(c):c,Ru=(s,c="")=>{var i;return Ri(s)?`Symbol(${(i=s.description)!=null?i:c})`:s};/**
* @vue/reactivity v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Bn;class ZR{constructor(c=!1){this.detached=c,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Bn,!c&&Bn&&(this.index=(Bn.scopes||(Bn.scopes=[])).push(this)-1)}get active(){return this._active}run(c){if(this._active){const i=Bn;try{return Bn=this,c()}finally{Bn=i}}}on(){Bn=this}off(){Bn=this.parent}stop(c){if(this._active){let i,a;for(i=0,a=this.effects.length;i<a;i++)this.effects[i].stop();for(i=0,a=this.cleanups.length;i<a;i++)this.cleanups[i]();if(this.scopes)for(i=0,a=this.scopes.length;i<a;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!c){const u=this.parent.scopes.pop();u&&u!==this&&(this.parent.scopes[this.index]=u,u.index=this.index)}this.parent=void 0,this._active=!1}}}function XR(s,c=Bn){c&&c.active&&c.effects.push(s)}function YR(){return Bn}let Gi;class dc{constructor(c,i,a,u){this.fn=c,this.trigger=i,this.scheduler=a,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,XR(this,u)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Zi();for(let c=0;c<this._depsLength;c++){const i=this.deps[c];if(i.computed&&(KR(i.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Xi()}return this._dirtyLevel>=4}set dirty(c){this._dirtyLevel=c?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let c=Ci,i=Gi;try{return Ci=!0,Gi=this,this._runnings++,Xg(this),this.fn()}finally{Yg(this),this._runnings--,Gi=i,Ci=c}}stop(){var c;this.active&&(Xg(this),Yg(this),(c=this.onStop)==null||c.call(this),this.active=!1)}}function KR(s){return s.value}function Xg(s){s._trackId++,s._depsLength=0}function Yg(s){if(s.deps.length>s._depsLength){for(let c=s._depsLength;c<s.deps.length;c++)Qm(s.deps[c],s);s.deps.length=s._depsLength}}function Qm(s,c){const i=s.get(c);i!==void 0&&c._trackId!==i&&(s.delete(c),s.size===0&&s.cleanup())}let Ci=!0,ju=0;const $m=[];function Zi(){$m.push(Ci),Ci=!1}function Xi(){const s=$m.pop();Ci=s===void 0?!0:s}function pc(){ju++}function fc(){for(ju--;!ju&&Uu.length;)Uu.shift()()}function e0(s,c,i){if(c.get(s)!==s._trackId){c.set(s,s._trackId);const a=s.deps[s._depsLength];a!==c?(a&&Qm(a,s),s.deps[s._depsLength++]=c):s._depsLength++}}const Uu=[];function t0(s,c,i){pc();for(const a of s.keys()){let u;a._dirtyLevel<c&&(u??(u=s.get(a)===a._trackId))&&(a._shouldSchedule||(a._shouldSchedule=a._dirtyLevel===0),a._dirtyLevel=c),a._shouldSchedule&&(u??(u=s.get(a)===a._trackId))&&(a.trigger(),(!a._runnings||a.allowRecurse)&&a._dirtyLevel!==2&&(a._shouldSchedule=!1,a.scheduler&&Uu.push(a.scheduler)))}fc()}const n0=(s,c)=>{const i=new Map;return i.cleanup=s,i.computed=c,i},Vu=new WeakMap,qi=Symbol(""),Wu=Symbol("");function vn(s,c,i){if(Ci&&Gi){let a=Vu.get(s);a||Vu.set(s,a=new Map);let u=a.get(i);u||a.set(i,u=n0(()=>a.delete(i))),e0(Gi,u)}}function li(s,c,i,a,u,d){const w=Vu.get(s);if(!w)return;let p=[];if(c==="clear")p=[...w.values()];else if(i==="length"&&Xe(s)){const m=Number(a);w.forEach((y,x)=>{(x==="length"||!Ri(x)&&x>=m)&&p.push(y)})}else switch(i!==void 0&&p.push(w.get(i)),c){case"add":Xe(s)?lc(i)&&p.push(w.get("length")):(p.push(w.get(qi)),kr(s)&&p.push(w.get(Wu)));break;case"delete":Xe(s)||(p.push(w.get(qi)),kr(s)&&p.push(w.get(Wu)));break;case"set":kr(s)&&p.push(w.get(qi));break}pc();for(const m of p)m&&t0(m,4);fc()}const JR=oc("__proto__,__v_isRef,__isVue"),i0=new Set(Object.getOwnPropertyNames(Symbol).filter(s=>s!=="arguments"&&s!=="caller").map(s=>Symbol[s]).filter(Ri)),Kg=QR();function QR(){const s={};return["includes","indexOf","lastIndexOf"].forEach(c=>{s[c]=function(...i){const a=xt(this);for(let d=0,w=this.length;d<w;d++)vn(a,"get",d+"");const u=a[c](...i);return u===-1||u===!1?a[c](...i.map(xt)):u}}),["push","pop","shift","unshift","splice"].forEach(c=>{s[c]=function(...i){Zi(),pc();const a=xt(this)[c].apply(this,i);return fc(),Xi(),a}}),s}function $R(s){const c=xt(this);return vn(c,"has",s),c.hasOwnProperty(s)}class r0{constructor(c=!1,i=!1){this._isReadonly=c,this._isShallow=i}get(c,i,a){const u=this._isReadonly,d=this._isShallow;if(i==="__v_isReactive")return!u;if(i==="__v_isReadonly")return u;if(i==="__v_isShallow")return d;if(i==="__v_raw")return a===(u?d?dA:l0:d?a0:s0).get(c)||Object.getPrototypeOf(c)===Object.getPrototypeOf(a)?c:void 0;const w=Xe(c);if(!u){if(w&&pt(Kg,i))return Reflect.get(Kg,i,a);if(i==="hasOwnProperty")return $R}const p=Reflect.get(c,i,a);return(Ri(i)?i0.has(i):JR(i))||(u||vn(c,"get",i),d)?p:yn(p)?w&&lc(i)?p:p.value:Ot(p)?u?c0(p):zo(p):p}}class o0 extends r0{constructor(c=!1){super(!1,c)}set(c,i,a,u){let d=c[i];if(!this._isShallow){const m=Lr(d);if(!ha(a)&&!Lr(a)&&(d=xt(d),a=xt(a)),!Xe(c)&&yn(d)&&!yn(a))return m?!1:(d.value=a,!0)}const w=Xe(c)&&lc(i)?Number(i)<c.length:pt(c,i),p=Reflect.set(c,i,a,u);return c===xt(u)&&(w?Ai(a,d)&&li(c,"set",i,a):li(c,"add",i,a)),p}deleteProperty(c,i){const a=pt(c,i);c[i];const u=Reflect.deleteProperty(c,i);return u&&a&&li(c,"delete",i,void 0),u}has(c,i){const a=Reflect.has(c,i);return(!Ri(i)||!i0.has(i))&&vn(c,"has",i),a}ownKeys(c){return vn(c,"iterate",Xe(c)?"length":qi),Reflect.ownKeys(c)}}class eA extends r0{constructor(c=!1){super(!0,c)}set(c,i){return!0}deleteProperty(c,i){return!0}}const tA=new o0,nA=new eA,iA=new o0(!0),gc=s=>s,xa=s=>Reflect.getPrototypeOf(s);function Qs(s,c,i=!1,a=!1){s=s.__v_raw;const u=xt(s),d=xt(c);i||(Ai(c,d)&&vn(u,"get",c),vn(u,"get",d));const{has:w}=xa(u),p=a?gc:i?yc:Ao;if(w.call(u,c))return p(s.get(c));if(w.call(u,d))return p(s.get(d));s!==u&&s.get(c)}function $s(s,c=!1){const i=this.__v_raw,a=xt(i),u=xt(s);return c||(Ai(s,u)&&vn(a,"has",s),vn(a,"has",u)),s===u?i.has(s):i.has(s)||i.has(u)}function ea(s,c=!1){return s=s.__v_raw,!c&&vn(xt(s),"iterate",qi),Reflect.get(s,"size",s)}function Jg(s){s=xt(s);const c=xt(this);return xa(c).has.call(c,s)||(c.add(s),li(c,"add",s,s)),this}function Qg(s,c){c=xt(c);const i=xt(this),{has:a,get:u}=xa(i);let d=a.call(i,s);d||(s=xt(s),d=a.call(i,s));const w=u.call(i,s);return i.set(s,c),d?Ai(c,w)&&li(i,"set",s,c):li(i,"add",s,c),this}function $g(s){const c=xt(this),{has:i,get:a}=xa(c);let u=i.call(c,s);u||(s=xt(s),u=i.call(c,s)),a&&a.call(c,s);const d=c.delete(s);return u&&li(c,"delete",s,void 0),d}function em(){const s=xt(this),c=s.size!==0,i=s.clear();return c&&li(s,"clear",void 0,void 0),i}function ta(s,c){return function(a,u){const d=this,w=d.__v_raw,p=xt(w),m=c?gc:s?yc:Ao;return!s&&vn(p,"iterate",qi),w.forEach((y,x)=>a.call(u,m(y),m(x),d))}}function na(s,c,i){return function(...a){const u=this.__v_raw,d=xt(u),w=kr(d),p=s==="entries"||s===Symbol.iterator&&w,m=s==="keys"&&w,y=u[s](...a),x=i?gc:c?yc:Ao;return!c&&vn(d,"iterate",m?Wu:qi),{next(){const{value:S,done:T}=y.next();return T?{value:S,done:T}:{value:p?[x(S[0]),x(S[1])]:x(S),done:T}},[Symbol.iterator](){return this}}}}function Ei(s){return function(...c){return s==="delete"?!1:s==="clear"?void 0:this}}function rA(){const s={get(d){return Qs(this,d)},get size(){return ea(this)},has:$s,add:Jg,set:Qg,delete:$g,clear:em,forEach:ta(!1,!1)},c={get(d){return Qs(this,d,!1,!0)},get size(){return ea(this)},has:$s,add:Jg,set:Qg,delete:$g,clear:em,forEach:ta(!1,!0)},i={get(d){return Qs(this,d,!0)},get size(){return ea(this,!0)},has(d){return $s.call(this,d,!0)},add:Ei("add"),set:Ei("set"),delete:Ei("delete"),clear:Ei("clear"),forEach:ta(!0,!1)},a={get(d){return Qs(this,d,!0,!0)},get size(){return ea(this,!0)},has(d){return $s.call(this,d,!0)},add:Ei("add"),set:Ei("set"),delete:Ei("delete"),clear:Ei("clear"),forEach:ta(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(d=>{s[d]=na(d,!1,!1),i[d]=na(d,!0,!1),c[d]=na(d,!1,!0),a[d]=na(d,!0,!0)}),[s,i,c,a]}const[oA,sA,aA,lA]=rA();function mc(s,c){const i=c?s?lA:aA:s?sA:oA;return(a,u,d)=>u==="__v_isReactive"?!s:u==="__v_isReadonly"?s:u==="__v_raw"?a:Reflect.get(pt(i,u)&&u in a?i:a,u,d)}const uA={get:mc(!1,!1)},cA={get:mc(!1,!0)},hA={get:mc(!0,!1)},s0=new WeakMap,a0=new WeakMap,l0=new WeakMap,dA=new WeakMap;function pA(s){switch(s){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function fA(s){return s.__v_skip||!Object.isExtensible(s)?0:pA(LR(s))}function zo(s){return Lr(s)?s:vc(s,!1,tA,uA,s0)}function u0(s){return vc(s,!1,iA,cA,a0)}function c0(s){return vc(s,!0,nA,hA,l0)}function vc(s,c,i,a,u){if(!Ot(s)||s.__v_raw&&!(c&&s.__v_isReactive))return s;const d=u.get(s);if(d)return d;const w=fA(s);if(w===0)return s;const p=new Proxy(s,w===2?a:i);return u.set(s,p),p}function Br(s){return Lr(s)?Br(s.__v_raw):!!(s&&s.__v_isReactive)}function Lr(s){return!!(s&&s.__v_isReadonly)}function ha(s){return!!(s&&s.__v_isShallow)}function h0(s){return Br(s)||Lr(s)}function xt(s){const c=s&&s.__v_raw;return c?xt(c):s}function d0(s){return Object.isExtensible(s)&&ca(s,"__v_skip",!0),s}const Ao=s=>Ot(s)?zo(s):s,yc=s=>Ot(s)?c0(s):s;class p0{constructor(c,i,a,u){this.getter=c,this._setter=i,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new dc(()=>c(this._value),()=>oa(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!u,this.__v_isReadonly=a}get value(){const c=xt(this);return(!c._cacheable||c.effect.dirty)&&Ai(c._value,c._value=c.effect.run())&&oa(c,4),f0(c),c.effect._dirtyLevel>=2&&oa(c,2),c._value}set value(c){this._setter(c)}get _dirty(){return this.effect.dirty}set _dirty(c){this.effect.dirty=c}}function gA(s,c,i=!1){let a,u;const d=rt(s);return d?(a=s,u=An):(a=s.get,u=s.set),new p0(a,u,d||!u,i)}function f0(s){var c;Ci&&Gi&&(s=xt(s),e0(Gi,(c=s.dep)!=null?c:s.dep=n0(()=>s.dep=void 0,s instanceof p0?s:void 0)))}function oa(s,c=4,i){s=xt(s);const a=s.dep;a&&t0(a,c)}function yn(s){return!!(s&&s.__v_isRef===!0)}function mA(s){return g0(s,!1)}function vA(s){return g0(s,!0)}function g0(s,c){return yn(s)?s:new yA(s,c)}class yA{constructor(c,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?c:xt(c),this._value=i?c:Ao(c)}get value(){return f0(this),this._value}set value(c){const i=this.__v_isShallow||ha(c)||Lr(c);c=i?c:xt(c),Ai(c,this._rawValue)&&(this._rawValue=c,this._value=i?c:Ao(c),oa(this,4))}}function ui(s){return yn(s)?s.value:s}const wA={get:(s,c,i)=>ui(Reflect.get(s,c,i)),set:(s,c,i,a)=>{const u=s[c];return yn(u)&&!yn(i)?(u.value=i,!0):Reflect.set(s,c,i,a)}};function m0(s){return Br(s)?s:new Proxy(s,wA)}/**
* @vue/runtime-core v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Pi(s,c,i,a){try{return a?s(...a):s()}catch(u){ba(u,c,i)}}function Ln(s,c,i,a){if(rt(s)){const d=Pi(s,c,i,a);return d&&qm(d)&&d.catch(w=>{ba(w,c,i)}),d}const u=[];for(let d=0;d<s.length;d++)u.push(Ln(s[d],c,i,a));return u}function ba(s,c,i,a=!0){const u=c?c.vnode:null;if(c){let d=c.parent;const w=c.proxy,p=`https://vuejs.org/error-reference/#runtime-${i}`;for(;d;){const y=d.ec;if(y){for(let x=0;x<y.length;x++)if(y[x](s,w,p)===!1)return}d=d.parent}const m=c.appContext.config.errorHandler;if(m){Pi(m,null,10,[s,w,p]);return}}EA(s,i,u,a)}function EA(s,c,i,a=!0){console.error(s)}let Do=!1,Gu=!1;const sn=[];let Yn=0;const Mr=[];let bi=null,Vi=0;const v0=Promise.resolve();let wc=null;function Ec(s){const c=wc||v0;return s?c.then(this?s.bind(this):s):c}function xA(s){let c=Yn+1,i=sn.length;for(;c<i;){const a=c+i>>>1,u=sn[a],d=Oo(u);d<s||d===s&&u.pre?c=a+1:i=a}return c}function xc(s){(!sn.length||!sn.includes(s,Do&&s.allowRecurse?Yn+1:Yn))&&(s.id==null?sn.push(s):sn.splice(xA(s.id),0,s),y0())}function y0(){!Do&&!Gu&&(Gu=!0,wc=v0.then(E0))}function bA(s){const c=sn.indexOf(s);c>Yn&&sn.splice(c,1)}function SA(s){Xe(s)?Mr.push(...s):(!bi||!bi.includes(s,s.allowRecurse?Vi+1:Vi))&&Mr.push(s),y0()}function tm(s,c,i=Do?Yn+1:0){for(;i<sn.length;i++){const a=sn[i];if(a&&a.pre){if(s&&a.id!==s.uid)continue;sn.splice(i,1),i--,a()}}}function w0(s){if(Mr.length){const c=[...new Set(Mr)].sort((i,a)=>Oo(i)-Oo(a));if(Mr.length=0,bi){bi.push(...c);return}for(bi=c,Vi=0;Vi<bi.length;Vi++)bi[Vi]();bi=null,Vi=0}}const Oo=s=>s.id==null?1/0:s.id,_A=(s,c)=>{const i=Oo(s)-Oo(c);if(i===0){if(s.pre&&!c.pre)return-1;if(c.pre&&!s.pre)return 1}return i};function E0(s){Gu=!1,Do=!0,sn.sort(_A);try{for(Yn=0;Yn<sn.length;Yn++){const c=sn[Yn];c&&c.active!==!1&&Pi(c,null,14)}}finally{Yn=0,sn.length=0,w0(),Do=!1,wc=null,(sn.length||Mr.length)&&E0()}}function TA(s,c,...i){if(s.isUnmounted)return;const a=s.vnode.props||kt;let u=i;const d=c.startsWith("update:"),w=d&&c.slice(7);if(w&&w in a){const x=`${w==="modelValue"?"model":w}Modifiers`,{number:S,trim:T}=a[x]||kt;T&&(u=i.map(B=>Gt(B)?B.trim():B)),S&&(u=i.map(uc))}let p,m=a[p=Pu(c)]||a[p=Pu(Jn(c))];!m&&d&&(m=a[p=Pu(Wr(c))]),m&&Ln(m,s,6,u);const y=a[p+"Once"];if(y){if(!s.emitted)s.emitted={};else if(s.emitted[p])return;s.emitted[p]=!0,Ln(y,s,6,u)}}function x0(s,c,i=!1){const a=c.emitsCache,u=a.get(s);if(u!==void 0)return u;const d=s.emits;let w={},p=!1;if(!rt(s)){const m=y=>{const x=x0(y,c,!0);x&&(p=!0,en(w,x))};!i&&c.mixins.length&&c.mixins.forEach(m),s.extends&&m(s.extends),s.mixins&&s.mixins.forEach(m)}return!d&&!p?(Ot(s)&&a.set(s,null),null):(Xe(d)?d.forEach(m=>w[m]=null):en(w,d),Ot(s)&&a.set(s,w),w)}function Sa(s,c){return!s||!va(c)?!1:(c=c.slice(2).replace(/Once$/,""),pt(s,c[0].toLowerCase()+c.slice(1))||pt(s,Wr(c))||pt(s,c))}let gn=null,b0=null;function da(s){const c=gn;return gn=s,b0=s&&s.type.__scopeId||null,c}function bc(s,c=gn,i){if(!c||s._n)return s;const a=(...u)=>{a._d&&dm(-1);const d=da(c);let w;try{w=s(...u)}finally{da(d),a._d&&dm(1)}return w};return a._n=!0,a._c=!0,a._d=!0,a}function Au(s){const{type:c,vnode:i,proxy:a,withProxy:u,props:d,propsOptions:[w],slots:p,attrs:m,emit:y,render:x,renderCache:S,data:T,setupState:B,ctx:L,inheritAttrs:q}=s;let V,G;const te=da(s);try{if(i.shapeFlag&4){const Te=u||a,Ie=Te;V=Xn(x.call(Ie,Te,S,d,B,T,L)),G=m}else{const Te=c;V=Xn(Te.length>1?Te(d,{attrs:m,slots:p,emit:y}):Te(d,null)),G=c.props?m:CA(m)}}catch(Te){Co.length=0,ba(Te,s,1),V=mn(ko)}let se=V;if(G&&q!==!1){const Te=Object.keys(G),{shapeFlag:Ie}=se;Te.length&&Ie&7&&(w&&Te.some(sc)&&(G=PA(G,w)),se=Hr(se,G))}return i.dirs&&(se=Hr(se),se.dirs=se.dirs?se.dirs.concat(i.dirs):i.dirs),i.transition&&(se.transition=i.transition),V=se,da(te),V}const CA=s=>{let c;for(const i in s)(i==="class"||i==="style"||va(i))&&((c||(c={}))[i]=s[i]);return c},PA=(s,c)=>{const i={};for(const a in s)(!sc(a)||!(a.slice(9)in c))&&(i[a]=s[a]);return i};function RA(s,c,i){const{props:a,children:u,component:d}=s,{props:w,children:p,patchFlag:m}=c,y=d.emitsOptions;if(c.dirs||c.transition)return!0;if(i&&m>=0){if(m&1024)return!0;if(m&16)return a?nm(a,w,y):!!w;if(m&8){const x=c.dynamicProps;for(let S=0;S<x.length;S++){const T=x[S];if(w[T]!==a[T]&&!Sa(y,T))return!0}}}else return(u||p)&&(!p||!p.$stable)?!0:a===w?!1:a?w?nm(a,w,y):!0:!!w;return!1}function nm(s,c,i){const a=Object.keys(c);if(a.length!==Object.keys(s).length)return!0;for(let u=0;u<a.length;u++){const d=a[u];if(c[d]!==s[d]&&!Sa(i,d))return!0}return!1}function AA({vnode:s,parent:c},i){for(;c;){const a=c.subTree;if(a.suspense&&a.suspense.activeBranch===s&&(a.el=s.el),a===s)(s=c.vnode).el=i,c=c.parent;else break}}const S0="components";function DA(s,c){return kA(S0,s,!0,c)||s}const OA=Symbol.for("v-ndc");function kA(s,c,i=!0,a=!1){const u=gn||an;if(u){const d=u.type;if(s===S0){const p=C2(d,!1);if(p&&(p===c||p===Jn(c)||p===wa(Jn(c))))return d}const w=im(u[s]||d[s],c)||im(u.appContext[s],c);return!w&&a?d:w}}function im(s,c){return s&&(s[c]||s[Jn(c)]||s[wa(Jn(c))])}const BA=s=>s.__isSuspense;function MA(s,c){c&&c.pendingBranch?Xe(s)?c.effects.push(...s):c.effects.push(s):SA(s)}const FA=Symbol.for("v-scx"),IA=()=>ci(FA),ia={};function Fr(s,c,i){return _0(s,c,i)}function _0(s,c,{immediate:i,deep:a,flush:u,once:d,onTrack:w,onTrigger:p}=kt){if(c&&d){const Ce=c;c=(...Ne)=>{Ce(...Ne),Ie()}}const m=an,y=Ce=>a===!0?Ce:Wi(Ce,a===!1?1:void 0);let x,S=!1,T=!1;if(yn(s)?(x=()=>s.value,S=ha(s)):Br(s)?(x=()=>y(s),S=!0):Xe(s)?(T=!0,S=s.some(Ce=>Br(Ce)||ha(Ce)),x=()=>s.map(Ce=>{if(yn(Ce))return Ce.value;if(Br(Ce))return y(Ce);if(rt(Ce))return Pi(Ce,m,2)})):rt(s)?c?x=()=>Pi(s,m,2):x=()=>(B&&B(),Ln(s,m,3,[L])):x=An,c&&a){const Ce=x;x=()=>Wi(Ce())}let B,L=Ce=>{B=se.onStop=()=>{Pi(Ce,m,4),B=se.onStop=void 0}},q;if(Pa)if(L=An,c?i&&Ln(c,m,3,[x(),T?[]:void 0,L]):x(),u==="sync"){const Ce=IA();q=Ce.__watcherHandles||(Ce.__watcherHandles=[])}else return An;let V=T?new Array(s.length).fill(ia):ia;const G=()=>{if(!(!se.active||!se.dirty))if(c){const Ce=se.run();(a||S||(T?Ce.some((Ne,je)=>Ai(Ne,V[je])):Ai(Ce,V)))&&(B&&B(),Ln(c,m,3,[Ce,V===ia?void 0:T&&V[0]===ia?[]:V,L]),V=Ce)}else se.run()};G.allowRecurse=!!c;let te;u==="sync"?te=G:u==="post"?te=()=>fn(G,m&&m.suspense):(G.pre=!0,m&&(G.id=m.uid),te=()=>xc(G));const se=new dc(x,An,te),Te=YR(),Ie=()=>{se.stop(),Te&&ac(Te.effects,se)};return c?i?G():V=se.run():u==="post"?fn(se.run.bind(se),m&&m.suspense):se.run(),q&&q.push(Ie),Ie}function LA(s,c,i){const a=this.proxy,u=Gt(s)?s.includes(".")?T0(a,s):()=>a[s]:s.bind(a,a);let d;rt(c)?d=c:(d=c.handler,i=c);const w=jo(this),p=_0(u,d.bind(a),i);return w(),p}function T0(s,c){const i=c.split(".");return()=>{let a=s;for(let u=0;u<i.length&&a;u++)a=a[i[u]];return a}}function Wi(s,c,i=0,a){if(!Ot(s)||s.__v_skip)return s;if(c&&c>0){if(i>=c)return s;i++}if(a=a||new Set,a.has(s))return s;if(a.add(s),yn(s))Wi(s.value,c,i,a);else if(Xe(s))for(let u=0;u<s.length;u++)Wi(s[u],c,i,a);else if(Vr(s)||kr(s))s.forEach(u=>{Wi(u,c,i,a)});else if(Xm(s))for(const u in s)Wi(s[u],c,i,a);return s}function Du(s,c){if(gn===null)return s;const i=Ra(gn)||gn.proxy,a=s.dirs||(s.dirs=[]);for(let u=0;u<c.length;u++){let[d,w,p,m=kt]=c[u];d&&(rt(d)&&(d={mounted:d,updated:d}),d.deep&&Wi(w),a.push({dir:d,instance:i,value:w,oldValue:void 0,arg:p,modifiers:m}))}return s}function ji(s,c,i,a){const u=s.dirs,d=c&&c.dirs;for(let w=0;w<u.length;w++){const p=u[w];d&&(p.oldValue=d[w].value);let m=p.dir[a];m&&(Zi(),Ln(m,i,8,[s.el,p,s,c]),Xi())}}/*! #__NO_SIDE_EFFECTS__ */function C0(s,c){return rt(s)?en({name:s.name},c,{setup:s}):s}const sa=s=>!!s.type.__asyncLoader,P0=s=>s.type.__isKeepAlive;function HA(s,c){R0(s,"a",c)}function NA(s,c){R0(s,"da",c)}function R0(s,c,i=an){const a=s.__wdc||(s.__wdc=()=>{let u=i;for(;u;){if(u.isDeactivated)return;u=u.parent}return s()});if(_a(c,a,i),i){let u=i.parent;for(;u&&u.parent;)P0(u.parent.vnode)&&zA(a,c,i,u),u=u.parent}}function zA(s,c,i,a){const u=_a(c,s,a,!0);A0(()=>{ac(a[c],u)},i)}function _a(s,c,i=an,a=!1){if(i){const u=i[s]||(i[s]=[]),d=c.__weh||(c.__weh=(...w)=>{if(i.isUnmounted)return;Zi();const p=jo(i),m=Ln(c,i,s,w);return p(),Xi(),m});return a?u.unshift(d):u.push(d),d}}const hi=s=>(c,i=an)=>(!Pa||s==="sp")&&_a(s,(...a)=>c(...a),i),jA=hi("bm"),UA=hi("m"),VA=hi("bu"),WA=hi("u"),GA=hi("bum"),A0=hi("um"),qA=hi("sp"),ZA=hi("rtg"),XA=hi("rtc");function YA(s,c=an){_a("ec",s,c)}function qu(s,c,i,a){let u;const d=i&&i[a];if(Xe(s)||Gt(s)){u=new Array(s.length);for(let w=0,p=s.length;w<p;w++)u[w]=c(s[w],w,void 0,d&&d[w])}else if(typeof s=="number"){u=new Array(s);for(let w=0;w<s;w++)u[w]=c(w+1,w,void 0,d&&d[w])}else if(Ot(s))if(s[Symbol.iterator])u=Array.from(s,(w,p)=>c(w,p,void 0,d&&d[p]));else{const w=Object.keys(s);u=new Array(w.length);for(let p=0,m=w.length;p<m;p++){const y=w[p];u[p]=c(s[y],y,p,d&&d[p])}}else u=[];return i&&(i[a]=u),u}const Zu=s=>s?j0(s)?Ra(s)||s.proxy:Zu(s.parent):null,_o=en(Object.create(null),{$:s=>s,$el:s=>s.vnode.el,$data:s=>s.data,$props:s=>s.props,$attrs:s=>s.attrs,$slots:s=>s.slots,$refs:s=>s.refs,$parent:s=>Zu(s.parent),$root:s=>Zu(s.root),$emit:s=>s.emit,$options:s=>Sc(s),$forceUpdate:s=>s.f||(s.f=()=>{s.effect.dirty=!0,xc(s.update)}),$nextTick:s=>s.n||(s.n=Ec.bind(s.proxy)),$watch:s=>LA.bind(s)}),Ou=(s,c)=>s!==kt&&!s.__isScriptSetup&&pt(s,c),KA={get({_:s},c){const{ctx:i,setupState:a,data:u,props:d,accessCache:w,type:p,appContext:m}=s;let y;if(c[0]!=="$"){const B=w[c];if(B!==void 0)switch(B){case 1:return a[c];case 2:return u[c];case 4:return i[c];case 3:return d[c]}else{if(Ou(a,c))return w[c]=1,a[c];if(u!==kt&&pt(u,c))return w[c]=2,u[c];if((y=s.propsOptions[0])&&pt(y,c))return w[c]=3,d[c];if(i!==kt&&pt(i,c))return w[c]=4,i[c];Xu&&(w[c]=0)}}const x=_o[c];let S,T;if(x)return c==="$attrs"&&vn(s,"get",c),x(s);if((S=p.__cssModules)&&(S=S[c]))return S;if(i!==kt&&pt(i,c))return w[c]=4,i[c];if(T=m.config.globalProperties,pt(T,c))return T[c]},set({_:s},c,i){const{data:a,setupState:u,ctx:d}=s;return Ou(u,c)?(u[c]=i,!0):a!==kt&&pt(a,c)?(a[c]=i,!0):pt(s.props,c)||c[0]==="$"&&c.slice(1)in s?!1:(d[c]=i,!0)},has({_:{data:s,setupState:c,accessCache:i,ctx:a,appContext:u,propsOptions:d}},w){let p;return!!i[w]||s!==kt&&pt(s,w)||Ou(c,w)||(p=d[0])&&pt(p,w)||pt(a,w)||pt(_o,w)||pt(u.config.globalProperties,w)},defineProperty(s,c,i){return i.get!=null?s._.accessCache[c]=0:pt(i,"value")&&this.set(s,c,i.value,null),Reflect.defineProperty(s,c,i)}};function rm(s){return Xe(s)?s.reduce((c,i)=>(c[i]=null,c),{}):s}let Xu=!0;function JA(s){const c=Sc(s),i=s.proxy,a=s.ctx;Xu=!1,c.beforeCreate&&om(c.beforeCreate,s,"bc");const{data:u,computed:d,methods:w,watch:p,provide:m,inject:y,created:x,beforeMount:S,mounted:T,beforeUpdate:B,updated:L,activated:q,deactivated:V,beforeDestroy:G,beforeUnmount:te,destroyed:se,unmounted:Te,render:Ie,renderTracked:Ce,renderTriggered:Ne,errorCaptured:je,serverPrefetch:ot,expose:at,inheritAttrs:vt,components:Ct,directives:Rt,filters:Lt}=c;if(y&&QA(y,a,null),w)for(const nt in w){const it=w[nt];rt(it)&&(a[nt]=it.bind(i))}if(u){const nt=u.call(i,i);Ot(nt)&&(s.data=zo(nt))}if(Xu=!0,d)for(const nt in d){const it=d[nt],jt=rt(it)?it.bind(i,i):rt(it.get)?it.get.bind(i,i):An,Ht=!rt(it)&&rt(it.set)?it.set.bind(i):An,Yt=Fn({get:jt,set:Ht});Object.defineProperty(a,nt,{enumerable:!0,configurable:!0,get:()=>Yt.value,set:Nt=>Yt.value=Nt})}if(p)for(const nt in p)D0(p[nt],a,i,nt);if(m){const nt=rt(m)?m.call(i):m;Reflect.ownKeys(nt).forEach(it=>{aa(it,nt[it])})}x&&om(x,s,"c");function ft(nt,it){Xe(it)?it.forEach(jt=>nt(jt.bind(i))):it&&nt(it.bind(i))}if(ft(jA,S),ft(UA,T),ft(VA,B),ft(WA,L),ft(HA,q),ft(NA,V),ft(YA,je),ft(XA,Ce),ft(ZA,Ne),ft(GA,te),ft(A0,Te),ft(qA,ot),Xe(at))if(at.length){const nt=s.exposed||(s.exposed={});at.forEach(it=>{Object.defineProperty(nt,it,{get:()=>i[it],set:jt=>i[it]=jt})})}else s.exposed||(s.exposed={});Ie&&s.render===An&&(s.render=Ie),vt!=null&&(s.inheritAttrs=vt),Ct&&(s.components=Ct),Rt&&(s.directives=Rt)}function QA(s,c,i=An){Xe(s)&&(s=Yu(s));for(const a in s){const u=s[a];let d;Ot(u)?"default"in u?d=ci(u.from||a,u.default,!0):d=ci(u.from||a):d=ci(u),yn(d)?Object.defineProperty(c,a,{enumerable:!0,configurable:!0,get:()=>d.value,set:w=>d.value=w}):c[a]=d}}function om(s,c,i){Ln(Xe(s)?s.map(a=>a.bind(c.proxy)):s.bind(c.proxy),c,i)}function D0(s,c,i,a){const u=a.includes(".")?T0(i,a):()=>i[a];if(Gt(s)){const d=c[s];rt(d)&&Fr(u,d)}else if(rt(s))Fr(u,s.bind(i));else if(Ot(s))if(Xe(s))s.forEach(d=>D0(d,c,i,a));else{const d=rt(s.handler)?s.handler.bind(i):c[s.handler];rt(d)&&Fr(u,d,s)}}function Sc(s){const c=s.type,{mixins:i,extends:a}=c,{mixins:u,optionsCache:d,config:{optionMergeStrategies:w}}=s.appContext,p=d.get(c);let m;return p?m=p:!u.length&&!i&&!a?m=c:(m={},u.length&&u.forEach(y=>pa(m,y,w,!0)),pa(m,c,w)),Ot(c)&&d.set(c,m),m}function pa(s,c,i,a=!1){const{mixins:u,extends:d}=c;d&&pa(s,d,i,!0),u&&u.forEach(w=>pa(s,w,i,!0));for(const w in c)if(!(a&&w==="expose")){const p=$A[w]||i&&i[w];s[w]=p?p(s[w],c[w]):c[w]}return s}const $A={data:sm,props:am,emits:am,methods:bo,computed:bo,beforeCreate:cn,created:cn,beforeMount:cn,mounted:cn,beforeUpdate:cn,updated:cn,beforeDestroy:cn,beforeUnmount:cn,destroyed:cn,unmounted:cn,activated:cn,deactivated:cn,errorCaptured:cn,serverPrefetch:cn,components:bo,directives:bo,watch:t2,provide:sm,inject:e2};function sm(s,c){return c?s?function(){return en(rt(s)?s.call(this,this):s,rt(c)?c.call(this,this):c)}:c:s}function e2(s,c){return bo(Yu(s),Yu(c))}function Yu(s){if(Xe(s)){const c={};for(let i=0;i<s.length;i++)c[s[i]]=s[i];return c}return s}function cn(s,c){return s?[...new Set([].concat(s,c))]:c}function bo(s,c){return s?en(Object.create(null),s,c):c}function am(s,c){return s?Xe(s)&&Xe(c)?[...new Set([...s,...c])]:en(Object.create(null),rm(s),rm(c??{})):c}function t2(s,c){if(!s)return c;if(!c)return s;const i=en(Object.create(null),s);for(const a in c)i[a]=cn(s[a],c[a]);return i}function O0(){return{app:null,config:{isNativeTag:FR,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let n2=0;function i2(s,c){return function(a,u=null){rt(a)||(a=en({},a)),u!=null&&!Ot(u)&&(u=null);const d=O0(),w=new WeakSet;let p=!1;const m=d.app={_uid:n2++,_component:a,_props:u,_container:null,_context:d,_instance:null,version:R2,get config(){return d.config},set config(y){},use(y,...x){return w.has(y)||(y&&rt(y.install)?(w.add(y),y.install(m,...x)):rt(y)&&(w.add(y),y(m,...x))),m},mixin(y){return d.mixins.includes(y)||d.mixins.push(y),m},component(y,x){return x?(d.components[y]=x,m):d.components[y]},directive(y,x){return x?(d.directives[y]=x,m):d.directives[y]},mount(y,x,S){if(!p){const T=mn(a,u);return T.appContext=d,S===!0?S="svg":S===!1&&(S=void 0),x&&c?c(T,y):s(T,y,S),p=!0,m._container=y,y.__vue_app__=m,Ra(T.component)||T.component.proxy}},unmount(){p&&(s(null,m._container),delete m._container.__vue_app__)},provide(y,x){return d.provides[y]=x,m},runWithContext(y){const x=To;To=m;try{return y()}finally{To=x}}};return m}}let To=null;function aa(s,c){if(an){let i=an.provides;const a=an.parent&&an.parent.provides;a===i&&(i=an.provides=Object.create(a)),i[s]=c}}function ci(s,c,i=!1){const a=an||gn;if(a||To){const u=a?a.parent==null?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:To._context.provides;if(u&&s in u)return u[s];if(arguments.length>1)return i&&rt(c)?c.call(a&&a.proxy):c}}function r2(s,c,i,a=!1){const u={},d={};ca(d,Ca,1),s.propsDefaults=Object.create(null),k0(s,c,u,d);for(const w in s.propsOptions[0])w in u||(u[w]=void 0);i?s.props=a?u:u0(u):s.type.props?s.props=u:s.props=d,s.attrs=d}function o2(s,c,i,a){const{props:u,attrs:d,vnode:{patchFlag:w}}=s,p=xt(u),[m]=s.propsOptions;let y=!1;if((a||w>0)&&!(w&16)){if(w&8){const x=s.vnode.dynamicProps;for(let S=0;S<x.length;S++){let T=x[S];if(Sa(s.emitsOptions,T))continue;const B=c[T];if(m)if(pt(d,T))B!==d[T]&&(d[T]=B,y=!0);else{const L=Jn(T);u[L]=Ku(m,p,L,B,s,!1)}else B!==d[T]&&(d[T]=B,y=!0)}}}else{k0(s,c,u,d)&&(y=!0);let x;for(const S in p)(!c||!pt(c,S)&&((x=Wr(S))===S||!pt(c,x)))&&(m?i&&(i[S]!==void 0||i[x]!==void 0)&&(u[S]=Ku(m,p,S,void 0,s,!0)):delete u[S]);if(d!==p)for(const S in d)(!c||!pt(c,S))&&(delete d[S],y=!0)}y&&li(s,"set","$attrs")}function k0(s,c,i,a){const[u,d]=s.propsOptions;let w=!1,p;if(c)for(let m in c){if(So(m))continue;const y=c[m];let x;u&&pt(u,x=Jn(m))?!d||!d.includes(x)?i[x]=y:(p||(p={}))[x]=y:Sa(s.emitsOptions,m)||(!(m in a)||y!==a[m])&&(a[m]=y,w=!0)}if(d){const m=xt(i),y=p||kt;for(let x=0;x<d.length;x++){const S=d[x];i[S]=Ku(u,m,S,y[S],s,!pt(y,S))}}return w}function Ku(s,c,i,a,u,d){const w=s[i];if(w!=null){const p=pt(w,"default");if(p&&a===void 0){const m=w.default;if(w.type!==Function&&!w.skipFactory&&rt(m)){const{propsDefaults:y}=u;if(i in y)a=y[i];else{const x=jo(u);a=y[i]=m.call(null,c),x()}}else a=m}w[0]&&(d&&!p?a=!1:w[1]&&(a===""||a===Wr(i))&&(a=!0))}return a}function B0(s,c,i=!1){const a=c.propsCache,u=a.get(s);if(u)return u;const d=s.props,w={},p=[];let m=!1;if(!rt(s)){const x=S=>{m=!0;const[T,B]=B0(S,c,!0);en(w,T),B&&p.push(...B)};!i&&c.mixins.length&&c.mixins.forEach(x),s.extends&&x(s.extends),s.mixins&&s.mixins.forEach(x)}if(!d&&!m)return Ot(s)&&a.set(s,Or),Or;if(Xe(d))for(let x=0;x<d.length;x++){const S=Jn(d[x]);lm(S)&&(w[S]=kt)}else if(d)for(const x in d){const S=Jn(x);if(lm(S)){const T=d[x],B=w[S]=Xe(T)||rt(T)?{type:T}:en({},T);if(B){const L=hm(Boolean,B.type),q=hm(String,B.type);B[0]=L>-1,B[1]=q<0||L<q,(L>-1||pt(B,"default"))&&p.push(S)}}}const y=[w,p];return Ot(s)&&a.set(s,y),y}function lm(s){return s[0]!=="$"&&!So(s)}function um(s){return s===null?"null":typeof s=="function"?s.name||"":typeof s=="object"&&s.constructor&&s.constructor.name||""}function cm(s,c){return um(s)===um(c)}function hm(s,c){return Xe(c)?c.findIndex(i=>cm(i,s)):rt(c)&&cm(c,s)?0:-1}const M0=s=>s[0]==="_"||s==="$stable",_c=s=>Xe(s)?s.map(Xn):[Xn(s)],s2=(s,c,i)=>{if(c._n)return c;const a=bc((...u)=>_c(c(...u)),i);return a._c=!1,a},F0=(s,c,i)=>{const a=s._ctx;for(const u in s){if(M0(u))continue;const d=s[u];if(rt(d))c[u]=s2(u,d,a);else if(d!=null){const w=_c(d);c[u]=()=>w}}},I0=(s,c)=>{const i=_c(c);s.slots.default=()=>i},a2=(s,c)=>{if(s.vnode.shapeFlag&32){const i=c._;i?(s.slots=xt(c),ca(c,"_",i)):F0(c,s.slots={})}else s.slots={},c&&I0(s,c);ca(s.slots,Ca,1)},l2=(s,c,i)=>{const{vnode:a,slots:u}=s;let d=!0,w=kt;if(a.shapeFlag&32){const p=c._;p?i&&p===1?d=!1:(en(u,c),!i&&p===1&&delete u._):(d=!c.$stable,F0(c,u)),w=c}else c&&(I0(s,c),w={default:1});if(d)for(const p in u)!M0(p)&&w[p]==null&&delete u[p]};function Ju(s,c,i,a,u=!1){if(Xe(s)){s.forEach((T,B)=>Ju(T,c&&(Xe(c)?c[B]:c),i,a,u));return}if(sa(a)&&!u)return;const d=a.shapeFlag&4?Ra(a.component)||a.component.proxy:a.el,w=u?null:d,{i:p,r:m}=s,y=c&&c.r,x=p.refs===kt?p.refs={}:p.refs,S=p.setupState;if(y!=null&&y!==m&&(Gt(y)?(x[y]=null,pt(S,y)&&(S[y]=null)):yn(y)&&(y.value=null)),rt(m))Pi(m,p,12,[w,x]);else{const T=Gt(m),B=yn(m);if(T||B){const L=()=>{if(s.f){const q=T?pt(S,m)?S[m]:x[m]:m.value;u?Xe(q)&&ac(q,d):Xe(q)?q.includes(d)||q.push(d):T?(x[m]=[d],pt(S,m)&&(S[m]=x[m])):(m.value=[d],s.k&&(x[s.k]=m.value))}else T?(x[m]=w,pt(S,m)&&(S[m]=w)):B&&(m.value=w,s.k&&(x[s.k]=w))};w?(L.id=-1,fn(L,i)):L()}}}const fn=MA;function u2(s){return c2(s)}function c2(s,c){const i=Ym();i.__VUE__=!0;const{insert:a,remove:u,patchProp:d,createElement:w,createText:p,createComment:m,setText:y,setElementText:x,parentNode:S,nextSibling:T,setScopeId:B=An,insertStaticContent:L}=s,q=(Z,Q,le,ge=null,b=null,F=null,ee=void 0,ne=null,re=!!Q.dynamicChildren)=>{if(Z===Q)return;Z&&!Eo(Z,Q)&&(ge=pe(Z),Nt(Z,b,F,!0),Z=null),Q.patchFlag===-2&&(re=!1,Q.dynamicChildren=null);const{type:ae,ref:ue,shapeFlag:xe}=Q;switch(ae){case Ta:V(Z,Q,le,ge);break;case ko:G(Z,Q,le,ge);break;case Bu:Z==null&&te(Q,le,ge,ee);break;case Pn:Ct(Z,Q,le,ge,b,F,ee,ne,re);break;default:xe&1?Ie(Z,Q,le,ge,b,F,ee,ne,re):xe&6?Rt(Z,Q,le,ge,b,F,ee,ne,re):(xe&64||xe&128)&&ae.process(Z,Q,le,ge,b,F,ee,ne,re,ke)}ue!=null&&b&&Ju(ue,Z&&Z.ref,F,Q||Z,!Q)},V=(Z,Q,le,ge)=>{if(Z==null)a(Q.el=p(Q.children),le,ge);else{const b=Q.el=Z.el;Q.children!==Z.children&&y(b,Q.children)}},G=(Z,Q,le,ge)=>{Z==null?a(Q.el=m(Q.children||""),le,ge):Q.el=Z.el},te=(Z,Q,le,ge)=>{[Z.el,Z.anchor]=L(Z.children,Q,le,ge,Z.el,Z.anchor)},se=({el:Z,anchor:Q},le,ge)=>{let b;for(;Z&&Z!==Q;)b=T(Z),a(Z,le,ge),Z=b;a(Q,le,ge)},Te=({el:Z,anchor:Q})=>{let le;for(;Z&&Z!==Q;)le=T(Z),u(Z),Z=le;u(Q)},Ie=(Z,Q,le,ge,b,F,ee,ne,re)=>{Q.type==="svg"?ee="svg":Q.type==="math"&&(ee="mathml"),Z==null?Ce(Q,le,ge,b,F,ee,ne,re):ot(Z,Q,b,F,ee,ne,re)},Ce=(Z,Q,le,ge,b,F,ee,ne)=>{let re,ae;const{props:ue,shapeFlag:xe,transition:Ee,dirs:Ae}=Z;if(re=Z.el=w(Z.type,F,ue&&ue.is,ue),xe&8?x(re,Z.children):xe&16&&je(Z.children,re,null,ge,b,ku(Z,F),ee,ne),Ae&&ji(Z,null,ge,"created"),Ne(re,Z,Z.scopeId,ee,ge),ue){for(const Ge in ue)Ge!=="value"&&!So(Ge)&&d(re,Ge,null,ue[Ge],F,Z.children,ge,b,Pt);"value"in ue&&d(re,"value",null,ue.value,F),(ae=ue.onVnodeBeforeMount)&&Zn(ae,ge,Z)}Ae&&ji(Z,null,ge,"beforeMount");const Pe=h2(b,Ee);Pe&&Ee.beforeEnter(re),a(re,Q,le),((ae=ue&&ue.onVnodeMounted)||Pe||Ae)&&fn(()=>{ae&&Zn(ae,ge,Z),Pe&&Ee.enter(re),Ae&&ji(Z,null,ge,"mounted")},b)},Ne=(Z,Q,le,ge,b)=>{if(le&&B(Z,le),ge)for(let F=0;F<ge.length;F++)B(Z,ge[F]);if(b){let F=b.subTree;if(Q===F){const ee=b.vnode;Ne(Z,ee,ee.scopeId,ee.slotScopeIds,b.parent)}}},je=(Z,Q,le,ge,b,F,ee,ne,re=0)=>{for(let ae=re;ae<Z.length;ae++){const ue=Z[ae]=ne?Si(Z[ae]):Xn(Z[ae]);q(null,ue,Q,le,ge,b,F,ee,ne)}},ot=(Z,Q,le,ge,b,F,ee)=>{const ne=Q.el=Z.el;let{patchFlag:re,dynamicChildren:ae,dirs:ue}=Q;re|=Z.patchFlag&16;const xe=Z.props||kt,Ee=Q.props||kt;let Ae;if(le&&Ui(le,!1),(Ae=Ee.onVnodeBeforeUpdate)&&Zn(Ae,le,Q,Z),ue&&ji(Q,Z,le,"beforeUpdate"),le&&Ui(le,!0),ae?at(Z.dynamicChildren,ae,ne,le,ge,ku(Q,b),F):ee||it(Z,Q,ne,null,le,ge,ku(Q,b),F,!1),re>0){if(re&16)vt(ne,Q,xe,Ee,le,ge,b);else if(re&2&&xe.class!==Ee.class&&d(ne,"class",null,Ee.class,b),re&4&&d(ne,"style",xe.style,Ee.style,b),re&8){const Pe=Q.dynamicProps;for(let Ge=0;Ge<Pe.length;Ge++){const D=Pe[Ge],A=xe[D],H=Ee[D];(H!==A||D==="value")&&d(ne,D,A,H,b,Z.children,le,ge,Pt)}}re&1&&Z.children!==Q.children&&x(ne,Q.children)}else!ee&&ae==null&&vt(ne,Q,xe,Ee,le,ge,b);((Ae=Ee.onVnodeUpdated)||ue)&&fn(()=>{Ae&&Zn(Ae,le,Q,Z),ue&&ji(Q,Z,le,"updated")},ge)},at=(Z,Q,le,ge,b,F,ee)=>{for(let ne=0;ne<Q.length;ne++){const re=Z[ne],ae=Q[ne],ue=re.el&&(re.type===Pn||!Eo(re,ae)||re.shapeFlag&70)?S(re.el):le;q(re,ae,ue,null,ge,b,F,ee,!0)}},vt=(Z,Q,le,ge,b,F,ee)=>{if(le!==ge){if(le!==kt)for(const ne in le)!So(ne)&&!(ne in ge)&&d(Z,ne,le[ne],null,ee,Q.children,b,F,Pt);for(const ne in ge){if(So(ne))continue;const re=ge[ne],ae=le[ne];re!==ae&&ne!=="value"&&d(Z,ne,ae,re,ee,Q.children,b,F,Pt)}"value"in ge&&d(Z,"value",le.value,ge.value,ee)}},Ct=(Z,Q,le,ge,b,F,ee,ne,re)=>{const ae=Q.el=Z?Z.el:p(""),ue=Q.anchor=Z?Z.anchor:p("");let{patchFlag:xe,dynamicChildren:Ee,slotScopeIds:Ae}=Q;Ae&&(ne=ne?ne.concat(Ae):Ae),Z==null?(a(ae,le,ge),a(ue,le,ge),je(Q.children||[],le,ue,b,F,ee,ne,re)):xe>0&&xe&64&&Ee&&Z.dynamicChildren?(at(Z.dynamicChildren,Ee,le,b,F,ee,ne),(Q.key!=null||b&&Q===b.subTree)&&L0(Z,Q,!0)):it(Z,Q,le,ue,b,F,ee,ne,re)},Rt=(Z,Q,le,ge,b,F,ee,ne,re)=>{Q.slotScopeIds=ne,Z==null?Q.shapeFlag&512?b.ctx.activate(Q,le,ge,ee,re):Lt(Q,le,ge,b,F,ee,re):ln(Z,Q,re)},Lt=(Z,Q,le,ge,b,F,ee)=>{const ne=Z.component=x2(Z,ge,b);if(P0(Z)&&(ne.ctx.renderer=ke),b2(ne),ne.asyncDep){if(b&&b.registerDep(ne,ft),!Z.el){const re=ne.subTree=mn(ko);G(null,re,Q,le)}}else ft(ne,Z,Q,le,b,F,ee)},ln=(Z,Q,le)=>{const ge=Q.component=Z.component;if(RA(Z,Q,le))if(ge.asyncDep&&!ge.asyncResolved){nt(ge,Q,le);return}else ge.next=Q,bA(ge.update),ge.effect.dirty=!0,ge.update();else Q.el=Z.el,ge.vnode=Q},ft=(Z,Q,le,ge,b,F,ee)=>{const ne=()=>{if(Z.isMounted){let{next:ue,bu:xe,u:Ee,parent:Ae,vnode:Pe}=Z;{const j=H0(Z);if(j){ue&&(ue.el=Pe.el,nt(Z,ue,ee)),j.asyncDep.then(()=>{Z.isUnmounted||ne()});return}}let Ge=ue,D;Ui(Z,!1),ue?(ue.el=Pe.el,nt(Z,ue,ee)):ue=Pe,xe&&ra(xe),(D=ue.props&&ue.props.onVnodeBeforeUpdate)&&Zn(D,Ae,ue,Pe),Ui(Z,!0);const A=Au(Z),H=Z.subTree;Z.subTree=A,q(H,A,S(H.el),pe(H),Z,b,F),ue.el=A.el,Ge===null&&AA(Z,A.el),Ee&&fn(Ee,b),(D=ue.props&&ue.props.onVnodeUpdated)&&fn(()=>Zn(D,Ae,ue,Pe),b)}else{let ue;const{el:xe,props:Ee}=Q,{bm:Ae,m:Pe,parent:Ge}=Z,D=sa(Q);if(Ui(Z,!1),Ae&&ra(Ae),!D&&(ue=Ee&&Ee.onVnodeBeforeMount)&&Zn(ue,Ge,Q),Ui(Z,!0),xe&&yt){const A=()=>{Z.subTree=Au(Z),yt(xe,Z.subTree,Z,b,null)};D?Q.type.__asyncLoader().then(()=>!Z.isUnmounted&&A()):A()}else{const A=Z.subTree=Au(Z);q(null,A,le,ge,Z,b,F),Q.el=A.el}if(Pe&&fn(Pe,b),!D&&(ue=Ee&&Ee.onVnodeMounted)){const A=Q;fn(()=>Zn(ue,Ge,A),b)}(Q.shapeFlag&256||Ge&&sa(Ge.vnode)&&Ge.vnode.shapeFlag&256)&&Z.a&&fn(Z.a,b),Z.isMounted=!0,Q=le=ge=null}},re=Z.effect=new dc(ne,An,()=>xc(ae),Z.scope),ae=Z.update=()=>{re.dirty&&re.run()};ae.id=Z.uid,Ui(Z,!0),ae()},nt=(Z,Q,le)=>{Q.component=Z;const ge=Z.vnode.props;Z.vnode=Q,Z.next=null,o2(Z,Q.props,ge,le),l2(Z,Q.children,le),Zi(),tm(Z),Xi()},it=(Z,Q,le,ge,b,F,ee,ne,re=!1)=>{const ae=Z&&Z.children,ue=Z?Z.shapeFlag:0,xe=Q.children,{patchFlag:Ee,shapeFlag:Ae}=Q;if(Ee>0){if(Ee&128){Ht(ae,xe,le,ge,b,F,ee,ne,re);return}else if(Ee&256){jt(ae,xe,le,ge,b,F,ee,ne,re);return}}Ae&8?(ue&16&&Pt(ae,b,F),xe!==ae&&x(le,xe)):ue&16?Ae&16?Ht(ae,xe,le,ge,b,F,ee,ne,re):Pt(ae,b,F,!0):(ue&8&&x(le,""),Ae&16&&je(xe,le,ge,b,F,ee,ne,re))},jt=(Z,Q,le,ge,b,F,ee,ne,re)=>{Z=Z||Or,Q=Q||Or;const ae=Z.length,ue=Q.length,xe=Math.min(ae,ue);let Ee;for(Ee=0;Ee<xe;Ee++){const Ae=Q[Ee]=re?Si(Q[Ee]):Xn(Q[Ee]);q(Z[Ee],Ae,le,null,b,F,ee,ne,re)}ae>ue?Pt(Z,b,F,!0,!1,xe):je(Q,le,ge,b,F,ee,ne,re,xe)},Ht=(Z,Q,le,ge,b,F,ee,ne,re)=>{let ae=0;const ue=Q.length;let xe=Z.length-1,Ee=ue-1;for(;ae<=xe&&ae<=Ee;){const Ae=Z[ae],Pe=Q[ae]=re?Si(Q[ae]):Xn(Q[ae]);if(Eo(Ae,Pe))q(Ae,Pe,le,null,b,F,ee,ne,re);else break;ae++}for(;ae<=xe&&ae<=Ee;){const Ae=Z[xe],Pe=Q[Ee]=re?Si(Q[Ee]):Xn(Q[Ee]);if(Eo(Ae,Pe))q(Ae,Pe,le,null,b,F,ee,ne,re);else break;xe--,Ee--}if(ae>xe){if(ae<=Ee){const Ae=Ee+1,Pe=Ae<ue?Q[Ae].el:ge;for(;ae<=Ee;)q(null,Q[ae]=re?Si(Q[ae]):Xn(Q[ae]),le,Pe,b,F,ee,ne,re),ae++}}else if(ae>Ee)for(;ae<=xe;)Nt(Z[ae],b,F,!0),ae++;else{const Ae=ae,Pe=ae,Ge=new Map;for(ae=Pe;ae<=Ee;ae++){const Je=Q[ae]=re?Si(Q[ae]):Xn(Q[ae]);Je.key!=null&&Ge.set(Je.key,ae)}let D,A=0;const H=Ee-Pe+1;let j=!1,ce=0;const ye=new Array(H);for(ae=0;ae<H;ae++)ye[ae]=0;for(ae=Ae;ae<=xe;ae++){const Je=Z[ae];if(A>=H){Nt(Je,b,F,!0);continue}let Fe;if(Je.key!=null)Fe=Ge.get(Je.key);else for(D=Pe;D<=Ee;D++)if(ye[D-Pe]===0&&Eo(Je,Q[D])){Fe=D;break}Fe===void 0?Nt(Je,b,F,!0):(ye[Fe-Pe]=ae+1,Fe>=ce?ce=Fe:j=!0,q(Je,Q[Fe],le,null,b,F,ee,ne,re),A++)}const He=j?d2(ye):Or;for(D=He.length-1,ae=H-1;ae>=0;ae--){const Je=Pe+ae,Fe=Q[Je],Ut=Je+1<ue?Q[Je+1].el:ge;ye[ae]===0?q(null,Fe,le,Ut,b,F,ee,ne,re):j&&(D<0||ae!==He[D]?Yt(Fe,le,Ut,2):D--)}}},Yt=(Z,Q,le,ge,b=null)=>{const{el:F,type:ee,transition:ne,children:re,shapeFlag:ae}=Z;if(ae&6){Yt(Z.component.subTree,Q,le,ge);return}if(ae&128){Z.suspense.move(Q,le,ge);return}if(ae&64){ee.move(Z,Q,le,ke);return}if(ee===Pn){a(F,Q,le);for(let xe=0;xe<re.length;xe++)Yt(re[xe],Q,le,ge);a(Z.anchor,Q,le);return}if(ee===Bu){se(Z,Q,le);return}if(ge!==2&&ae&1&&ne)if(ge===0)ne.beforeEnter(F),a(F,Q,le),fn(()=>ne.enter(F),b);else{const{leave:xe,delayLeave:Ee,afterLeave:Ae}=ne,Pe=()=>a(F,Q,le),Ge=()=>{xe(F,()=>{Pe(),Ae&&Ae()})};Ee?Ee(F,Pe,Ge):Ge()}else a(F,Q,le)},Nt=(Z,Q,le,ge=!1,b=!1)=>{const{type:F,props:ee,ref:ne,children:re,dynamicChildren:ae,shapeFlag:ue,patchFlag:xe,dirs:Ee}=Z;if(ne!=null&&Ju(ne,null,le,Z,!0),ue&256){Q.ctx.deactivate(Z);return}const Ae=ue&1&&Ee,Pe=!sa(Z);let Ge;if(Pe&&(Ge=ee&&ee.onVnodeBeforeUnmount)&&Zn(Ge,Q,Z),ue&6)Dn(Z.component,le,ge);else{if(ue&128){Z.suspense.unmount(le,ge);return}Ae&&ji(Z,null,Q,"beforeUnmount"),ue&64?Z.type.remove(Z,Q,le,b,ke,ge):ae&&(F!==Pn||xe>0&&xe&64)?Pt(ae,Q,le,!1,!0):(F===Pn&&xe&384||!b&&ue&16)&&Pt(re,Q,le),ge&&We(Z)}(Pe&&(Ge=ee&&ee.onVnodeUnmounted)||Ae)&&fn(()=>{Ge&&Zn(Ge,Q,Z),Ae&&ji(Z,null,Q,"unmounted")},le)},We=Z=>{const{type:Q,el:le,anchor:ge,transition:b}=Z;if(Q===Pn){hn(le,ge);return}if(Q===Bu){Te(Z);return}const F=()=>{u(le),b&&!b.persisted&&b.afterLeave&&b.afterLeave()};if(Z.shapeFlag&1&&b&&!b.persisted){const{leave:ee,delayLeave:ne}=b,re=()=>ee(le,F);ne?ne(Z.el,F,re):re()}else F()},hn=(Z,Q)=>{let le;for(;Z!==Q;)le=T(Z),u(Z),Z=le;u(Q)},Dn=(Z,Q,le)=>{const{bum:ge,scope:b,update:F,subTree:ee,um:ne}=Z;ge&&ra(ge),b.stop(),F&&(F.active=!1,Nt(ee,Z,Q,le)),ne&&fn(ne,Q),fn(()=>{Z.isUnmounted=!0},Q),Q&&Q.pendingBranch&&!Q.isUnmounted&&Z.asyncDep&&!Z.asyncResolved&&Z.suspenseId===Q.pendingId&&(Q.deps--,Q.deps===0&&Q.resolve())},Pt=(Z,Q,le,ge=!1,b=!1,F=0)=>{for(let ee=F;ee<Z.length;ee++)Nt(Z[ee],Q,le,ge,b)},pe=Z=>Z.shapeFlag&6?pe(Z.component.subTree):Z.shapeFlag&128?Z.suspense.next():T(Z.anchor||Z.el);let _e=!1;const Re=(Z,Q,le)=>{Z==null?Q._vnode&&Nt(Q._vnode,null,null,!0):q(Q._vnode||null,Z,Q,null,null,null,le),_e||(_e=!0,tm(),w0(),_e=!1),Q._vnode=Z},ke={p:q,um:Nt,m:Yt,r:We,mt:Lt,mc:je,pc:it,pbc:at,n:pe,o:s};let st,yt;return c&&([st,yt]=c(ke)),{render:Re,hydrate:st,createApp:i2(Re,st)}}function ku({type:s,props:c},i){return i==="svg"&&s==="foreignObject"||i==="mathml"&&s==="annotation-xml"&&c&&c.encoding&&c.encoding.includes("html")?void 0:i}function Ui({effect:s,update:c},i){s.allowRecurse=c.allowRecurse=i}function h2(s,c){return(!s||s&&!s.pendingBranch)&&c&&!c.persisted}function L0(s,c,i=!1){const a=s.children,u=c.children;if(Xe(a)&&Xe(u))for(let d=0;d<a.length;d++){const w=a[d];let p=u[d];p.shapeFlag&1&&!p.dynamicChildren&&((p.patchFlag<=0||p.patchFlag===32)&&(p=u[d]=Si(u[d]),p.el=w.el),i||L0(w,p)),p.type===Ta&&(p.el=w.el)}}function d2(s){const c=s.slice(),i=[0];let a,u,d,w,p;const m=s.length;for(a=0;a<m;a++){const y=s[a];if(y!==0){if(u=i[i.length-1],s[u]<y){c[a]=u,i.push(a);continue}for(d=0,w=i.length-1;d<w;)p=d+w>>1,s[i[p]]<y?d=p+1:w=p;y<s[i[d]]&&(d>0&&(c[a]=i[d-1]),i[d]=a)}}for(d=i.length,w=i[d-1];d-- >0;)i[d]=w,w=c[w];return i}function H0(s){const c=s.subTree.component;if(c)return c.asyncDep&&!c.asyncResolved?c:H0(c)}const p2=s=>s.__isTeleport,Pn=Symbol.for("v-fgt"),Ta=Symbol.for("v-txt"),ko=Symbol.for("v-cmt"),Bu=Symbol.for("v-stc"),Co=[];let In=null;function Kn(s=!1){Co.push(In=s?null:[])}function f2(){Co.pop(),In=Co[Co.length-1]||null}let Bo=1;function dm(s){Bo+=s}function N0(s){return s.dynamicChildren=Bo>0?In||Or:null,f2(),Bo>0&&In&&In.push(s),s}function ai(s,c,i,a,u,d){return N0(Qe(s,c,i,a,u,d,!0))}function g2(s,c,i,a,u){return N0(mn(s,c,i,a,u,!0))}function Qu(s){return s?s.__v_isVNode===!0:!1}function Eo(s,c){return s.type===c.type&&s.key===c.key}const Ca="__vInternal",z0=({key:s})=>s??null,la=({ref:s,ref_key:c,ref_for:i})=>(typeof s=="number"&&(s=""+s),s!=null?Gt(s)||yn(s)||rt(s)?{i:gn,r:s,k:c,f:!!i}:s:null);function Qe(s,c=null,i=null,a=0,u=null,d=s===Pn?0:1,w=!1,p=!1){const m={__v_isVNode:!0,__v_skip:!0,type:s,props:c,key:c&&z0(c),ref:c&&la(c),scopeId:b0,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:a,dynamicProps:u,dynamicChildren:null,appContext:null,ctx:gn};return p?(Tc(m,i),d&128&&s.normalize(m)):i&&(m.shapeFlag|=Gt(i)?8:16),Bo>0&&!w&&In&&(m.patchFlag>0||d&6)&&m.patchFlag!==32&&In.push(m),m}const mn=m2;function m2(s,c=null,i=null,a=0,u=null,d=!1){if((!s||s===OA)&&(s=ko),Qu(s)){const p=Hr(s,c,!0);return i&&Tc(p,i),Bo>0&&!d&&In&&(p.shapeFlag&6?In[In.indexOf(s)]=p:In.push(p)),p.patchFlag|=-2,p}if(P2(s)&&(s=s.__vccOpts),c){c=v2(c);let{class:p,style:m}=c;p&&!Gt(p)&&(c.class=Ea(p)),Ot(m)&&(h0(m)&&!Xe(m)&&(m=en({},m)),c.style=cc(m))}const w=Gt(s)?1:BA(s)?128:p2(s)?64:Ot(s)?4:rt(s)?2:0;return Qe(s,c,i,a,u,w,d,!0)}function v2(s){return s?h0(s)||Ca in s?en({},s):s:null}function Hr(s,c,i=!1){const{props:a,ref:u,patchFlag:d,children:w}=s,p=c?y2(a||{},c):a;return{__v_isVNode:!0,__v_skip:!0,type:s.type,props:p,key:p&&z0(p),ref:c&&c.ref?i&&u?Xe(u)?u.concat(la(c)):[u,la(c)]:la(c):u,scopeId:s.scopeId,slotScopeIds:s.slotScopeIds,children:w,target:s.target,targetAnchor:s.targetAnchor,staticCount:s.staticCount,shapeFlag:s.shapeFlag,patchFlag:c&&s.type!==Pn?d===-1?16:d|16:d,dynamicProps:s.dynamicProps,dynamicChildren:s.dynamicChildren,appContext:s.appContext,dirs:s.dirs,transition:s.transition,component:s.component,suspense:s.suspense,ssContent:s.ssContent&&Hr(s.ssContent),ssFallback:s.ssFallback&&Hr(s.ssFallback),el:s.el,anchor:s.anchor,ctx:s.ctx,ce:s.ce}}function Mo(s=" ",c=0){return mn(Ta,null,s,c)}function Xn(s){return s==null||typeof s=="boolean"?mn(ko):Xe(s)?mn(Pn,null,s.slice()):typeof s=="object"?Si(s):mn(Ta,null,String(s))}function Si(s){return s.el===null&&s.patchFlag!==-1||s.memo?s:Hr(s)}function Tc(s,c){let i=0;const{shapeFlag:a}=s;if(c==null)c=null;else if(Xe(c))i=16;else if(typeof c=="object")if(a&65){const u=c.default;u&&(u._c&&(u._d=!1),Tc(s,u()),u._c&&(u._d=!0));return}else{i=32;const u=c._;!u&&!(Ca in c)?c._ctx=gn:u===3&&gn&&(gn.slots._===1?c._=1:(c._=2,s.patchFlag|=1024))}else rt(c)?(c={default:c,_ctx:gn},i=32):(c=String(c),a&64?(i=16,c=[Mo(c)]):i=8);s.children=c,s.shapeFlag|=i}function y2(...s){const c={};for(let i=0;i<s.length;i++){const a=s[i];for(const u in a)if(u==="class")c.class!==a.class&&(c.class=Ea([c.class,a.class]));else if(u==="style")c.style=cc([c.style,a.style]);else if(va(u)){const d=c[u],w=a[u];w&&d!==w&&!(Xe(d)&&d.includes(w))&&(c[u]=d?[].concat(d,w):w)}else u!==""&&(c[u]=a[u])}return c}function Zn(s,c,i,a=null){Ln(s,c,7,[i,a])}const w2=O0();let E2=0;function x2(s,c,i){const a=s.type,u=(c?c.appContext:s.appContext)||w2,d={uid:E2++,vnode:s,type:a,parent:c,appContext:u,root:null,next:null,subTree:null,effect:null,update:null,scope:new ZR(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:c?c.provides:Object.create(u.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:B0(a,u),emitsOptions:x0(a,u),emit:null,emitted:null,propsDefaults:kt,inheritAttrs:a.inheritAttrs,ctx:kt,data:kt,props:kt,attrs:kt,slots:kt,refs:kt,setupState:kt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=c?c.root:d,d.emit=TA.bind(null,d),s.ce&&s.ce(d),d}let an=null,fa,$u;{const s=Ym(),c=(i,a)=>{let u;return(u=s[i])||(u=s[i]=[]),u.push(a),d=>{u.length>1?u.forEach(w=>w(d)):u[0](d)}};fa=c("__VUE_INSTANCE_SETTERS__",i=>an=i),$u=c("__VUE_SSR_SETTERS__",i=>Pa=i)}const jo=s=>{const c=an;return fa(s),s.scope.on(),()=>{s.scope.off(),fa(c)}},pm=()=>{an&&an.scope.off(),fa(null)};function j0(s){return s.vnode.shapeFlag&4}let Pa=!1;function b2(s,c=!1){c&&$u(c);const{props:i,children:a}=s.vnode,u=j0(s);r2(s,i,u,c),a2(s,a);const d=u?S2(s,c):void 0;return c&&$u(!1),d}function S2(s,c){const i=s.type;s.accessCache=Object.create(null),s.proxy=d0(new Proxy(s.ctx,KA));const{setup:a}=i;if(a){const u=s.setupContext=a.length>1?T2(s):null,d=jo(s);Zi();const w=Pi(a,s,0,[s.props,u]);if(Xi(),d(),qm(w)){if(w.then(pm,pm),c)return w.then(p=>{fm(s,p,c)}).catch(p=>{ba(p,s,0)});s.asyncDep=w}else fm(s,w,c)}else U0(s,c)}function fm(s,c,i){rt(c)?s.type.__ssrInlineRender?s.ssrRender=c:s.render=c:Ot(c)&&(s.setupState=m0(c)),U0(s,i)}let gm;function U0(s,c,i){const a=s.type;if(!s.render){if(!c&&gm&&!a.render){const u=a.template||Sc(s).template;if(u){const{isCustomElement:d,compilerOptions:w}=s.appContext.config,{delimiters:p,compilerOptions:m}=a,y=en(en({isCustomElement:d,delimiters:p},w),m);a.render=gm(u,y)}}s.render=a.render||An}{const u=jo(s);Zi();try{JA(s)}finally{Xi(),u()}}}function _2(s){return s.attrsProxy||(s.attrsProxy=new Proxy(s.attrs,{get(c,i){return vn(s,"get","$attrs"),c[i]}}))}function T2(s){const c=i=>{s.exposed=i||{}};return{get attrs(){return _2(s)},slots:s.slots,emit:s.emit,expose:c}}function Ra(s){if(s.exposed)return s.exposeProxy||(s.exposeProxy=new Proxy(m0(d0(s.exposed)),{get(c,i){if(i in c)return c[i];if(i in _o)return _o[i](s)},has(c,i){return i in c||i in _o}}))}function C2(s,c=!0){return rt(s)?s.displayName||s.name:s.name||c&&s.__name}function P2(s){return rt(s)&&"__vccOpts"in s}const Fn=(s,c)=>gA(s,c,Pa);function V0(s,c,i){const a=arguments.length;return a===2?Ot(c)&&!Xe(c)?Qu(c)?mn(s,null,[c]):mn(s,c):mn(s,null,c):(a>3?i=Array.prototype.slice.call(arguments,2):a===3&&Qu(i)&&(i=[i]),mn(s,c,i))}const R2="3.4.21";/**
* @vue/runtime-dom v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const A2="http://www.w3.org/2000/svg",D2="http://www.w3.org/1998/Math/MathML",_i=typeof document<"u"?document:null,mm=_i&&_i.createElement("template"),O2={insert:(s,c,i)=>{c.insertBefore(s,i||null)},remove:s=>{const c=s.parentNode;c&&c.removeChild(s)},createElement:(s,c,i,a)=>{const u=c==="svg"?_i.createElementNS(A2,s):c==="mathml"?_i.createElementNS(D2,s):_i.createElement(s,i?{is:i}:void 0);return s==="select"&&a&&a.multiple!=null&&u.setAttribute("multiple",a.multiple),u},createText:s=>_i.createTextNode(s),createComment:s=>_i.createComment(s),setText:(s,c)=>{s.nodeValue=c},setElementText:(s,c)=>{s.textContent=c},parentNode:s=>s.parentNode,nextSibling:s=>s.nextSibling,querySelector:s=>_i.querySelector(s),setScopeId(s,c){s.setAttribute(c,"")},insertStaticContent(s,c,i,a,u,d){const w=i?i.previousSibling:c.lastChild;if(u&&(u===d||u.nextSibling))for(;c.insertBefore(u.cloneNode(!0),i),!(u===d||!(u=u.nextSibling)););else{mm.innerHTML=a==="svg"?`<svg>${s}</svg>`:a==="mathml"?`<math>${s}</math>`:s;const p=mm.content;if(a==="svg"||a==="mathml"){const m=p.firstChild;for(;m.firstChild;)p.appendChild(m.firstChild);p.removeChild(m)}c.insertBefore(p,i)}return[w?w.nextSibling:c.firstChild,i?i.previousSibling:c.lastChild]}},k2=Symbol("_vtc");function B2(s,c,i){const a=s[k2];a&&(c=(c?[c,...a]:[...a]).join(" ")),c==null?s.removeAttribute("class"):i?s.setAttribute("class",c):s.className=c}const vm=Symbol("_vod"),M2=Symbol("_vsh"),F2=Symbol(""),I2=/(^|;)\s*display\s*:/;function L2(s,c,i){const a=s.style,u=Gt(i);let d=!1;if(i&&!u){if(c)if(Gt(c))for(const w of c.split(";")){const p=w.slice(0,w.indexOf(":")).trim();i[p]==null&&ua(a,p,"")}else for(const w in c)i[w]==null&&ua(a,w,"");for(const w in i)w==="display"&&(d=!0),ua(a,w,i[w])}else if(u){if(c!==i){const w=a[F2];w&&(i+=";"+w),a.cssText=i,d=I2.test(i)}}else c&&s.removeAttribute("style");vm in s&&(s[vm]=d?a.display:"",s[M2]&&(a.display="none"))}const ym=/\s*!important$/;function ua(s,c,i){if(Xe(i))i.forEach(a=>ua(s,c,a));else if(i==null&&(i=""),c.startsWith("--"))s.setProperty(c,i);else{const a=H2(s,c);ym.test(i)?s.setProperty(Wr(a),i.replace(ym,""),"important"):s[a]=i}}const wm=["Webkit","Moz","ms"],Mu={};function H2(s,c){const i=Mu[c];if(i)return i;let a=Jn(c);if(a!=="filter"&&a in s)return Mu[c]=a;a=wa(a);for(let u=0;u<wm.length;u++){const d=wm[u]+a;if(d in s)return Mu[c]=d}return c}const Em="http://www.w3.org/1999/xlink";function N2(s,c,i,a,u){if(a&&c.startsWith("xlink:"))i==null?s.removeAttributeNS(Em,c.slice(6,c.length)):s.setAttributeNS(Em,c,i);else{const d=GR(c);i==null||d&&!Km(i)?s.removeAttribute(c):s.setAttribute(c,d?"":i)}}function z2(s,c,i,a,u,d,w){if(c==="innerHTML"||c==="textContent"){a&&w(a,u,d),s[c]=i??"";return}const p=s.tagName;if(c==="value"&&p!=="PROGRESS"&&!p.includes("-")){const y=p==="OPTION"?s.getAttribute("value")||"":s.value,x=i??"";(y!==x||!("_value"in s))&&(s.value=x),i==null&&s.removeAttribute(c),s._value=i;return}let m=!1;if(i===""||i==null){const y=typeof s[c];y==="boolean"?i=Km(i):i==null&&y==="string"?(i="",m=!0):y==="number"&&(i=0,m=!0)}try{s[c]=i}catch{}m&&s.removeAttribute(c)}function Cc(s,c,i,a){s.addEventListener(c,i,a)}function j2(s,c,i,a){s.removeEventListener(c,i,a)}const xm=Symbol("_vei");function U2(s,c,i,a,u=null){const d=s[xm]||(s[xm]={}),w=d[c];if(a&&w)w.value=a;else{const[p,m]=V2(c);if(a){const y=d[c]=q2(a,u);Cc(s,p,y,m)}else w&&(j2(s,p,w,m),d[c]=void 0)}}const bm=/(?:Once|Passive|Capture)$/;function V2(s){let c;if(bm.test(s)){c={};let a;for(;a=s.match(bm);)s=s.slice(0,s.length-a[0].length),c[a[0].toLowerCase()]=!0}return[s[2]===":"?s.slice(3):Wr(s.slice(2)),c]}let Fu=0;const W2=Promise.resolve(),G2=()=>Fu||(W2.then(()=>Fu=0),Fu=Date.now());function q2(s,c){const i=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=i.attached)return;Ln(Z2(a,i.value),c,5,[a])};return i.value=s,i.attached=G2(),i}function Z2(s,c){if(Xe(c)){const i=s.stopImmediatePropagation;return s.stopImmediatePropagation=()=>{i.call(s),s._stopped=!0},c.map(a=>u=>!u._stopped&&a&&a(u))}else return c}const Sm=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&s.charCodeAt(2)>96&&s.charCodeAt(2)<123,X2=(s,c,i,a,u,d,w,p,m)=>{const y=u==="svg";c==="class"?B2(s,a,y):c==="style"?L2(s,i,a):va(c)?sc(c)||U2(s,c,i,a,w):(c[0]==="."?(c=c.slice(1),!0):c[0]==="^"?(c=c.slice(1),!1):Y2(s,c,a,y))?z2(s,c,a,d,w,p,m):(c==="true-value"?s._trueValue=a:c==="false-value"&&(s._falseValue=a),N2(s,c,a,y))};function Y2(s,c,i,a){if(a)return!!(c==="innerHTML"||c==="textContent"||c in s&&Sm(c)&&rt(i));if(c==="spellcheck"||c==="draggable"||c==="translate"||c==="form"||c==="list"&&s.tagName==="INPUT"||c==="type"&&s.tagName==="TEXTAREA")return!1;if(c==="width"||c==="height"){const u=s.tagName;if(u==="IMG"||u==="VIDEO"||u==="CANVAS"||u==="SOURCE")return!1}return Sm(c)&&Gt(i)?!1:c in s}const ga=s=>{const c=s.props["onUpdate:modelValue"]||!1;return Xe(c)?i=>ra(c,i):c},Ir=Symbol("_assign"),_m={deep:!0,created(s,c,i){s[Ir]=ga(i),Cc(s,"change",()=>{const a=s._modelValue,u=Fo(s),d=s.checked,w=s[Ir];if(Xe(a)){const p=hc(a,u),m=p!==-1;if(d&&!m)w(a.concat(u));else if(!d&&m){const y=[...a];y.splice(p,1),w(y)}}else if(Vr(a)){const p=new Set(a);d?p.add(u):p.delete(u),w(p)}else w(W0(s,d))})},mounted:Tm,beforeUpdate(s,c,i){s[Ir]=ga(i),Tm(s,c,i)}};function Tm(s,{value:c,oldValue:i},a){s._modelValue=c,Xe(c)?s.checked=hc(c,a.props.value)>-1:Vr(c)?s.checked=c.has(a.props.value):c!==i&&(s.checked=No(c,W0(s,!0)))}const K2={deep:!0,created(s,{value:c,modifiers:{number:i}},a){const u=Vr(c);Cc(s,"change",()=>{const d=Array.prototype.filter.call(s.options,w=>w.selected).map(w=>i?uc(Fo(w)):Fo(w));s[Ir](s.multiple?u?new Set(d):d:d[0]),s._assigning=!0,Ec(()=>{s._assigning=!1})}),s[Ir]=ga(a)},mounted(s,{value:c,modifiers:{number:i}}){Cm(s,c,i)},beforeUpdate(s,c,i){s[Ir]=ga(i)},updated(s,{value:c,modifiers:{number:i}}){s._assigning||Cm(s,c,i)}};function Cm(s,c,i){const a=s.multiple,u=Xe(c);if(!(a&&!u&&!Vr(c))){for(let d=0,w=s.options.length;d<w;d++){const p=s.options[d],m=Fo(p);if(a)if(u){const y=typeof m;y==="string"||y==="number"?p.selected=c.includes(i?uc(m):m):p.selected=hc(c,m)>-1}else p.selected=c.has(m);else if(No(Fo(p),c)){s.selectedIndex!==d&&(s.selectedIndex=d);return}}!a&&s.selectedIndex!==-1&&(s.selectedIndex=-1)}}function Fo(s){return"_value"in s?s._value:s.value}function W0(s,c){const i=c?"_trueValue":"_falseValue";return i in s?s[i]:c}const J2=en({patchProp:X2},O2);let Pm;function Q2(){return Pm||(Pm=u2(J2))}const $2=(...s)=>{const c=Q2().createApp(...s),{mount:i}=c;return c.mount=a=>{const u=tD(a);if(!u)return;const d=c._component;!rt(d)&&!d.render&&!d.template&&(d.template=u.innerHTML),u.innerHTML="";const w=i(u,!1,eD(u));return u instanceof Element&&(u.removeAttribute("v-cloak"),u.setAttribute("data-v-app","")),w},c};function eD(s){if(s instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&s instanceof MathMLElement)return"mathml"}function tD(s){return Gt(s)?document.querySelector(s):s}function nD(){return G0().__VUE_DEVTOOLS_GLOBAL_HOOK__}function G0(){return typeof navigator<"u"&&typeof window<"u"?window:typeof globalThis<"u"?globalThis:{}}const iD=typeof Proxy=="function",rD="devtools-plugin:setup",oD="plugin:settings:set";let Pr,ec;function sD(){var s;return Pr!==void 0||(typeof window<"u"&&window.performance?(Pr=!0,ec=window.performance):typeof globalThis<"u"&&(!((s=globalThis.perf_hooks)===null||s===void 0)&&s.performance)?(Pr=!0,ec=globalThis.perf_hooks.performance):Pr=!1),Pr}function aD(){return sD()?ec.now():Date.now()}class lD{constructor(c,i){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=c,this.hook=i;const a={};if(c.settings)for(const w in c.settings){const p=c.settings[w];a[w]=p.defaultValue}const u=`__vue-devtools-plugin-settings__${c.id}`;let d=Object.assign({},a);try{const w=localStorage.getItem(u),p=JSON.parse(w);Object.assign(d,p)}catch{}this.fallbacks={getSettings(){return d},setSettings(w){try{localStorage.setItem(u,JSON.stringify(w))}catch{}d=w},now(){return aD()}},i&&i.on(oD,(w,p)=>{w===this.plugin.id&&this.fallbacks.setSettings(p)}),this.proxiedOn=new Proxy({},{get:(w,p)=>this.target?this.target.on[p]:(...m)=>{this.onQueue.push({method:p,args:m})}}),this.proxiedTarget=new Proxy({},{get:(w,p)=>this.target?this.target[p]:p==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(p)?(...m)=>(this.targetQueue.push({method:p,args:m,resolve:()=>{}}),this.fallbacks[p](...m)):(...m)=>new Promise(y=>{this.targetQueue.push({method:p,args:m,resolve:y})})})}async setRealTarget(c){this.target=c;for(const i of this.onQueue)this.target.on[i.method](...i.args);for(const i of this.targetQueue)i.resolve(await this.target[i.method](...i.args))}}function uD(s,c){const i=s,a=G0(),u=nD(),d=iD&&i.enableEarlyProxy;if(u&&(a.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!d))u.emit(rD,s,c);else{const w=d?new lD(i,u):null;(a.__VUE_DEVTOOLS_PLUGINS__=a.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:i,setupFn:c,proxy:w}),w&&c(w.proxiedTarget)}}/*!
  * vue-router v4.3.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Dr=typeof document<"u";function cD(s){return s.__esModule||s[Symbol.toStringTag]==="Module"}const Tt=Object.assign;function Iu(s,c){const i={};for(const a in c){const u=c[a];i[a]=Hn(u)?u.map(s):s(u)}return i}const Po=()=>{},Hn=Array.isArray,q0=/#/g,hD=/&/g,dD=/\//g,pD=/=/g,fD=/\?/g,Z0=/\+/g,gD=/%5B/g,mD=/%5D/g,X0=/%5E/g,vD=/%60/g,Y0=/%7B/g,yD=/%7C/g,K0=/%7D/g,wD=/%20/g;function Pc(s){return encodeURI(""+s).replace(yD,"|").replace(gD,"[").replace(mD,"]")}function ED(s){return Pc(s).replace(Y0,"{").replace(K0,"}").replace(X0,"^")}function tc(s){return Pc(s).replace(Z0,"%2B").replace(wD,"+").replace(q0,"%23").replace(hD,"%26").replace(vD,"`").replace(Y0,"{").replace(K0,"}").replace(X0,"^")}function xD(s){return tc(s).replace(pD,"%3D")}function bD(s){return Pc(s).replace(q0,"%23").replace(fD,"%3F")}function SD(s){return s==null?"":bD(s).replace(dD,"%2F")}function Io(s){try{return decodeURIComponent(""+s)}catch{}return""+s}const _D=/\/$/,TD=s=>s.replace(_D,"");function Lu(s,c,i="/"){let a,u={},d="",w="";const p=c.indexOf("#");let m=c.indexOf("?");return p<m&&p>=0&&(m=-1),m>-1&&(a=c.slice(0,m),d=c.slice(m+1,p>-1?p:c.length),u=s(d)),p>-1&&(a=a||c.slice(0,p),w=c.slice(p,c.length)),a=AD(a??c,i),{fullPath:a+(d&&"?")+d+w,path:a,query:u,hash:Io(w)}}function CD(s,c){const i=c.query?s(c.query):"";return c.path+(i&&"?")+i+(c.hash||"")}function Rm(s,c){return!c||!s.toLowerCase().startsWith(c.toLowerCase())?s:s.slice(c.length)||"/"}function PD(s,c,i){const a=c.matched.length-1,u=i.matched.length-1;return a>-1&&a===u&&Nr(c.matched[a],i.matched[u])&&J0(c.params,i.params)&&s(c.query)===s(i.query)&&c.hash===i.hash}function Nr(s,c){return(s.aliasOf||s)===(c.aliasOf||c)}function J0(s,c){if(Object.keys(s).length!==Object.keys(c).length)return!1;for(const i in s)if(!RD(s[i],c[i]))return!1;return!0}function RD(s,c){return Hn(s)?Am(s,c):Hn(c)?Am(c,s):s===c}function Am(s,c){return Hn(c)?s.length===c.length&&s.every((i,a)=>i===c[a]):s.length===1&&s[0]===c}function AD(s,c){if(s.startsWith("/"))return s;if(!s)return c;const i=c.split("/"),a=s.split("/"),u=a[a.length-1];(u===".."||u===".")&&a.push("");let d=i.length-1,w,p;for(w=0;w<a.length;w++)if(p=a[w],p!==".")if(p==="..")d>1&&d--;else break;return i.slice(0,d).join("/")+"/"+a.slice(w).join("/")}var Lo;(function(s){s.pop="pop",s.push="push"})(Lo||(Lo={}));var Ro;(function(s){s.back="back",s.forward="forward",s.unknown=""})(Ro||(Ro={}));function DD(s){if(!s)if(Dr){const c=document.querySelector("base");s=c&&c.getAttribute("href")||"/",s=s.replace(/^\w+:\/\/[^\/]+/,"")}else s="/";return s[0]!=="/"&&s[0]!=="#"&&(s="/"+s),TD(s)}const OD=/^[^#]+#/;function kD(s,c){return s.replace(OD,"#")+c}function BD(s,c){const i=document.documentElement.getBoundingClientRect(),a=s.getBoundingClientRect();return{behavior:c.behavior,left:a.left-i.left-(c.left||0),top:a.top-i.top-(c.top||0)}}const Aa=()=>({left:window.scrollX,top:window.scrollY});function MD(s){let c;if("el"in s){const i=s.el,a=typeof i=="string"&&i.startsWith("#"),u=typeof i=="string"?a?document.getElementById(i.slice(1)):document.querySelector(i):i;if(!u)return;c=BD(u,s)}else c=s;"scrollBehavior"in document.documentElement.style?window.scrollTo(c):window.scrollTo(c.left!=null?c.left:window.scrollX,c.top!=null?c.top:window.scrollY)}function Dm(s,c){return(history.state?history.state.position-c:-1)+s}const nc=new Map;function FD(s,c){nc.set(s,c)}function ID(s){const c=nc.get(s);return nc.delete(s),c}let LD=()=>location.protocol+"//"+location.host;function Q0(s,c){const{pathname:i,search:a,hash:u}=c,d=s.indexOf("#");if(d>-1){let p=u.includes(s.slice(d))?s.slice(d).length:1,m=u.slice(p);return m[0]!=="/"&&(m="/"+m),Rm(m,"")}return Rm(i,s)+a+u}function HD(s,c,i,a){let u=[],d=[],w=null;const p=({state:T})=>{const B=Q0(s,location),L=i.value,q=c.value;let V=0;if(T){if(i.value=B,c.value=T,w&&w===L){w=null;return}V=q?T.position-q.position:0}else a(B);u.forEach(G=>{G(i.value,L,{delta:V,type:Lo.pop,direction:V?V>0?Ro.forward:Ro.back:Ro.unknown})})};function m(){w=i.value}function y(T){u.push(T);const B=()=>{const L=u.indexOf(T);L>-1&&u.splice(L,1)};return d.push(B),B}function x(){const{history:T}=window;T.state&&T.replaceState(Tt({},T.state,{scroll:Aa()}),"")}function S(){for(const T of d)T();d=[],window.removeEventListener("popstate",p),window.removeEventListener("beforeunload",x)}return window.addEventListener("popstate",p),window.addEventListener("beforeunload",x,{passive:!0}),{pauseListeners:m,listen:y,destroy:S}}function Om(s,c,i,a=!1,u=!1){return{back:s,current:c,forward:i,replaced:a,position:window.history.length,scroll:u?Aa():null}}function ND(s){const{history:c,location:i}=window,a={value:Q0(s,i)},u={value:c.state};u.value||d(a.value,{back:null,current:a.value,forward:null,position:c.length-1,replaced:!0,scroll:null},!0);function d(m,y,x){const S=s.indexOf("#"),T=S>-1?(i.host&&document.querySelector("base")?s:s.slice(S))+m:LD()+s+m;try{c[x?"replaceState":"pushState"](y,"",T),u.value=y}catch(B){console.error(B),i[x?"replace":"assign"](T)}}function w(m,y){const x=Tt({},c.state,Om(u.value.back,m,u.value.forward,!0),y,{position:u.value.position});d(m,x,!0),a.value=m}function p(m,y){const x=Tt({},u.value,c.state,{forward:m,scroll:Aa()});d(x.current,x,!0);const S=Tt({},Om(a.value,m,null),{position:x.position+1},y);d(m,S,!1),a.value=m}return{location:a,state:u,push:p,replace:w}}function zD(s){s=DD(s);const c=ND(s),i=HD(s,c.state,c.location,c.replace);function a(d,w=!0){w||i.pauseListeners(),history.go(d)}const u=Tt({location:"",base:s,go:a,createHref:kD.bind(null,s)},c,i);return Object.defineProperty(u,"location",{enumerable:!0,get:()=>c.location.value}),Object.defineProperty(u,"state",{enumerable:!0,get:()=>c.state.value}),u}function jD(s){return typeof s=="string"||s&&typeof s=="object"}function $0(s){return typeof s=="string"||typeof s=="symbol"}const xi={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},ev=Symbol("");var km;(function(s){s[s.aborted=4]="aborted",s[s.cancelled=8]="cancelled",s[s.duplicated=16]="duplicated"})(km||(km={}));function zr(s,c){return Tt(new Error,{type:s,[ev]:!0},c)}function si(s,c){return s instanceof Error&&ev in s&&(c==null||!!(s.type&c))}const Bm="[^/]+?",UD={sensitive:!1,strict:!1,start:!0,end:!0},VD=/[.+*?^${}()[\]/\\]/g;function WD(s,c){const i=Tt({},UD,c),a=[];let u=i.start?"^":"";const d=[];for(const y of s){const x=y.length?[]:[90];i.strict&&!y.length&&(u+="/");for(let S=0;S<y.length;S++){const T=y[S];let B=40+(i.sensitive?.25:0);if(T.type===0)S||(u+="/"),u+=T.value.replace(VD,"\\$&"),B+=40;else if(T.type===1){const{value:L,repeatable:q,optional:V,regexp:G}=T;d.push({name:L,repeatable:q,optional:V});const te=G||Bm;if(te!==Bm){B+=10;try{new RegExp(`(${te})`)}catch(Te){throw new Error(`Invalid custom RegExp for param "${L}" (${te}): `+Te.message)}}let se=q?`((?:${te})(?:/(?:${te}))*)`:`(${te})`;S||(se=V&&y.length<2?`(?:/${se})`:"/"+se),V&&(se+="?"),u+=se,B+=20,V&&(B+=-8),q&&(B+=-20),te===".*"&&(B+=-50)}x.push(B)}a.push(x)}if(i.strict&&i.end){const y=a.length-1;a[y][a[y].length-1]+=.7000000000000001}i.strict||(u+="/?"),i.end?u+="$":i.strict&&(u+="(?:/|$)");const w=new RegExp(u,i.sensitive?"":"i");function p(y){const x=y.match(w),S={};if(!x)return null;for(let T=1;T<x.length;T++){const B=x[T]||"",L=d[T-1];S[L.name]=B&&L.repeatable?B.split("/"):B}return S}function m(y){let x="",S=!1;for(const T of s){(!S||!x.endsWith("/"))&&(x+="/"),S=!1;for(const B of T)if(B.type===0)x+=B.value;else if(B.type===1){const{value:L,repeatable:q,optional:V}=B,G=L in y?y[L]:"";if(Hn(G)&&!q)throw new Error(`Provided param "${L}" is an array but it is not repeatable (* or + modifiers)`);const te=Hn(G)?G.join("/"):G;if(!te)if(V)T.length<2&&(x.endsWith("/")?x=x.slice(0,-1):S=!0);else throw new Error(`Missing required param "${L}"`);x+=te}}return x||"/"}return{re:w,score:a,keys:d,parse:p,stringify:m}}function GD(s,c){let i=0;for(;i<s.length&&i<c.length;){const a=c[i]-s[i];if(a)return a;i++}return s.length<c.length?s.length===1&&s[0]===80?-1:1:s.length>c.length?c.length===1&&c[0]===80?1:-1:0}function qD(s,c){let i=0;const a=s.score,u=c.score;for(;i<a.length&&i<u.length;){const d=GD(a[i],u[i]);if(d)return d;i++}if(Math.abs(u.length-a.length)===1){if(Mm(a))return 1;if(Mm(u))return-1}return u.length-a.length}function Mm(s){const c=s[s.length-1];return s.length>0&&c[c.length-1]<0}const ZD={type:0,value:""},XD=/[a-zA-Z0-9_]/;function YD(s){if(!s)return[[]];if(s==="/")return[[ZD]];if(!s.startsWith("/"))throw new Error(`Invalid path "${s}"`);function c(B){throw new Error(`ERR (${i})/"${y}": ${B}`)}let i=0,a=i;const u=[];let d;function w(){d&&u.push(d),d=[]}let p=0,m,y="",x="";function S(){y&&(i===0?d.push({type:0,value:y}):i===1||i===2||i===3?(d.length>1&&(m==="*"||m==="+")&&c(`A repeatable param (${y}) must be alone in its segment. eg: '/:ids+.`),d.push({type:1,value:y,regexp:x,repeatable:m==="*"||m==="+",optional:m==="*"||m==="?"})):c("Invalid state to consume buffer"),y="")}function T(){y+=m}for(;p<s.length;){if(m=s[p++],m==="\\"&&i!==2){a=i,i=4;continue}switch(i){case 0:m==="/"?(y&&S(),w()):m===":"?(S(),i=1):T();break;case 4:T(),i=a;break;case 1:m==="("?i=2:XD.test(m)?T():(S(),i=0,m!=="*"&&m!=="?"&&m!=="+"&&p--);break;case 2:m===")"?x[x.length-1]=="\\"?x=x.slice(0,-1)+m:i=3:x+=m;break;case 3:S(),i=0,m!=="*"&&m!=="?"&&m!=="+"&&p--,x="";break;default:c("Unknown state");break}}return i===2&&c(`Unfinished custom RegExp for param "${y}"`),S(),w(),u}function KD(s,c,i){const a=WD(YD(s.path),i),u=Tt(a,{record:s,parent:c,children:[],alias:[]});return c&&!u.record.aliasOf==!c.record.aliasOf&&c.children.push(u),u}function JD(s,c){const i=[],a=new Map;c=Lm({strict:!1,end:!0,sensitive:!1},c);function u(x){return a.get(x)}function d(x,S,T){const B=!T,L=QD(x);L.aliasOf=T&&T.record;const q=Lm(c,x),V=[L];if("alias"in x){const se=typeof x.alias=="string"?[x.alias]:x.alias;for(const Te of se)V.push(Tt({},L,{components:T?T.record.components:L.components,path:Te,aliasOf:T?T.record:L}))}let G,te;for(const se of V){const{path:Te}=se;if(S&&Te[0]!=="/"){const Ie=S.record.path,Ce=Ie[Ie.length-1]==="/"?"":"/";se.path=S.record.path+(Te&&Ce+Te)}if(G=KD(se,S,q),T?T.alias.push(G):(te=te||G,te!==G&&te.alias.push(G),B&&x.name&&!Im(G)&&w(x.name)),L.children){const Ie=L.children;for(let Ce=0;Ce<Ie.length;Ce++)d(Ie[Ce],G,T&&T.children[Ce])}T=T||G,(G.record.components&&Object.keys(G.record.components).length||G.record.name||G.record.redirect)&&m(G)}return te?()=>{w(te)}:Po}function w(x){if($0(x)){const S=a.get(x);S&&(a.delete(x),i.splice(i.indexOf(S),1),S.children.forEach(w),S.alias.forEach(w))}else{const S=i.indexOf(x);S>-1&&(i.splice(S,1),x.record.name&&a.delete(x.record.name),x.children.forEach(w),x.alias.forEach(w))}}function p(){return i}function m(x){let S=0;for(;S<i.length&&qD(x,i[S])>=0&&(x.record.path!==i[S].record.path||!tv(x,i[S]));)S++;i.splice(S,0,x),x.record.name&&!Im(x)&&a.set(x.record.name,x)}function y(x,S){let T,B={},L,q;if("name"in x&&x.name){if(T=a.get(x.name),!T)throw zr(1,{location:x});q=T.record.name,B=Tt(Fm(S.params,T.keys.filter(te=>!te.optional).concat(T.parent?T.parent.keys.filter(te=>te.optional):[]).map(te=>te.name)),x.params&&Fm(x.params,T.keys.map(te=>te.name))),L=T.stringify(B)}else if(x.path!=null)L=x.path,T=i.find(te=>te.re.test(L)),T&&(B=T.parse(L),q=T.record.name);else{if(T=S.name?a.get(S.name):i.find(te=>te.re.test(S.path)),!T)throw zr(1,{location:x,currentLocation:S});q=T.record.name,B=Tt({},S.params,x.params),L=T.stringify(B)}const V=[];let G=T;for(;G;)V.unshift(G.record),G=G.parent;return{name:q,path:L,params:B,matched:V,meta:eO(V)}}return s.forEach(x=>d(x)),{addRoute:d,resolve:y,removeRoute:w,getRoutes:p,getRecordMatcher:u}}function Fm(s,c){const i={};for(const a of c)a in s&&(i[a]=s[a]);return i}function QD(s){return{path:s.path,redirect:s.redirect,name:s.name,meta:s.meta||{},aliasOf:void 0,beforeEnter:s.beforeEnter,props:$D(s),children:s.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in s?s.components||null:s.component&&{default:s.component}}}function $D(s){const c={},i=s.props||!1;if("component"in s)c.default=i;else for(const a in s.components)c[a]=typeof i=="object"?i[a]:i;return c}function Im(s){for(;s;){if(s.record.aliasOf)return!0;s=s.parent}return!1}function eO(s){return s.reduce((c,i)=>Tt(c,i.meta),{})}function Lm(s,c){const i={};for(const a in s)i[a]=a in c?c[a]:s[a];return i}function tv(s,c){return c.children.some(i=>i===s||tv(s,i))}function tO(s){const c={};if(s===""||s==="?")return c;const a=(s[0]==="?"?s.slice(1):s).split("&");for(let u=0;u<a.length;++u){const d=a[u].replace(Z0," "),w=d.indexOf("="),p=Io(w<0?d:d.slice(0,w)),m=w<0?null:Io(d.slice(w+1));if(p in c){let y=c[p];Hn(y)||(y=c[p]=[y]),y.push(m)}else c[p]=m}return c}function Hm(s){let c="";for(let i in s){const a=s[i];if(i=xD(i),a==null){a!==void 0&&(c+=(c.length?"&":"")+i);continue}(Hn(a)?a.map(d=>d&&tc(d)):[a&&tc(a)]).forEach(d=>{d!==void 0&&(c+=(c.length?"&":"")+i,d!=null&&(c+="="+d))})}return c}function nO(s){const c={};for(const i in s){const a=s[i];a!==void 0&&(c[i]=Hn(a)?a.map(u=>u==null?null:""+u):a==null?a:""+a)}return c}const iO=Symbol(""),Nm=Symbol(""),Rc=Symbol(""),nv=Symbol(""),ic=Symbol("");function xo(){let s=[];function c(a){return s.push(a),()=>{const u=s.indexOf(a);u>-1&&s.splice(u,1)}}function i(){s=[]}return{add:c,list:()=>s.slice(),reset:i}}function Ti(s,c,i,a,u,d=w=>w()){const w=a&&(a.enterCallbacks[u]=a.enterCallbacks[u]||[]);return()=>new Promise((p,m)=>{const y=T=>{T===!1?m(zr(4,{from:i,to:c})):T instanceof Error?m(T):jD(T)?m(zr(2,{from:c,to:T})):(w&&a.enterCallbacks[u]===w&&typeof T=="function"&&w.push(T),p())},x=d(()=>s.call(a&&a.instances[u],c,i,y));let S=Promise.resolve(x);s.length<3&&(S=S.then(y)),S.catch(T=>m(T))})}function Hu(s,c,i,a,u=d=>d()){const d=[];for(const w of s)for(const p in w.components){let m=w.components[p];if(!(c!=="beforeRouteEnter"&&!w.instances[p]))if(rO(m)){const x=(m.__vccOpts||m)[c];x&&d.push(Ti(x,i,a,w,p,u))}else{let y=m();d.push(()=>y.then(x=>{if(!x)return Promise.reject(new Error(`Couldn't resolve component "${p}" at "${w.path}"`));const S=cD(x)?x.default:x;w.components[p]=S;const B=(S.__vccOpts||S)[c];return B&&Ti(B,i,a,w,p,u)()}))}}return d}function rO(s){return typeof s=="object"||"displayName"in s||"props"in s||"__vccOpts"in s}function zm(s){const c=ci(Rc),i=ci(nv),a=Fn(()=>c.resolve(ui(s.to))),u=Fn(()=>{const{matched:m}=a.value,{length:y}=m,x=m[y-1],S=i.matched;if(!x||!S.length)return-1;const T=S.findIndex(Nr.bind(null,x));if(T>-1)return T;const B=jm(m[y-2]);return y>1&&jm(x)===B&&S[S.length-1].path!==B?S.findIndex(Nr.bind(null,m[y-2])):T}),d=Fn(()=>u.value>-1&&aO(i.params,a.value.params)),w=Fn(()=>u.value>-1&&u.value===i.matched.length-1&&J0(i.params,a.value.params));function p(m={}){return sO(m)?c[ui(s.replace)?"replace":"push"](ui(s.to)).catch(Po):Promise.resolve()}return{route:a,href:Fn(()=>a.value.href),isActive:d,isExactActive:w,navigate:p}}const oO=C0({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:zm,setup(s,{slots:c}){const i=zo(zm(s)),{options:a}=ci(Rc),u=Fn(()=>({[Um(s.activeClass,a.linkActiveClass,"router-link-active")]:i.isActive,[Um(s.exactActiveClass,a.linkExactActiveClass,"router-link-exact-active")]:i.isExactActive}));return()=>{const d=c.default&&c.default(i);return s.custom?d:V0("a",{"aria-current":i.isExactActive?s.ariaCurrentValue:null,href:i.href,onClick:i.navigate,class:u.value},d)}}}),iv=oO;function sO(s){if(!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)&&!s.defaultPrevented&&!(s.button!==void 0&&s.button!==0)){if(s.currentTarget&&s.currentTarget.getAttribute){const c=s.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(c))return}return s.preventDefault&&s.preventDefault(),!0}}function aO(s,c){for(const i in c){const a=c[i],u=s[i];if(typeof a=="string"){if(a!==u)return!1}else if(!Hn(u)||u.length!==a.length||a.some((d,w)=>d!==u[w]))return!1}return!0}function jm(s){return s?s.aliasOf?s.aliasOf.path:s.path:""}const Um=(s,c,i)=>s??c??i,lO=C0({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(s,{attrs:c,slots:i}){const a=ci(ic),u=Fn(()=>s.route||a.value),d=ci(Nm,0),w=Fn(()=>{let y=ui(d);const{matched:x}=u.value;let S;for(;(S=x[y])&&!S.components;)y++;return y}),p=Fn(()=>u.value.matched[w.value]);aa(Nm,Fn(()=>w.value+1)),aa(iO,p),aa(ic,u);const m=mA();return Fr(()=>[m.value,p.value,s.name],([y,x,S],[T,B,L])=>{x&&(x.instances[S]=y,B&&B!==x&&y&&y===T&&(x.leaveGuards.size||(x.leaveGuards=B.leaveGuards),x.updateGuards.size||(x.updateGuards=B.updateGuards))),y&&x&&(!B||!Nr(x,B)||!T)&&(x.enterCallbacks[S]||[]).forEach(q=>q(y))},{flush:"post"}),()=>{const y=u.value,x=s.name,S=p.value,T=S&&S.components[x];if(!T)return Vm(i.default,{Component:T,route:y});const B=S.props[x],L=B?B===!0?y.params:typeof B=="function"?B(y):B:null,V=V0(T,Tt({},L,c,{onVnodeUnmounted:G=>{G.component.isUnmounted&&(S.instances[x]=null)},ref:m}));return Vm(i.default,{Component:V,route:y})||V}}});function Vm(s,c){if(!s)return null;const i=s(c);return i.length===1?i[0]:i}const rv=lO;function uO(s){const c=JD(s.routes,s),i=s.parseQuery||tO,a=s.stringifyQuery||Hm,u=s.history,d=xo(),w=xo(),p=xo(),m=vA(xi);let y=xi;Dr&&s.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const x=Iu.bind(null,pe=>""+pe),S=Iu.bind(null,SD),T=Iu.bind(null,Io);function B(pe,_e){let Re,ke;return $0(pe)?(Re=c.getRecordMatcher(pe),ke=_e):ke=pe,c.addRoute(ke,Re)}function L(pe){const _e=c.getRecordMatcher(pe);_e&&c.removeRoute(_e)}function q(){return c.getRoutes().map(pe=>pe.record)}function V(pe){return!!c.getRecordMatcher(pe)}function G(pe,_e){if(_e=Tt({},_e||m.value),typeof pe=="string"){const Q=Lu(i,pe,_e.path),le=c.resolve({path:Q.path},_e),ge=u.createHref(Q.fullPath);return Tt(Q,le,{params:T(le.params),hash:Io(Q.hash),redirectedFrom:void 0,href:ge})}let Re;if(pe.path!=null)Re=Tt({},pe,{path:Lu(i,pe.path,_e.path).path});else{const Q=Tt({},pe.params);for(const le in Q)Q[le]==null&&delete Q[le];Re=Tt({},pe,{params:S(Q)}),_e.params=S(_e.params)}const ke=c.resolve(Re,_e),st=pe.hash||"";ke.params=x(T(ke.params));const yt=CD(a,Tt({},pe,{hash:ED(st),path:ke.path})),Z=u.createHref(yt);return Tt({fullPath:yt,hash:st,query:a===Hm?nO(pe.query):pe.query||{}},ke,{redirectedFrom:void 0,href:Z})}function te(pe){return typeof pe=="string"?Lu(i,pe,m.value.path):Tt({},pe)}function se(pe,_e){if(y!==pe)return zr(8,{from:_e,to:pe})}function Te(pe){return Ne(pe)}function Ie(pe){return Te(Tt(te(pe),{replace:!0}))}function Ce(pe){const _e=pe.matched[pe.matched.length-1];if(_e&&_e.redirect){const{redirect:Re}=_e;let ke=typeof Re=="function"?Re(pe):Re;return typeof ke=="string"&&(ke=ke.includes("?")||ke.includes("#")?ke=te(ke):{path:ke},ke.params={}),Tt({query:pe.query,hash:pe.hash,params:ke.path!=null?{}:pe.params},ke)}}function Ne(pe,_e){const Re=y=G(pe),ke=m.value,st=pe.state,yt=pe.force,Z=pe.replace===!0,Q=Ce(Re);if(Q)return Ne(Tt(te(Q),{state:typeof Q=="object"?Tt({},st,Q.state):st,force:yt,replace:Z}),_e||Re);const le=Re;le.redirectedFrom=_e;let ge;return!yt&&PD(a,ke,Re)&&(ge=zr(16,{to:le,from:ke}),Yt(ke,ke,!0,!1)),(ge?Promise.resolve(ge):at(le,ke)).catch(b=>si(b)?si(b,2)?b:Ht(b):it(b,le,ke)).then(b=>{if(b){if(si(b,2))return Ne(Tt({replace:Z},te(b.to),{state:typeof b.to=="object"?Tt({},st,b.to.state):st,force:yt}),_e||le)}else b=Ct(le,ke,!0,Z,st);return vt(le,ke,b),b})}function je(pe,_e){const Re=se(pe,_e);return Re?Promise.reject(Re):Promise.resolve()}function ot(pe){const _e=hn.values().next().value;return _e&&typeof _e.runWithContext=="function"?_e.runWithContext(pe):pe()}function at(pe,_e){let Re;const[ke,st,yt]=cO(pe,_e);Re=Hu(ke.reverse(),"beforeRouteLeave",pe,_e);for(const Q of ke)Q.leaveGuards.forEach(le=>{Re.push(Ti(le,pe,_e))});const Z=je.bind(null,pe,_e);return Re.push(Z),Pt(Re).then(()=>{Re=[];for(const Q of d.list())Re.push(Ti(Q,pe,_e));return Re.push(Z),Pt(Re)}).then(()=>{Re=Hu(st,"beforeRouteUpdate",pe,_e);for(const Q of st)Q.updateGuards.forEach(le=>{Re.push(Ti(le,pe,_e))});return Re.push(Z),Pt(Re)}).then(()=>{Re=[];for(const Q of yt)if(Q.beforeEnter)if(Hn(Q.beforeEnter))for(const le of Q.beforeEnter)Re.push(Ti(le,pe,_e));else Re.push(Ti(Q.beforeEnter,pe,_e));return Re.push(Z),Pt(Re)}).then(()=>(pe.matched.forEach(Q=>Q.enterCallbacks={}),Re=Hu(yt,"beforeRouteEnter",pe,_e,ot),Re.push(Z),Pt(Re))).then(()=>{Re=[];for(const Q of w.list())Re.push(Ti(Q,pe,_e));return Re.push(Z),Pt(Re)}).catch(Q=>si(Q,8)?Q:Promise.reject(Q))}function vt(pe,_e,Re){p.list().forEach(ke=>ot(()=>ke(pe,_e,Re)))}function Ct(pe,_e,Re,ke,st){const yt=se(pe,_e);if(yt)return yt;const Z=_e===xi,Q=Dr?history.state:{};Re&&(ke||Z?u.replace(pe.fullPath,Tt({scroll:Z&&Q&&Q.scroll},st)):u.push(pe.fullPath,st)),m.value=pe,Yt(pe,_e,Re,Z),Ht()}let Rt;function Lt(){Rt||(Rt=u.listen((pe,_e,Re)=>{if(!Dn.listening)return;const ke=G(pe),st=Ce(ke);if(st){Ne(Tt(st,{replace:!0}),ke).catch(Po);return}y=ke;const yt=m.value;Dr&&FD(Dm(yt.fullPath,Re.delta),Aa()),at(ke,yt).catch(Z=>si(Z,12)?Z:si(Z,2)?(Ne(Z.to,ke).then(Q=>{si(Q,20)&&!Re.delta&&Re.type===Lo.pop&&u.go(-1,!1)}).catch(Po),Promise.reject()):(Re.delta&&u.go(-Re.delta,!1),it(Z,ke,yt))).then(Z=>{Z=Z||Ct(ke,yt,!1),Z&&(Re.delta&&!si(Z,8)?u.go(-Re.delta,!1):Re.type===Lo.pop&&si(Z,20)&&u.go(-1,!1)),vt(ke,yt,Z)}).catch(Po)}))}let ln=xo(),ft=xo(),nt;function it(pe,_e,Re){Ht(pe);const ke=ft.list();return ke.length?ke.forEach(st=>st(pe,_e,Re)):console.error(pe),Promise.reject(pe)}function jt(){return nt&&m.value!==xi?Promise.resolve():new Promise((pe,_e)=>{ln.add([pe,_e])})}function Ht(pe){return nt||(nt=!pe,Lt(),ln.list().forEach(([_e,Re])=>pe?Re(pe):_e()),ln.reset()),pe}function Yt(pe,_e,Re,ke){const{scrollBehavior:st}=s;if(!Dr||!st)return Promise.resolve();const yt=!Re&&ID(Dm(pe.fullPath,0))||(ke||!Re)&&history.state&&history.state.scroll||null;return Ec().then(()=>st(pe,_e,yt)).then(Z=>Z&&MD(Z)).catch(Z=>it(Z,pe,_e))}const Nt=pe=>u.go(pe);let We;const hn=new Set,Dn={currentRoute:m,listening:!0,addRoute:B,removeRoute:L,hasRoute:V,getRoutes:q,resolve:G,options:s,push:Te,replace:Ie,go:Nt,back:()=>Nt(-1),forward:()=>Nt(1),beforeEach:d.add,beforeResolve:w.add,afterEach:p.add,onError:ft.add,isReady:jt,install(pe){const _e=this;pe.component("RouterLink",iv),pe.component("RouterView",rv),pe.config.globalProperties.$router=_e,Object.defineProperty(pe.config.globalProperties,"$route",{enumerable:!0,get:()=>ui(m)}),Dr&&!We&&m.value===xi&&(We=!0,Te(u.location).catch(st=>{}));const Re={};for(const st in xi)Object.defineProperty(Re,st,{get:()=>m.value[st],enumerable:!0});pe.provide(Rc,_e),pe.provide(nv,u0(Re)),pe.provide(ic,m);const ke=pe.unmount;hn.add(pe),pe.unmount=function(){hn.delete(pe),hn.size<1&&(y=xi,Rt&&Rt(),Rt=null,m.value=xi,We=!1,nt=!1),ke()}}};function Pt(pe){return pe.reduce((_e,Re)=>_e.then(()=>ot(Re)),Promise.resolve())}return Dn}function cO(s,c){const i=[],a=[],u=[],d=Math.max(c.matched.length,s.matched.length);for(let w=0;w<d;w++){const p=c.matched[w];p&&(s.matched.find(y=>Nr(y,p))?a.push(p):i.push(p));const m=s.matched[w];m&&(c.matched.find(y=>Nr(y,m))||u.push(m))}return[i,a,u]}const Ac=(s,c)=>{const i=s.__vccOpts||s;for(const[a,u]of c)i[a]=u;return i},hO={__name:"App",setup(s){return(c,i)=>(Kn(),g2(ui(rv)))}},dO=Ac(hO,[["__scopeId","data-v-e476b595"]]),pO="/iike/ii-icon_256.png",jr={version:"0.0.1",list:[{bookid:"iike-15",title:"",volume:15,identifier:"850/8500/08/0115",pages:["0001","0002","0003","0004","0005","0006","0007","0008","0009","0010","0011","0012","0013","0014","0015","0016","0017","0018","0019","0020","0021","0022","0023","0024","0025","0026","0027","0028","0029","0030","0031","0032","0033","0034","0035","0036","0037","0038","0039","0040","0041","0042","0043","0044","0045","0046","0047","0048","0049","0050","0051","0052","0053","0054","0055","0056","0057","0058","0059","0060","0061","0062","0063","0064","0065","0066","0067","0068","0069","0070","0071","0072","0073","0074","0075","0076","0077","0078","0079","0080","0081","0082","0083","0084","0085","0086","0087","0088","0089","0090","0091","0092","0093","0094","0095","0096","0097","0098","0099","0100","0101","0102","0103","0104","0105","0106","0107","0108","0109","0110","0111","0112","0113","0114","0115","0116","0117","0118","0119","0120","0121","0122","0123","0124","0125","0126","0127","0128","0129","0130","0131","0132","0133","0134","0135","0136","0137","0138","0139","0140","0141","0142","0143","0144","0145","0146","0147","0148","0149","0150","0151","0152","0153","0154","0155","0156","0157","0158","0159","0160","0161","0162","0163","0164","0165","0166","0167","0168","0169","0170","0171","0172","0173","0174","0175","0176","0177","0178","0179","0180","0181","0182","0183","0184","0185","0186","0187","0188","0189","0190","0191","0192","0193","0194","0195","0196","0197","0198","0199","0200","0201","0202","0203","0204","0205","0206","0207","0208","0209","0210","0211","0212","0213","0214","0215","0216","0217","0218","0219","0220","0221","0222","0223","0224","0225","0226","0227","0228","0229","0230","0231","0232","0233","0234","0235","0236","0237","0238","0239","0240","0241","0242","0243","0244","0245","0246","0247","0248","0249","0250","0251","0252","0253","0254","0255","0256","0257","0258","0259","0260","0261","0262","0263","0264","0265","0266","0267","0268","0269","0270","0271","0272","0273","0274","0275","0276","0277","0278","0279","0280","0281","0282","0283","0284","0285","0286","0287","0288","0289","0290","0291","0292","0293","0294","0295","0296","0297","0298","0299","0300","0301","0302","0303","0304","0305","0306","0307","0308","0309","0310","0311","0312","0313","0314","0315","0316","0317","0318","0319","0320","0321","0322","0323","0324","0325","0326","0327","0328","0329","0330","0331","0332","0333","0334","0335","0336","0337","0338","0339","0340","0341","0342","0343","0344","0345","0346","0347","0348","0349","0350","0351","0352","0353","0354","0355","0356","0357","0358","0359","0360","0361","0362","0363","0364","0365","0366","0367","0368","0369","0370"],jsonUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/info/idata/",suffix:"/",extension:""},imageUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/image/idata/",suffix:"/",extension:".tif"},width:2112,height:3200,width_excep:[],height_excep:[]},{bookid:"iike-20",title:"",volume:"20",identifier:"850/8500/08/0120",pages:["0001","0002","0003","0004","0005","0006","0007","0008","0009","0010","0011","0012","0013","0014","0015","0016","0017","0018","0019","0020","0021","0022","0023","0024","0025","0026","0027","0028","0029","0030","0031","0032","0033","0034","0035","0036","0037","0038","0039","0040","0041","0042","0043","0044","0045","0046","0047","0048","0049","0050","0051","0052","0053","0054","0055","0056","0057","0058","0059","0060","0061","0062","0063","0064","0065","0066","0067","0068","0069","0070","0071","0072","0073","0074","0075","0076","0077","0078","0079","0080","0081","0082","0083","0084","0085","0086","0087","0088","0089","0090","0091","0092","0093","0094","0095","0096","0097","0098","0099","0100","0101","0102","0103","0104","0105","0106","0107","0108","0109","0110","0111","0112","0113","0114","0115","0116","0117","0118","0119","0120","0121","0122","0123","0124","0125","0126","0127","0128","0129","0130","0131","0132","0133","0134","0135","0136","0137","0138","0139","0140","0141","0142","0143","0144","0145","0146","0147","0148","0149","0150","0151","0152","0153","0154","0155","0156","0157","0158","0159","0160","0161","0162","0163","0164","0165","0166","0167","0168","0169","0170","0171","0172","0173","0174","0175","0176","0177","0178","0179","0180","0181","0182","0183","0184","0185","0186","0187","0188","0189","0190","0191","0192","0193","0194","0195","0196","0197","0198","0199","0200","0201","0202","0203","0204","0205","0206","0207","0208","0209","0210","0211","0212","0213","0214","0215","0216","0217","0218","0219","0220","0221","0222","0223","0224","0225","0226","0227","0228","0229","0230","0231","0232","0233","0234","0235","0236","0237","0238","0239","0240","0241","0242","0243","0244","0245","0246","0247","0248","0249","0250","0251","0252","0253","0254","0255","0256","0257","0258","0259","0260","0261","0262","0263","0264","0265","0266","0267","0268","0269","0270","0271","0272","0273","0274","0275","0276","0277","0278","0279","0280","0281","0282","0283","0284","0285","0286","0287","0288","0289","0290","0291","0292","0293","0294","0295","0296","0297","0298","0299","0300","0301","0302","0303","0304","0305","0306","0307","0308","0309","0310","0311","0312","0313","0314","0315","0316","0317","0318","0319","0320","0321","0322","0323","0324","0325","0326","0327","0328","0329","0330","0331","0332","0333","0334","0335","0336","0337","0338","0339","0340","0341","0342","0343","0344","0345","0346","0347","0348","0349","0350","0351","0352","0353","0354","0355","0356","0357","0358","0359","0360","0361","0362","0363","0364","0365","0366","0367","0368","0369","0370","0371","0372","0373","0374","0375","0376"],jsonUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/info/idata/",suffix:"/",extension:""},imageUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/image/idata/",suffix:"/",extension:".tif"},width:2112,height:3200,width_excep:[],height_excep:[]},{bookid:"iike-30",title:"",volume:"30",identifier:"850/8500/08/0130",pages:["0001","0002","0003","0004","0005","0006","0007","0008","0009","0010","0011","0012","0013","0014","0015","0016","0017","0018","0019","0020","0021","0022","0023","0024","0025","0026","0027","0028","0029","0030","0031","0032","0033","0034","0035","0036","0037","0038","0039","0040","0041","0042","0043","0044","0045","0046","0047","0048","0049","0050","0051","0052","0053","0054","0055","0056","0057","0058","0059","0060","0061","0062","0063","0064","0065","0066","0067","0068","0069","0070","0071","0072","0073","0074","0075","0076","0077","0078","0079","0080","0081","0082","0083","0084","0085","0086","0087","0088","0089","0090","0091","0092","0093","0094","0095","0096","0097","0098","0099","0100","0101","0102","0103","0104","0105","0106","0107","0108","0109","0110","0111","0112","0113","0114","0115","0116","0117","0118","0119","0120","0121","0122","0123","0124","0125","0126","0127","0128","0129","0130","0131","0132","0133","0134","0135","0136","0137","0138","0139","0140","0141","0142","0143","0144","0145","0146","0147","0148","0149","0150","0151","0152","0153","0154","0155","0156","0157","0158","0159","0160","0161","0162","0163","0164","0165","0166","0167","0168","0169","0170","0171","0172","0173","0174","0175","0176","0177","0178","0179","0180","0181","0182","0183","0184","0185","0186","0187","0188","0189","0190","0191","0192","0193","0194","0195","0196","0197","0198","0199","0200","0201","0202","0203","0204","0205","0206","0207","0208","0209","0210","0211","0212","0213","0214","0215","0216","0217","0218","0219","0220","0221","0222","0223","0224","0225","0226","0227","0228","0229","0230","0231","0232","0233","0234","0235","0236","0237","0238","0239","0240","0241","0242","0243","0244","0245","0246","0247","0248","0249","0250","0251","0252","0253","0254","0255","0256","0257","0258","0259","0260","0261","0262","0263","0264","0265","0266","0267","0268","0269","0270","0271","0272","0273","0274","0275","0276","0277","0278","0279","0280","0281","0282","0283","0284","0285","0286","0287","0288"],jsonUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/info/idata/",suffix:"/supple/",extension:""},imageUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/image/idata/",suffix:"/supple/",extension:".tif"},width:3492,height:4967,width_excep:[],height_excep:[]},{bookid:"akiyasu-02",title:"",volume:"2",identifier:"400/4344/1/2",pages:["30000001","30000002","30000003","30000004","30000005","30000006","30000007","30000008","30000009","30000010","30000011","30000012","30000013","30000014","30000015","30000016","30000017","30000018","30000019","30000020","30000021","30000022","30000023","30000024","30000025","30000026","30000027","30000028","30000029","30000030","30000031","30000032","30000033","30000034","30000035"],jsonUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/info/idata/",suffix:"/",extension:""},imageUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/image/idata/",suffix:"/",extension:".tif"},width:8256,height:5504,width_excep:[],height_excep:[]},{bookid:"akiyasu-02-kaitai",title:"",volume:"2",identifier:"400/4344/1/2",pages:["20000001","20000002","20000003","20000004","20000005","20000006","20000007","20000008","20000009","20000010","20000011","20000012","20000013","20000014","20000015","20000016","20000017","20000018","20000019","20000020","20000021","20000022","20000023","20000024","20000025","20000026","20000027","20000028","20000029","20000030","20000031"],jsonUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/info/idata/",suffix:"/",extension:""},imageUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/image/idata/",suffix:"/",extension:".tif"},width:8256,height:5504,width_excep:[],height_excep:[]},{bookid:"akiyasu-02-touka",title:"",volume:"2",identifier:"400/4344/1/2",pages:["10000001","10000002","10000003","10000004","10000005","10000006","10000007","10000008","10000009","10000010","10000011","10000012","10000013","10000014","10000015","10000016","10000017","10000018","10000019","10000020","10000021","10000022","10000023","10000024","10000025"],jsonUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/info/idata/",suffix:"/",extension:""},imageUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/image/idata/",suffix:"/",extension:".tif"},width:8256,height:5504,width_excep:[],height_excep:[]},{bookid:"akiyasu-02-kaitaimae",title:"",volume:"2",identifier:"400/4344/1/2",pages:["00000001","00000002","00000003","00000004","00000005","00000006","00000007","00000008","00000009","00000010","00000011","00000012","00000013","00000014","00000015","00000016","00000017","00000018","00000019","00000020","00000021","00000022","00000023","00000024","00000025","00000026","00000027","00000028","00000029","00000030","00000031","00000032"],jsonUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/info/idata/",suffix:"/",extension:""},imageUrl:{server:"https://clioimg.hi.u-tokyo.ac.jp/viewer",prefix:"/api/image/idata/",suffix:"/",extension:".tif"},width:5760,height:3840,width_excep:[],height_excep:[]}]},fO=Qe("h1",null,[Qe("img",{src:pO,style:{width:"64px",height:"64px","vertical-align":"bottom"}}),Mo("Home")],-1),gO={__name:"HomeView",setup(s){return(c,i)=>(Kn(),ai("main",null,[fO,Qe("nav",null,[(Kn(!0),ai(Pn,null,qu(ui(jr).list,a=>(Kn(),ai("div",null,[mn(ui(iv),{to:"/viewer/"+a.bookid},{default:bc(()=>[Mo(Mn(a.title),1)]),_:2},1032,["to"])]))),256))])]))}};var mO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function vO(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var ov={exports:{}};(function(s){//! openseadragon 4.1.0
//! Built on 2023-05-25
//! Git commit: v4.1.0-0-8849681
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function c(i){return new c.Viewer(i)}(function(i){i.version={versionStr:"4.1.0",major:parseInt("4",10),minor:parseInt("1",10),revision:parseInt("0",10)};var a={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object AsyncFunction]":"function","[object Promise]":"promise","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},u=Object.prototype.toString,d=Object.prototype.hasOwnProperty;i.isFunction=function(w){return i.type(w)==="function"},i.isArray=Array.isArray||function(w){return i.type(w)==="array"},i.isWindow=function(w){return w&&typeof w=="object"&&"setInterval"in w},i.type=function(w){return w==null?String(w):a[u.call(w)]||"object"},i.isPlainObject=function(w){if(!w||c.type(w)!=="object"||w.nodeType||i.isWindow(w)||w.constructor&&!d.call(w,"constructor")&&!d.call(w.constructor.prototype,"isPrototypeOf"))return!1;var p;for(var m in w)p=m;return p===void 0||d.call(w,p)},i.isEmptyObject=function(w){for(var p in w)return!1;return!0},i.freezeObject=function(w){return Object.freeze?i.freezeObject=Object.freeze:i.freezeObject=function(p){return p},i.freezeObject(w)},i.supportsCanvas=function(){var w=document.createElement("canvas");return!!(i.isFunction(w.getContext)&&w.getContext("2d"))}(),i.isCanvasTainted=function(w){var p=!1;try{w.getContext("2d").getImageData(0,0,1,1)}catch{p=!0}return p},i.supportsAddEventListener=function(){return!!(document.documentElement.addEventListener&&document.addEventListener)}(),i.supportsRemoveEventListener=function(){return!!(document.documentElement.removeEventListener&&document.removeEventListener)}(),i.supportsEventListenerOptions=function(){var w=0;if(i.supportsAddEventListener)try{var p={get capture(){return w++,!1},get once(){return w++,!1},get passive(){return w++,!1}};window.addEventListener("test",null,p),window.removeEventListener("test",null,p)}catch{w=0}return w>=3}(),i.getCurrentPixelDensityRatio=function(){if(i.supportsCanvas){var w=document.createElement("canvas").getContext("2d"),p=window.devicePixelRatio||1,m=w.webkitBackingStorePixelRatio||w.mozBackingStorePixelRatio||w.msBackingStorePixelRatio||w.oBackingStorePixelRatio||w.backingStorePixelRatio||1;return Math.max(p,1)/m}else return 1},i.pixelDensityRatio=i.getCurrentPixelDensityRatio()})(c),function(i){i.extend=function(){var m,y,x,S,T,B,L=arguments[0]||{},q=arguments.length,V=!1,G=1;for(typeof L=="boolean"&&(V=L,L=arguments[1]||{},G=2),typeof L!="object"&&!c.isFunction(L)&&(L={}),q===G&&(L=this,--G);G<q;G++)if(m=arguments[G],m!==null||m!==void 0)for(y in m){var te=Object.getOwnPropertyDescriptor(m,y);if(te!==void 0){if(te.get||te.set){Object.defineProperty(L,y,te);continue}S=te.value}else{i.console.warn('Could not copy inherited property "'+y+'".');continue}L!==S&&(V&&S&&(c.isPlainObject(S)||(T=c.isArray(S)))?(x=L[y],T?(T=!1,B=x&&c.isArray(x)?x:[]):B=x&&c.isPlainObject(x)?x:{},L[y]=c.extend(V,B,S)):S!==void 0&&(L[y]=S))}return L};var a=function(){if(typeof navigator!="object")return!1;var m=navigator.userAgent;return typeof m!="string"?!1:m.indexOf("iPhone")!==-1||m.indexOf("iPad")!==-1||m.indexOf("iPod")!==-1};i.extend(i,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},splitHashDataForPost:!1,panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{dragToPan:!0,scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!1,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerDblClickDrag:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:a(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorElement:null,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,subPixelRoundingForTransparency:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,tileRetryMax:0,tileRetryDelay:2500,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"],silenceMultiImageWarnings:!1},SIGNAL:"----seadragon----",delegate:function(m,y){return function(){var x=arguments;return x===void 0&&(x=[]),y.apply(m,x)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6,CHROMEEDGE:7},SUBPIXEL_ROUNDING_OCCURRENCES:{NEVER:0,ONLY_AT_REST:1,ALWAYS:2},_viewers:new Map,getViewer:function(m){return i._viewers.get(this.getElement(m))},getElement:function(m){return typeof m=="string"&&(m=document.getElementById(m)),m},getElementPosition:function(m){var y=new i.Point,x,S;for(m=i.getElement(m),x=i.getElementStyle(m).position==="fixed",S=p(m,x);S;)y.x+=m.offsetLeft,y.y+=m.offsetTop,x&&(y=y.plus(i.getPageScroll())),m=S,x=i.getElementStyle(m).position==="fixed",S=p(m,x);return y},getElementOffset:function(m){m=i.getElement(m);var y=m&&m.ownerDocument,x,S,T={top:0,left:0};return y?(x=y.documentElement,typeof m.getBoundingClientRect<"u"&&(T=m.getBoundingClientRect()),S=y===y.window?y:y.nodeType===9?y.defaultView||y.parentWindow:!1,new i.Point(T.left+(S.pageXOffset||x.scrollLeft)-(x.clientLeft||0),T.top+(S.pageYOffset||x.scrollTop)-(x.clientTop||0))):new i.Point},getElementSize:function(m){return m=i.getElement(m),new i.Point(m.clientWidth,m.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(m){return m=i.getElement(m),m.currentStyle}:function(m){return m=i.getElement(m),window.getComputedStyle(m,"")},getCssPropertyWithVendorPrefix:function(m){var y={};return i.getCssPropertyWithVendorPrefix=function(x){if(y[x]!==void 0)return y[x];var S=document.createElement("div").style,T=null;if(S[x]!==void 0)T=x;else for(var B=["Webkit","Moz","MS","O","webkit","moz","ms","o"],L=i.capitalizeFirstLetter(x),q=0;q<B.length;q++){var V=B[q]+L;if(S[V]!==void 0){T=V;break}}return y[x]=T,T},i.getCssPropertyWithVendorPrefix(m)},capitalizeFirstLetter:function(m){return m.charAt(0).toUpperCase()+m.slice(1)},positiveModulo:function(m,y){var x=m%y;return x<0&&(x+=y),x},pointInElement:function(m,y){m=i.getElement(m);var x=i.getElementOffset(m),S=i.getElementSize(m);return y.x>=x.x&&y.x<x.x+S.x&&y.y<x.y+S.y&&y.y>=x.y},getMousePosition:function(m){if(typeof m.pageX=="number")i.getMousePosition=function(y){var x=new i.Point;return x.x=y.pageX,x.y=y.pageY,x};else if(typeof m.clientX=="number")i.getMousePosition=function(y){var x=new i.Point;return x.x=y.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,x.y=y.clientY+document.body.scrollTop+document.documentElement.scrollTop,x};else throw new Error("Unknown event mouse position, no known technique.");return i.getMousePosition(m)},getPageScroll:function(){var m=document.documentElement||{},y=document.body||{};if(typeof window.pageXOffset=="number")i.getPageScroll=function(){return new i.Point(window.pageXOffset,window.pageYOffset)};else if(y.scrollLeft||y.scrollTop)i.getPageScroll=function(){return new i.Point(document.body.scrollLeft,document.body.scrollTop)};else if(m.scrollLeft||m.scrollTop)i.getPageScroll=function(){return new i.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)};else return new i.Point(0,0);return i.getPageScroll()},setPageScroll:function(m){if(typeof window.scrollTo<"u")i.setPageScroll=function(S){window.scrollTo(S.x,S.y)};else{var y=i.getPageScroll();if(y.x===m.x&&y.y===m.y)return;document.body.scrollLeft=m.x,document.body.scrollTop=m.y;var x=i.getPageScroll();if(x.x!==y.x&&x.y!==y.y){i.setPageScroll=function(S){document.body.scrollLeft=S.x,document.body.scrollTop=S.y};return}if(document.documentElement.scrollLeft=m.x,document.documentElement.scrollTop=m.y,x=i.getPageScroll(),x.x!==y.x&&x.y!==y.y){i.setPageScroll=function(S){document.documentElement.scrollLeft=S.x,document.documentElement.scrollTop=S.y};return}i.setPageScroll=function(S){}}i.setPageScroll(m)},getWindowSize:function(){var m=document.documentElement||{},y=document.body||{};if(typeof window.innerWidth=="number")i.getWindowSize=function(){return new i.Point(window.innerWidth,window.innerHeight)};else if(m.clientWidth||m.clientHeight)i.getWindowSize=function(){return new i.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else if(y.clientWidth||y.clientHeight)i.getWindowSize=function(){return new i.Point(document.body.clientWidth,document.body.clientHeight)};else throw new Error("Unknown window size, no known technique.");return i.getWindowSize()},makeCenteredNode:function(m){m=i.getElement(m);var y=[i.makeNeutralElement("div"),i.makeNeutralElement("div"),i.makeNeutralElement("div")];return i.extend(y[0].style,{display:"table",height:"100%",width:"100%"}),i.extend(y[1].style,{display:"table-row"}),i.extend(y[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),y[0].appendChild(y[1]),y[1].appendChild(y[2]),y[2].appendChild(m),y[0]},makeNeutralElement:function(m){var y=document.createElement(m),x=y.style;return x.background="transparent none",x.border="none",x.margin="0px",x.padding="0px",x.position="static",y},now:function(){return Date.now?i.now=Date.now:i.now=function(){return new Date().getTime()},i.now()},makeTransparentImage:function(m){var y=i.makeNeutralElement("img");return y.src=m,y},setElementOpacity:function(m,y,x){var S,T;m=i.getElement(m),x&&!i.Browser.alpha&&(y=Math.round(y)),i.Browser.opacity?m.style.opacity=y<1?y:"":y<1?(S=Math.round(100*y),T="alpha(opacity="+S+")",m.style.filter=T):m.style.filter=""},setElementTouchActionNone:function(m){m=i.getElement(m),typeof m.style.touchAction<"u"?m.style.touchAction="none":typeof m.style.msTouchAction<"u"&&(m.style.msTouchAction="none")},setElementPointerEvents:function(m,y){m=i.getElement(m),typeof m.style<"u"&&typeof m.style.pointerEvents<"u"&&(m.style.pointerEvents=y)},setElementPointerEventsNone:function(m){i.setElementPointerEvents(m,"none")},addClass:function(m,y){m=i.getElement(m),m.className?(" "+m.className+" ").indexOf(" "+y+" ")===-1&&(m.className+=" "+y):m.className=y},indexOf:function(m,y,x){return Array.prototype.indexOf?this.indexOf=function(S,T,B){return S.indexOf(T,B)}:this.indexOf=function(S,T,B){var L,q=B||0,V;if(!S)throw new TypeError;if(V=S.length,V===0||q>=V)return-1;for(q<0&&(q=V-Math.abs(q)),L=q;L<V;L++)if(S[L]===T)return L;return-1},this.indexOf(m,y,x)},removeClass:function(m,y){var x,S=[],T;for(m=i.getElement(m),x=m.className.split(/\s+/),T=0;T<x.length;T++)x[T]&&x[T]!==y&&S.push(x[T]);m.className=S.join(" ")},normalizeEventListenerOptions:function(m){var y;return typeof m<"u"?typeof m=="boolean"?y=i.supportsEventListenerOptions?{capture:m}:m:y=i.supportsEventListenerOptions?m:typeof m.capture<"u"?m.capture:!1:y=i.supportsEventListenerOptions?{capture:!1}:!1,y},addEvent:function(){if(i.supportsAddEventListener)return function(m,y,x,S){S=i.normalizeEventListenerOptions(S),m=i.getElement(m),m.addEventListener(y,x,S)};if(document.documentElement.attachEvent&&document.attachEvent)return function(m,y,x){m=i.getElement(m),m.attachEvent("on"+y,x)};throw new Error("No known event model.")}(),removeEvent:function(){if(i.supportsRemoveEventListener)return function(m,y,x,S){S=i.normalizeEventListenerOptions(S),m=i.getElement(m),m.removeEventListener(y,x,S)};if(document.documentElement.detachEvent&&document.detachEvent)return function(m,y,x){m=i.getElement(m),m.detachEvent("on"+y,x)};throw new Error("No known event model.")}(),cancelEvent:function(m){m.preventDefault()},eventIsCanceled:function(m){return m.defaultPrevented},stopEvent:function(m){m.stopPropagation()},createCallback:function(m,y){var x=[],S;for(S=2;S<arguments.length;S++)x.push(arguments[S]);return function(){var T=x.concat([]),B;for(B=0;B<arguments.length;B++)T.push(arguments[B]);return y.apply(m,T)}},getUrlParameter:function(m){var y=w[m];return y||null},getUrlProtocol:function(m){var y=m.match(/^([a-z]+:)\/\//i);return y===null?window.location.protocol:y[1].toLowerCase()},createAjaxRequest:function(m){var y;try{y=!!new ActiveXObject("Microsoft.XMLHTTP")}catch{y=!1}if(y)window.XMLHttpRequest?i.createAjaxRequest=function(x){return x?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:i.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else if(window.XMLHttpRequest)i.createAjaxRequest=function(){return new XMLHttpRequest};else throw new Error("Browser doesn't support XMLHttpRequest.");return i.createAjaxRequest(m)},makeAjaxRequest:function(m,y,x){var S,T,B,L;i.isPlainObject(m)&&(y=m.success,x=m.error,S=m.withCredentials,T=m.headers,B=m.responseType||null,L=m.postData||null,m=m.url);var q=i.getUrlProtocol(m),V=i.createAjaxRequest(q==="file:");if(!i.isFunction(y))throw new Error("makeAjaxRequest requires a success callback");V.onreadystatechange=function(){V.readyState===4&&(V.onreadystatechange=function(){},V.status>=200&&V.status<300||V.status===0&&q!=="http:"&&q!=="https:"?y(V):i.isFunction(x)?x(V):i.console.error("AJAX request returned %d: %s",V.status,m))};var G=L?"POST":"GET";try{if(V.open(G,m,!0),B&&(V.responseType=B),T)for(var te in T)Object.prototype.hasOwnProperty.call(T,te)&&T[te]&&V.setRequestHeader(te,T[te]);S&&(V.withCredentials=!0),V.send(L)}catch(se){i.console.error("%s while making AJAX request: %s",se.name,se.message),V.onreadystatechange=function(){},i.isFunction(x)&&x(V,se)}return V},jsonp:function(m){var y,x=m.url,S=document.head||document.getElementsByTagName("head")[0]||document.documentElement,T=m.callbackName||"openseadragon"+i.now(),B=window[T],L="$1"+T+"$2",q=m.param||"callback",V=m.callback;x=x.replace(/(=)\?(&|$)|\?\?/i,L),x+=(/\?/.test(x)?"&":"?")+q+"="+T,window[T]=function(G){if(B)window[T]=B;else try{delete window[T]}catch{}V&&i.isFunction(V)&&V(G)},y=document.createElement("script"),(m.async!==void 0||m.async!==!1)&&(y.async="async"),m.scriptCharset&&(y.charset=m.scriptCharset),y.src=x,y.onload=y.onreadystatechange=function(G,te){(te||!y.readyState||/loaded|complete/.test(y.readyState))&&(y.onload=y.onreadystatechange=null,S&&y.parentNode&&S.removeChild(y),y=void 0)},S.insertBefore(y,S.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(m){if(window.DOMParser)i.parseXml=function(y){var x=null,S;return S=new DOMParser,x=S.parseFromString(y,"text/xml"),x};else if(window.ActiveXObject)i.parseXml=function(y){var x=null;return x=new ActiveXObject("Microsoft.XMLDOM"),x.async=!1,x.loadXML(y),x};else throw new Error("Browser doesn't support XML DOM.");return i.parseXml(m)},parseJSON:function(m){return i.parseJSON=window.JSON.parse,i.parseJSON(m)},imageFormatSupported:function(m){return m=m||"",!!d[m.toLowerCase()]},setImageFormatsSupported:function(m){i.extend(d,m)}});var u=function(m){};i.console=window.console||{log:u,debug:u,info:u,warn:u,error:u,assert:u},i.Browser={vendor:i.BROWSERS.UNKNOWN,version:0,alpha:!0};var d={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},w={};(function(){var m=navigator.appVersion,y=navigator.userAgent,x;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&(i.Browser.vendor=i.BROWSERS.IE,i.Browser.version=parseFloat(y.substring(y.indexOf("MSIE")+5,y.indexOf(";",y.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(y.indexOf("Edge")>=0?(i.Browser.vendor=i.BROWSERS.EDGE,i.Browser.version=parseFloat(y.substring(y.indexOf("Edge")+5))):y.indexOf("Edg")>=0?(i.Browser.vendor=i.BROWSERS.CHROMEEDGE,i.Browser.version=parseFloat(y.substring(y.indexOf("Edg")+4))):y.indexOf("Firefox")>=0?(i.Browser.vendor=i.BROWSERS.FIREFOX,i.Browser.version=parseFloat(y.substring(y.indexOf("Firefox")+8))):y.indexOf("Safari")>=0?(i.Browser.vendor=y.indexOf("Chrome")>=0?i.BROWSERS.CHROME:i.BROWSERS.SAFARI,i.Browser.version=parseFloat(y.substring(y.substring(0,y.indexOf("Safari")).lastIndexOf("/")+1,y.indexOf("Safari")))):(x=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),x.exec(y)!==null&&(i.Browser.vendor=i.BROWSERS.IE,i.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":i.Browser.vendor=i.BROWSERS.OPERA,i.Browser.version=parseFloat(m);break}var S=window.location.search.substring(1),T=S.split("&"),B,L,q;for(q=0;q<T.length;q++)if(B=T[q],L=B.indexOf("="),L>0){var V=B.substring(0,L),G=B.substring(L+1);try{w[V]=decodeURIComponent(G)}catch{i.console.error("Ignoring malformed URL parameter: %s=%s",V,G)}}i.Browser.alpha=!(i.Browser.vendor===i.BROWSERS.CHROME&&i.Browser.version<2),i.Browser.opacity=!0,i.Browser.vendor===i.BROWSERS.IE&&i.Browser.version<11&&i.console.error("Internet Explorer versions < 11 are not supported by OpenSeadragon")})(),function(m){var y=m.requestAnimationFrame||m.mozRequestAnimationFrame||m.webkitRequestAnimationFrame||m.msRequestAnimationFrame,x=m.cancelAnimationFrame||m.mozCancelAnimationFrame||m.webkitCancelAnimationFrame||m.msCancelAnimationFrame;if(y&&x)i.requestAnimationFrame=function(){return y.apply(m,arguments)},i.cancelAnimationFrame=function(){return x.apply(m,arguments)};else{var S=[],T=[],B=0,L;i.requestAnimationFrame=function(q){return S.push([++B,q]),L||(L=setInterval(function(){if(S.length){var V=i.now(),G=T;for(T=S,S=G;T.length;)T.shift()[1](V)}else clearInterval(L),L=void 0},1e3/50)),B},i.cancelAnimationFrame=function(q){var V,G;for(V=0,G=S.length;V<G;V+=1)if(S[V][0]===q){S.splice(V,1);return}for(V=0,G=T.length;V<G;V+=1)if(T[V][0]===q){T.splice(V,1);return}}}}(window);function p(m,y){return y&&m!==document.body?document.body:m.offsetParent}}(c),function(i,a){s.exports?s.exports=a():i.OpenSeadragon=a()}(mO,function(){return c}),function(i){var a={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(a.supportsFullScreen=!0,a.getFullScreenElement=function(){return document.fullscreenElement},a.requestFullScreen=function(u){return u.requestFullscreen()},a.exitFullScreen=function(){document.exitFullscreen()},a.fullScreenEventName="fullscreenchange",a.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(a.supportsFullScreen=!0,a.getFullScreenElement=function(){return document.msFullscreenElement},a.requestFullScreen=function(u){return u.msRequestFullscreen()},a.exitFullScreen=function(){document.msExitFullscreen()},a.fullScreenEventName="MSFullscreenChange",a.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(a.supportsFullScreen=!0,a.getFullScreenElement=function(){return document.webkitFullscreenElement},a.requestFullScreen=function(u){return u.webkitRequestFullscreen()},a.exitFullScreen=function(){document.webkitExitFullscreen()},a.fullScreenEventName="webkitfullscreenchange",a.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(a.supportsFullScreen=!0,a.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},a.requestFullScreen=function(u){return u.webkitRequestFullScreen()},a.exitFullScreen=function(){document.webkitCancelFullScreen()},a.fullScreenEventName="webkitfullscreenchange",a.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(a.supportsFullScreen=!0,a.getFullScreenElement=function(){return document.mozFullScreenElement},a.requestFullScreen=function(u){return u.mozRequestFullScreen()},a.exitFullScreen=function(){document.mozCancelFullScreen()},a.fullScreenEventName="mozfullscreenchange",a.fullScreenErrorEventName="mozfullscreenerror"),a.isFullScreen=function(){return a.getFullScreenElement()!==null},a.cancelFullScreen=function(){i.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),a.exitFullScreen()},i.extend(i,a)}(c),function(i){i.EventSource=function(){this.events={}},i.EventSource.prototype={addOnceHandler:function(a,u,d,w,p){var m=this;w=w||1;var y=0,x=function(S){return y++,y===w&&m.removeHandler(a,x),u(S)};this.addHandler(a,x,d,p)},addHandler:function(a,u,d,w){var p=this.events[a];if(p||(this.events[a]=p=[]),u&&i.isFunction(u)){var m=p.length,y={handler:u,userData:d||null,priority:w||0};for(p[m]=y;m>0&&p[m-1].priority<p[m].priority;)p[m]=p[m-1],p[m-1]=y,m--}},removeHandler:function(a,u){var d=this.events[a],w=[],p;if(d&&i.isArray(d)){for(p=0;p<d.length;p++)d[p].handler!==u&&w.push(d[p]);this.events[a]=w}},numberOfHandlers:function(a){var u=this.events[a];return u?u.length:0},removeAllHandlers:function(a){if(a)this.events[a]=[];else for(var u in this.events)this.events[u]=[]},getHandler:function(a){var u=this.events[a];return!u||!u.length?null:(u=u.length===1?[u[0]]:Array.apply(null,u),function(d,w){var p,m=u.length;for(p=0;p<m;p++)u[p]&&(w.eventSource=d,w.userData=u[p].userData,u[p].handler(w))})},raiseEvent:function(a,u){var d=this.getHandler(a);if(d)return d(this,u||{})}}}(c),function(i){var a={};i.MouseTracker=function(D){var A=arguments;i.isPlainObject(D)||(D={element:A[0],clickTimeThreshold:A[1],clickDistThreshold:A[2]}),this.hash=Math.random(),this.element=i.getElement(D.element),this.clickTimeThreshold=D.clickTimeThreshold||i.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=D.clickDistThreshold||i.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=D.dblClickTimeThreshold||i.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=D.dblClickDistThreshold||i.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=D.userData||null,this.stopDelay=D.stopDelay||50,this.preProcessEventHandler=D.preProcessEventHandler||null,this.contextMenuHandler=D.contextMenuHandler||null,this.enterHandler=D.enterHandler||null,this.leaveHandler=D.leaveHandler||null,this.exitHandler=D.exitHandler||null,this.overHandler=D.overHandler||null,this.outHandler=D.outHandler||null,this.pressHandler=D.pressHandler||null,this.nonPrimaryPressHandler=D.nonPrimaryPressHandler||null,this.releaseHandler=D.releaseHandler||null,this.nonPrimaryReleaseHandler=D.nonPrimaryReleaseHandler||null,this.moveHandler=D.moveHandler||null,this.scrollHandler=D.scrollHandler||null,this.clickHandler=D.clickHandler||null,this.dblClickHandler=D.dblClickHandler||null,this.dragHandler=D.dragHandler||null,this.dragEndHandler=D.dragEndHandler||null,this.pinchHandler=D.pinchHandler||null,this.stopHandler=D.stopHandler||null,this.keyDownHandler=D.keyDownHandler||null,this.keyUpHandler=D.keyUpHandler||null,this.keyHandler=D.keyHandler||null,this.focusHandler=D.focusHandler||null,this.blurHandler=D.blurHandler||null;var H=this;a[this.hash]={click:function(j){se(H,j)},dblclick:function(j){Te(H,j)},keydown:function(j){Ie(H,j)},keyup:function(j){Ce(H,j)},keypress:function(j){Ne(H,j)},focus:function(j){je(H,j)},blur:function(j){ot(H,j)},contextmenu:function(j){at(H,j)},wheel:function(j){vt(H,j)},mousewheel:function(j){Ct(H,j)},DOMMouseScroll:function(j){Ct(H,j)},MozMousePixelScroll:function(j){Ct(H,j)},losecapture:function(j){Lt(H,j)},mouseenter:function(j){We(H,j)},mouseleave:function(j){hn(H,j)},mouseover:function(j){Dn(H,j)},mouseout:function(j){Pt(H,j)},mousedown:function(j){pe(H,j)},mouseup:function(j){_e(H,j)},mousemove:function(j){st(H,j)},touchstart:function(j){ln(H,j)},touchend:function(j){ft(H,j)},touchmove:function(j){nt(H,j)},touchcancel:function(j){it(H,j)},gesturestart:function(j){jt(H,j)},gesturechange:function(j){Ht(H,j)},gotpointercapture:function(j){Yt(H,j)},lostpointercapture:function(j){Nt(H,j)},pointerenter:function(j){We(H,j)},pointerleave:function(j){hn(H,j)},pointerover:function(j){Dn(H,j)},pointerout:function(j){Pt(H,j)},pointerdown:function(j){pe(H,j)},pointerup:function(j){_e(H,j)},pointermove:function(j){st(H,j)},pointercancel:function(j){Q(H,j)},pointerupcaptured:function(j){Re(H,j)},pointermovecaptured:function(j){yt(H,j)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null,sentDragEvent:!1},this.hasGestureHandlers=!!(this.pressHandler||this.nonPrimaryPressHandler||this.releaseHandler||this.nonPrimaryReleaseHandler||this.clickHandler||this.dblClickHandler||this.dragHandler||this.dragEndHandler||this.pinchHandler),this.hasScrollHandler=!!this.scrollHandler,i.MouseTracker.havePointerEvents&&i.setElementPointerEvents(this.element,"auto"),this.exitHandler&&i.console.error("MouseTracker.exitHandler is deprecated. Use MouseTracker.leaveHandler instead."),D.startDisabled||this.setTracking(!0)},i.MouseTracker.prototype={destroy:function(){m(this),this.element=null,a[this.hash]=null,delete a[this.hash]},isTracking:function(){return a[this.hash].tracking},setTracking:function(D){return D?p(this):m(this),this},getActivePointersListByType:function(D){var A=a[this.hash],H,j=A.activePointersLists.length,ce;for(H=0;H<j;H++)if(A.activePointersLists[H].type===D)return A.activePointersLists[H];return ce=new i.MouseTracker.GesturePointList(D),A.activePointersLists.push(ce),ce},getActivePointerCount:function(){var D=a[this.hash],A,H=D.activePointersLists.length,j=0;for(A=0;A<H;A++)j+=D.activePointersLists[A].getLength();return j},preProcessEventHandler:function(){},contextMenuHandler:function(){},enterHandler:function(){},leaveHandler:function(){},exitHandler:function(){},overHandler:function(){},outHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}};var u=function(){try{return window.self!==window.top}catch{return!0}}();function d(D){try{return D.addEventListener&&D.removeEventListener}catch{return!1}}i.MouseTracker.gesturePointVelocityTracker=function(){var D=[],A=0,H=0,j=function(Je,Fe){return Je.hash.toString()+Fe.type+Fe.id.toString()},ce=function(){var Je,Fe=D.length,Ut,It,di=i.now(),Ki,qr,Zr;for(Ki=di-H,H=di,Je=0;Je<Fe;Je++)Ut=D[Je],It=Ut.gPoint,It.direction=Math.atan2(It.currentPos.y-Ut.lastPos.y,It.currentPos.x-Ut.lastPos.x),qr=Ut.lastPos.distanceTo(It.currentPos),Ut.lastPos=It.currentPos,Zr=1e3*qr/(Ki+1),It.speed=.75*Zr+.25*It.speed},ye=function(Je,Fe){var Ut=j(Je,Fe);D.push({guid:Ut,gPoint:Fe,lastPos:Fe.currentPos}),D.length===1&&(H=i.now(),A=window.setInterval(ce,50))},He=function(Je,Fe){var Ut=j(Je,Fe),It,di=D.length;for(It=0;It<di;It++)if(D[It].guid===Ut){D.splice(It,1),di--,di===0&&window.clearInterval(A);break}};return{addPoint:ye,removePoint:He}}(),i.MouseTracker.captureElement=document,i.MouseTracker.wheelEventName=i.Browser.vendor===i.BROWSERS.IE&&i.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll",i.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur","contextmenu",i.MouseTracker.wheelEventName],i.MouseTracker.wheelEventName==="DOMMouseScroll"&&i.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent?(i.MouseTracker.havePointerEvents=!0,i.MouseTracker.subscribeEvents.push("pointerenter","pointerleave","pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),i.MouseTracker.havePointerCapture=function(){var D=document.createElement("div");return i.isFunction(D.setPointerCapture)&&i.isFunction(D.releasePointerCapture)}(),i.MouseTracker.havePointerCapture&&i.MouseTracker.subscribeEvents.push("gotpointercapture","lostpointercapture")):(i.MouseTracker.havePointerEvents=!1,i.MouseTracker.subscribeEvents.push("mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","mousemove"),i.MouseTracker.mousePointerId="legacy-mouse",i.MouseTracker.havePointerCapture=function(){var D=document.createElement("div");return i.isFunction(D.setCapture)&&i.isFunction(D.releaseCapture)}(),i.MouseTracker.havePointerCapture&&i.MouseTracker.subscribeEvents.push("losecapture"),"ontouchstart"in window&&i.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&i.MouseTracker.subscribeEvents.push("gesturestart","gesturechange")),i.MouseTracker.GesturePointList=function(D){this._gPoints=[],this.type=D,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},i.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(D){return this._gPoints.push(D)},removeById:function(D){var A,H=this._gPoints.length;for(A=0;A<H;A++)if(this._gPoints[A].id===D){this._gPoints.splice(A,1);break}return this._gPoints.length},getByIndex:function(D){return D<this._gPoints.length?this._gPoints[D]:null},getById:function(D){var A,H=this._gPoints.length;for(A=0;A<H;A++)if(this._gPoints[A].id===D)return this._gPoints[A];return null},getPrimary:function(D){var A,H=this._gPoints.length;for(A=0;A<H;A++)if(this._gPoints[A].isPrimary)return this._gPoints[A];return null},addContact:function(){++this.contacts,this.contacts>1&&(this.type==="mouse"||this.type==="pen")&&(i.console.warn("GesturePointList.addContact() Implausible contacts value"),this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};function w(D){var A=a[D.hash],H,j,ce,ye,He,Je=A.activePointersLists.length;for(H=0;H<Je;H++)if(ce=A.activePointersLists[H],ce.getLength()>0){for(He=[],ye=ce.asArray(),j=0;j<ye.length;j++)He.push(ye[j]);for(j=0;j<He.length;j++)ge(D,ce,He[j])}for(H=0;H<Je;H++)A.activePointersLists.pop();A.sentDragEvent=!1}function p(D){var A=a[D.hash],H,j;if(!A.tracking){for(j=0;j<i.MouseTracker.subscribeEvents.length;j++)H=i.MouseTracker.subscribeEvents[j],i.addEvent(D.element,H,A[H],H===i.MouseTracker.wheelEventName?{passive:!1,capture:!1}:!1);w(D),A.tracking=!0}}function m(D){var A=a[D.hash],H,j;if(A.tracking){for(j=0;j<i.MouseTracker.subscribeEvents.length;j++)H=i.MouseTracker.subscribeEvents[j],i.removeEvent(D.element,H,A[H],!1);w(D),A.tracking=!1}}function y(D,A){var H=a[D.hash];if(A==="pointerevent")return{upName:"pointerup",upHandler:H.pointerupcaptured,moveName:"pointermove",moveHandler:H.pointermovecaptured};if(A==="mouse")return{upName:"pointerup",upHandler:H.pointerupcaptured,moveName:"pointermove",moveHandler:H.pointermovecaptured};if(A==="touch")return{upName:"touchend",upHandler:H.touchendcaptured,moveName:"touchmove",moveHandler:H.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function x(D,A){var H;if(i.MouseTracker.havePointerCapture)if(i.MouseTracker.havePointerEvents)try{D.element.setPointerCapture(A.id)}catch{i.console.warn("setPointerCapture() called on invalid pointer ID");return}else D.element.setCapture(!0);else H=y(D,i.MouseTracker.havePointerEvents?"pointerevent":A.type),u&&d(window.top)&&i.addEvent(window.top,H.upName,H.upHandler,!0),i.addEvent(i.MouseTracker.captureElement,H.upName,H.upHandler,!0),i.addEvent(i.MouseTracker.captureElement,H.moveName,H.moveHandler,!0);ee(D,A,!0)}function S(D,A){var H,j,ce;if(i.MouseTracker.havePointerCapture)if(i.MouseTracker.havePointerEvents){if(j=D.getActivePointersListByType(A.type),ce=j.getById(A.id),!ce||!ce.captured)return;try{D.element.releasePointerCapture(A.id)}catch{}}else D.element.releaseCapture();else H=y(D,i.MouseTracker.havePointerEvents?"pointerevent":A.type),u&&d(window.top)&&i.removeEvent(window.top,H.upName,H.upHandler,!0),i.removeEvent(i.MouseTracker.captureElement,H.moveName,H.moveHandler,!0),i.removeEvent(i.MouseTracker.captureElement,H.upName,H.upHandler,!0);ee(D,A,!1)}function T(D){return i.MouseTracker.havePointerEvents?D.pointerId:i.MouseTracker.mousePointerId}function B(D){return i.MouseTracker.havePointerEvents?D.pointerType||(i.Browser.vendor===i.BROWSERS.IE?"mouse":""):"mouse"}function L(D){return i.MouseTracker.havePointerEvents?D.isPrimary:!0}function q(D){return i.getMousePosition(D)}function V(D,A){return G(q(D),A)}function G(D,A){var H=i.getElementOffset(A);return D.minus(H)}function te(D,A){return new i.Point((D.x+A.x)/2,(D.y+A.y)/2)}function se(D,A){var H={originalEvent:A,eventType:"click",pointerType:"mouse",isEmulated:!1};F(D,H),H.preventDefault&&!H.defaultPrevented&&i.cancelEvent(A),H.stopPropagation&&i.stopEvent(A)}function Te(D,A){var H={originalEvent:A,eventType:"dblclick",pointerType:"mouse",isEmulated:!1};F(D,H),H.preventDefault&&!H.defaultPrevented&&i.cancelEvent(A),H.stopPropagation&&i.stopEvent(A)}function Ie(D,A){var H=null,j={originalEvent:A,eventType:"keydown",pointerType:"",isEmulated:!1};F(D,j),D.keyDownHandler&&!j.preventGesture&&!j.defaultPrevented&&(H={eventSource:D,keyCode:A.keyCode?A.keyCode:A.charCode,ctrl:A.ctrlKey,shift:A.shiftKey,alt:A.altKey,meta:A.metaKey,originalEvent:A,preventDefault:j.preventDefault||j.defaultPrevented,userData:D.userData},D.keyDownHandler(H)),(H&&H.preventDefault||j.preventDefault&&!j.defaultPrevented)&&i.cancelEvent(A),j.stopPropagation&&i.stopEvent(A)}function Ce(D,A){var H=null,j={originalEvent:A,eventType:"keyup",pointerType:"",isEmulated:!1};F(D,j),D.keyUpHandler&&!j.preventGesture&&!j.defaultPrevented&&(H={eventSource:D,keyCode:A.keyCode?A.keyCode:A.charCode,ctrl:A.ctrlKey,shift:A.shiftKey,alt:A.altKey,meta:A.metaKey,originalEvent:A,preventDefault:j.preventDefault||j.defaultPrevented,userData:D.userData},D.keyUpHandler(H)),(H&&H.preventDefault||j.preventDefault&&!j.defaultPrevented)&&i.cancelEvent(A),j.stopPropagation&&i.stopEvent(A)}function Ne(D,A){var H=null,j={originalEvent:A,eventType:"keypress",pointerType:"",isEmulated:!1};F(D,j),D.keyHandler&&!j.preventGesture&&!j.defaultPrevented&&(H={eventSource:D,keyCode:A.keyCode?A.keyCode:A.charCode,ctrl:A.ctrlKey,shift:A.shiftKey,alt:A.altKey,meta:A.metaKey,originalEvent:A,preventDefault:j.preventDefault||j.defaultPrevented,userData:D.userData},D.keyHandler(H)),(H&&H.preventDefault||j.preventDefault&&!j.defaultPrevented)&&i.cancelEvent(A),j.stopPropagation&&i.stopEvent(A)}function je(D,A){var H={originalEvent:A,eventType:"focus",pointerType:"",isEmulated:!1};F(D,H),D.focusHandler&&!H.preventGesture&&D.focusHandler({eventSource:D,originalEvent:A,userData:D.userData})}function ot(D,A){var H={originalEvent:A,eventType:"blur",pointerType:"",isEmulated:!1};F(D,H),D.blurHandler&&!H.preventGesture&&D.blurHandler({eventSource:D,originalEvent:A,userData:D.userData})}function at(D,A){var H=null,j={originalEvent:A,eventType:"contextmenu",pointerType:"mouse",isEmulated:!1};F(D,j),D.contextMenuHandler&&!j.preventGesture&&!j.defaultPrevented&&(H={eventSource:D,position:G(q(A),D.element),originalEvent:j.originalEvent,preventDefault:j.preventDefault||j.defaultPrevented,userData:D.userData},D.contextMenuHandler(H)),(H&&H.preventDefault||j.preventDefault&&!j.defaultPrevented)&&i.cancelEvent(A),j.stopPropagation&&i.stopEvent(A)}function vt(D,A){Rt(D,A,A)}function Ct(D,A){var H={target:A.target||A.srcElement,type:"wheel",shiftKey:A.shiftKey||!1,clientX:A.clientX,clientY:A.clientY,pageX:A.pageX?A.pageX:A.clientX,pageY:A.pageY?A.pageY:A.clientY,deltaMode:A.type==="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0};i.MouseTracker.wheelEventName==="mousewheel"?H.deltaY=-A.wheelDelta/i.DEFAULT_SETTINGS.pixelsPerWheelLine:H.deltaY=A.detail,Rt(D,H,A)}function Rt(D,A,H){var j=0,ce,ye=null;j=A.deltaY<0?1:-1,ce={originalEvent:A,eventType:"wheel",pointerType:"mouse",isEmulated:A!==H},F(D,ce),D.scrollHandler&&!ce.preventGesture&&!ce.defaultPrevented&&(ye={eventSource:D,pointerType:"mouse",position:V(A,D.element),scroll:j,shift:A.shiftKey,isTouchEvent:!1,originalEvent:H,preventDefault:ce.preventDefault||ce.defaultPrevented,userData:D.userData},D.scrollHandler(ye)),ce.stopPropagation&&i.stopEvent(H),(ye&&ye.preventDefault||ce.preventDefault&&!ce.defaultPrevented)&&i.cancelEvent(H)}function Lt(D,A){var H={id:i.MouseTracker.mousePointerId,type:"mouse"},j={originalEvent:A,eventType:"lostpointercapture",pointerType:"mouse",isEmulated:!1};F(D,j),A.target===D.element&&ee(D,H,!1),j.stopPropagation&&i.stopEvent(A)}function ln(D,A){var H,j,ce=A.changedTouches.length,ye,He=D.getActivePointersListByType("touch");H=i.now(),He.getLength()>A.touches.length-ce&&i.console.warn("Tracked touch contact count doesn't match event.touches.length");var Je={originalEvent:A,eventType:"pointerdown",pointerType:"touch",isEmulated:!1};for(F(D,Je),j=0;j<ce;j++)ye={id:A.changedTouches[j].identifier,type:"touch",isPrimary:He.getLength()===0,currentPos:q(A.changedTouches[j]),currentTime:H},ne(D,Je,ye),xe(D,Je,ye,0),ee(D,ye,!0);Je.preventDefault&&!Je.defaultPrevented&&i.cancelEvent(A),Je.stopPropagation&&i.stopEvent(A)}function ft(D,A){var H,j,ce=A.changedTouches.length,ye;H=i.now();var He={originalEvent:A,eventType:"pointerup",pointerType:"touch",isEmulated:!1};for(F(D,He),j=0;j<ce;j++)ye={id:A.changedTouches[j].identifier,type:"touch",currentPos:q(A.changedTouches[j]),currentTime:H},Ee(D,He,ye,0),ee(D,ye,!1),re(D,He,ye);He.preventDefault&&!He.defaultPrevented&&i.cancelEvent(A),He.stopPropagation&&i.stopEvent(A)}function nt(D,A){var H,j,ce=A.changedTouches.length,ye;H=i.now();var He={originalEvent:A,eventType:"pointermove",pointerType:"touch",isEmulated:!1};for(F(D,He),j=0;j<ce;j++)ye={id:A.changedTouches[j].identifier,type:"touch",currentPos:q(A.changedTouches[j]),currentTime:H},Ae(D,He,ye);He.preventDefault&&!He.defaultPrevented&&i.cancelEvent(A),He.stopPropagation&&i.stopEvent(A)}function it(D,A){var H=A.changedTouches.length,j,ce,ye={originalEvent:A,eventType:"pointercancel",pointerType:"touch",isEmulated:!1};for(F(D,ye),j=0;j<H;j++)ce={id:A.changedTouches[j].identifier,type:"touch"},Pe(D,ye,ce);ye.stopPropagation&&i.stopEvent(A)}function jt(D,A){return i.eventIsCanceled(A)||A.preventDefault(),!1}function Ht(D,A){return i.eventIsCanceled(A)||A.preventDefault(),!1}function Yt(D,A){var H={originalEvent:A,eventType:"gotpointercapture",pointerType:B(A),isEmulated:!1};F(D,H),A.target===D.element&&ee(D,{id:A.pointerId,type:B(A)},!0),H.stopPropagation&&i.stopEvent(A)}function Nt(D,A){var H={originalEvent:A,eventType:"lostpointercapture",pointerType:B(A),isEmulated:!1};F(D,H),A.target===D.element&&ee(D,{id:A.pointerId,type:B(A)},!1),H.stopPropagation&&i.stopEvent(A)}function We(D,A){var H={id:T(A),type:B(A),isPrimary:L(A),currentPos:q(A),currentTime:i.now()},j={originalEvent:A,eventType:"pointerenter",pointerType:H.type,isEmulated:!1};F(D,j),ne(D,j,H)}function hn(D,A){var H={id:T(A),type:B(A),isPrimary:L(A),currentPos:q(A),currentTime:i.now()},j={originalEvent:A,eventType:"pointerleave",pointerType:H.type,isEmulated:!1};F(D,j),re(D,j,H)}function Dn(D,A){var H={id:T(A),type:B(A),isPrimary:L(A),currentPos:q(A),currentTime:i.now()},j={originalEvent:A,eventType:"pointerover",pointerType:H.type,isEmulated:!1};F(D,j),ae(D,j,H),j.preventDefault&&!j.defaultPrevented&&i.cancelEvent(A),j.stopPropagation&&i.stopEvent(A)}function Pt(D,A){var H={id:T(A),type:B(A),isPrimary:L(A),currentPos:q(A),currentTime:i.now()},j={originalEvent:A,eventType:"pointerout",pointerType:H.type,isEmulated:!1};F(D,j),ue(D,j,H),j.preventDefault&&!j.defaultPrevented&&i.cancelEvent(A),j.stopPropagation&&i.stopEvent(A)}function pe(D,A){var H={id:T(A),type:B(A),isPrimary:L(A),currentPos:q(A),currentTime:i.now()},j=i.MouseTracker.havePointerEvents&&H.type==="touch"&&i.Browser.vendor!==i.BROWSERS.IE,ce={originalEvent:A,eventType:"pointerdown",pointerType:H.type,isEmulated:!1};F(D,ce),xe(D,ce,H,A.button),ce.preventDefault&&!ce.defaultPrevented&&i.cancelEvent(A),ce.stopPropagation&&i.stopEvent(A),ce.shouldCapture&&(j?ee(D,H,!0):x(D,H))}function _e(D,A){ke(D,A)}function Re(D,A){var H=D.getActivePointersListByType(B(A));H.getById(A.pointerId)&&ke(D,A),i.stopEvent(A)}function ke(D,A){var H;H={id:T(A),type:B(A),isPrimary:L(A),currentPos:q(A),currentTime:i.now()};var j={originalEvent:A,eventType:"pointerup",pointerType:H.type,isEmulated:!1};F(D,j),Ee(D,j,H,A.button),j.preventDefault&&!j.defaultPrevented&&i.cancelEvent(A),j.stopPropagation&&i.stopEvent(A),j.shouldReleaseCapture&&(A.target===D.element?S(D,H):ee(D,H,!1))}function st(D,A){Z(D,A)}function yt(D,A){var H=D.getActivePointersListByType(B(A));H.getById(A.pointerId)&&Z(D,A),i.stopEvent(A)}function Z(D,A){var H={id:T(A),type:B(A),isPrimary:L(A),currentPos:q(A),currentTime:i.now()},j={originalEvent:A,eventType:"pointermove",pointerType:H.type,isEmulated:!1};F(D,j),Ae(D,j,H),j.preventDefault&&!j.defaultPrevented&&i.cancelEvent(A),j.stopPropagation&&i.stopEvent(A)}function Q(D,A){var H={id:A.pointerId,type:B(A)},j={originalEvent:A,eventType:"pointercancel",pointerType:H.type,isEmulated:!1};F(D,j),Pe(D,j,H),j.stopPropagation&&i.stopEvent(A)}function le(D,A){return A.speed=0,A.direction=0,A.contactPos=A.currentPos,A.contactTime=A.currentTime,A.lastPos=A.currentPos,A.lastTime=A.currentTime,D.add(A)}function ge(D,A,H){var j,ce=A.getById(H.id);return ce?(ce.captured&&(i.console.warn("stopTrackingPointer() called on captured pointer"),S(D,ce)),A.removeContact(),j=A.removeById(H.id)):j=A.getLength(),j}function b(D,A){switch(A.eventType){case"pointermove":A.isStoppable=!0,A.isCancelable=!0,A.preventDefault=!1,A.preventGesture=!D.hasGestureHandlers,A.stopPropagation=!1;break;case"pointerover":case"pointerout":case"contextmenu":case"keydown":case"keyup":case"keypress":A.isStoppable=!0,A.isCancelable=!0,A.preventDefault=!1,A.preventGesture=!1,A.stopPropagation=!1;break;case"pointerdown":A.isStoppable=!0,A.isCancelable=!0,A.preventDefault=!1,A.preventGesture=!D.hasGestureHandlers,A.stopPropagation=!1;break;case"pointerup":A.isStoppable=!0,A.isCancelable=!0,A.preventDefault=!1,A.preventGesture=!D.hasGestureHandlers,A.stopPropagation=!1;break;case"wheel":A.isStoppable=!0,A.isCancelable=!0,A.preventDefault=!1,A.preventGesture=!D.hasScrollHandler,A.stopPropagation=!1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":A.isStoppable=!0,A.isCancelable=!1,A.preventDefault=!1,A.preventGesture=!1,A.stopPropagation=!1;break;case"click":A.isStoppable=!0,A.isCancelable=!0,A.preventDefault=!!D.clickHandler,A.preventGesture=!1,A.stopPropagation=!1;break;case"dblclick":A.isStoppable=!0,A.isCancelable=!0,A.preventDefault=!!D.dblClickHandler,A.preventGesture=!1,A.stopPropagation=!1;break;case"focus":case"blur":case"pointerenter":case"pointerleave":default:A.isStoppable=!1,A.isCancelable=!1,A.preventDefault=!1,A.preventGesture=!1,A.stopPropagation=!1;break}}function F(D,A){A.eventSource=D,A.eventPhase=A.originalEvent&&typeof A.originalEvent.eventPhase<"u"?A.originalEvent.eventPhase:0,A.defaultPrevented=i.eventIsCanceled(A.originalEvent),A.shouldCapture=!1,A.shouldReleaseCapture=!1,A.userData=D.userData,b(D,A),D.preProcessEventHandler&&D.preProcessEventHandler(A)}function ee(D,A,H){var j=D.getActivePointersListByType(A.type),ce=j.getById(A.id);ce?H&&!ce.captured?(ce.captured=!0,j.captureCount++):!H&&ce.captured&&(ce.captured=!1,j.captureCount--,j.captureCount<0&&(j.captureCount=0,i.console.warn("updatePointerCaptured() - pointsList.captureCount went negative"))):i.console.warn("updatePointerCaptured() called on untracked pointer")}function ne(D,A,H){var j=D.getActivePointersListByType(H.type),ce;ce=j.getById(H.id),ce?(ce.insideElement=!0,ce.lastPos=ce.currentPos,ce.lastTime=ce.currentTime,ce.currentPos=H.currentPos,ce.currentTime=H.currentTime,H=ce):(H.captured=!1,H.insideElementPressed=!1,H.insideElement=!0,le(j,H)),D.enterHandler&&D.enterHandler({eventSource:D,pointerType:H.type,position:G(H.currentPos,D.element),buttons:j.buttons,pointers:D.getActivePointerCount(),insideElementPressed:H.insideElementPressed,buttonDownAny:j.buttons!==0,isTouchEvent:H.type==="touch",originalEvent:A.originalEvent,userData:D.userData})}function re(D,A,H){var j=D.getActivePointersListByType(H.type),ce,ye;ce=j.getById(H.id),ce?(ce.captured?(ce.insideElement=!1,ce.lastPos=ce.currentPos,ce.lastTime=ce.currentTime,ce.currentPos=H.currentPos,ce.currentTime=H.currentTime):ge(D,j,ce),H=ce):(H.captured=!1,H.insideElementPressed=!1),(D.leaveHandler||D.exitHandler)&&(ye={eventSource:D,pointerType:H.type,position:H.currentPos&&G(H.currentPos,D.element),buttons:j.buttons,pointers:D.getActivePointerCount(),insideElementPressed:H.insideElementPressed,buttonDownAny:j.buttons!==0,isTouchEvent:H.type==="touch",originalEvent:A.originalEvent,userData:D.userData},D.leaveHandler&&D.leaveHandler(ye),D.exitHandler&&D.exitHandler(ye))}function ae(D,A,H){var j,ce;j=D.getActivePointersListByType(H.type),ce=j.getById(H.id),ce?H=ce:(H.captured=!1,H.insideElementPressed=!1),D.overHandler&&D.overHandler({eventSource:D,pointerType:H.type,position:G(H.currentPos,D.element),buttons:j.buttons,pointers:D.getActivePointerCount(),insideElementPressed:H.insideElementPressed,buttonDownAny:j.buttons!==0,isTouchEvent:H.type==="touch",originalEvent:A.originalEvent,userData:D.userData})}function ue(D,A,H){var j,ce;j=D.getActivePointersListByType(H.type),ce=j.getById(H.id),ce?H=ce:(H.captured=!1,H.insideElementPressed=!1),D.outHandler&&D.outHandler({eventSource:D,pointerType:H.type,position:H.currentPos&&G(H.currentPos,D.element),buttons:j.buttons,pointers:D.getActivePointerCount(),insideElementPressed:H.insideElementPressed,buttonDownAny:j.buttons!==0,isTouchEvent:H.type==="touch",originalEvent:A.originalEvent,userData:D.userData})}function xe(D,A,H,j){var ce=a[D.hash],ye=D.getActivePointersListByType(H.type),He;if(typeof A.originalEvent.buttons<"u"?ye.buttons=A.originalEvent.buttons:j===0?ye.buttons|=1:j===1?ye.buttons|=4:j===2?ye.buttons|=2:j===3?ye.buttons|=8:j===4?ye.buttons|=16:j===5&&(ye.buttons|=32),j!==0){A.shouldCapture=!1,A.shouldReleaseCapture=!1,D.nonPrimaryPressHandler&&!A.preventGesture&&!A.defaultPrevented&&(A.preventDefault=!0,D.nonPrimaryPressHandler({eventSource:D,pointerType:H.type,position:G(H.currentPos,D.element),button:j,buttons:ye.buttons,isTouchEvent:H.type==="touch",originalEvent:A.originalEvent,userData:D.userData}));return}He=ye.getById(H.id),He?(He.insideElementPressed=!0,He.insideElement=!0,He.originalTarget=A.originalEvent.target,He.contactPos=H.currentPos,He.contactTime=H.currentTime,He.lastPos=He.currentPos,He.lastTime=He.currentTime,He.currentPos=H.currentPos,He.currentTime=H.currentTime,H=He):(H.captured=!1,H.insideElementPressed=!0,H.insideElement=!0,H.originalTarget=A.originalEvent.target,le(ye,H)),ye.addContact(),!A.preventGesture&&!A.defaultPrevented?(A.shouldCapture=!0,A.shouldReleaseCapture=!1,A.preventDefault=!0,(D.dragHandler||D.dragEndHandler||D.pinchHandler)&&i.MouseTracker.gesturePointVelocityTracker.addPoint(D,H),ye.contacts===1?D.pressHandler&&!A.preventGesture&&D.pressHandler({eventSource:D,pointerType:H.type,position:G(H.contactPos,D.element),buttons:ye.buttons,isTouchEvent:H.type==="touch",originalEvent:A.originalEvent,userData:D.userData}):ye.contacts===2&&D.pinchHandler&&H.type==="touch"&&(ce.pinchGPoints=ye.asArray(),ce.lastPinchDist=ce.currentPinchDist=ce.pinchGPoints[0].currentPos.distanceTo(ce.pinchGPoints[1].currentPos),ce.lastPinchCenter=ce.currentPinchCenter=te(ce.pinchGPoints[0].currentPos,ce.pinchGPoints[1].currentPos))):(A.shouldCapture=!1,A.shouldReleaseCapture=!1)}function Ee(D,A,H,j){var ce=a[D.hash],ye=D.getActivePointersListByType(H.type),He,Je,Fe,Ut=!1,It;if(typeof A.originalEvent.buttons<"u"?ye.buttons=A.originalEvent.buttons:j===0?ye.buttons^=-2:j===1?ye.buttons^=-5:j===2?ye.buttons^=-3:j===3?ye.buttons^=-9:j===4?ye.buttons^=-17:j===5&&(ye.buttons^=-33),A.shouldCapture=!1,j!==0){A.shouldReleaseCapture=!1,D.nonPrimaryReleaseHandler&&!A.preventGesture&&!A.defaultPrevented&&(A.preventDefault=!0,D.nonPrimaryReleaseHandler({eventSource:D,pointerType:H.type,position:G(H.currentPos,D.element),button:j,buttons:ye.buttons,isTouchEvent:H.type==="touch",originalEvent:A.originalEvent,userData:D.userData}));return}Fe=ye.getById(H.id),Fe?(ye.removeContact(),Fe.captured&&(Ut=!0),Fe.lastPos=Fe.currentPos,Fe.lastTime=Fe.currentTime,Fe.currentPos=H.currentPos,Fe.currentTime=H.currentTime,Fe.insideElement||ge(D,ye,Fe),He=Fe.currentPos,Je=Fe.currentTime):(H.captured=!1,H.insideElementPressed=!1,H.insideElement=!0,le(ye,H),Fe=H),!A.preventGesture&&!A.defaultPrevented&&(Ut?(A.shouldReleaseCapture=!0,A.preventDefault=!0,(D.dragHandler||D.dragEndHandler||D.pinchHandler)&&i.MouseTracker.gesturePointVelocityTracker.removePoint(D,Fe),ye.contacts===0?(D.releaseHandler&&He&&D.releaseHandler({eventSource:D,pointerType:Fe.type,position:G(He,D.element),buttons:ye.buttons,insideElementPressed:Fe.insideElementPressed,insideElementReleased:Fe.insideElement,isTouchEvent:Fe.type==="touch",originalEvent:A.originalEvent,userData:D.userData}),D.dragEndHandler&&ce.sentDragEvent&&D.dragEndHandler({eventSource:D,pointerType:Fe.type,position:G(Fe.currentPos,D.element),speed:Fe.speed,direction:Fe.direction,shift:A.originalEvent.shiftKey,isTouchEvent:Fe.type==="touch",originalEvent:A.originalEvent,userData:D.userData}),ce.sentDragEvent=!1,(D.clickHandler||D.dblClickHandler)&&Fe.insideElement&&(It=Je-Fe.contactTime<=D.clickTimeThreshold&&Fe.contactPos.distanceTo(He)<=D.clickDistThreshold,D.clickHandler&&D.clickHandler({eventSource:D,pointerType:Fe.type,position:G(Fe.currentPos,D.element),quick:It,shift:A.originalEvent.shiftKey,isTouchEvent:Fe.type==="touch",originalEvent:A.originalEvent,originalTarget:Fe.originalTarget,userData:D.userData}),D.dblClickHandler&&It&&(ye.clicks++,ye.clicks===1?(ce.lastClickPos=He,ce.dblClickTimeOut=setTimeout(function(){ye.clicks=0},D.dblClickTimeThreshold)):ye.clicks===2&&(clearTimeout(ce.dblClickTimeOut),ye.clicks=0,ce.lastClickPos.distanceTo(He)<=D.dblClickDistThreshold&&D.dblClickHandler({eventSource:D,pointerType:Fe.type,position:G(Fe.currentPos,D.element),shift:A.originalEvent.shiftKey,isTouchEvent:Fe.type==="touch",originalEvent:A.originalEvent,userData:D.userData}),ce.lastClickPos=null)))):ye.contacts===2&&D.pinchHandler&&Fe.type==="touch"&&(ce.pinchGPoints=ye.asArray(),ce.lastPinchDist=ce.currentPinchDist=ce.pinchGPoints[0].currentPos.distanceTo(ce.pinchGPoints[1].currentPos),ce.lastPinchCenter=ce.currentPinchCenter=te(ce.pinchGPoints[0].currentPos,ce.pinchGPoints[1].currentPos))):(A.shouldReleaseCapture=!1,D.releaseHandler&&He&&(D.releaseHandler({eventSource:D,pointerType:Fe.type,position:G(He,D.element),buttons:ye.buttons,insideElementPressed:Fe.insideElementPressed,insideElementReleased:Fe.insideElement,isTouchEvent:Fe.type==="touch",originalEvent:A.originalEvent,userData:D.userData}),A.preventDefault=!0)))}function Ae(D,A,H){var j=a[D.hash],ce=D.getActivePointersListByType(H.type),ye,He,Je;if(typeof A.originalEvent.buttons<"u"&&(ce.buttons=A.originalEvent.buttons),ye=ce.getById(H.id),ye)ye.lastPos=ye.currentPos,ye.lastTime=ye.currentTime,ye.currentPos=H.currentPos,ye.currentTime=H.currentTime;else return;A.shouldCapture=!1,A.shouldReleaseCapture=!1,D.stopHandler&&H.type==="mouse"&&(clearTimeout(D.stopTimeOut),D.stopTimeOut=setTimeout(function(){Ge(D,A.originalEvent,H.type)},D.stopDelay)),ce.contacts===0?D.moveHandler&&D.moveHandler({eventSource:D,pointerType:H.type,position:G(H.currentPos,D.element),buttons:ce.buttons,isTouchEvent:H.type==="touch",originalEvent:A.originalEvent,userData:D.userData}):ce.contacts===1?(D.moveHandler&&(ye=ce.asArray()[0],D.moveHandler({eventSource:D,pointerType:ye.type,position:G(ye.currentPos,D.element),buttons:ce.buttons,isTouchEvent:ye.type==="touch",originalEvent:A.originalEvent,userData:D.userData})),D.dragHandler&&!A.preventGesture&&!A.defaultPrevented&&(ye=ce.asArray()[0],Je=ye.currentPos.minus(ye.lastPos),D.dragHandler({eventSource:D,pointerType:ye.type,position:G(ye.currentPos,D.element),buttons:ce.buttons,delta:Je,speed:ye.speed,direction:ye.direction,shift:A.originalEvent.shiftKey,isTouchEvent:ye.type==="touch",originalEvent:A.originalEvent,userData:D.userData}),A.preventDefault=!0,j.sentDragEvent=!0)):ce.contacts===2&&(D.moveHandler&&(He=ce.asArray(),D.moveHandler({eventSource:D,pointerType:He[0].type,position:G(te(He[0].currentPos,He[1].currentPos),D.element),buttons:ce.buttons,isTouchEvent:He[0].type==="touch",originalEvent:A.originalEvent,userData:D.userData})),D.pinchHandler&&H.type==="touch"&&!A.preventGesture&&!A.defaultPrevented&&(Je=j.pinchGPoints[0].currentPos.distanceTo(j.pinchGPoints[1].currentPos),Je!==j.currentPinchDist&&(j.lastPinchDist=j.currentPinchDist,j.currentPinchDist=Je,j.lastPinchCenter=j.currentPinchCenter,j.currentPinchCenter=te(j.pinchGPoints[0].currentPos,j.pinchGPoints[1].currentPos),D.pinchHandler({eventSource:D,pointerType:"touch",gesturePoints:j.pinchGPoints,lastCenter:G(j.lastPinchCenter,D.element),center:G(j.currentPinchCenter,D.element),lastDistance:j.lastPinchDist,distance:j.currentPinchDist,shift:A.originalEvent.shiftKey,originalEvent:A.originalEvent,userData:D.userData}),A.preventDefault=!0)))}function Pe(D,A,H){var j=D.getActivePointersListByType(H.type),ce;ce=j.getById(H.id),ce&&ge(D,j,ce)}function Ge(D,A,H){D.stopHandler&&D.stopHandler({eventSource:D,pointerType:H,position:V(A,D.element),buttons:D.getActivePointersListByType(H).buttons,isTouchEvent:H==="touch",originalEvent:A,userData:D.userData})}}(c),function(i){i.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},i.Control=function(a,u,d){var w=a.parentNode;typeof u=="number"&&(i.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),u={anchor:u}),u.attachToViewer=typeof u.attachToViewer>"u"?!0:u.attachToViewer,this.autoFade=typeof u.autoFade>"u"?!0:u.autoFade,this.element=a,this.anchor=u.anchor,this.container=d,this.anchor===i.ControlAnchor.ABSOLUTE?(this.wrapper=i.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top=typeof u.top=="number"?u.top+"px":u.top,this.wrapper.style.left=typeof u.left=="number"?u.left+"px":u.left,this.wrapper.style.height=typeof u.height=="number"?u.height+"px":u.height,this.wrapper.style.width=typeof u.width=="number"?u.width+"px":u.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=i.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor===i.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),u.attachToViewer?this.anchor===i.ControlAnchor.TOP_RIGHT||this.anchor===i.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):w.appendChild(this.wrapper)},i.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.anchor!==i.ControlAnchor.NONE&&this.container.removeChild(this.wrapper)},isVisible:function(){return this.wrapper.style.display!=="none"},setVisible:function(a){this.wrapper.style.display=a?this.anchor===i.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(a){this.element[i.SIGNAL]&&i.Browser.vendor===i.BROWSERS.IE?i.setElementOpacity(this.element,a,!0):i.setElementOpacity(this.wrapper,a,!0)}}}(c),function(i){i.ControlDock=function(u){var d=["topleft","topright","bottomright","bottomleft"],w,p;for(i.extend(!0,this,{id:"controldock-"+i.now()+"-"+Math.floor(Math.random()*1e6),container:i.makeNeutralElement("div"),controls:[]},u),this.container.onsubmit=function(){return!1},this.element&&(this.element=i.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),p=0;p<d.length;p++)w=d[p],this.controls[w]=i.makeNeutralElement("div"),this.controls[w].style.position="absolute",w.match("left")&&(this.controls[w].style.left="0px"),w.match("right")&&(this.controls[w].style.right="0px"),w.match("top")&&(this.controls[w].style.top="0px"),w.match("bottom")&&(this.controls[w].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},i.ControlDock.prototype={addControl:function(u,d){u=i.getElement(u);var w=null;if(!(a(this,u)>=0)){switch(d.anchor){case i.ControlAnchor.TOP_RIGHT:w=this.controls.topright,u.style.position="relative",u.style.paddingRight="0px",u.style.paddingTop="0px";break;case i.ControlAnchor.BOTTOM_RIGHT:w=this.controls.bottomright,u.style.position="relative",u.style.paddingRight="0px",u.style.paddingBottom="0px";break;case i.ControlAnchor.BOTTOM_LEFT:w=this.controls.bottomleft,u.style.position="relative",u.style.paddingLeft="0px",u.style.paddingBottom="0px";break;case i.ControlAnchor.TOP_LEFT:w=this.controls.topleft,u.style.position="relative",u.style.paddingLeft="0px",u.style.paddingTop="0px";break;case i.ControlAnchor.ABSOLUTE:w=this.container,u.style.margin="0px",u.style.padding="0px";break;default:case i.ControlAnchor.NONE:w=this.container,u.style.margin="0px",u.style.padding="0px";break}this.controls.push(new i.Control(u,d,w)),u.style.display="inline-block"}},removeControl:function(u){u=i.getElement(u);var d=a(this,u);return d>=0&&(this.controls[d].destroy(),this.controls.splice(d,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var u;for(u=this.controls.length-1;u>=0;u--)if(this.controls[u].isVisible())return!0;return!1},setControlsEnabled:function(u){var d;for(d=this.controls.length-1;d>=0;d--)this.controls[d].setVisible(u);return this}};function a(u,d){var w=u.controls,p;for(p=w.length-1;p>=0;p--)if(w[p].element===d)return p;return-1}}(c),function(i){i.Placement=i.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(c),function(i){var a={},u=1;i.Viewer=function(b){var F=arguments,ee=this,ne;if(i.isPlainObject(b)||(b={id:F[0],xmlPath:F.length>1?F[1]:void 0,prefixUrl:F.length>2?F[2]:void 0,controls:F.length>3?F[3]:void 0,overlays:F.length>4?F[4]:void 0}),b.config&&(i.extend(!0,b,b.config),delete b.config),i.extend(!0,this,{id:b.id,hash:b.hash||u++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttonGroup:null,profiler:null},i.DEFAULT_SETTINGS,b),typeof this.hash>"u")throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(typeof a[this.hash]<"u"&&i.console.warn("Hash "+this.hash+" has already been used."),a[this.hash]={fsBoundsDelta:new i.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,needsResize:!1,forceResize:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null,lastClickTime:null,draggingToZoom:!1},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._updatePixelDensityRatioBind=null,this._lastScrollTime=i.now(),i.EventSource.call(this),this.addHandler("open-failed",function(re){var ae=i.getString("Errors.OpenFailed",re.eventSource,re.message);ee._showMessage(ae)}),i.ControlDock.call(this,b),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=i.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(re){re.width="100%",re.height="100%",re.overflow="hidden",re.position="absolute",re.top="0px",re.left="0px"}(this.canvas.style),i.setElementTouchActionNone(this.canvas),b.tabIndex!==""&&(this.canvas.tabIndex=b.tabIndex===void 0?0:b.tabIndex),this.container.className="openseadragon-container",function(re){re.width="100%",re.height="100%",re.position="relative",re.overflow="hidden",re.left="0px",re.top="0px",re.textAlign="left"}(this.container.style),i.setElementTouchActionNone(this.container),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new i.MouseTracker({userData:"Viewer.innerTracker",element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,contextMenuHandler:i.delegate(this,V),keyDownHandler:i.delegate(this,G),keyHandler:i.delegate(this,te),clickHandler:i.delegate(this,se),dblClickHandler:i.delegate(this,Te),dragHandler:i.delegate(this,Ie),dragEndHandler:i.delegate(this,Ce),enterHandler:i.delegate(this,Ne),leaveHandler:i.delegate(this,je),pressHandler:i.delegate(this,ot),releaseHandler:i.delegate(this,at),nonPrimaryPressHandler:i.delegate(this,vt),nonPrimaryReleaseHandler:i.delegate(this,Ct),scrollHandler:i.delegate(this,ft),pinchHandler:i.delegate(this,Rt),focusHandler:i.delegate(this,Lt),blurHandler:i.delegate(this,ln)}),this.outerTracker=new i.MouseTracker({userData:"Viewer.outerTracker",element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:i.delegate(this,nt),leaveHandler:i.delegate(this,it)}),this.toolbar&&(this.toolbar=new i.ControlDock({element:this.toolbar})),this.bindStandardControls(),a[this.hash].prevContainerSize=d(this.container),window.ResizeObserver?(this._autoResizePolling=!1,this._resizeObserver=new ResizeObserver(function(){a[ee.hash].needsResize=!0}),this._resizeObserver.observe(this.container,{})):this._autoResizePolling=!0,this.world=new i.World({viewer:this}),this.world.addHandler("add-item",function(re){ee.source=ee.world.getItemAt(0).source,a[ee.hash].forceRedraw=!0,ee._updateRequestId||(ee._updateRequestId=y(ee,jt))}),this.world.addHandler("remove-item",function(re){ee.world.getItemCount()?ee.source=ee.world.getItemAt(0).source:ee.source=null,a[ee.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(re){ee.viewport&&ee.viewport._setContentBounds(ee.world.getHomeBounds(),ee.world.getContentFactor())}),this.world.addHandler("item-index-change",function(re){ee.source=ee.world.getItemAt(0).source}),this.viewport=new i.Viewport({containerSize:a[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins,silenceMultiImageWarnings:this.silenceMultiImageWarnings}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new i.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:b.timeout,tileRetryMax:this.tileRetryMax,tileRetryDelay:this.tileRetryDelay}),this.tileCache=new i.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new i.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=i.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(ne=this.buttonGroup.buttons.indexOf(this.rotateLeft),this.buttonGroup.buttons.splice(ne,1),this.buttonGroup.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(ne=this.buttonGroup.buttons.indexOf(this.rotateRight),this.buttonGroup.buttons.splice(ne,1),this.buttonGroup.element.removeChild(this.rotateRight.element))),this._addUpdatePixelDensityRatioEvent(),this.showNavigator&&(this.navigator=new i.Navigator({element:this.navigatorElement,id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy,animationTime:this.animationTime})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),ne=0;ne<this.customControls.length;ne++)this.addControl(this.customControls[ne].id,{anchor:this.customControls[ne].anchor});i.requestAnimationFrame(function(){S(ee)}),this.imageSmoothingEnabled!==void 0&&!this.imageSmoothingEnabled&&this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled),i._viewers.set(this.element,this)},i.extend(i.Viewer.prototype,i.EventSource.prototype,i.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(b){return i.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(b)},openTileSource:function(b){return i.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(b)},get buttons(){return i.console.warn("Viewer.buttons is deprecated; Please use Viewer.buttonGroup"),this.buttonGroup},open:function(b,F){var ee=this;if(this.close(),!b)return this;if(this.sequenceMode&&i.isArray(b))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),typeof F<"u"&&!isNaN(F)&&(this.initialPage=F),this.tileSources=b,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),this._updateSequenceButtons(this._sequenceIndex),this;if(i.isArray(b)||(b=[b]),!b.length)return this;this._opening=!0;for(var ne=b.length,re=0,ae=0,ue,xe=function(){if(re+ae===ne)if(re){(ee._firstOpen||!ee.preserveViewport)&&(ee.viewport.goHome(!0),ee.viewport.update()),ee._firstOpen=!1;var Pe=b[0];if(Pe.tileSource&&(Pe=Pe.tileSource),ee.overlays&&!ee.preserveOverlays)for(var Ge=0;Ge<ee.overlays.length;Ge++)ee.currentOverlays[Ge]=p(ee,ee.overlays[Ge]);ee._drawOverlays(),ee._opening=!1,ee.raiseEvent("open",{source:Pe})}else ee._opening=!1,ee.raiseEvent("open-failed",ue)},Ee=function(Pe){(!i.isPlainObject(Pe)||!Pe.tileSource)&&(Pe={tileSource:Pe}),Pe.index!==void 0&&(i.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete Pe.index),Pe.collectionImmediately===void 0&&(Pe.collectionImmediately=!0);var Ge=Pe.success;Pe.success=function(A){if(re++,Pe.tileSource.overlays)for(var H=0;H<Pe.tileSource.overlays.length;H++)ee.addOverlay(Pe.tileSource.overlays[H]);Ge&&Ge(A),xe()};var D=Pe.error;Pe.error=function(A){ae++,ue||(ue=A),D&&D(A),xe()},ee.addTiledImage(Pe)},Ae=0;Ae<b.length;Ae++)Ee(b[Ae]);return this},close:function(){return a[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),a[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(a[this.hash]){if(this.raiseEvent("before-destroy"),this._removeUpdatePixelDensityRatioEvent(),this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this._resizeObserver&&this._resizeObserver.disconnect(),this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),this._updateRequestId!==null&&(i.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.navigator&&(this.navigator.destroy(),a[this.navigator.hash]=null,delete a[this.navigator.hash],this.navigator=null),this.buttonGroup)this.buttonGroup.destroy();else if(this.customButtons)for(;this.customButtons.length;)this.customButtons.pop().destroy();if(this.paging&&this.paging.destroy(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.container.onsubmit=null,this.clearControls(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),a[this.hash]=null,delete a[this.hash],this.canvas=null,this.container=null,i._viewers.delete(this.element),this.element=null,this.raiseEvent("destroy"),this.removeAllHandlers()}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(b){return this.innerTracker.setTracking(b),this.outerTracker.setTracking(b),this.raiseEvent("mouse-enabled",{enabled:b}),this},areControlsEnabled:function(){var b=this.controls.length,F;for(F=0;F<this.controls.length;F++)b=b&&this.controls[F].isVisible();return b},setControlsEnabled:function(b){return b?B(this):S(this),this.raiseEvent("controls-enabled",{enabled:b}),this},setDebugMode:function(b){for(var F=0;F<this.world.getItemCount();F++)this.world.getItemAt(F).debugMode=b;this.debugMode=b,this.forceRedraw()},setAjaxHeaders:function(b,F){if(b===null&&(b={}),!i.isPlainObject(b)){console.error("[Viewer.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}if(F===void 0&&(F=!0),this.ajaxHeaders=b,F){for(var ee=0;ee<this.world.getItemCount();ee++)this.world.getItemAt(ee)._updateAjaxHeaders(!0);if(this.navigator&&this.navigator.setAjaxHeaders(this.ajaxHeaders,!0),this.referenceStrip&&this.referenceStrip.miniViewers)for(var ne in this.referenceStrip.miniViewers)this.referenceStrip.miniViewers[ne].setAjaxHeaders(this.ajaxHeaders,!0)}},addButton:function(b){this.buttonGroup.addButton(b)},isFullPage:function(){return a[this.hash].fullPage},setFullPage:function(b){var F=document.body,ee=F.style,ne=document.documentElement.style,re=this,ae,ue;if(b===this.isFullPage())return this;var xe={fullPage:b,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",xe),xe.preventDefaultAction)return this;if(b){for(this.elementSize=i.getElementSize(this.element),this.pageScroll=i.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=ee.margin,this.docMargin=ne.margin,ee.margin="0",ne.margin="0",this.bodyPadding=ee.padding,this.docPadding=ne.padding,ee.padding="0",ne.padding="0",this.bodyWidth=ee.width,this.docWidth=ne.width,ee.width="100%",ne.width="100%",this.bodyHeight=ee.height,this.docHeight=ne.height,ee.height="100%",ne.height="100%",this.bodyDisplay=ee.display,ee.display="block",this.previousBody=[],a[this.hash].prevElementParent=this.element.parentNode,a[this.hash].prevNextSibling=this.element.nextSibling,a[this.hash].prevElementWidth=this.element.style.width,a[this.hash].prevElementHeight=this.element.style.height,ae=F.childNodes.length,ue=0;ue<ae;ue++)this.previousBody.push(F.childNodes[0]),F.removeChild(F.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,F.appendChild(this.toolbar.element),i.addClass(this.toolbar.element,"fullpage")),i.addClass(this.element,"fullpage"),F.appendChild(this.element),this.element.style.height="100vh",this.element.style.width="100vw",this.toolbar&&this.toolbar.element&&(this.element.style.height=i.getElementSize(this.element).y-i.getElementSize(this.toolbar.element).y+"px"),a[this.hash].fullPage=!0,i.delegate(this,nt)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,ee.margin=this.bodyMargin,ne.margin=this.docMargin,ee.padding=this.bodyPadding,ne.padding=this.docPadding,ee.width=this.bodyWidth,ne.width=this.docWidth,ee.height=this.bodyHeight,ne.height=this.docHeight,ee.display=this.bodyDisplay,F.removeChild(this.element),ae=this.previousBody.length,ue=0;ue<ae;ue++)F.appendChild(this.previousBody.shift());i.removeClass(this.element,"fullpage"),a[this.hash].prevElementParent.insertBefore(this.element,a[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(F.removeChild(this.toolbar.element),i.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=a[this.hash].prevElementWidth,this.element.style.height=a[this.hash].prevElementHeight;var Ee=0,Ae=function(){i.setPageScroll(re.pageScroll);var Pe=i.getPageScroll();Ee++,Ee<10&&(Pe.x!==re.pageScroll.x||Pe.y!==re.pageScroll.y)&&i.requestAnimationFrame(Ae)};i.requestAnimationFrame(Ae),a[this.hash].fullPage=!1,i.delegate(this,it)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:b}),this},setFullScreen:function(b){var F=this;if(!i.supportsFullScreen)return this.setFullPage(b);if(i.isFullScreen()===b)return this;var ee={fullScreen:b,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",ee),ee.preventDefaultAction)return this;if(b){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var ne=function(){var re=i.isFullScreen();re||(i.removeEvent(document,i.fullScreenEventName,ne),i.removeEvent(document,i.fullScreenErrorEventName,ne),F.setFullPage(!1),F.isFullPage()&&(F.element.style.width=F.fullPageStyleWidth,F.element.style.height=F.fullPageStyleHeight)),F.navigator&&F.viewport&&setTimeout(function(){F.navigator.update(F.viewport)}),F.raiseEvent("full-screen",{fullScreen:re})};i.addEvent(document,i.fullScreenEventName,ne),i.addEvent(document,i.fullScreenErrorEventName,ne),i.requestFullScreen(document.body)}else i.exitFullScreen();return this},isVisible:function(){return this.container.style.visibility!=="hidden"},isFullScreen:function(){return i.isFullScreen()&&this.isFullPage()},setVisible:function(b){return this.container.style.visibility=b?"":"hidden",this.raiseEvent("visible",{visible:b}),this},addTiledImage:function(b){i.console.assert(b,"[Viewer.addTiledImage] options is required"),i.console.assert(b.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),i.console.assert(!b.replace||b.index>-1&&b.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var F=this;b.replace&&(b.replaceItem=F.world.getItemAt(b.index)),this._hideMessage(),b.placeholderFillStyle===void 0&&(b.placeholderFillStyle=this.placeholderFillStyle),b.opacity===void 0&&(b.opacity=this.opacity),b.preload===void 0&&(b.preload=this.preload),b.compositeOperation===void 0&&(b.compositeOperation=this.compositeOperation),b.crossOriginPolicy===void 0&&(b.crossOriginPolicy=b.tileSource.crossOriginPolicy!==void 0?b.tileSource.crossOriginPolicy:this.crossOriginPolicy),b.ajaxWithCredentials===void 0&&(b.ajaxWithCredentials=this.ajaxWithCredentials),b.loadTilesWithAjax===void 0&&(b.loadTilesWithAjax=this.loadTilesWithAjax),i.isPlainObject(b.ajaxHeaders)||(b.ajaxHeaders={});var ee={options:b};function ne(ue){for(var xe=0;xe<F._loadQueue.length;xe++)if(F._loadQueue[xe]===ee){F._loadQueue.splice(xe,1);break}F._loadQueue.length===0&&re(ee),F.raiseEvent("add-item-failed",ue),b.error&&b.error(ue)}function re(ue){F.collectionMode&&(F.world.arrange({immediately:ue.options.collectionImmediately,rows:F.collectionRows,columns:F.collectionColumns,layout:F.collectionLayout,tileSize:F.collectionTileSize,tileMargin:F.collectionTileMargin}),F.world.setAutoRefigureSizes(!0))}if(i.isArray(b.tileSource)){setTimeout(function(){ne({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:b.tileSource,options:b})});return}this._loadQueue.push(ee);function ae(){for(var ue,xe,Ee;F._loadQueue.length&&(ue=F._loadQueue[0],!!ue.tileSource);){if(F._loadQueue.splice(0,1),ue.options.replace){var Ae=F.world.getIndexOfItem(ue.options.replaceItem);Ae!==-1&&(ue.options.index=Ae),F.world.removeItem(ue.options.replaceItem)}xe=new i.TiledImage({viewer:F,source:ue.tileSource,viewport:F.viewport,drawer:F.drawer,tileCache:F.tileCache,imageLoader:F.imageLoader,x:ue.options.x,y:ue.options.y,width:ue.options.width,height:ue.options.height,fitBounds:ue.options.fitBounds,fitBoundsPlacement:ue.options.fitBoundsPlacement,clip:ue.options.clip,placeholderFillStyle:ue.options.placeholderFillStyle,opacity:ue.options.opacity,preload:ue.options.preload,degrees:ue.options.degrees,flipped:ue.options.flipped,compositeOperation:ue.options.compositeOperation,springStiffness:F.springStiffness,animationTime:F.animationTime,minZoomImageRatio:F.minZoomImageRatio,wrapHorizontal:F.wrapHorizontal,wrapVertical:F.wrapVertical,immediateRender:F.immediateRender,blendTime:F.blendTime,alwaysBlend:F.alwaysBlend,minPixelRatio:F.minPixelRatio,smoothTileEdgesMinZoom:F.smoothTileEdgesMinZoom,iOSDevice:F.iOSDevice,crossOriginPolicy:ue.options.crossOriginPolicy,ajaxWithCredentials:ue.options.ajaxWithCredentials,loadTilesWithAjax:ue.options.loadTilesWithAjax,ajaxHeaders:ue.options.ajaxHeaders,debugMode:F.debugMode,subPixelRoundingForTransparency:F.subPixelRoundingForTransparency}),F.collectionMode&&F.world.setAutoRefigureSizes(!1),F.navigator&&(Ee=i.extend({},ue.options,{replace:!1,originalTiledImage:xe,tileSource:ue.tileSource}),F.navigator.addTiledImage(Ee)),F.world.addItem(xe,{index:ue.options.index}),F._loadQueue.length===0&&re(ue),F.world.getItemCount()===1&&!F.preserveViewport&&F.viewport.goHome(!0),ue.options.success&&ue.options.success({item:xe})}}w(this,b.tileSource,b,function(ue){ee.tileSource=ue,ae()},function(ue){ue.options=b,ne(ue),ae()})},addSimpleImage:function(b){i.console.assert(b,"[Viewer.addSimpleImage] options is required"),i.console.assert(b.url,"[Viewer.addSimpleImage] options.url is required");var F=i.extend({},b,{tileSource:{type:"image",url:b.url}});delete F.url,this.addTiledImage(F)},addLayer:function(b){var F=this;i.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var ee=i.extend({},b,{success:function(ne){F.raiseEvent("add-layer",{options:b,drawer:ne.item})},error:function(ne){F.raiseEvent("add-layer-failed",ne)}});return this.addTiledImage(ee),this},getLayerAtLevel:function(b){return i.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(b)},getLevelOfLayer:function(b){return i.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(b)},getLayersCount:function(){return i.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(b,F){return i.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(b,F)},removeLayer:function(b){return i.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(b)},forceRedraw:function(){return a[this.hash].forceRedraw=!0,this},forceResize:function(){a[this.hash].needsResize=!0,a[this.hash].forceResize=!0},bindSequenceControls:function(){var b=i.delegate(this,L),F=i.delegate(this,q),ee=i.delegate(this,this.goToNextPage),ne=i.delegate(this,this.goToPreviousPage),re=this.navImages,ae=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(ae=!1),this.previousButton=new i.Button({element:this.previousButton?i.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.PreviousPage"),srcRest:We(this.prefixUrl,re.previous.REST),srcGroup:We(this.prefixUrl,re.previous.GROUP),srcHover:We(this.prefixUrl,re.previous.HOVER),srcDown:We(this.prefixUrl,re.previous.DOWN),onRelease:ne,onFocus:b,onBlur:F}),this.nextButton=new i.Button({element:this.nextButton?i.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.NextPage"),srcRest:We(this.prefixUrl,re.next.REST),srcGroup:We(this.prefixUrl,re.next.GROUP),srcHover:We(this.prefixUrl,re.next.HOVER),srcDown:We(this.prefixUrl,re.next.DOWN),onRelease:ee,onFocus:b,onBlur:F}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),ae&&(this.paging=new i.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:i.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||i.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var b=i.delegate(this,hn),F=i.delegate(this,Pt),ee=i.delegate(this,Re),ne=i.delegate(this,Dn),re=i.delegate(this,ke),ae=i.delegate(this,yt),ue=i.delegate(this,Z),xe=i.delegate(this,Q),Ee=i.delegate(this,le),Ae=i.delegate(this,ge),Pe=i.delegate(this,L),Ge=i.delegate(this,q),D=this.navImages,A=[],H=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(H=!1),this.showZoomControl&&(A.push(this.zoomInButton=new i.Button({element:this.zoomInButton?i.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.ZoomIn"),srcRest:We(this.prefixUrl,D.zoomIn.REST),srcGroup:We(this.prefixUrl,D.zoomIn.GROUP),srcHover:We(this.prefixUrl,D.zoomIn.HOVER),srcDown:We(this.prefixUrl,D.zoomIn.DOWN),onPress:b,onRelease:F,onClick:ee,onEnter:b,onExit:F,onFocus:Pe,onBlur:Ge})),A.push(this.zoomOutButton=new i.Button({element:this.zoomOutButton?i.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.ZoomOut"),srcRest:We(this.prefixUrl,D.zoomOut.REST),srcGroup:We(this.prefixUrl,D.zoomOut.GROUP),srcHover:We(this.prefixUrl,D.zoomOut.HOVER),srcDown:We(this.prefixUrl,D.zoomOut.DOWN),onPress:ne,onRelease:F,onClick:re,onEnter:ne,onExit:F,onFocus:Pe,onBlur:Ge}))),this.showHomeControl&&A.push(this.homeButton=new i.Button({element:this.homeButton?i.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.Home"),srcRest:We(this.prefixUrl,D.home.REST),srcGroup:We(this.prefixUrl,D.home.GROUP),srcHover:We(this.prefixUrl,D.home.HOVER),srcDown:We(this.prefixUrl,D.home.DOWN),onRelease:ae,onFocus:Pe,onBlur:Ge})),this.showFullPageControl&&A.push(this.fullPageButton=new i.Button({element:this.fullPageButton?i.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.FullPage"),srcRest:We(this.prefixUrl,D.fullpage.REST),srcGroup:We(this.prefixUrl,D.fullpage.GROUP),srcHover:We(this.prefixUrl,D.fullpage.HOVER),srcDown:We(this.prefixUrl,D.fullpage.DOWN),onRelease:ue,onFocus:Pe,onBlur:Ge})),this.showRotationControl&&(A.push(this.rotateLeftButton=new i.Button({element:this.rotateLeftButton?i.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.RotateLeft"),srcRest:We(this.prefixUrl,D.rotateleft.REST),srcGroup:We(this.prefixUrl,D.rotateleft.GROUP),srcHover:We(this.prefixUrl,D.rotateleft.HOVER),srcDown:We(this.prefixUrl,D.rotateleft.DOWN),onRelease:xe,onFocus:Pe,onBlur:Ge})),A.push(this.rotateRightButton=new i.Button({element:this.rotateRightButton?i.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.RotateRight"),srcRest:We(this.prefixUrl,D.rotateright.REST),srcGroup:We(this.prefixUrl,D.rotateright.GROUP),srcHover:We(this.prefixUrl,D.rotateright.HOVER),srcDown:We(this.prefixUrl,D.rotateright.DOWN),onRelease:Ee,onFocus:Pe,onBlur:Ge}))),this.showFlipControl&&A.push(this.flipButton=new i.Button({element:this.flipButton?i.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.Flip"),srcRest:We(this.prefixUrl,D.flip.REST),srcGroup:We(this.prefixUrl,D.flip.GROUP),srcHover:We(this.prefixUrl,D.flip.HOVER),srcDown:We(this.prefixUrl,D.flip.DOWN),onRelease:Ae,onFocus:Pe,onBlur:Ge})),H?(this.buttonGroup=new i.ButtonGroup({buttons:A,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttonGroup.element,this.addHandler("open",i.delegate(this,st)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||i.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||i.ControlAnchor.TOP_LEFT})):this.customButtons=A),this},currentPage:function(){return this._sequenceIndex},goToPage:function(b){return this.tileSources&&b>=0&&b<this.tileSources.length&&(this._sequenceIndex=b,this._updateSequenceButtons(b),this.open(this.tileSources[b]),this.referenceStrip&&this.referenceStrip.setFocus(b),this.raiseEvent("page",{page:b})),this},addOverlay:function(b,F,ee,ne){var re;if(i.isPlainObject(b)?re=b:re={element:b,location:F,placement:ee,onDraw:ne},b=i.getElement(re.element),m(this.currentOverlays,b)>=0)return this;var ae=p(this,re);return this.currentOverlays.push(ae),ae.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:b,location:re.location,placement:re.placement}),this},updateOverlay:function(b,F,ee){var ne;return b=i.getElement(b),ne=m(this.currentOverlays,b),ne>=0&&(this.currentOverlays[ne].update(F,ee),a[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:b,location:F,placement:ee})),this},removeOverlay:function(b){var F;return b=i.getElement(b),F=m(this.currentOverlays,b),F>=0&&(this.currentOverlays[F].destroy(),this.currentOverlays.splice(F,1),a[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:b})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return a[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(b){var F;return b=i.getElement(b),F=m(this.currentOverlays,b),F>=0?this.currentOverlays[F]:null},_updateSequenceButtons:function(b){this.nextButton&&(!this.tileSources||this.tileSources.length-1===b?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(b>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(b){this._hideMessage();var F=i.makeNeutralElement("div");F.appendChild(document.createTextNode(b)),this.messageDiv=i.makeCenteredNode(F),i.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var b=this.messageDiv;b&&(b.parentNode.removeChild(b),delete this.messageDiv)},gestureSettingsByDeviceType:function(b){switch(b){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var b,F=this.currentOverlays.length;for(b=0;b<F;b++)this.currentOverlays[b].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new i.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else i.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')},_addUpdatePixelDensityRatioEvent:function(){this._updatePixelDensityRatioBind=this._updatePixelDensityRatio.bind(this),i.addEvent(window,"resize",this._updatePixelDensityRatioBind)},_removeUpdatePixelDensityRatioEvent:function(){i.removeEvent(window,"resize",this._updatePixelDensityRatioBind)},_updatePixelDensityRatio:function(){var b=i.pixelDensityRatio,F=i.getCurrentPixelDensityRatio();b!==F&&(i.pixelDensityRatio=F,this.world.resetItems(),this.forceRedraw())},goToPreviousPage:function(){var b=this._sequenceIndex-1;this.navPrevNextWrap&&b<0&&(b+=this.tileSources.length),this.goToPage(b)},goToNextPage:function(){var b=this._sequenceIndex+1;this.navPrevNextWrap&&b>=this.tileSources.length&&(b=0),this.goToPage(b)},isAnimating:function(){return a[this.hash].animating}});function d(b){return b=i.getElement(b),new i.Point(b.clientWidth===0?1:b.clientWidth,b.clientHeight===0?1:b.clientHeight)}function w(b,F,ee,ne,re){var ae=b;if(i.type(F)==="string"){if(F.match(/^\s*<.*>\s*$/))F=i.parseXml(F);else if(F.match(/^\s*[{[].*[}\]]\s*$/))try{var ue=i.parseJSON(F);F=ue}catch{}}function xe(Ee,Ae){Ee.ready?ne(Ee):(Ee.addHandler("ready",function(){ne(Ee)}),Ee.addHandler("open-failed",function(Pe){re({message:Pe.message,source:Ae})}))}setTimeout(function(){if(i.type(F)==="string")F=new i.TileSource({url:F,crossOriginPolicy:ee.crossOriginPolicy!==void 0?ee.crossOriginPolicy:b.crossOriginPolicy,ajaxWithCredentials:b.ajaxWithCredentials,ajaxHeaders:ee.ajaxHeaders?ee.ajaxHeaders:b.ajaxHeaders,splitHashDataForPost:b.splitHashDataForPost,useCanvas:b.useCanvas,success:function(Ge){ne(Ge.tileSource)}}),F.addHandler("open-failed",function(Ge){re(Ge)});else if(i.isPlainObject(F)||F.nodeType)if(F.crossOriginPolicy===void 0&&(ee.crossOriginPolicy!==void 0||b.crossOriginPolicy!==void 0)&&(F.crossOriginPolicy=ee.crossOriginPolicy!==void 0?ee.crossOriginPolicy:b.crossOriginPolicy),F.ajaxWithCredentials===void 0&&(F.ajaxWithCredentials=b.ajaxWithCredentials),F.useCanvas===void 0&&(F.useCanvas=b.useCanvas),i.isFunction(F.getTileUrl)){var Ee=new i.TileSource(F);Ee.getTileUrl=F.getTileUrl,ne(Ee)}else{var Ae=i.TileSource.determineType(ae,F);if(!Ae){re({message:"Unable to load TileSource",source:F});return}var Pe=Ae.prototype.configure.apply(ae,[F]);xe(new Ae(Pe),F)}else xe(F,F)})}function p(b,F){if(F instanceof i.Overlay)return F;var ee=null;if(F.element)ee=i.getElement(F.element);else{var ne=F.id?F.id:"openseadragon-overlay-"+Math.floor(Math.random()*1e7);ee=i.getElement(F.id),ee||(ee=document.createElement("a"),ee.href="#/overlay/"+ne),ee.id=ne,i.addClass(ee,F.className?F.className:"openseadragon-overlay")}var re=F.location,ae=F.width,ue=F.height;if(!re){var xe=F.x,Ee=F.y;if(F.px!==void 0){var Ae=b.viewport.imageToViewportRectangle(new i.Rect(F.px,F.py,ae||0,ue||0));xe=Ae.x,Ee=Ae.y,ae=ae!==void 0?Ae.width:void 0,ue=ue!==void 0?Ae.height:void 0}re=new i.Point(xe,Ee)}var Pe=F.placement;return Pe&&i.type(Pe)==="string"&&(Pe=i.Placement[F.placement.toUpperCase()]),new i.Overlay({element:ee,location:re,placement:Pe,onDraw:F.onDraw,checkResize:F.checkResize,width:ae,height:ue,rotationMode:F.rotationMode})}function m(b,F){var ee;for(ee=b.length-1;ee>=0;ee--)if(b[ee].element===F)return ee;return-1}function y(b,F){return i.requestAnimationFrame(function(){F(b)})}function x(b){i.requestAnimationFrame(function(){T(b)})}function S(b){b.autoHideControls&&(b.controlsShouldFade=!0,b.controlsFadeBeginTime=i.now()+b.controlsFadeDelay,window.setTimeout(function(){x(b)},b.controlsFadeDelay))}function T(b){var F,ee,ne,re;if(b.controlsShouldFade){for(F=i.now(),ee=F-b.controlsFadeBeginTime,ne=1-ee/b.controlsFadeLength,ne=Math.min(1,ne),ne=Math.max(0,ne),re=b.controls.length-1;re>=0;re--)b.controls[re].autoFade&&b.controls[re].setOpacity(ne);ne>0&&x(b)}}function B(b){var F;for(b.controlsShouldFade=!1,F=b.controls.length-1;F>=0;F--)b.controls[F].setOpacity(1)}function L(){B(this)}function q(){S(this)}function V(b){var F={tracker:b.eventSource,position:b.position,originalEvent:b.originalEvent,preventDefault:b.preventDefault};this.raiseEvent("canvas-contextmenu",F),b.preventDefault=F.preventDefault}function G(b){var F={originalEvent:b.originalEvent,preventDefaultAction:!1,preventVerticalPan:b.preventVerticalPan||!this.panVertical,preventHorizontalPan:b.preventHorizontalPan||!this.panHorizontal};if(this.raiseEvent("canvas-key",F),!F.preventDefaultAction&&!b.ctrl&&!b.alt&&!b.meta)switch(b.keyCode){case 38:F.preventVerticalPan||(b.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),b.preventDefault=!0;break;case 40:F.preventVerticalPan||(b.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),b.preventDefault=!0;break;case 37:F.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),b.preventDefault=!0;break;case 39:F.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),b.preventDefault=!0;break;case 187:this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),b.preventDefault=!0;break;case 189:this.viewport.zoomBy(.9),this.viewport.applyConstraints(),b.preventDefault=!0;break;case 48:this.viewport.goHome(),this.viewport.applyConstraints(),b.preventDefault=!0;break;case 87:F.preventVerticalPan||(b.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(0,-40))),this.viewport.applyConstraints()),b.preventDefault=!0;break;case 83:F.preventVerticalPan||(b.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(0,40))),this.viewport.applyConstraints()),b.preventDefault=!0;break;case 65:F.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(-40,0))),this.viewport.applyConstraints()),b.preventDefault=!0;break;case 68:F.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(40,0))),this.viewport.applyConstraints()),b.preventDefault=!0;break;case 82:b.shift?this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement),this.viewport.applyConstraints(),b.preventDefault=!0;break;case 70:this.viewport.toggleFlip(),b.preventDefault=!0;break;case 74:this.goToPreviousPage();break;case 75:this.goToNextPage();break;default:b.preventDefault=!1;break}else b.preventDefault=!1}function te(b){var F={originalEvent:b.originalEvent};this.raiseEvent("canvas-key-press",F)}function se(b){var F,ee=document.activeElement===this.canvas;ee||this.canvas.focus(),this.viewport.flipped&&(b.position.x=this.viewport.getContainerSize().x-b.position.x);var ne={tracker:b.eventSource,position:b.position,quick:b.quick,shift:b.shift,originalEvent:b.originalEvent,originalTarget:b.originalTarget,preventDefaultAction:!1};this.raiseEvent("canvas-click",ne),!ne.preventDefaultAction&&this.viewport&&b.quick&&(F=this.gestureSettingsByDeviceType(b.pointerType),F.clickToZoom===!0&&(this.viewport.zoomBy(b.shift?1/this.zoomPerClick:this.zoomPerClick,F.zoomToRefPoint?this.viewport.pointFromPixel(b.position,!0):null),this.viewport.applyConstraints()),F.dblClickDragToZoom&&(a[this.hash].draggingToZoom===!0?(a[this.hash].lastClickTime=null,a[this.hash].draggingToZoom=!1):a[this.hash].lastClickTime=i.now()))}function Te(b){var F,ee={tracker:b.eventSource,position:b.position,shift:b.shift,originalEvent:b.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-double-click",ee),!ee.preventDefaultAction&&this.viewport&&(F=this.gestureSettingsByDeviceType(b.pointerType),F.dblClickToZoom&&(this.viewport.zoomBy(b.shift?1/this.zoomPerClick:this.zoomPerClick,F.zoomToRefPoint?this.viewport.pointFromPixel(b.position,!0):null),this.viewport.applyConstraints()))}function Ie(b){var F,ee={tracker:b.eventSource,pointerType:b.pointerType,position:b.position,delta:b.delta,speed:b.speed,direction:b.direction,shift:b.shift,originalEvent:b.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag",ee),F=this.gestureSettingsByDeviceType(b.pointerType),!ee.preventDefaultAction&&this.viewport){if(F.dblClickDragToZoom&&a[this.hash].draggingToZoom){var ne=Math.pow(this.zoomPerDblClickDrag,b.delta.y/50);this.viewport.zoomBy(ne)}else if(F.dragToPan&&!a[this.hash].draggingToZoom){if(this.panHorizontal||(b.delta.x=0),this.panVertical||(b.delta.y=0),this.viewport.flipped&&(b.delta.x=-b.delta.x),this.constrainDuringPan){var re=this.viewport.deltaPointsFromPixels(b.delta.negate());this.viewport.centerSpringX.target.value+=re.x,this.viewport.centerSpringY.target.value+=re.y;var ae=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=re.x,this.viewport.centerSpringY.target.value-=re.y,ae.xConstrained&&(b.delta.x=0),ae.yConstrained&&(b.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(b.delta.negate()),F.flickEnabled&&!this.constrainDuringPan)}}}function Ce(b){var F,ee={tracker:b.eventSource,pointerType:b.pointerType,position:b.position,speed:b.speed,direction:b.direction,shift:b.shift,originalEvent:b.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag-end",ee),F=this.gestureSettingsByDeviceType(b.pointerType),!ee.preventDefaultAction&&this.viewport){if(!a[this.hash].draggingToZoom&&F.flickEnabled&&b.speed>=F.flickMinSpeed){var ne=0;this.panHorizontal&&(ne=F.flickMomentum*b.speed*Math.cos(b.direction));var re=0;this.panVertical&&(re=F.flickMomentum*b.speed*Math.sin(b.direction));var ae=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),ue=this.viewport.pointFromPixel(new i.Point(ae.x-ne,ae.y-re));this.viewport.panTo(ue,!1)}this.viewport.applyConstraints()}F.dblClickDragToZoom&&a[this.hash].draggingToZoom===!0&&(a[this.hash].draggingToZoom=!1)}function Ne(b){this.raiseEvent("canvas-enter",{tracker:b.eventSource,pointerType:b.pointerType,position:b.position,buttons:b.buttons,pointers:b.pointers,insideElementPressed:b.insideElementPressed,buttonDownAny:b.buttonDownAny,originalEvent:b.originalEvent})}function je(b){this.raiseEvent("canvas-exit",{tracker:b.eventSource,pointerType:b.pointerType,position:b.position,buttons:b.buttons,pointers:b.pointers,insideElementPressed:b.insideElementPressed,buttonDownAny:b.buttonDownAny,originalEvent:b.originalEvent})}function ot(b){var F;if(this.raiseEvent("canvas-press",{tracker:b.eventSource,pointerType:b.pointerType,position:b.position,insideElementPressed:b.insideElementPressed,insideElementReleased:b.insideElementReleased,originalEvent:b.originalEvent}),F=this.gestureSettingsByDeviceType(b.pointerType),F.dblClickDragToZoom){var ee=a[this.hash].lastClickTime,ne=i.now();if(ee===null)return;ne-ee<this.dblClickTimeThreshold&&(a[this.hash].draggingToZoom=!0),a[this.hash].lastClickTime=null}}function at(b){this.raiseEvent("canvas-release",{tracker:b.eventSource,pointerType:b.pointerType,position:b.position,insideElementPressed:b.insideElementPressed,insideElementReleased:b.insideElementReleased,originalEvent:b.originalEvent})}function vt(b){this.raiseEvent("canvas-nonprimary-press",{tracker:b.eventSource,position:b.position,pointerType:b.pointerType,button:b.button,buttons:b.buttons,originalEvent:b.originalEvent})}function Ct(b){this.raiseEvent("canvas-nonprimary-release",{tracker:b.eventSource,position:b.position,pointerType:b.pointerType,button:b.button,buttons:b.buttons,originalEvent:b.originalEvent})}function Rt(b){var F,ee,ne,re,ae={tracker:b.eventSource,pointerType:b.pointerType,gesturePoints:b.gesturePoints,lastCenter:b.lastCenter,center:b.center,lastDistance:b.lastDistance,distance:b.distance,shift:b.shift,originalEvent:b.originalEvent,preventDefaultPanAction:!1,preventDefaultZoomAction:!1,preventDefaultRotateAction:!1};if(this.raiseEvent("canvas-pinch",ae),this.viewport&&(F=this.gestureSettingsByDeviceType(b.pointerType),F.pinchToZoom&&(!ae.preventDefaultPanAction||!ae.preventDefaultZoomAction)&&(ee=this.viewport.pointFromPixel(b.center,!0),F.zoomToRefPoint&&!ae.preventDefaultPanAction&&(ne=this.viewport.pointFromPixel(b.lastCenter,!0),re=ne.minus(ee),this.panHorizontal||(re.x=0),this.panVertical||(re.y=0),this.viewport.panBy(re,!0)),ae.preventDefaultZoomAction||this.viewport.zoomBy(b.distance/b.lastDistance,ee,!0),this.viewport.applyConstraints()),F.pinchRotate&&!ae.preventDefaultRotateAction)){var ue=Math.atan2(b.gesturePoints[0].currentPos.y-b.gesturePoints[1].currentPos.y,b.gesturePoints[0].currentPos.x-b.gesturePoints[1].currentPos.x),xe=Math.atan2(b.gesturePoints[0].lastPos.y-b.gesturePoints[1].lastPos.y,b.gesturePoints[0].lastPos.x-b.gesturePoints[1].lastPos.x);ee=this.viewport.pointFromPixel(b.center,!0),this.viewport.rotateTo(this.viewport.getRotation(!0)+(ue-xe)*(180/Math.PI),ee,!0)}}function Lt(b){this.raiseEvent("canvas-focus",{tracker:b.eventSource,originalEvent:b.originalEvent})}function ln(b){this.raiseEvent("canvas-blur",{tracker:b.eventSource,originalEvent:b.originalEvent})}function ft(b){var F,ee,ne,re,ae;re=i.now(),ae=re-this._lastScrollTime,ae>this.minScrollDeltaTime?(this._lastScrollTime=re,F={tracker:b.eventSource,position:b.position,scroll:b.scroll,shift:b.shift,originalEvent:b.originalEvent,preventDefaultAction:!1,preventDefault:!0},this.raiseEvent("canvas-scroll",F),!F.preventDefaultAction&&this.viewport&&(this.viewport.flipped&&(b.position.x=this.viewport.getContainerSize().x-b.position.x),ee=this.gestureSettingsByDeviceType(b.pointerType),ee.scrollToZoom&&(ne=Math.pow(this.zoomPerScroll,b.scroll),this.viewport.zoomBy(ne,ee.zoomToRefPoint?this.viewport.pointFromPixel(b.position,!0):null),this.viewport.applyConstraints())),b.preventDefault=F.preventDefault):b.preventDefault=!0}function nt(b){a[this.hash].mouseInside=!0,B(this),this.raiseEvent("container-enter",{tracker:b.eventSource,pointerType:b.pointerType,position:b.position,buttons:b.buttons,pointers:b.pointers,insideElementPressed:b.insideElementPressed,buttonDownAny:b.buttonDownAny,originalEvent:b.originalEvent})}function it(b){b.pointers<1&&(a[this.hash].mouseInside=!1,a[this.hash].animating||S(this)),this.raiseEvent("container-exit",{tracker:b.eventSource,pointerType:b.pointerType,position:b.position,buttons:b.buttons,pointers:b.pointers,insideElementPressed:b.insideElementPressed,buttonDownAny:b.buttonDownAny,originalEvent:b.originalEvent})}function jt(b){Yt(b),b.isOpen()?b._updateRequestId=y(b,jt):b._updateRequestId=!1}function Ht(b,F){var ee=b.viewport,ne=ee.getZoom(),re=ee.getCenter();ee.resize(F,b.preserveImageSizeOnResize),ee.panTo(re,!0);var ae;if(b.preserveImageSizeOnResize)ae=a[b.hash].prevContainerSize.x/F.x;else{var ue=new i.Point(0,0),xe=new i.Point(a[b.hash].prevContainerSize.x,a[b.hash].prevContainerSize.y).distanceTo(ue),Ee=new i.Point(F.x,F.y).distanceTo(ue);ae=Ee/xe*a[b.hash].prevContainerSize.x/F.x}ee.zoomTo(ne*ae,null,!0),a[b.hash].prevContainerSize=F,a[b.hash].forceRedraw=!0,a[b.hash].needsResize=!1,a[b.hash].forceResize=!1}function Yt(b){if(!(b._opening||!a[b.hash])){if(b.autoResize||a[b.hash].forceResize){var F;if(b._autoResizePolling){F=d(b.container);var ee=a[b.hash].prevContainerSize;F.equals(ee)||(a[b.hash].needsResize=!0)}a[b.hash].needsResize&&Ht(b,F||d(b.container))}var ne=b.viewport.update(),re=b.world.update()||ne;ne&&b.raiseEvent("viewport-change"),b.referenceStrip&&(re=b.referenceStrip.update(b.viewport)||re);var ae=a[b.hash].animating;!ae&&re&&(b.raiseEvent("animation-start"),B(b));var ue=ae&&!re;ue&&(a[b.hash].animating=!1),(re||ue||a[b.hash].forceRedraw||b.world.needsDraw())&&(Nt(b),b._drawOverlays(),b.navigator&&b.navigator.update(b.viewport),a[b.hash].forceRedraw=!1,re&&b.raiseEvent("animation")),ue&&(b.raiseEvent("animation-finish"),a[b.hash].mouseInside||S(b)),a[b.hash].animating=re}}function Nt(b){b.imageLoader.clear(),b.drawer.clear(),b.world.draw(),b.raiseEvent("update-viewport",{})}function We(b,F){return b?b+F:F}function hn(){a[this.hash].lastZoomTime=i.now(),a[this.hash].zoomFactor=this.zoomPerSecond,a[this.hash].zooming=!0,pe(this)}function Dn(){a[this.hash].lastZoomTime=i.now(),a[this.hash].zoomFactor=1/this.zoomPerSecond,a[this.hash].zooming=!0,pe(this)}function Pt(){a[this.hash].zooming=!1}function pe(b){i.requestAnimationFrame(i.delegate(b,_e))}function _e(){var b,F,ee;a[this.hash].zooming&&this.viewport&&(b=i.now(),F=b-a[this.hash].lastZoomTime,ee=Math.pow(a[this.hash].zoomFactor,F/1e3),this.viewport.zoomBy(ee),this.viewport.applyConstraints(),a[this.hash].lastZoomTime=b,pe(this))}function Re(){this.viewport&&(a[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function ke(){this.viewport&&(a[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function st(){this.buttonGroup&&(this.buttonGroup.emulateEnter(),this.buttonGroup.emulateLeave())}function yt(){this.viewport&&this.viewport.goHome()}function Z(){this.isFullPage()&&!i.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttonGroup&&this.buttonGroup.emulateLeave(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function Q(){if(this.viewport){var b=this.viewport.getRotation();this.viewport.flipped?b+=this.rotationIncrement:b-=this.rotationIncrement,this.viewport.setRotation(b)}}function le(){if(this.viewport){var b=this.viewport.getRotation();this.viewport.flipped?b-=this.rotationIncrement:b+=this.rotationIncrement,this.viewport.setRotation(b)}}function ge(){this.viewport.toggleFlip()}}(c),function(i){i.Navigator=function(y){var x=y.viewer,S=this,T,B;y.element||y.id?(y.element?(y.id&&i.console.warn("Given option.id for Navigator was ignored since option.element was provided and is being used instead."),y.element.id?y.id=y.element.id:y.id="navigator-"+i.now(),this.element=y.element):this.element=document.getElementById(y.id),y.controlOptions={anchor:i.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(y.id="navigator-"+i.now(),this.element=i.makeNeutralElement("div"),y.controlOptions={anchor:i.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:y.autoFade},y.position&&(y.position==="BOTTOM_RIGHT"?y.controlOptions.anchor=i.ControlAnchor.BOTTOM_RIGHT:y.position==="BOTTOM_LEFT"?y.controlOptions.anchor=i.ControlAnchor.BOTTOM_LEFT:y.position==="TOP_RIGHT"?y.controlOptions.anchor=i.ControlAnchor.TOP_RIGHT:y.position==="TOP_LEFT"?y.controlOptions.anchor=i.ControlAnchor.TOP_LEFT:y.position==="ABSOLUTE"&&(y.controlOptions.anchor=i.ControlAnchor.ABSOLUTE,y.controlOptions.top=y.top,y.controlOptions.left=y.left,y.controlOptions.height=y.height,y.controlOptions.width=y.width))),this.element.id=y.id,this.element.className+=" navigator",y=i.extend(!0,{sizeRatio:i.DEFAULT_SETTINGS.navigatorSizeRatio},y,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:y.animationTime,autoResize:!1,minZoomImageRatio:1,background:y.background,opacity:y.opacity,borderColor:y.borderColor,displayRegionColor:y.displayRegionColor}),y.minPixelRatio=this.minPixelRatio=x.minPixelRatio,i.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new i.Point(1,1),this.totalBorderWidths=new i.Point(this.borderWidth*2,this.borderWidth*2).minus(this.fudge),y.controlOptions.anchor!==i.ControlAnchor.NONE&&function(V,G){V.margin="0px",V.border=G+"px solid "+y.borderColor,V.padding="0px",V.background=y.background,V.opacity=y.opacity,V.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=i.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(V,G){V.position="relative",V.top="0px",V.left="0px",V.fontSize="0px",V.overflow="hidden",V.border=G+"px solid "+y.displayRegionColor,V.margin="0px",V.padding="0px",V.background="transparent",V.float="left",V.cssFloat="left",V.styleFloat="left",V.zIndex=999999999,V.cursor="default",V.boxSizing="content-box"}(this.displayRegion.style,this.borderWidth),i.setElementPointerEventsNone(this.displayRegion),i.setElementTouchActionNone(this.displayRegion),this.displayRegionContainer=i.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",i.setElementPointerEventsNone(this.displayRegionContainer),i.setElementTouchActionNone(this.displayRegionContainer),x.addControl(this.element,y.controlOptions),this._resizeWithViewer=y.controlOptions.anchor!==i.ControlAnchor.ABSOLUTE&&y.controlOptions.anchor!==i.ControlAnchor.NONE,y.width&&y.height?(this.setWidth(y.width),this.setHeight(y.height)):this._resizeWithViewer&&(T=i.getElementSize(x.element),this.element.style.height=Math.round(T.y*y.sizeRatio)+"px",this.element.style.width=Math.round(T.x*y.sizeRatio)+"px",this.oldViewerSize=T,B=i.getElementSize(this.element),this.elementArea=B.x*B.y),this.oldContainerSize=new i.Point(0,0),i.Viewer.apply(this,[y]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer);function L(V,G){p(S.displayRegionContainer,V),p(S.displayRegion,-V),S.viewport.setRotation(V,G)}if(y.navigatorRotate){var q=y.viewer.viewport?y.viewer.viewport.getRotation():y.viewer.degrees||0;L(q,!0),y.viewer.addHandler("rotate",function(V){L(V.degrees,V.immediately)})}this.innerTracker.destroy(),this.innerTracker=new i.MouseTracker({userData:"Navigator.innerTracker",element:this.element,dragHandler:i.delegate(this,u),clickHandler:i.delegate(this,a),releaseHandler:i.delegate(this,d),scrollHandler:i.delegate(this,w),preProcessEventHandler:function(V){V.eventType==="wheel"&&(V.preventDefault=!0)}}),this.outerTracker.userData="Navigator.outerTracker",i.setElementPointerEventsNone(this.canvas),i.setElementPointerEventsNone(this.container),this.addHandler("reset-size",function(){S.viewport&&S.viewport.goHome(!0)}),x.world.addHandler("item-index-change",function(V){window.setTimeout(function(){var G=S.world.getItemAt(V.previousIndex);S.world.setItemIndex(G,V.newIndex)},1)}),x.world.addHandler("remove-item",function(V){var G=V.item,te=S._getMatchingItem(G);te&&S.world.removeItem(te)}),this.update(x.viewport)},i.extend(i.Navigator.prototype,i.EventSource.prototype,i.Viewer.prototype,{updateSize:function(){if(this.viewport){var y=new i.Point(this.container.clientWidth===0?1:this.container.clientWidth,this.container.clientHeight===0?1:this.container.clientHeight);y.equals(this.oldContainerSize)||(this.viewport.resize(y,!0),this.viewport.goHome(!0),this.oldContainerSize=y,this.drawer.clear(),this.world.draw())}},setWidth:function(y){this.width=y,this.element.style.width=typeof y=="number"?y+"px":y,this._resizeWithViewer=!1,this.updateSize()},setHeight:function(y){this.height=y,this.element.style.height=typeof y=="number"?y+"px":y,this._resizeWithViewer=!1,this.updateSize()},setFlip:function(y){return this.viewport.setFlip(y),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(y){m(this.displayRegion,y),m(this.canvas,y),m(this.element,y)},update:function(y){var x,S,T,B,L,q;if(x=i.getElementSize(this.viewer.element),this._resizeWithViewer&&x.x&&x.y&&!x.equals(this.oldViewerSize)&&(this.oldViewerSize=x,this.maintainSizeRatio||!this.elementArea?(S=x.x*this.sizeRatio,T=x.y*this.sizeRatio):(S=Math.sqrt(this.elementArea*(x.x/x.y)),T=this.elementArea/S),this.element.style.width=Math.round(S)+"px",this.element.style.height=Math.round(T)+"px",this.elementArea||(this.elementArea=S*T),this.updateSize()),y&&this.viewport){if(B=y.getBoundsNoRotate(!0),L=this.viewport.pixelFromPointNoRotate(B.getTopLeft(),!1),q=this.viewport.pixelFromPointNoRotate(B.getBottomRight(),!1).minus(this.totalBorderWidths),!this.navigatorRotate){var V=y.getRotation(!0);p(this.displayRegion,-V)}var G=this.displayRegion.style;G.display=this.world.getItemCount()?"block":"none",G.top=L.y.toFixed(2)+"px",G.left=L.x.toFixed(2)+"px";var te=q.x-L.x,se=q.y-L.y;G.width=Math.round(Math.max(te,0))+"px",G.height=Math.round(Math.max(se,0))+"px"}},addTiledImage:function(y){var x=this,S=y.originalTiledImage;delete y.original;var T=i.extend({},y,{success:function(B){var L=B.item;L._originalForNavigator=S,x._matchBounds(L,S,!0),x._matchOpacity(L,S),x._matchCompositeOperation(L,S);function q(){x._matchBounds(L,S)}function V(){x._matchOpacity(L,S)}function G(){x._matchCompositeOperation(L,S)}S.addHandler("bounds-change",q),S.addHandler("clip-change",q),S.addHandler("opacity-change",V),S.addHandler("composite-operation-change",G)}});return i.Viewer.prototype.addTiledImage.apply(this,[T])},destroy:function(){return i.Viewer.prototype.destroy.apply(this)},_getMatchingItem:function(y){for(var x=this.world.getItemCount(),S,T=0;T<x;T++)if(S=this.world.getItemAt(T),S._originalForNavigator===y)return S;return null},_matchBounds:function(y,x,S){var T=x.getBoundsNoRotate();y.setPosition(T.getTopLeft(),S),y.setWidth(T.width,S),y.setRotation(x.getRotation(),S),y.setClip(x.getClip()),y.setFlip(x.getFlip())},_matchOpacity:function(y,x){y.setOpacity(x.opacity)},_matchCompositeOperation:function(y,x){y.setCompositeOperation(x.compositeOperation)}});function a(y){var x={tracker:y.eventSource,position:y.position,quick:y.quick,shift:y.shift,originalEvent:y.originalEvent,preventDefaultAction:!1};if(this.viewer.raiseEvent("navigator-click",x),!x.preventDefaultAction&&y.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(y.position.x=this.viewport.getContainerSize().x-y.position.x);var S=this.viewport.pointFromPixel(y.position);this.panVertical?this.panHorizontal||(S.x=this.viewer.viewport.getCenter(!0).x):S.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(S),this.viewer.viewport.applyConstraints()}}function u(y){var x={tracker:y.eventSource,position:y.position,delta:y.delta,speed:y.speed,direction:y.direction,shift:y.shift,originalEvent:y.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-drag",x),!x.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(y.delta.x=0),this.panVertical||(y.delta.y=0),this.viewer.viewport.flipped&&(y.delta.x=-y.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(y.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function d(y){y.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function w(y){var x={tracker:y.eventSource,position:y.position,scroll:y.scroll,shift:y.shift,originalEvent:y.originalEvent,preventDefault:y.preventDefault};this.viewer.raiseEvent("navigator-scroll",x),y.preventDefault=x.preventDefault}function p(y,x){m(y,"rotate("+x+"deg)")}function m(y,x){y.style.webkitTransform=x,y.style.mozTransform=x,y.style.msTransform=x,y.style.oTransform=x,y.style.transform=x}}(c),function(i){var a={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};i.extend(i,{getString:function(u){var d=u.split("."),w=null,p=arguments,m=a,y;for(y=0;y<d.length-1;y++)m=m[d[y]]||{};return w=m[d[y]],typeof w!="string"&&(i.console.error("Untranslated source string:",u),w=""),w.replace(/\{\d+\}/g,function(x){var S=parseInt(x.match(/\d+/),10)+1;return S<p.length?p[S]:""})},setString:function(u,d){var w=u.split("."),p=a,m;for(m=0;m<w.length-1;m++)p[w[m]]||(p[w[m]]={}),p=p[w[m]];p[w[m]]=d}})}(c),function(i){i.Point=function(a,u){this.x=typeof a=="number"?a:0,this.y=typeof u=="number"?u:0},i.Point.prototype={clone:function(){return new i.Point(this.x,this.y)},plus:function(a){return new i.Point(this.x+a.x,this.y+a.y)},minus:function(a){return new i.Point(this.x-a.x,this.y-a.y)},times:function(a){return new i.Point(this.x*a,this.y*a)},divide:function(a){return new i.Point(this.x/a,this.y/a)},negate:function(){return new i.Point(-this.x,-this.y)},distanceTo:function(a){return Math.sqrt(Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2))},squaredDistanceTo:function(a){return Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2)},apply:function(a){return new i.Point(a(this.x),a(this.y))},equals:function(a){return a instanceof i.Point&&this.x===a.x&&this.y===a.y},rotate:function(a,u){u=u||new i.Point(0,0);var d,w;if(a%90===0){var p=i.positiveModulo(a,360);switch(p){case 0:d=1,w=0;break;case 90:d=0,w=1;break;case 180:d=-1,w=0;break;case 270:d=0,w=-1;break}}else{var m=a*Math.PI/180;d=Math.cos(m),w=Math.sin(m)}var y=d*(this.x-u.x)-w*(this.y-u.y)+u.x,x=w*(this.x-u.x)+d*(this.y-u.y)+u.y;return new i.Point(y,x)},toString:function(){return"("+Math.round(this.x*100)/100+","+Math.round(this.y*100)/100+")"}}}(c),function(i){i.TileSource=function(u,d,w,p,m,y){var x=this,S=arguments,T,B;if(i.isPlainObject(u)?T=u:T={width:S[0],height:S[1],tileSize:S[2],tileOverlap:S[3],minLevel:S[4],maxLevel:S[5]},i.EventSource.call(this),i.extend(!0,this,T),!this.success){for(B=0;B<arguments.length;B++)if(i.isFunction(arguments[B])){this.success=arguments[B];break}}this.success&&this.addHandler("ready",function(L){x.success(L)}),i.type(arguments[0])==="string"&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new i.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=T.width&&T.height?T.width/T.height:1,this.dimensions=new i.Point(T.width,T.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=T.tileOverlap?T.tileOverlap:0,this.minLevel=T.minLevel?T.minLevel:0,this.maxLevel=T.maxLevel!==void 0&&T.maxLevel!==null?T.maxLevel:T.width&&T.height?Math.ceil(Math.log(Math.max(T.width,T.height))/Math.log(2)):0,this.success&&i.isFunction(this.success)&&this.success(this))},i.TileSource.prototype={getTileSize:function(u){return i.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(u){return this._tileWidth?this._tileWidth:this.getTileSize(u)},getTileHeight:function(u){return this._tileHeight?this._tileHeight:this.getTileSize(u)},setMaxLevel:function(u){this.maxLevel=u,this._memoizeLevelScale()},getLevelScale:function(u){return this._memoizeLevelScale(),this.getLevelScale(u)},_memoizeLevelScale:function(){var u={},d;for(d=0;d<=this.maxLevel;d++)u[d]=1/Math.pow(2,this.maxLevel-d);this.getLevelScale=function(w){return u[w]}},getNumTiles:function(u){var d=this.getLevelScale(u),w=Math.ceil(d*this.dimensions.x/this.getTileWidth(u)),p=Math.ceil(d*this.dimensions.y/this.getTileHeight(u));return new i.Point(w,p)},getPixelRatio:function(u){var d=this.dimensions.times(this.getLevelScale(u)),w=1/d.x*i.pixelDensityRatio,p=1/d.y*i.pixelDensityRatio;return new i.Point(w,p)},getClosestLevel:function(){var u,d;for(u=this.minLevel+1;u<=this.maxLevel&&(d=this.getNumTiles(u),!(d.x>1||d.y>1));u++);return u-1},getTileAtPoint:function(u,d){var w=d.x>=0&&d.x<=1&&d.y>=0&&d.y<=1/this.aspectRatio;i.console.assert(w,"[TileSource.getTileAtPoint] must be called with a valid point.");var p=this.dimensions.x*this.getLevelScale(u),m=d.x*p,y=d.y*p,x=Math.floor(m/this.getTileWidth(u)),S=Math.floor(y/this.getTileHeight(u));d.x>=1&&(x=this.getNumTiles(u).x-1);var T=1e-15;return d.y>=1/this.aspectRatio-T&&(S=this.getNumTiles(u).y-1),new i.Point(x,S)},getTileBounds:function(u,d,w,p){var m=this.dimensions.times(this.getLevelScale(u)),y=this.getTileWidth(u),x=this.getTileHeight(u),S=d===0?0:y*d-this.tileOverlap,T=w===0?0:x*w-this.tileOverlap,B=y+(d===0?1:2)*this.tileOverlap,L=x+(w===0?1:2)*this.tileOverlap,q=1/m.x;return B=Math.min(B,m.x-S),L=Math.min(L,m.y-T),p?new i.Rect(0,0,B,L):new i.Rect(S*q,T*q,B*q,L*q)},getImageInfo:function(u){var d=this,w,p,m,y,x,S,T;u&&(x=u.split("/"),S=x[x.length-1],T=S.lastIndexOf("."),T>-1&&(x[x.length-1]=S.slice(0,T)));var B=null;if(this.splitHashDataForPost){var L=u.indexOf("#");L!==-1&&(B=u.substring(L+1),u=u.substr(0,L))}p=function(q){typeof q=="string"&&(q=i.parseXml(q));var V=i.TileSource.determineType(d,q,u);if(!V){d.raiseEvent("open-failed",{message:"Unable to load TileSource",source:u});return}y=V.prototype.configure.apply(d,[q,u,B]),y.ajaxWithCredentials===void 0&&(y.ajaxWithCredentials=d.ajaxWithCredentials),m=new V(y),d.ready=!0,d.raiseEvent("ready",{tileSource:m})},u.match(/\.js$/)?(w=u.split("/").pop().replace(".js",""),i.jsonp({url:u,async:!1,callbackName:w,callback:p})):i.makeAjaxRequest({url:u,postData:B,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(q){var V=a(q);p(V)},error:function(q,V){var G;try{G="HTTP "+q.status+" attempting to load TileSource: "+u}catch{var te;typeof V>"u"||!V.toString?te="Unknown error":te=V.toString(),G=te+" attempting to load TileSource: "+u}i.console.error(G),d.raiseEvent("open-failed",{message:G,source:u,postData:B})}})},supports:function(u,d){return!1},configure:function(u,d,w){throw new Error("Method not implemented.")},getTileUrl:function(u,d,w){throw new Error("Method not implemented.")},getTilePostData:function(u,d,w){return null},getTileAjaxHeaders:function(u,d,w){return{}},getTileHashKey:function(u,d,w,p,m,y){function x(S){return m?S+"+"+JSON.stringify(m):S}return x(typeof p!="string"?u+"/"+d+"_"+w:p)},tileExists:function(u,d,w){var p=this.getNumTiles(u);return u>=this.minLevel&&u<=this.maxLevel&&d>=0&&w>=0&&d<p.x&&w<p.y},hasTransparency:function(u,d,w,p){return!!u||d.match(".png")},downloadTileStart:function(u){var d=u.userData,w=new Image;d.image=w,d.request=null;var p=function(m){if(!w){u.finish(null,d.request,"Image load failed: undefined Image instance.");return}w.onload=w.onerror=w.onabort=null,u.finish(m?null:w,d.request,m)};w.onload=function(){p()},w.onabort=w.onerror=function(){p("Image load aborted.")},u.loadWithAjax?d.request=i.makeAjaxRequest({url:u.src,withCredentials:u.ajaxWithCredentials,headers:u.ajaxHeaders,responseType:"arraybuffer",postData:u.postData,success:function(m){var y;try{y=new window.Blob([m.response])}catch(T){var x=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(T.name==="TypeError"&&x){var S=new x;S.append(m.response),y=S.getBlob()}}y.size===0?p("Empty image response."):w.src=(window.URL||window.webkitURL).createObjectURL(y)},error:function(m){p("Image load aborted - XHR error")}}):(u.crossOriginPolicy!==!1&&(w.crossOrigin=u.crossOriginPolicy),w.src=u.src)},downloadTileAbort:function(u){u.userData.request&&u.userData.request.abort();var d=u.userData.image;u.userData.image&&(d.onload=d.onerror=d.onabort=null)},createTileCache:function(u,d,w){u._data=d},destroyTileCache:function(u){u._data=null,u._renderedContext=null},getTileCacheData:function(u){return u._data},getTileCacheDataAsImage:function(u){return u._data},getTileCacheDataAsContext2D:function(u){if(!u._renderedContext){var d=document.createElement("canvas");d.width=u._data.width,d.height=u._data.height,u._renderedContext=d.getContext("2d"),u._renderedContext.drawImage(u._data,0,0),u._data=null}return u._renderedContext}},i.extend(!0,i.TileSource.prototype,i.EventSource.prototype);function a(u){var d=u.responseText,w=u.status,p,m;if(u){if(u.status!==200&&u.status!==0)throw w=u.status,p=w===404?"Not Found":u.statusText,new Error(i.getString("Errors.Status",w,p))}else throw new Error(i.getString("Errors.Security"));if(d.match(/^\s*<.*/))try{m=u.responseXML&&u.responseXML.documentElement?u.responseXML:i.parseXml(d)}catch{m=u.responseText}else if(d.match(/\s*[{[].*/))try{m=i.parseJSON(d)}catch{m=d}else m=d;return m}i.TileSource.determineType=function(u,d,w){var p;for(p in c)if(p.match(/.+TileSource$/)&&i.isFunction(c[p])&&i.isFunction(c[p].prototype.supports)&&c[p].prototype.supports.call(u,d,w))return c[p];return i.console.error("No TileSource was able to open %s %s",w,d),null}}(c),function(i){i.DziTileSource=function(d,w,p,m,y,x,S,T,B){var L,q,V,G;if(i.isPlainObject(d)?G=d:G={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=G.tilesUrl,this.fileFormat=G.fileFormat,this.displayRects=G.displayRects,this.displayRects)for(L=this.displayRects.length-1;L>=0;L--)for(q=this.displayRects[L],V=q.minLevel;V<=q.maxLevel;V++)this._levelRects[V]||(this._levelRects[V]=[]),this._levelRects[V].push(q);i.TileSource.apply(this,[G])},i.extend(i.DziTileSource.prototype,i.TileSource.prototype,{supports:function(d,w){var p;return d.Image?p=d.Image.xmlns:d.documentElement&&(d.documentElement.localName==="Image"||d.documentElement.tagName==="Image")&&(p=d.documentElement.namespaceURI),p=(p||"").toLowerCase(),p.indexOf("schemas.microsoft.com/deepzoom/2008")!==-1||p.indexOf("schemas.microsoft.com/deepzoom/2009")!==-1},configure:function(d,w,p){var m;return i.isPlainObject(d)?m=u(this,d):m=a(this,d),w&&!m.tilesUrl&&(m.tilesUrl=w.replace(/([^/]+?)(\.(dzi|xml|js)?(\?[^/]*)?)?\/?$/,"$1_files/"),w.search(/\.(dzi|xml|js)\?/)!==-1?m.queryParams=w.match(/\?.*/):m.queryParams=""),m},getTileUrl:function(d,w,p){return[this.tilesUrl,d,"/",w,"_",p,".",this.fileFormat,this.queryParams].join("")},tileExists:function(d,w,p){var m=this._levelRects[d],y,x,S,T,B,L,q;if(this.minLevel&&d<this.minLevel||this.maxLevel&&d>this.maxLevel)return!1;if(!m||!m.length)return!0;for(q=m.length-1;q>=0;q--)if(y=m[q],!(d<y.minLevel||d>y.maxLevel)&&(x=this.getLevelScale(d),S=y.x*x,T=y.y*x,B=S+y.width*x,L=T+y.height*x,S=Math.floor(S/this._tileWidth),T=Math.floor(T/this._tileWidth),B=Math.ceil(B/this._tileWidth),L=Math.ceil(L/this._tileWidth),S<=w&&w<B&&T<=p&&p<L))return!0;return!1}});function a(d,w){if(!w||!w.documentElement)throw new Error(i.getString("Errors.Xml"));var p=w.documentElement,m=p.localName||p.tagName,y=w.documentElement.namespaceURI,x=null,S=[],T,B,L,q,V;if(m==="Image")try{if(q=p.getElementsByTagName("Size")[0],q===void 0&&(q=p.getElementsByTagNameNS(y,"Size")[0]),x={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:p.getAttribute("Url"),Format:p.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(p.getAttribute("Overlap"),10),TileSize:parseInt(p.getAttribute("TileSize"),10),Size:{Height:parseInt(q.getAttribute("Height"),10),Width:parseInt(q.getAttribute("Width"),10)}}},!i.imageFormatSupported(x.Image.Format))throw new Error(i.getString("Errors.ImageFormat",x.Image.Format.toUpperCase()));for(T=p.getElementsByTagName("DisplayRect"),T===void 0&&(T=p.getElementsByTagNameNS(y,"DisplayRect")[0]),V=0;V<T.length;V++)B=T[V],L=B.getElementsByTagName("Rect")[0],L===void 0&&(L=B.getElementsByTagNameNS(y,"Rect")[0]),S.push({Rect:{X:parseInt(L.getAttribute("X"),10),Y:parseInt(L.getAttribute("Y"),10),Width:parseInt(L.getAttribute("Width"),10),Height:parseInt(L.getAttribute("Height"),10),MinLevel:parseInt(B.getAttribute("MinLevel"),10),MaxLevel:parseInt(B.getAttribute("MaxLevel"),10)}});return S.length&&(x.Image.DisplayRect=S),u(d,x)}catch(se){throw se instanceof Error?se:new Error(i.getString("Errors.Dzi"))}else{if(m==="Collection")throw new Error(i.getString("Errors.Dzc"));if(m==="Error"){var G=p.getElementsByTagName("Message")[0],te=G.firstChild.nodeValue;throw new Error(te)}}throw new Error(i.getString("Errors.Dzi"))}function u(d,w){var p=w.Image,m=p.Url,y=p.Format,x=p.Size,S=p.DisplayRect||[],T=parseInt(x.Width,10),B=parseInt(x.Height,10),L=parseInt(p.TileSize,10),q=parseInt(p.Overlap,10),V=[],G,te;for(te=0;te<S.length;te++)G=S[te].Rect,V.push(new i.DisplayRect(parseInt(G.X,10),parseInt(G.Y,10),parseInt(G.Width,10),parseInt(G.Height,10),parseInt(G.MinLevel,10),parseInt(G.MaxLevel,10)));return i.extend(!0,{width:T,height:B,tileSize:L,tileOverlap:q,minLevel:null,maxLevel:null,tilesUrl:m,fileFormat:y,displayRects:V},w)}}(c),function(i){i.IIIFTileSource=function(p){if(i.extend(!0,this,p),this._id=this["@id"]||this.id||this.identifier||null,!(this.height&&this.width&&this._id))throw new Error("IIIF required parameters (width, height, or id) not provided.");if(p.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=p.version,this.tile_width&&this.tile_height)p.tileWidth=this.tile_width,p.tileHeight=this.tile_height;else if(this.tile_width)p.tileSize=this.tile_width;else if(this.tile_height)p.tileSize=this.tile_height;else if(this.tiles)if(this.tiles.length===1)p.tileWidth=this.tiles[0].width,p.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var m=0;m<this.tiles.length;m++)for(var y=0;y<this.tiles[m].scaleFactors.length;y++){var x=this.tiles[m].scaleFactors[y];this.scale_factors.push(x),p.tileSizePerScaleFactor[x]={width:this.tiles[m].width,height:this.tiles[m].height||this.tiles[m].width}}}else if(a(p)){for(var S=Math.min(this.height,this.width),T=[256,512,1024],B=[],L=0;L<T.length;L++)T[L]<=S&&B.push(T[L]);B.length>0?p.tileSize=Math.max.apply(null,B):p.tileSize=S}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,p.levels=u(this),i.extend(!0,p,{width:p.levels[p.levels.length-1].width,height:p.levels[p.levels.length-1].height,tileSize:Math.max(p.height,p.width),tileOverlap:0,minLevel:0,maxLevel:p.levels.length-1}),this.levels=p.levels):i.console.error("Nothing in the info.json to construct image pyramids from");if(!p.maxLevel&&!this.emulateLegacyImagePyramid)if(!this.scale_factors)p.maxLevel=Number(Math.round(Math.log(Math.max(this.width,this.height),2)));else{var q=Math.max.apply(null,this.scale_factors);p.maxLevel=Math.round(Math.log(q)*Math.LOG2E)}if(this.sizes){var V=this.sizes.length;(V===p.maxLevel||V===p.maxLevel+1)&&(this.levelSizes=this.sizes,V===p.maxLevel&&this.levelSizes.push({width:this.width,height:this.height}))}i.TileSource.apply(this,[p])},i.extend(i.IIIFTileSource.prototype,i.TileSource.prototype,{supports:function(p,m){return p.protocol&&p.protocol==="http://iiif.io/api/image"||p["@context"]&&(p["@context"]==="http://library.stanford.edu/iiif/image-api/1.1/context.json"||p["@context"]==="http://iiif.io/api/image/1/context.json")||p.profile&&p.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")===0||p.identifier&&p.width&&p.height?!0:!!(p.documentElement&&p.documentElement.tagName==="info"&&p.documentElement.namespaceURI==="http://library.stanford.edu/iiif/image-api/ns/")},configure:function(p,m,y){if(i.isPlainObject(p)){if(!p["@context"])p["@context"]="http://iiif.io/api/image/1.0/context.json",p["@id"]=m.replace("/info.json",""),p.version=1;else{var S=p["@context"];if(Array.isArray(S)){for(var T=0;T<S.length;T++)if(typeof S[T]=="string"&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(S[T])||S[T]==="http://library.stanford.edu/iiif/image-api/1.1/context.json")){S=S[T];break}}switch(S){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":p.version=1;break;case"http://iiif.io/api/image/2/context.json":p.version=2;break;case"http://iiif.io/api/image/3/context.json":p.version=3;break;default:i.console.error("Data has a @context property which contains no known IIIF context URI.")}}if(p.preferredFormats){for(var B=0;B<p.preferredFormats.length;B++)if(c.imageFormatSupported(p.preferredFormats[B])){p.tileFormat=p.preferredFormats[B];break}}return p}else{var x=d(p);return x["@context"]="http://iiif.io/api/image/1.0/context.json",x["@id"]=m.replace("/info.xml",""),x.version=1,x}},getTileWidth:function(p){if(this.emulateLegacyImagePyramid)return i.TileSource.prototype.getTileWidth.call(this,p);var m=Math.pow(2,this.maxLevel-p);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[m]?this.tileSizePerScaleFactor[m].width:this._tileWidth},getTileHeight:function(p){if(this.emulateLegacyImagePyramid)return i.TileSource.prototype.getTileHeight.call(this,p);var m=Math.pow(2,this.maxLevel-p);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[m]?this.tileSizePerScaleFactor[m].height:this._tileHeight},getLevelScale:function(p){if(this.emulateLegacyImagePyramid){var m=NaN;return this.levels.length>0&&p>=this.minLevel&&p<=this.maxLevel&&(m=this.levels[p].width/this.levels[this.maxLevel].width),m}return i.TileSource.prototype.getLevelScale.call(this,p)},getNumTiles:function(p){if(this.emulateLegacyImagePyramid){var m=this.getLevelScale(p);return m?new i.Point(1,1):new i.Point(0,0)}if(this.levelSizes){var y=this.levelSizes[p],x=Math.ceil(y.width/this.getTileWidth(p)),S=Math.ceil(y.height/this.getTileHeight(p));return new i.Point(x,S)}else return i.TileSource.prototype.getNumTiles.call(this,p)},getTileAtPoint:function(p,m){if(this.emulateLegacyImagePyramid)return new i.Point(0,0);if(this.levelSizes){var y=m.x>=0&&m.x<=1&&m.y>=0&&m.y<=1/this.aspectRatio;i.console.assert(y,"[TileSource.getTileAtPoint] must be called with a valid point.");var x=this.levelSizes[p].width,S=m.x*x,T=m.y*x,B=Math.floor(S/this.getTileWidth(p)),L=Math.floor(T/this.getTileHeight(p));m.x>=1&&(B=this.getNumTiles(p).x-1);var q=1e-15;return m.y>=1/this.aspectRatio-q&&(L=this.getNumTiles(p).y-1),new i.Point(B,L)}return i.TileSource.prototype.getTileAtPoint.call(this,p,m)},getTileUrl:function(p,m,y){if(this.emulateLegacyImagePyramid){var x=null;return this.levels.length>0&&p>=this.minLevel&&p<=this.maxLevel&&(x=this.levels[p].url),x}var S="0",T=Math.pow(.5,this.maxLevel-p),B,L,q,V,G,te,se,Te,Ie,Ce,Ne,je,ot,at,vt,Ct;return this.levelSizes?(B=this.levelSizes[p].width,L=this.levelSizes[p].height):(B=Math.ceil(this.width*T),L=Math.ceil(this.height*T)),q=this.getTileWidth(p),V=this.getTileHeight(p),G=Math.round(q/T),te=Math.round(V/T),this.version===1?vt="native."+this.tileFormat:vt="default."+this.tileFormat,B<q&&L<V?(this.version===2&&B===this.width?je="full":this.version===3&&B===this.width&&L===this.height?je="max":this.version===3?je=B+","+L:je=B+",",se="full"):(Te=m*G,Ie=y*te,Ce=Math.min(G,this.width-Te),Ne=Math.min(te,this.height-Ie),m===0&&y===0&&Ce===this.width&&Ne===this.height?se="full":se=[Te,Ie,Ce,Ne].join(","),ot=Math.min(q,B-m*q),at=Math.min(V,L-y*V),this.version===2&&ot===this.width?je="full":this.version===3&&ot===this.width&&at===this.height?je="max":this.version===3?je=ot+","+at:je=ot+","),Ct=[this._id,se,je,S,vt].join("/"),Ct},__testonly__:{canBeTiled:a,constructLevels:u}});function a(p){var m=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"],y=Array.isArray(p.profile)?p.profile[0]:p.profile,x=m.indexOf(y)!==-1,S=!1;return p.version===2&&p.profile.length>1&&p.profile[1].supports&&(S=p.profile[1].supports.indexOf("sizeByW")!==-1),p.version===3&&p.extraFeatures&&(S=p.extraFeatures.indexOf("sizeByWh")!==-1),!x||S}function u(p){for(var m=[],y=0;y<p.sizes.length;y++)m.push({url:p._id+"/full/"+p.sizes[y].width+","+(p.version===3?p.sizes[y].height:"")+"/0/default."+p.tileFormat,width:p.sizes[y].width,height:p.sizes[y].height});return m.sort(function(x,S){return x.width-S.width})}function d(p){if(!p||!p.documentElement)throw new Error(i.getString("Errors.Xml"));var m=p.documentElement,y=m.tagName,x=null;if(y==="info")try{return x={},w(m,x),x}catch(S){throw S instanceof Error?S:new Error(i.getString("Errors.IIIF"))}throw new Error(i.getString("Errors.IIIF"))}function w(p,m,y){var x,S;if(p.nodeType===3&&y)S=p.nodeValue.trim(),S.match(/^\d*$/)&&(S=Number(S)),m[y]?(i.isArray(m[y])||(m[y]=[m[y]]),m[y].push(S)):m[y]=S;else if(p.nodeType===1)for(x=0;x<p.childNodes.length;x++)w(p.childNodes[x],m,p.nodeName)}}(c),function(i){i.OsmTileSource=function(a,u,d,w,p){var m;i.isPlainObject(a)?m=a:m={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},(!m.width||!m.height)&&(m.width=65572864,m.height=65572864),m.tileSize||(m.tileSize=256,m.tileOverlap=0),m.tilesUrl||(m.tilesUrl="http://tile.openstreetmap.org/"),m.minLevel=8,i.TileSource.apply(this,[m])},i.extend(i.OsmTileSource.prototype,i.TileSource.prototype,{supports:function(a,u){return a.type&&a.type==="openstreetmaps"},configure:function(a,u,d){return a},getTileUrl:function(a,u,d){return this.tilesUrl+(a-8)+"/"+u+"/"+d+".png"}})}(c),function(i){i.TmsTileSource=function(a,u,d,w,p){var m;i.isPlainObject(a)?m=a:m={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var y=Math.ceil(m.width/256)*256,x=Math.ceil(m.height/256)*256,S;y>x?S=y/256:S=x/256,m.maxLevel=Math.ceil(Math.log(S)/Math.log(2))-1,m.tileSize=256,m.width=y,m.height=x,i.TileSource.apply(this,[m])},i.extend(i.TmsTileSource.prototype,i.TileSource.prototype,{supports:function(a,u){return a.type&&a.type==="tiledmapservice"},configure:function(a,u,d){return a},getTileUrl:function(a,u,d){var w=this.getNumTiles(a).y-1;return this.tilesUrl+a+"/"+u+"/"+(w-d)+".png"}})}(c),function(i){i.ZoomifyTileSource=function(a){typeof a.tileSize>"u"&&(a.tileSize=256),typeof a.fileFormat>"u"&&(a.fileFormat="jpg",this.fileFormat=a.fileFormat);var u={x:a.width,y:a.height};for(a.imageSizes=[{x:a.width,y:a.height}],a.gridSize=[this._getGridSize(a.width,a.height,a.tileSize)];parseInt(u.x,10)>a.tileSize||parseInt(u.y,10)>a.tileSize;)u.x=Math.floor(u.x/2),u.y=Math.floor(u.y/2),a.imageSizes.push({x:u.x,y:u.y}),a.gridSize.push(this._getGridSize(u.x,u.y,a.tileSize));a.imageSizes.reverse(),a.gridSize.reverse(),a.minLevel=0,a.maxLevel=a.gridSize.length-1,c.TileSource.apply(this,[a])},i.extend(i.ZoomifyTileSource.prototype,i.TileSource.prototype,{_getGridSize:function(a,u,d){return{x:Math.ceil(a/d),y:Math.ceil(u/d)}},_calculateAbsoluteTileNumber:function(a,u,d){for(var w=0,p={},m=0;m<a;m++)p=this.gridSize[m],w+=p.x*p.y;return p=this.gridSize[a],w+=p.x*d+u,w},supports:function(a,u){return a.type&&a.type==="zoomifytileservice"},configure:function(a,u,d){return a},getTileUrl:function(a,u,d){var w=0,p=this._calculateAbsoluteTileNumber(a,u,d);return w=Math.floor(p/256),this.tilesUrl+"TileGroup"+w+"/"+a+"-"+u+"-"+d+"."+this.fileFormat}})}(c),function(i){i.LegacyTileSource=function(w){var p,m,y;i.isArray(w)&&(p={type:"legacy-image-pyramid",levels:w}),p.levels=a(p.levels),p.levels.length>0?(m=p.levels[p.levels.length-1].width,y=p.levels[p.levels.length-1].height):(m=0,y=0,i.console.error("No supported image formats found")),i.extend(!0,p,{width:m,height:y,tileSize:Math.max(y,m),tileOverlap:0,minLevel:0,maxLevel:p.levels.length>0?p.levels.length-1:0}),i.TileSource.apply(this,[p]),this.levels=p.levels},i.extend(i.LegacyTileSource.prototype,i.TileSource.prototype,{supports:function(w,p){return w.type&&w.type==="legacy-image-pyramid"||w.documentElement&&w.documentElement.getAttribute("type")==="legacy-image-pyramid"},configure:function(w,p,m){var y;return i.isPlainObject(w)?y=d(this,w):y=u(this,w),y},getLevelScale:function(w){var p=NaN;return this.levels.length>0&&w>=this.minLevel&&w<=this.maxLevel&&(p=this.levels[w].width/this.levels[this.maxLevel].width),p},getNumTiles:function(w){var p=this.getLevelScale(w);return p?new i.Point(1,1):new i.Point(0,0)},getTileUrl:function(w,p,m){var y=null;return this.levels.length>0&&w>=this.minLevel&&w<=this.maxLevel&&(y=this.levels[w].url),y}});function a(w){var p=[],m,y;for(y=0;y<w.length;y++)m=w[y],m.height&&m.width&&m.url?p.push({url:m.url,width:Number(m.width),height:Number(m.height)}):i.console.error("Unsupported image format: %s",m.url?m.url:"<no URL>");return p.sort(function(x,S){return x.height-S.height})}function u(w,p){if(!p||!p.documentElement)throw new Error(i.getString("Errors.Xml"));var m=p.documentElement,y=m.tagName,x=null,S=[],T,B;if(y==="image")try{for(x={type:m.getAttribute("type"),levels:[]},S=m.getElementsByTagName("level"),B=0;B<S.length;B++)T=S[B],x.levels.push({url:T.getAttribute("url"),width:parseInt(T.getAttribute("width"),10),height:parseInt(T.getAttribute("height"),10)});return d(w,x)}catch(L){throw L instanceof Error?L:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if(y==="collection")throw new Error("Legacy Image Pyramid Collections not yet supported.");if(y==="error")throw new Error("Error: "+p)}throw new Error("Unknown element "+y)}function d(w,p){return p.levels}}(c),function(i){i.ImageTileSource=function(a){a=i.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},a),i.TileSource.apply(this,[a])},i.extend(i.ImageTileSource.prototype,i.TileSource.prototype,{supports:function(a,u){return a.type&&a.type==="image"},configure:function(a,u,d){return a},getImageInfo:function(a){var u=this._image=new Image,d=this;this.crossOriginPolicy&&(u.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(u.useCredentials=this.ajaxWithCredentials),i.addEvent(u,"load",function(){d.width=u.naturalWidth,d.height=u.naturalHeight,d.aspectRatio=d.width/d.height,d.dimensions=new i.Point(d.width,d.height),d._tileWidth=d.width,d._tileHeight=d.height,d.tileOverlap=0,d.minLevel=0,d.levels=d._buildLevels(),d.maxLevel=d.levels.length-1,d.ready=!0,d.raiseEvent("ready",{tileSource:d})}),i.addEvent(u,"error",function(){d.raiseEvent("open-failed",{message:"Error loading image at "+a,source:a})}),u.src=a},getLevelScale:function(a){var u=NaN;return a>=this.minLevel&&a<=this.maxLevel&&(u=this.levels[a].width/this.levels[this.maxLevel].width),u},getNumTiles:function(a){var u=this.getLevelScale(a);return u?new i.Point(1,1):new i.Point(0,0)},getTileUrl:function(a,u,d){var w=null;return a>=this.minLevel&&a<=this.maxLevel&&(w=this.levels[a].url),w},getContext2D:function(a,u,d){var w=null;return a>=this.minLevel&&a<=this.maxLevel&&(w=this.levels[a].context2D),w},destroy:function(){this._freeupCanvasMemory()},_buildLevels:function(){var a=[{url:this._image.src,width:this._image.naturalWidth,height:this._image.naturalHeight}];if(!this.buildPyramid||!i.supportsCanvas||!this.useCanvas)return delete this._image,a;var u=this._image.naturalWidth,d=this._image.naturalHeight,w=document.createElement("canvas"),p=w.getContext("2d");if(w.width=u,w.height=d,p.drawImage(this._image,0,0,u,d),a[0].context2D=p,delete this._image,i.isCanvasTainted(w))return a;for(;u>=2&&d>=2;){u=Math.floor(u/2),d=Math.floor(d/2);var m=document.createElement("canvas"),y=m.getContext("2d");m.width=u,m.height=d,y.drawImage(w,0,0,u,d),a.splice(0,0,{context2D:y,width:u,height:d}),w=m,p=y}return a},_freeupCanvasMemory:function(){for(var a=0;a<this.levels.length;a++)this.levels[a].context2D&&(this.levels[a].context2D.canvas.height=0,this.levels[a].context2D.canvas.width=0)}})}(c),function(i){i.TileSourceCollection=function(a,u,d,w){i.console.error("TileSourceCollection is deprecated; use World instead")}}(c),function(i){i.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},i.Button=function(y){var x=this;i.EventSource.call(this),i.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:i.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:i.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null,userData:null},y),this.element=y.element||i.makeNeutralElement("div"),y.element||(this.imgRest=i.makeTransparentImage(this.srcRest),this.imgGroup=i.makeTransparentImage(this.srcGroup),this.imgHover=i.makeTransparentImage(this.srcHover),this.imgDown=i.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,i.setElementPointerEventsNone(this.imgRest),i.setElementPointerEventsNone(this.imgGroup),i.setElementPointerEventsNone(this.imgHover),i.setElementPointerEventsNone(this.imgDown),this.element.style.position="relative",i.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",i.Browser.vendor===i.BROWSERS.FIREFOX&&i.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=i.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new i.MouseTracker({userData:"Button.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(S){S.insideElementPressed?(p(x,i.ButtonState.DOWN),x.raiseEvent("enter",{originalEvent:S.originalEvent})):S.buttonDownAny||p(x,i.ButtonState.HOVER)},focusHandler:function(S){x.tracker.enterHandler(S),x.raiseEvent("focus",{originalEvent:S.originalEvent})},leaveHandler:function(S){m(x,i.ButtonState.GROUP),S.insideElementPressed&&x.raiseEvent("exit",{originalEvent:S.originalEvent})},blurHandler:function(S){x.tracker.leaveHandler(S),x.raiseEvent("blur",{originalEvent:S.originalEvent})},pressHandler:function(S){p(x,i.ButtonState.DOWN),x.raiseEvent("press",{originalEvent:S.originalEvent})},releaseHandler:function(S){S.insideElementPressed&&S.insideElementReleased?(m(x,i.ButtonState.HOVER),x.raiseEvent("release",{originalEvent:S.originalEvent})):S.insideElementPressed?m(x,i.ButtonState.GROUP):p(x,i.ButtonState.HOVER)},clickHandler:function(S){S.quick&&x.raiseEvent("click",{originalEvent:S.originalEvent})},keyHandler:function(S){S.keyCode===13?(x.raiseEvent("click",{originalEvent:S.originalEvent}),x.raiseEvent("release",{originalEvent:S.originalEvent}),S.preventDefault=!0):S.preventDefault=!1}}),m(this,i.ButtonState.REST)},i.extend(i.Button.prototype,i.EventSource.prototype,{notifyGroupEnter:function(){p(this,i.ButtonState.GROUP)},notifyGroupExit:function(){m(this,i.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,this.tracker.setTracking(!1),i.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,this.tracker.setTracking(!0),i.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()},destroy:function(){this.imgRest&&(this.element.removeChild(this.imgRest),this.imgRest=null),this.imgGroup&&(this.element.removeChild(this.imgGroup),this.imgGroup=null),this.imgHover&&(this.element.removeChild(this.imgHover),this.imgHover=null),this.imgDown&&(this.element.removeChild(this.imgDown),this.imgDown=null),this.removeAllHandlers(),this.tracker.destroy(),this.element=null}});function a(y){i.requestAnimationFrame(function(){u(y)})}function u(y){var x,S,T;y.shouldFade&&(x=i.now(),S=x-y.fadeBeginTime,T=1-S/y.fadeLength,T=Math.min(1,T),T=Math.max(0,T),y.imgGroup&&i.setElementOpacity(y.imgGroup,T,!0),T>0&&a(y))}function d(y){y.shouldFade=!0,y.fadeBeginTime=i.now()+y.fadeDelay,window.setTimeout(function(){a(y)},y.fadeDelay)}function w(y){y.shouldFade=!1,y.imgGroup&&i.setElementOpacity(y.imgGroup,1,!0)}function p(y,x){y.element.disabled||(x>=i.ButtonState.GROUP&&y.currentState===i.ButtonState.REST&&(w(y),y.currentState=i.ButtonState.GROUP),x>=i.ButtonState.HOVER&&y.currentState===i.ButtonState.GROUP&&(y.imgHover&&(y.imgHover.style.visibility=""),y.currentState=i.ButtonState.HOVER),x>=i.ButtonState.DOWN&&y.currentState===i.ButtonState.HOVER&&(y.imgDown&&(y.imgDown.style.visibility=""),y.currentState=i.ButtonState.DOWN))}function m(y,x){y.element.disabled||(x<=i.ButtonState.HOVER&&y.currentState===i.ButtonState.DOWN&&(y.imgDown&&(y.imgDown.style.visibility="hidden"),y.currentState=i.ButtonState.HOVER),x<=i.ButtonState.GROUP&&y.currentState===i.ButtonState.HOVER&&(y.imgHover&&(y.imgHover.style.visibility="hidden"),y.currentState=i.ButtonState.GROUP),x<=i.ButtonState.REST&&y.currentState===i.ButtonState.GROUP&&(d(y),y.currentState=i.ButtonState.REST))}}(c),function(i){i.ButtonGroup=function(a){i.extend(!0,this,{buttons:[],clickTimeThreshold:i.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:i.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},a);var u=this.buttons.concat([]),d=this,w;if(this.element=a.element||i.makeNeutralElement("div"),!a.group)for(this.element.style.display="inline-block",w=0;w<u.length;w++)this.element.appendChild(u[w].element);i.setElementTouchActionNone(this.element),this.tracker=new i.MouseTracker({userData:"ButtonGroup.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(p){var m;for(m=0;m<d.buttons.length;m++)d.buttons[m].notifyGroupEnter()},leaveHandler:function(p){var m;if(!p.insideElementPressed)for(m=0;m<d.buttons.length;m++)d.buttons[m].notifyGroupExit()}})},i.ButtonGroup.prototype={addButton:function(a){this.buttons.push(a),this.element.appendChild(a.element)},emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateLeave:function(){this.tracker.leaveHandler({eventSource:this.tracker})},destroy:function(){for(;this.buttons.length;){var a=this.buttons.pop();this.element.removeChild(a.element),a.destroy()}this.tracker.destroy(),this.element=null}}}(c),function(i){i.Rect=function(a,u,d,w,p){this.x=typeof a=="number"?a:0,this.y=typeof u=="number"?u:0,this.width=typeof d=="number"?d:0,this.height=typeof w=="number"?w:0,this.degrees=typeof p=="number"?p:0,this.degrees=i.positiveModulo(this.degrees,360);var m,y;this.degrees>=270?(m=this.getTopRight(),this.x=m.x,this.y=m.y,y=this.height,this.height=this.width,this.width=y,this.degrees-=270):this.degrees>=180?(m=this.getBottomRight(),this.x=m.x,this.y=m.y,this.degrees-=180):this.degrees>=90&&(m=this.getBottomLeft(),this.x=m.x,this.y=m.y,y=this.height,this.height=this.width,this.width=y,this.degrees-=90)},i.Rect.fromSummits=function(a,u,d){var w=a.distanceTo(u),p=a.distanceTo(d),m=u.minus(a),y=Math.atan(m.y/m.x);return m.x<0?y+=Math.PI:m.y<0&&(y+=2*Math.PI),new i.Rect(a.x,a.y,w,p,y/Math.PI*180)},i.Rect.prototype={clone:function(){return new i.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new i.Point(this.x,this.y)},getBottomRight:function(){return new i.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new i.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new i.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new i.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new i.Point(this.width,this.height)},equals:function(a){return a instanceof i.Rect&&this.x===a.x&&this.y===a.y&&this.width===a.width&&this.height===a.height&&this.degrees===a.degrees},times:function(a){return new i.Rect(this.x*a,this.y*a,this.width*a,this.height*a,this.degrees)},translate:function(a){return new i.Rect(this.x+a.x,this.y+a.y,this.width,this.height,this.degrees)},union:function(a){var u=this.getBoundingBox(),d=a.getBoundingBox(),w=Math.min(u.x,d.x),p=Math.min(u.y,d.y),m=Math.max(u.x+u.width,d.x+d.width),y=Math.max(u.y+u.height,d.y+d.height);return new i.Rect(w,p,m-w,y-p)},intersection:function(a){var u=1e-10,d=[],w=this.getTopLeft();a.containsPoint(w,u)&&d.push(w);var p=this.getTopRight();a.containsPoint(p,u)&&d.push(p);var m=this.getBottomLeft();a.containsPoint(m,u)&&d.push(m);var y=this.getBottomRight();a.containsPoint(y,u)&&d.push(y);var x=a.getTopLeft();this.containsPoint(x,u)&&d.push(x);var S=a.getTopRight();this.containsPoint(S,u)&&d.push(S);var T=a.getBottomLeft();this.containsPoint(T,u)&&d.push(T);var B=a.getBottomRight();this.containsPoint(B,u)&&d.push(B);for(var L=this._getSegments(),q=a._getSegments(),V=0;V<L.length;V++)for(var G=L[V],te=0;te<q.length;te++){var se=q[te],Te=Ie(G[0],G[1],se[0],se[1]);Te&&d.push(Te)}function Ie(Ct,Rt,Lt,ln){var ft=Rt.minus(Ct),nt=ln.minus(Lt),it=-nt.x*ft.y+ft.x*nt.y;if(it===0)return null;var jt=(ft.x*(Ct.y-Lt.y)-ft.y*(Ct.x-Lt.x))/it,Ht=(nt.x*(Ct.y-Lt.y)-nt.y*(Ct.x-Lt.x))/it;return-u<=jt&&jt<=1-u&&-u<=Ht&&Ht<=1-u?new i.Point(Ct.x+Ht*ft.x,Ct.y+Ht*ft.y):null}if(d.length===0)return null;for(var Ce=d[0].x,Ne=d[0].x,je=d[0].y,ot=d[0].y,at=1;at<d.length;at++){var vt=d[at];vt.x<Ce&&(Ce=vt.x),vt.x>Ne&&(Ne=vt.x),vt.y<je&&(je=vt.y),vt.y>ot&&(ot=vt.y)}return new i.Rect(Ce,je,Ne-Ce,ot-je)},_getSegments:function(){var a=this.getTopLeft(),u=this.getTopRight(),d=this.getBottomLeft(),w=this.getBottomRight();return[[a,u],[u,w],[w,d],[d,a]]},rotate:function(a,u){if(a=i.positiveModulo(a,360),a===0)return this.clone();u=u||this.getCenter();var d=this.getTopLeft().rotate(a,u),w=this.getTopRight().rotate(a,u),p=w.minus(d);p=p.apply(function(y){var x=1e-15;return Math.abs(y)<x?0:y});var m=Math.atan(p.y/p.x);return p.x<0?m+=Math.PI:p.y<0&&(m+=2*Math.PI),new i.Rect(d.x,d.y,this.width,this.height,m/Math.PI*180)},getBoundingBox:function(){if(this.degrees===0)return this.clone();var a=this.getTopLeft(),u=this.getTopRight(),d=this.getBottomLeft(),w=this.getBottomRight(),p=Math.min(a.x,u.x,d.x,w.x),m=Math.max(a.x,u.x,d.x,w.x),y=Math.min(a.y,u.y,d.y,w.y),x=Math.max(a.y,u.y,d.y,w.y);return new i.Rect(p,y,m-p,x-y)},getIntegerBoundingBox:function(){var a=this.getBoundingBox(),u=Math.floor(a.x),d=Math.floor(a.y),w=Math.ceil(a.width+a.x-u),p=Math.ceil(a.height+a.y-d);return new i.Rect(u,d,w,p)},containsPoint:function(a,u){u=u||0;var d=this.getTopLeft(),w=this.getTopRight(),p=this.getBottomLeft(),m=w.minus(d),y=p.minus(d);return(a.x-d.x)*m.x+(a.y-d.y)*m.y>=-u&&(a.x-w.x)*m.x+(a.y-w.y)*m.y<=u&&(a.x-d.x)*y.x+(a.y-d.y)*y.y>=-u&&(a.x-p.x)*y.x+(a.y-p.y)*y.y<=u},toString:function(){return"["+Math.round(this.x*100)/100+", "+Math.round(this.y*100)/100+", "+Math.round(this.width*100)/100+"x"+Math.round(this.height*100)/100+", "+Math.round(this.degrees*100)/100+"deg]"}}}(c),function(i){var a={};i.ReferenceStrip=function(T){var B=this,L=T.viewer,q=i.getElementSize(L.element),V,G,te;for(T.id||(T.id="referencestrip-"+i.now(),this.element=i.makeNeutralElement("div"),this.element.id=T.id,this.element.className="referencestrip"),T=i.extend(!0,{sizeRatio:i.DEFAULT_SETTINGS.referenceStripSizeRatio,position:i.DEFAULT_SETTINGS.referenceStripPosition,scroll:i.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:i.DEFAULT_SETTINGS.clickTimeThreshold},T,{element:this.element}),i.extend(this,T),a[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,this.element.tabIndex=0,G=this.element.style,G.marginTop="0px",G.marginRight="0px",G.marginBottom="0px",G.marginLeft="0px",G.left="0px",G.bottom="0px",G.border="0px",G.background="#000",G.position="relative",i.setElementTouchActionNone(this.element),i.setElementOpacity(this.element,.8),this.viewer=L,this.tracker=new i.MouseTracker({userData:"ReferenceStrip.tracker",element:this.element,clickHandler:i.delegate(this,u),dragHandler:i.delegate(this,d),scrollHandler:i.delegate(this,w),enterHandler:i.delegate(this,m),leaveHandler:i.delegate(this,y),keyDownHandler:i.delegate(this,x),keyHandler:i.delegate(this,S),preProcessEventHandler:function(se){se.eventType==="wheel"&&(se.preventDefault=!0)}}),T.width&&T.height?(this.element.style.width=T.width+"px",this.element.style.height=T.height+"px",L.addControl(this.element,{anchor:i.ControlAnchor.BOTTOM_LEFT})):T.scroll==="horizontal"?(this.element.style.width=q.x*T.sizeRatio*L.tileSources.length+12*L.tileSources.length+"px",this.element.style.height=q.y*T.sizeRatio+"px",L.addControl(this.element,{anchor:i.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=q.y*T.sizeRatio*L.tileSources.length+12*L.tileSources.length+"px",this.element.style.width=q.x*T.sizeRatio+"px",L.addControl(this.element,{anchor:i.ControlAnchor.TOP_LEFT})),this.panelWidth=q.x*this.sizeRatio+8,this.panelHeight=q.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},te=0;te<L.tileSources.length;te++)V=i.makeNeutralElement("div"),V.id=this.element.id+"-"+te,V.style.width=B.panelWidth+"px",V.style.height=B.panelHeight+"px",V.style.display="inline",V.style.float="left",V.style.cssFloat="left",V.style.styleFloat="left",V.style.padding="2px",i.setElementTouchActionNone(V),i.setElementPointerEventsNone(V),this.element.appendChild(V),V.activePanel=!1,this.panels.push(V);p(this,this.scroll==="vertical"?q.y:q.x,0),this.setFocus(0)},i.ReferenceStrip.prototype={setFocus:function(T){var B=this.element.querySelector("#"+this.element.id+"-"+T),L=i.getElementSize(this.viewer.canvas),q=Number(this.element.style.width.replace("px","")),V=Number(this.element.style.height.replace("px","")),G=-Number(this.element.style.marginLeft.replace("px","")),te=-Number(this.element.style.marginTop.replace("px","")),se;this.currentSelected!==B&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=B,this.currentSelected.style.background="#999",this.scroll==="horizontal"?(se=Number(T)*(this.panelWidth+3),se>G+L.x-this.panelWidth?(se=Math.min(se,q-L.x),this.element.style.marginLeft=-se+"px",p(this,L.x,-se)):se<G&&(se=Math.max(0,se-L.x/2),this.element.style.marginLeft=-se+"px",p(this,L.x,-se))):(se=Number(T)*(this.panelHeight+3),se>te+L.y-this.panelHeight?(se=Math.min(se,V-L.y),this.element.style.marginTop=-se+"px",p(this,L.y,-se)):se<te&&(se=Math.max(0,se-L.y/2),this.element.style.marginTop=-se+"px",p(this,L.y,-se))),this.currentPage=T,m.call(this,{eventSource:this.tracker}))},update:function(){return!!a[this.id].animating},destroy:function(){if(this.miniViewers)for(var T in this.miniViewers)this.miniViewers[T].destroy();this.tracker.destroy(),this.element&&this.viewer.removeControl(this.element)}};function u(T){if(T.quick){var B;this.scroll==="horizontal"?B=Math.floor(T.position.x/(this.panelWidth+4)):B=Math.floor(T.position.y/this.panelHeight),this.viewer.goToPage(B)}this.element.focus()}function d(T){if(this.dragging=!0,this.element){var B=Number(this.element.style.marginLeft.replace("px","")),L=Number(this.element.style.marginTop.replace("px","")),q=Number(this.element.style.width.replace("px","")),V=Number(this.element.style.height.replace("px","")),G=i.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?-T.delta.x>0?B>-(q-G.x)&&(this.element.style.marginLeft=B+T.delta.x*2+"px",p(this,G.x,B+T.delta.x*2)):-T.delta.x<0&&B<0&&(this.element.style.marginLeft=B+T.delta.x*2+"px",p(this,G.x,B+T.delta.x*2)):-T.delta.y>0?L>-(V-G.y)&&(this.element.style.marginTop=L+T.delta.y*2+"px",p(this,G.y,L+T.delta.y*2)):-T.delta.y<0&&L<0&&(this.element.style.marginTop=L+T.delta.y*2+"px",p(this,G.y,L+T.delta.y*2))}}function w(T){if(this.element){var B=Number(this.element.style.marginLeft.replace("px","")),L=Number(this.element.style.marginTop.replace("px","")),q=Number(this.element.style.width.replace("px","")),V=Number(this.element.style.height.replace("px","")),G=i.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?T.scroll>0?B>-(q-G.x)&&(this.element.style.marginLeft=B-T.scroll*60+"px",p(this,G.x,B-T.scroll*60)):T.scroll<0&&B<0&&(this.element.style.marginLeft=B-T.scroll*60+"px",p(this,G.x,B-T.scroll*60)):T.scroll<0?L>G.y-V&&(this.element.style.marginTop=L+T.scroll*60+"px",p(this,G.y,L+T.scroll*60)):T.scroll>0&&L<0&&(this.element.style.marginTop=L+T.scroll*60+"px",p(this,G.y,L+T.scroll*60)),T.preventDefault=!0}}function p(T,B,L){var q,V,G,te,se,Te;for(T.scroll==="horizontal"?q=T.panelWidth:q=T.panelHeight,V=Math.ceil(B/q)+5,G=Math.ceil((Math.abs(L)+B)/q)+1,V=G-V,V=V<0?0:V,se=V;se<G&&se<T.panels.length;se++)if(Te=T.panels[se],!Te.activePanel){var Ie,Ce=T.viewer.tileSources[se];Ce.referenceStripThumbnailUrl?Ie={type:"image",url:Ce.referenceStripThumbnailUrl}:Ie=Ce,te=new i.Viewer({id:Te.id,tileSources:[Ie],element:Te,navigatorSizeRatio:T.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:T.viewer.loadTilesWithAjax,ajaxHeaders:T.viewer.ajaxHeaders,useCanvas:T.useCanvas}),i.setElementPointerEventsNone(te.canvas),i.setElementPointerEventsNone(te.container),te.innerTracker.setTracking(!1),te.outerTracker.setTracking(!1),T.miniViewers[Te.id]=te,Te.activePanel=!0}}function m(T){var B=T.eventSource.element;this.scroll==="horizontal"?B.style.marginBottom="0px":B.style.marginLeft="0px"}function y(T){var B=T.eventSource.element;this.scroll==="horizontal"?B.style.marginBottom="-"+i.getElementSize(B).y/2+"px":B.style.marginLeft="-"+i.getElementSize(B).x/2+"px"}function x(T){if(!T.ctrl&&!T.alt&&!T.meta)switch(T.keyCode){case 38:w.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),T.preventDefault=!0;break;case 40:w.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),T.preventDefault=!0;break;case 37:w.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),T.preventDefault=!0;break;case 39:w.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),T.preventDefault=!0;break;default:T.preventDefault=!1;break}else T.preventDefault=!1}function S(T){if(!T.ctrl&&!T.alt&&!T.meta)switch(T.keyCode){case 61:w.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),T.preventDefault=!0;break;case 45:w.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),T.preventDefault=!0;break;case 48:case 119:case 87:w.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),T.preventDefault=!0;break;case 115:case 83:w.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),T.preventDefault=!0;break;case 97:w.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),T.preventDefault=!0;break;case 100:w.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),T.preventDefault=!0;break;default:T.preventDefault=!1;break}else T.preventDefault=!1}}(c),function(i){i.DisplayRect=function(a,u,d,w,p,m){i.Rect.apply(this,[a,u,d,w]),this.minLevel=p,this.maxLevel=m},i.extend(i.DisplayRect.prototype,i.Rect.prototype)}(c),function(i){i.Spring=function(u){var d=arguments;typeof u!="object"&&(u={initial:d.length&&typeof d[0]=="number"?d[0]:void 0,springStiffness:d.length>1?d[1].springStiffness:5,animationTime:d.length>1?d[1].animationTime:1.5}),i.console.assert(typeof u.springStiffness=="number"&&u.springStiffness!==0,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),i.console.assert(typeof u.animationTime=="number"&&u.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),u.exponential&&(this._exponential=!0,delete u.exponential),i.extend(!0,this,u),this.current={value:typeof this.initial=="number"?this.initial:this._exponential?0:1,time:i.now()},i.console.assert(!this._exponential||this.current.value!==0,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},i.Spring.prototype={resetTo:function(u){i.console.assert(!this._exponential||u!==0,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=u,this.start.time=this.target.time=this.current.time=i.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(u){i.console.assert(!this._exponential||u!==0,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=u,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(u){this.start.value+=u,this.target.value+=u,this._exponential&&(i.console.assert(this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(u){this._exponential=u,this._exponential&&(i.console.assert(this.current.value!==0&&this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=i.now();var u,d;this._exponential?(u=this.start._logValue,d=this.target._logValue):(u=this.start.value,d=this.target.value);var w=this.current.time>=this.target.time?d:u+(d-u)*a(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),p=this.current.value;return this._exponential?this.current.value=Math.exp(w):this.current.value=w,p!==this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}};function a(u,d){return(1-Math.exp(u*-d))/(1-Math.exp(-u))}}(c),function(i){i.ImageJob=function(u){i.extend(!0,this,{timeout:i.DEFAULT_SETTINGS.timeout,jobId:null,tries:0},u),this.data=null,this.userData={},this.errorMsg=null},i.ImageJob.prototype={start:function(){this.tries++;var u=this,d=this.abort;this.jobId=window.setTimeout(function(){u.finish(null,null,"Image load exceeded timeout ("+u.timeout+" ms)")},this.timeout),this.abort=function(){u.source.downloadTileAbort(u),typeof d=="function"&&d()},this.source.downloadTileStart(this)},finish:function(u,d,w){this.data=u,this.request=d,this.errorMsg=w,this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},i.ImageLoader=function(u){i.extend(!0,this,{jobLimit:i.DEFAULT_SETTINGS.imageLoaderLimit,timeout:i.DEFAULT_SETTINGS.timeout,jobQueue:[],failedTiles:[],jobsInProgress:0},u)},i.ImageLoader.prototype={addJob:function(u){if(!u.source){i.console.error("ImageLoader.prototype.addJob() requires [options.source]. TileSource since new API defines how images are fetched. Creating a dummy TileSource.");var d=i.TileSource.prototype;u.source={downloadTileStart:d.downloadTileStart,downloadTileAbort:d.downloadTileAbort}}var w=this,p=function(x){a(w,x,u.callback)},m={src:u.src,tile:u.tile||{},source:u.source,loadWithAjax:u.loadWithAjax,ajaxHeaders:u.loadWithAjax?u.ajaxHeaders:null,crossOriginPolicy:u.crossOriginPolicy,ajaxWithCredentials:u.ajaxWithCredentials,postData:u.postData,callback:p,abort:u.abort,timeout:this.timeout},y=new i.ImageJob(m);!this.jobLimit||this.jobsInProgress<this.jobLimit?(y.start(),this.jobsInProgress++):this.jobQueue.push(y)},clear:function(){for(var u=0;u<this.jobQueue.length;u++){var d=this.jobQueue[u];typeof d.abort=="function"&&d.abort()}this.jobQueue=[]}};function a(u,d,w){d.errorMsg!==""&&(d.data===null||d.data===void 0)&&d.tries<1+u.tileRetryMax&&u.failedTiles.push(d);var p;u.jobsInProgress--,(!u.jobLimit||u.jobsInProgress<u.jobLimit)&&u.jobQueue.length>0&&(p=u.jobQueue.shift(),p.start(),u.jobsInProgress++),u.tileRetryMax>0&&u.jobQueue.length===0&&(!u.jobLimit||u.jobsInProgress<u.jobLimit)&&u.failedTiles.length>0&&(p=u.failedTiles.shift(),setTimeout(function(){p.start()},u.tileRetryDelay),u.jobsInProgress++),w(d.data,d.errorMsg,d.request)}}(c),function(i){i.Tile=function(a,u,d,w,p,m,y,x,S,T,B,L){this.level=a,this.x=u,this.y=d,this.bounds=w,this.sourceBounds=T,this.exists=p,this._url=m,this.postData=B,this.context2D=y,this.loadWithAjax=x,this.ajaxHeaders=S,L===void 0&&(i.console.warn("Tile constructor needs 'cacheKey' variable: creation tile cache in Tile class is deprecated. TileSource.prototype.getTileHashKey will be used."),L=i.TileSource.prototype.getTileHashKey(a,u,d,m,S,B)),this.cacheKey=L,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.style=null,this.position=null,this.size=null,this.flipped=!1,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.hasTransparency=!1,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},i.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return console.warn("Tile.prototype._hasTransparencyChannel() has been deprecated and will be removed in the future. Use TileSource.prototype.hasTransparency() instead."),!!this.context2D||this.getUrl().match(".png")},drawHTML:function(a){if(!this.cacheImageRecord){i.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString());return}if(!this.loaded){i.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}if(!this.element){var u=this.getImage();if(!u)return;this.element=i.makeNeutralElement("div"),this.imgElement=u.cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"}this.element.parentNode!==a&&a.appendChild(this.element),this.imgElement.parentNode!==this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",this.flipped&&(this.style.transform="scaleX(-1)"),i.setElementOpacity(this.element,this.opacity)},get image(){return i.console.error("[Tile.image] property has been deprecated. Use [Tile.prototype.getImage] instead."),this.getImage()},get url(){return i.console.error("[Tile.url] property has been deprecated. Use [Tile.prototype.getUrl] instead."),this.getUrl()},getImage:function(){return this.cacheImageRecord.getImage()},getUrl:function(){return typeof this._url=="function"?this._url():this._url},getCanvasContext:function(){return this.context2D||this.cacheImageRecord.getRenderedContext()},drawCanvas:function(a,u,d,w,p,m){var y=this.position.times(i.pixelDensityRatio),x=this.size.times(i.pixelDensityRatio),S;if(!this.context2D&&!this.cacheImageRecord){i.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString());return}if(S=this.getCanvasContext(),!this.loaded||!S){i.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}a.save(),a.globalAlpha=this.opacity,typeof d=="number"&&d!==1&&(y=y.times(d),x=x.times(d)),w instanceof i.Point&&(y=y.plus(w)),a.globalAlpha===1&&this.hasTransparency&&(p&&(y.x=Math.round(y.x),y.y=Math.round(y.y),x.x=Math.round(x.x),x.y=Math.round(x.y)),a.clearRect(y.x,y.y,x.x,x.y)),u({context:a,tile:this,rendered:S});var T,B;this.sourceBounds?(T=Math.min(this.sourceBounds.width,S.canvas.width),B=Math.min(this.sourceBounds.height,S.canvas.height)):(T=S.canvas.width,B=S.canvas.height),a.translate(y.x+x.x/2,0),this.flipped&&a.scale(-1,1),a.drawImage(S.canvas,0,0,T,B,-x.x/2,y.y,x.x,x.y),a.restore()},getScaleForEdgeSmoothing:function(){var a;if(this.cacheImageRecord)a=this.cacheImageRecord.getRenderedContext();else if(this.context2D)a=this.context2D;else return i.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;return a.canvas.width/(this.size.x*i.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(a,u,d){var w=Math.max(1,Math.ceil((d.x-u.x)/2)),p=Math.max(1,Math.ceil((d.y-u.y)/2));return new i.Point(w,p).minus(this.position.times(i.pixelDensityRatio).times(a||1).apply(function(m){return m%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(c),function(i){i.OverlayPlacement=i.Placement,i.OverlayRotationMode=i.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),i.Overlay=function(a,u,d){var w;i.isPlainObject(a)?w=a:w={element:a,location:u,placement:d},this.element=w.element,this.style=w.element.style,this._init(w)},i.Overlay.prototype={_init:function(a){this.location=a.location,this.placement=a.placement===void 0?i.Placement.TOP_LEFT:a.placement,this.onDraw=a.onDraw,this.checkResize=a.checkResize===void 0?!0:a.checkResize,this.width=a.width===void 0?null:a.width,this.height=a.height===void 0?null:a.height,this.rotationMode=a.rotationMode||i.OverlayRotationMode.EXACT,this.location instanceof i.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=i.Placement.TOP_LEFT),this.scales=this.width!==null&&this.height!==null,this.bounds=new i.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(a,u){var d=i.Placement.properties[this.placement];d&&(d.isHorizontallyCentered?a.x-=u.x/2:d.isRight&&(a.x-=u.x),d.isVerticallyCentered?a.y-=u.y/2:d.isBottom&&(a.y-=u.y))},destroy:function(){var a=this.element,u=this.style;a.parentNode&&(a.parentNode.removeChild(a),a.prevElementParent&&(u.display="none",document.body.appendChild(a))),this.onDraw=null,u.top="",u.left="",u.position="",this.width!==null&&(u.width=""),this.height!==null&&(u.height="");var d=i.getCssPropertyWithVendorPrefix("transformOrigin"),w=i.getCssPropertyWithVendorPrefix("transform");d&&w&&(u[d]="",u[w]="")},drawHTML:function(a,u){var d=this.element;d.parentNode!==a&&(d.prevElementParent=d.parentNode,d.prevNextSibling=d.nextSibling,a.appendChild(d),this.style.position="absolute",this.size=i.getElementSize(d));var w=this._getOverlayPositionAndSize(u),p=w.position,m=this.size=w.size,y=w.rotate;if(this.onDraw)this.onDraw(p,m,this.element);else{var x=this.style;x.left=p.x+"px",x.top=p.y+"px",this.width!==null&&(x.width=m.x+"px"),this.height!==null&&(x.height=m.y+"px");var S=i.getCssPropertyWithVendorPrefix("transformOrigin"),T=i.getCssPropertyWithVendorPrefix("transform");S&&T&&(y?(x[S]=this._getTransformOrigin(),x[T]="rotate("+y+"deg)"):(x[S]="",x[T]="")),x.display="block"}},_getOverlayPositionAndSize:function(a){var u=a.pixelFromPoint(this.location,!0),d=this._getSizeInPixels(a);this.adjust(u,d);var w=0;if(a.getRotation(!0)&&this.rotationMode!==i.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===i.OverlayRotationMode.BOUNDING_BOX&&this.width!==null&&this.height!==null){var p=new i.Rect(u.x,u.y,d.x,d.y),m=this._getBoundingBox(p,a.getRotation(!0));u=m.getTopLeft(),d=m.getSize()}else w=a.getRotation(!0);return{position:u,size:d,rotate:w}},_getSizeInPixels:function(a){var u=this.size.x,d=this.size.y;if(this.width!==null||this.height!==null){var w=a.deltaPixelsFromPointsNoRotate(new i.Point(this.width||0,this.height||0),!0);this.width!==null&&(u=w.x),this.height!==null&&(d=w.y)}if(this.checkResize&&(this.width===null||this.height===null)){var p=this.size=i.getElementSize(this.element);this.width===null&&(u=p.x),this.height===null&&(d=p.y)}return new i.Point(u,d)},_getBoundingBox:function(a,u){var d=this._getPlacementPoint(a);return a.rotate(u,d).getBoundingBox()},_getPlacementPoint:function(a){var u=new i.Point(a.x,a.y),d=i.Placement.properties[this.placement];return d&&(d.isHorizontallyCentered?u.x+=a.width/2:d.isRight&&(u.x+=a.width),d.isVerticallyCentered?u.y+=a.height/2:d.isBottom&&(u.y+=a.height)),u},_getTransformOrigin:function(){var a="",u=i.Placement.properties[this.placement];return u&&(u.isLeft?a="left":u.isRight&&(a="right"),u.isTop?a+=" top":u.isBottom&&(a+=" bottom")),a},update:function(a,u){var d=i.isPlainObject(a)?a:{location:a,placement:u};this._init({location:d.location||this.location,placement:d.placement!==void 0?d.placement:this.placement,onDraw:d.onDraw||this.onDraw,checkResize:d.checkResize||this.checkResize,width:d.width!==void 0?d.width:this.width,height:d.height!==void 0?d.height:this.height,rotationMode:d.rotationMode||this.rotationMode})},getBounds:function(a){i.console.assert(a,"A viewport must now be passed to Overlay.getBounds.");var u=this.width,d=this.height;if(u===null||d===null){var w=a.deltaPointsFromPixelsNoRotate(this.size,!0);u===null&&(u=w.x),d===null&&(d=w.y)}var p=this.location.clone();return this.adjust(p,new i.Point(u,d)),this._adjustBoundsForRotation(a,new i.Rect(p.x,p.y,u,d))},_adjustBoundsForRotation:function(a,u){if(!a||a.getRotation(!0)===0||this.rotationMode===i.OverlayRotationMode.EXACT)return u;if(this.rotationMode===i.OverlayRotationMode.BOUNDING_BOX){if(this.width===null||this.height===null)return u;var d=this._getOverlayPositionAndSize(a);return a.viewerElementToViewportRectangle(new i.Rect(d.position.x,d.position.y,d.size.x,d.size.y))}return u.rotate(-a.getRotation(!0),this._getPlacementPoint(u))}}}(c),function(i){i.Drawer=function(a){i.console.assert(a.viewer,"[Drawer] options.viewer is required");var u=arguments;if(i.isPlainObject(a)||(a={source:u[0],viewport:u[1],element:u[2]}),i.console.assert(a.viewport,"[Drawer] options.viewport is required"),i.console.assert(a.element,"[Drawer] options.element is required"),a.source&&i.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=a.viewer,this.viewport=a.viewport,this.debugGridColor=typeof a.debugGridColor=="string"?[a.debugGridColor]:a.debugGridColor||i.DEFAULT_SETTINGS.debugGridColor,a.opacity&&i.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=i.supportsCanvas&&(this.viewer?this.viewer.useCanvas:!0),this.container=i.getElement(a.element),this.canvas=i.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var d=this._calculateCanvasSize();this.canvas.width=d.x,this.canvas.height=d.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",i.setElementOpacity(this.canvas,this.opacity,!0),i.setElementPointerEventsNone(this.canvas),i.setElementTouchActionNone(this.canvas),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},i.Drawer.prototype={addOverlay:function(a,u,d,w){return i.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(a,u,d,w),this},updateOverlay:function(a,u,d){return i.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(a,u,d),this},removeOverlay:function(a){return i.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(a),this},clearOverlays:function(){return i.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(a){var u=this.viewport.pixelFromPointNoRotate(a,!0);return new i.Point(u.x*i.pixelDensityRatio,u.y*i.pixelDensityRatio)},clipWithPolygons:function(a,u){if(this.useCanvas){var d=this._getContext(u);d.beginPath(),a.forEach(function(w){w.forEach(function(p,m){d[m===0?"moveTo":"lineTo"](p.x,p.y)})}),d.clip()}},setOpacity:function(a){i.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var u=this.viewer.world,d=0;d<u.getItemCount();d++)u.getItemAt(d).setOpacity(a);return this},getOpacity:function(){i.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var a=this.viewer.world,u=0,d=0;d<a.getItemCount();d++){var w=a.getItemAt(d).getOpacity();w>u&&(u=w)}return u},needsUpdate:function(){return i.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return i.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return i.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return i.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var a=this._calculateCanvasSize();if((this.canvas.width!==a.x||this.canvas.height!==a.y)&&(this.canvas.width=a.x,this.canvas.height=a.y,this._updateImageSmoothingEnabled(this.context),this.sketchCanvas!==null)){var u=this._calculateSketchCanvasSize();this.sketchCanvas.width=u.x,this.sketchCanvas.height=u.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(a,u){if(this.useCanvas){var d=this._getContext(a);if(u)d.clearRect(u.x,u.y,u.width,u.height);else{var w=d.canvas;d.clearRect(0,0,w.width,w.height)}}},viewportToDrawerRectangle:function(a){var u=this.viewport.pixelFromPointNoRotate(a.getTopLeft(),!0),d=this.viewport.deltaPixelsFromPointsNoRotate(a.getSize(),!0);return new i.Rect(u.x*i.pixelDensityRatio,u.y*i.pixelDensityRatio,d.x*i.pixelDensityRatio,d.y*i.pixelDensityRatio)},drawTile:function(a,u,d,w,p,m,y){if(i.console.assert(a,"[Drawer.drawTile] tile is required"),i.console.assert(u,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var x=this._getContext(d);w=w||1,a.drawCanvas(x,u,w,p,m,y)}else a.drawHTML(this.canvas)},_getContext:function(a){var u=this.context;if(a){if(this.sketchCanvas===null){this.sketchCanvas=document.createElement("canvas");var d=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=d.x,this.sketchCanvas.height=d.y,this.sketchContext=this.sketchCanvas.getContext("2d"),this.viewport.getRotation()===0){var w=this;this.viewer.addHandler("rotate",function p(){if(w.viewport.getRotation()!==0){w.viewer.removeHandler("rotate",p);var m=w._calculateSketchCanvasSize();w.sketchCanvas.width=m.x,w.sketchCanvas.height=m.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}u=this.sketchContext}return u},saveContext:function(a){this.useCanvas&&this._getContext(a).save()},restoreContext:function(a){this.useCanvas&&this._getContext(a).restore()},setClip:function(a,u){if(this.useCanvas){var d=this._getContext(u);d.beginPath(),d.rect(a.x,a.y,a.width,a.height),d.clip()}},drawRectangle:function(a,u,d){if(this.useCanvas){var w=this._getContext(d);w.save(),w.fillStyle=u,w.fillRect(a.x,a.y,a.width,a.height),w.restore()}},blendSketch:function(a,u,d,w){var p=a;if(i.isPlainObject(p)||(p={opacity:a,scale:u,translate:d,compositeOperation:w}),!(!this.useCanvas||!this.sketchCanvas)){a=p.opacity,w=p.compositeOperation;var m=p.bounds;if(this.context.save(),this.context.globalAlpha=a,w&&(this.context.globalCompositeOperation=w),m)m.x<0&&(m.width+=m.x,m.x=0),m.x+m.width>this.canvas.width&&(m.width=this.canvas.width-m.x),m.y<0&&(m.height+=m.y,m.y=0),m.y+m.height>this.canvas.height&&(m.height=this.canvas.height-m.y),this.context.drawImage(this.sketchCanvas,m.x,m.y,m.width,m.height,m.x,m.y,m.width,m.height);else{u=p.scale||1,d=p.translate;var y=d instanceof i.Point?d:new i.Point(0,0),x=0,S=0;if(d){var T=this.sketchCanvas.width-this.canvas.width,B=this.sketchCanvas.height-this.canvas.height;x=Math.round(T/2),S=Math.round(B/2)}this.context.drawImage(this.sketchCanvas,y.x-x*u,y.y-S*u,(this.canvas.width+2*x)*u,(this.canvas.height+2*S)*u,-x,-S,this.canvas.width+2*x,this.canvas.height+2*S)}this.context.restore()}},drawDebugInfo:function(a,u,d,w){if(this.useCanvas){var p=this.viewer.world.getIndexOfItem(w)%this.debugGridColor.length,m=this.context;m.save(),m.lineWidth=2*i.pixelDensityRatio,m.font="small-caps bold "+13*i.pixelDensityRatio+"px arial",m.strokeStyle=this.debugGridColor[p],m.fillStyle=this.debugGridColor[p],this.viewport.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:this.viewport.getRotation(!0)}),w.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:w.getRotation(!0),point:w.viewport.pixelFromPointNoRotate(w._getRotationPoint(!0),!0)}),w.viewport.getRotation(!0)%360===0&&w.getRotation(!0)%360===0&&w._drawer.viewer.viewport.getFlip()&&w._drawer._flip(),m.strokeRect(a.position.x*i.pixelDensityRatio,a.position.y*i.pixelDensityRatio,a.size.x*i.pixelDensityRatio,a.size.y*i.pixelDensityRatio);var y=(a.position.x+a.size.x/2)*i.pixelDensityRatio,x=(a.position.y+a.size.y/2)*i.pixelDensityRatio;m.translate(y,x),m.rotate(Math.PI/180*-this.viewport.getRotation(!0)),m.translate(-y,-x),a.x===0&&a.y===0&&(m.fillText("Zoom: "+this.viewport.getZoom(),a.position.x*i.pixelDensityRatio,(a.position.y-30)*i.pixelDensityRatio),m.fillText("Pan: "+this.viewport.getBounds().toString(),a.position.x*i.pixelDensityRatio,(a.position.y-20)*i.pixelDensityRatio)),m.fillText("Level: "+a.level,(a.position.x+10)*i.pixelDensityRatio,(a.position.y+20)*i.pixelDensityRatio),m.fillText("Column: "+a.x,(a.position.x+10)*i.pixelDensityRatio,(a.position.y+30)*i.pixelDensityRatio),m.fillText("Row: "+a.y,(a.position.x+10)*i.pixelDensityRatio,(a.position.y+40)*i.pixelDensityRatio),m.fillText("Order: "+d+" of "+u,(a.position.x+10)*i.pixelDensityRatio,(a.position.y+50)*i.pixelDensityRatio),m.fillText("Size: "+a.size.toString(),(a.position.x+10)*i.pixelDensityRatio,(a.position.y+60)*i.pixelDensityRatio),m.fillText("Position: "+a.position.toString(),(a.position.x+10)*i.pixelDensityRatio,(a.position.y+70)*i.pixelDensityRatio),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(),w.getRotation(!0)%360!==0&&this._restoreRotationChanges(),w.viewport.getRotation(!0)%360===0&&w.getRotation(!0)%360===0&&w._drawer.viewer.viewport.getFlip()&&w._drawer._flip(),m.restore()}},debugRect:function(a){if(this.useCanvas){var u=this.context;u.save(),u.lineWidth=2*i.pixelDensityRatio,u.strokeStyle=this.debugGridColor[0],u.fillStyle=this.debugGridColor[0],u.strokeRect(a.x*i.pixelDensityRatio,a.y*i.pixelDensityRatio,a.width*i.pixelDensityRatio,a.height*i.pixelDensityRatio),u.restore()}},setImageSmoothingEnabled:function(a){this.useCanvas&&(this._imageSmoothingEnabled=a,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(a){a.msImageSmoothingEnabled=this._imageSmoothingEnabled,a.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(a){var u=this._getContext(a).canvas;return new i.Point(u.width,u.height)},getCanvasCenter:function(){return new i.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(a){var u=a.point?a.point.times(i.pixelDensityRatio):this.getCanvasCenter(),d=this._getContext(a.useSketch);d.save(),d.translate(u.x,u.y),this.viewer.viewport.flipped?(d.rotate(Math.PI/180*-a.degrees),d.scale(-1,1)):d.rotate(Math.PI/180*a.degrees),d.translate(-u.x,-u.y)},_flip:function(a){a=a||{};var u=a.point?a.point.times(i.pixelDensityRatio):this.getCanvasCenter(),d=this._getContext(a.useSketch);d.translate(u.x,0),d.scale(-1,1),d.translate(-u.x,0)},_restoreRotationChanges:function(a){var u=this._getContext(a);u.restore()},_calculateCanvasSize:function(){var a=i.pixelDensityRatio,u=this.viewport.getContainerSize();return{x:Math.round(u.x*a),y:Math.round(u.y*a)}},_calculateSketchCanvasSize:function(){var a=this._calculateCanvasSize();if(this.viewport.getRotation()===0)return a;var u=Math.ceil(Math.sqrt(a.x*a.x+a.y*a.y));return{x:u,y:u}}}}(c),function(i){i.Viewport=function(a){var u=arguments;u.length&&u[0]instanceof i.Point&&(a={containerSize:u[0],contentSize:u[1],config:u[2]}),a.config&&(i.extend(!0,a,a.config),delete a.config),this._margins=i.extend({left:0,top:0,right:0,bottom:0},a.margins||{}),delete a.margins,a.initialDegrees=a.degrees,delete a.degrees,i.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,rotationPivot:null,viewer:null,springStiffness:i.DEFAULT_SETTINGS.springStiffness,animationTime:i.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:i.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:i.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:i.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:i.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:i.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:i.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:i.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:i.DEFAULT_SETTINGS.maxZoomLevel,initialDegrees:i.DEFAULT_SETTINGS.degrees,flipped:i.DEFAULT_SETTINGS.flipped,homeFillsViewer:i.DEFAULT_SETTINGS.homeFillsViewer,silenceMultiImageWarnings:i.DEFAULT_SETTINGS.silenceMultiImageWarnings},a),this._updateContainerInnerSize(),this.centerSpringX=new i.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new i.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new i.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.degreesSpring=new i.Spring({initial:a.initialDegrees,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,this._setContentBounds(new i.Rect(0,0,1,1),1),this.goHome(!0),this.update()},i.Viewport.prototype={get degrees(){return i.console.warn("Accessing [Viewport.degrees] is deprecated. Use viewport.getRotation instead."),this.getRotation()},set degrees(a){i.console.warn("Setting [Viewport.degrees] is deprecated. Use viewport.rotateTo, viewport.rotateBy, or viewport.setRotation instead."),this.rotateTo(a)},resetContentSize:function(a){return i.console.assert(a,"[Viewport.resetContentSize] contentSize is required"),i.console.assert(a instanceof i.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),i.console.assert(a.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),i.console.assert(a.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new i.Rect(0,0,1,a.y/a.x),a.x),this},setHomeBounds:function(a,u){i.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(a,u)},_setContentBounds:function(a,u){i.console.assert(a,"[Viewport._setContentBounds] bounds is required"),i.console.assert(a instanceof i.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),i.console.assert(a.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),i.console.assert(a.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=a.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(u),this._contentBounds=a.rotate(this.getRotation()).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(u),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:u,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var a=this._contentAspectRatio/this.getAspectRatio(),u;return this.homeFillsViewer?u=a>=1?a:1:u=a>=1?1:a,u/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var a=this._contentBounds.getCenter(),u=1/this.getHomeZoom(),d=u/this.getAspectRatio();return new i.Rect(a.x-u/2,a.y-d/2,u,d)},goHome:function(a){return this.viewer&&this.viewer.raiseEvent("home",{immediately:a}),this.fitBounds(this.getHomeBounds(),a)},getMinZoom:function(){var a=this.getHomeZoom(),u=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*a;return u},getMaxZoom:function(){var a=this.maxZoomLevel;return a||(a=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,a/=this._contentBounds.width),Math.max(a,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new i.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return i.extend({},this._margins)},setMargins:function(a){i.console.assert(i.type(a)==="object","[Viewport.setMargins] margins must be an object"),this._margins=i.extend({left:0,top:0,right:0,bottom:0},a),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(a){return this.getBoundsNoRotate(a).rotate(-this.getRotation(a))},getBoundsNoRotate:function(a){var u=this.getCenter(a),d=1/this.getZoom(a),w=d/this.getAspectRatio();return new i.Rect(u.x-d/2,u.y-w/2,d,w)},getBoundsWithMargins:function(a){return this.getBoundsNoRotateWithMargins(a).rotate(-this.getRotation(a),this.getCenter(a))},getBoundsNoRotateWithMargins:function(a){var u=this.getBoundsNoRotate(a),d=this._containerInnerSize.x*this.getZoom(a);return u.x-=this._margins.left/d,u.y-=this._margins.top/d,u.width+=(this._margins.left+this._margins.right)/d,u.height+=(this._margins.top+this._margins.bottom)/d,u},getCenter:function(a){var u=new i.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),d=new i.Point(this.centerSpringX.target.value,this.centerSpringY.target.value),w,p,m,y,x,S,T,B;return a?u:this.zoomPoint?(w=this.pixelFromPoint(this.zoomPoint,!0),p=this.getZoom(),m=1/p,y=m/this.getAspectRatio(),x=new i.Rect(u.x-m/2,u.y-y/2,m,y),S=this._pixelFromPoint(this.zoomPoint,x),T=S.minus(w).rotate(-this.getRotation(!0)),B=T.divide(this._containerInnerSize.x*p),d.plus(B)):d},getZoom:function(a){return a?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(a){return Math.max(Math.min(a,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(a){var u=this.viewportToViewerElementRectangle(a).getBoundingBox(),d=this.viewportToViewerElementRectangle(this._contentBoundsNoRotate).getBoundingBox(),w=!1,p=!1;if(!this.wrapHorizontal){var m=u.x+u.width,y=d.x+d.width,x,S,T;u.width>d.width?x=this.visibilityRatio*d.width:x=this.visibilityRatio*u.width,S=d.x-m+x,T=y-u.x-x,x>d.width?(u.x+=(S+T)/2,w=!0):T<0?(u.x+=T,w=!0):S>0&&(u.x+=S,w=!0)}if(!this.wrapVertical){var B=u.y+u.height,L=d.y+d.height,q,V,G;u.height>d.height?q=this.visibilityRatio*d.height:q=this.visibilityRatio*u.height,V=d.y-B+q,G=L-u.y-q,q>d.height?(u.y+=(V+G)/2,p=!0):G<0?(u.y+=G,p=!0):V>0&&(u.y+=V,p=!0)}var te=w||p,se=te?this.viewerElementToViewportRectangle(u):a.clone();return se.xConstrained=w,se.yConstrained=p,se.constraintApplied=te,se},_raiseConstraintsEvent:function(a){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:a})},applyConstraints:function(a){var u=this.getZoom(),d=this._applyZoomConstraints(u);u!==d&&this.zoomTo(d,this.zoomPoint,a);var w=this.getConstrainedBounds(!1);return w.constraintApplied&&(this.fitBounds(w,a),this._raiseConstraintsEvent(a)),this},ensureVisible:function(a){return this.applyConstraints(a)},_fitBounds:function(a,u){u=u||{};var d=u.immediately||!1,w=u.constraints||!1,p=this.getAspectRatio(),m=a.getCenter(),y=new i.Rect(a.x,a.y,a.width,a.height,a.degrees+this.getRotation()).getBoundingBox();y.getAspectRatio()>=p?y.height=y.width/p:y.width=y.height*p,y.x=m.x-y.width/2,y.y=m.y-y.height/2;var x=1/y.width;if(d)return this.panTo(m,!0),this.zoomTo(x,null,!0),w&&this.applyConstraints(!0),this;var S=this.getCenter(!0),T=this.getZoom(!0);this.panTo(S,!0),this.zoomTo(T,null,!0);var B=this.getBounds(),L=this.getZoom();if(L===0||Math.abs(x/L-1)<1e-8)return this.zoomTo(x,null,!0),this.panTo(m,d),w&&this.applyConstraints(!1),this;if(w){this.panTo(m,!1),x=this._applyZoomConstraints(x),this.zoomTo(x,null,!1);var q=this.getConstrainedBounds();this.panTo(S,!0),this.zoomTo(T,null,!0),this.fitBounds(q)}else{var V=y.rotate(-this.getRotation()),G=V.getTopLeft().times(x).minus(B.getTopLeft().times(L)).divide(x-L);this.zoomTo(x,G,d)}return this},fitBounds:function(a,u){return this._fitBounds(a,{immediately:u,constraints:!1})},fitBoundsWithConstraints:function(a,u){return this._fitBounds(a,{immediately:u,constraints:!0})},fitVertically:function(a){var u=new i.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(u,a)},fitHorizontally:function(a){var u=new i.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(u,a)},getConstrainedBounds:function(a){var u,d;return u=this.getBounds(a),d=this._applyBoundaryConstraints(u),d},panBy:function(a,u){var d=new i.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(d.plus(a),u)},panTo:function(a,u){return u?(this.centerSpringX.resetTo(a.x),this.centerSpringY.resetTo(a.y)):(this.centerSpringX.springTo(a.x),this.centerSpringY.springTo(a.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:a,immediately:u}),this},zoomBy:function(a,u,d){return this.zoomTo(this.zoomSpring.target.value*a,u,d)},zoomTo:function(a,u,d){var w=this;return this.zoomPoint=u instanceof i.Point&&!isNaN(u.x)&&!isNaN(u.y)?u:null,d?this._adjustCenterSpringsForZoomPoint(function(){w.zoomSpring.resetTo(a)}):this.zoomSpring.springTo(a),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:a,refPoint:u,immediately:d}),this},setRotation:function(a,u){return this.rotateTo(a,null,u)},getRotation:function(a){return a?this.degreesSpring.current.value:this.degreesSpring.target.value},setRotationWithPivot:function(a,u,d){return this.rotateTo(a,u,d)},rotateTo:function(a,u,d){if(!this.viewer||!this.viewer.drawer.canRotate())return this;if(this.degreesSpring.target.value===a&&this.degreesSpring.isAtTargetValue())return this;if(this.rotationPivot=u instanceof i.Point&&!isNaN(u.x)&&!isNaN(u.y)?u:null,d)if(this.rotationPivot){var w=a-this._oldDegrees;if(!w)return this.rotationPivot=null,this;this._rotateAboutPivot(a)}else this.degreesSpring.resetTo(a);else{var p=i.positiveModulo(this.degreesSpring.current.value,360),m=i.positiveModulo(a,360),y=m-p;y>180?m-=360:y<-180&&(m+=360);var x=p-m;this.degreesSpring.resetTo(a+x),this.degreesSpring.springTo(a)}return this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:a,immediately:!!d,pivot:this.rotationPivot||this.getCenter()}),this},rotateBy:function(a,u,d){return this.rotateTo(this.degreesSpring.target.value+a,u,d)},resize:function(a,u){var d=this.getBoundsNoRotate(),w=d,p;this.containerSize.x=a.x,this.containerSize.y=a.y,this._updateContainerInnerSize(),u&&(p=a.x/this.containerSize.x,w.width=d.width*p,w.height=w.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:a,maintain:u});var m=this.fitBounds(w,!0);return this.viewer&&this.viewer.raiseEvent("after-resize",{newContainerSize:a,maintain:u}),m},_updateContainerInnerSize:function(){this._containerInnerSize=new i.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var a=this;this._adjustCenterSpringsForZoomPoint(function(){a.zoomSpring.update()}),this.degreesSpring.isAtTargetValue()&&(this.rotationPivot=null),this.centerSpringX.update(),this.centerSpringY.update(),this.rotationPivot?this._rotateAboutPivot(!0):this.degreesSpring.update();var u=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom||this.degreesSpring.current.value!==this._oldDegrees;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,u},_rotateAboutPivot:function(a){var u=a===!0,d=this.rotationPivot.minus(this.getCenter());this.centerSpringX.shiftBy(d.x),this.centerSpringY.shiftBy(d.y),u?this.degreesSpring.update():this.degreesSpring.resetTo(a);var w=this.degreesSpring.current.value-this._oldDegrees,p=d.rotate(w*-1).times(-1);this.centerSpringX.shiftBy(p.x),this.centerSpringY.shiftBy(p.y)},_adjustCenterSpringsForZoomPoint:function(a){if(this.zoomPoint){var u=this.pixelFromPoint(this.zoomPoint,!0);a();var d=this.pixelFromPoint(this.zoomPoint,!0),w=d.minus(u),p=this.deltaPointsFromPixels(w,!0);this.centerSpringX.shiftBy(p.x),this.centerSpringY.shiftBy(p.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else a()},deltaPixelsFromPointsNoRotate:function(a,u){return a.times(this._containerInnerSize.x*this.getZoom(u))},deltaPixelsFromPoints:function(a,u){return this.deltaPixelsFromPointsNoRotate(a.rotate(this.getRotation(u)),u)},deltaPointsFromPixelsNoRotate:function(a,u){return a.divide(this._containerInnerSize.x*this.getZoom(u))},deltaPointsFromPixels:function(a,u){return this.deltaPointsFromPixelsNoRotate(a,u).rotate(-this.getRotation(u))},pixelFromPointNoRotate:function(a,u){return this._pixelFromPointNoRotate(a,this.getBoundsNoRotate(u))},pixelFromPoint:function(a,u){return this._pixelFromPoint(a,this.getBoundsNoRotate(u))},_pixelFromPointNoRotate:function(a,u){return a.minus(u.getTopLeft()).times(this._containerInnerSize.x/u.width).plus(new i.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(a,u){return this._pixelFromPointNoRotate(a.rotate(this.getRotation(!0),this.getCenter(!0)),u)},pointFromPixelNoRotate:function(a,u){var d=this.getBoundsNoRotate(u);return a.minus(new i.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/d.width).plus(d.getTopLeft())},pointFromPixel:function(a,u){return this.pointFromPixelNoRotate(a,u).rotate(-this.getRotation(u),this.getCenter(u))},_viewportToImageDelta:function(a,u){var d=this._contentBoundsNoRotate.width;return new i.Point(a*this._contentSizeNoRotate.x/d,u*this._contentSizeNoRotate.x/d)},viewportToImageCoordinates:function(a,u){if(a instanceof i.Point)return this.viewportToImageCoordinates(a.x,a.y);if(this.viewer){var d=this.viewer.world.getItemCount();if(d>1)this.silenceMultiImageWarnings||i.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(d===1){var w=this.viewer.world.getItemAt(0);return w.viewportToImageCoordinates(a,u,!0)}}return this._viewportToImageDelta(a-this._contentBoundsNoRotate.x,u-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(a,u){var d=this._contentBoundsNoRotate.width;return new i.Point(a/this._contentSizeNoRotate.x*d,u/this._contentSizeNoRotate.x*d)},imageToViewportCoordinates:function(a,u){if(a instanceof i.Point)return this.imageToViewportCoordinates(a.x,a.y);if(this.viewer){var d=this.viewer.world.getItemCount();if(d>1)this.silenceMultiImageWarnings||i.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(d===1){var w=this.viewer.world.getItemAt(0);return w.imageToViewportCoordinates(a,u,!0)}}var p=this._imageToViewportDelta(a,u);return p.x+=this._contentBoundsNoRotate.x,p.y+=this._contentBoundsNoRotate.y,p},imageToViewportRectangle:function(a,u,d,w){var p=a;if(p instanceof i.Rect||(p=new i.Rect(a,u,d,w)),this.viewer){var m=this.viewer.world.getItemCount();if(m>1)this.silenceMultiImageWarnings||i.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(m===1){var y=this.viewer.world.getItemAt(0);return y.imageToViewportRectangle(a,u,d,w,!0)}}var x=this.imageToViewportCoordinates(p.x,p.y),S=this._imageToViewportDelta(p.width,p.height);return new i.Rect(x.x,x.y,S.x,S.y,p.degrees)},viewportToImageRectangle:function(a,u,d,w){var p=a;if(p instanceof i.Rect||(p=new i.Rect(a,u,d,w)),this.viewer){var m=this.viewer.world.getItemCount();if(m>1)this.silenceMultiImageWarnings||i.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(m===1){var y=this.viewer.world.getItemAt(0);return y.viewportToImageRectangle(a,u,d,w,!0)}}var x=this.viewportToImageCoordinates(p.x,p.y),S=this._viewportToImageDelta(p.width,p.height);return new i.Rect(x.x,x.y,S.x,S.y,p.degrees)},viewerElementToImageCoordinates:function(a){var u=this.pointFromPixel(a,!0);return this.viewportToImageCoordinates(u)},imageToViewerElementCoordinates:function(a){var u=this.imageToViewportCoordinates(a);return this.pixelFromPoint(u,!0)},windowToImageCoordinates:function(a){i.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var u=a.minus(i.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(u)},imageToWindowCoordinates:function(a){i.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var u=this.imageToViewerElementCoordinates(a);return u.plus(i.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(a){return this.pointFromPixel(a,!0)},viewportToViewerElementCoordinates:function(a){return this.pixelFromPoint(a,!0)},viewerElementToViewportRectangle:function(a){return i.Rect.fromSummits(this.pointFromPixel(a.getTopLeft(),!0),this.pointFromPixel(a.getTopRight(),!0),this.pointFromPixel(a.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(a){return i.Rect.fromSummits(this.pixelFromPoint(a.getTopLeft(),!0),this.pixelFromPoint(a.getTopRight(),!0),this.pixelFromPoint(a.getBottomLeft(),!0))},windowToViewportCoordinates:function(a){i.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var u=a.minus(i.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(u)},viewportToWindowCoordinates:function(a){i.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var u=this.viewportToViewerElementCoordinates(a);return u.plus(i.getElementPosition(this.viewer.element))},viewportToImageZoom:function(a){if(this.viewer){var u=this.viewer.world.getItemCount();if(u>1)this.silenceMultiImageWarnings||i.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(u===1){var d=this.viewer.world.getItemAt(0);return d.viewportToImageZoom(a)}}var w=this._contentSizeNoRotate.x,p=this._containerInnerSize.x,m=this._contentBoundsNoRotate.width,y=p/w*m;return a*y},imageToViewportZoom:function(a){if(this.viewer){var u=this.viewer.world.getItemCount();if(u>1)this.silenceMultiImageWarnings||i.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(u===1){var d=this.viewer.world.getItemAt(0);return d.imageToViewportZoom(a)}}var w=this._contentSizeNoRotate.x,p=this._containerInnerSize.x,m=this._contentBoundsNoRotate.width,y=w/p/m;return a*y},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(a){return this.flipped===a?this:(this.flipped=a,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:a}),this)}}}(c),function(i){i.TiledImage=function(p){var m=this;i.console.assert(p.tileCache,"[TiledImage] options.tileCache is required"),i.console.assert(p.drawer,"[TiledImage] options.drawer is required"),i.console.assert(p.viewer,"[TiledImage] options.viewer is required"),i.console.assert(p.imageLoader,"[TiledImage] options.imageLoader is required"),i.console.assert(p.source,"[TiledImage] options.source is required"),i.console.assert(!p.clip||p.clip instanceof i.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),i.EventSource.call(this),this._tileCache=p.tileCache,delete p.tileCache,this._drawer=p.drawer,delete p.drawer,this._imageLoader=p.imageLoader,delete p.imageLoader,p.clip instanceof i.Rect&&(this._clip=p.clip.clone()),delete p.clip;var y=p.x||0;delete p.x;var x=p.y||0;delete p.y,this.normHeight=p.source.dimensions.y/p.source.dimensions.x,this.contentAspectX=p.source.dimensions.x/p.source.dimensions.y;var S=1;p.width?(S=p.width,delete p.width,p.height&&(i.console.error("specifying both width and height to a tiledImage is not supported"),delete p.height)):p.height&&(S=p.height/this.normHeight,delete p.height);var T=p.fitBounds;delete p.fitBounds;var B=p.fitBoundsPlacement||c.Placement.CENTER;delete p.fitBoundsPlacement;var L=p.degrees||0;delete p.degrees;var q=p.ajaxHeaders;delete p.ajaxHeaders,i.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:i.DEFAULT_SETTINGS.springStiffness,animationTime:i.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:i.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:i.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:i.DEFAULT_SETTINGS.wrapVertical,immediateRender:i.DEFAULT_SETTINGS.immediateRender,blendTime:i.DEFAULT_SETTINGS.blendTime,alwaysBlend:i.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:i.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:i.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:i.DEFAULT_SETTINGS.iOSDevice,debugMode:i.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:i.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:i.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:i.DEFAULT_SETTINGS.placeholderFillStyle,opacity:i.DEFAULT_SETTINGS.opacity,preload:i.DEFAULT_SETTINGS.preload,compositeOperation:i.DEFAULT_SETTINGS.compositeOperation,subPixelRoundingForTransparency:i.DEFAULT_SETTINGS.subPixelRoundingForTransparency},p),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new i.Spring({initial:y,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new i.Spring({initial:x,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new i.Spring({initial:S,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new i.Spring({initial:L,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),T&&this.fitBounds(T,B,!0),this._drawingHandler=function(V){m.viewer.raiseEvent("tile-drawing",i.extend({tiledImage:m},V))},this._ownAjaxHeaders={},this.setAjaxHeaders(q,!1)},i.extend(i.TiledImage.prototype,i.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(p){p!==this._fullyLoaded&&(this._fullyLoaded=p,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=i.now(),this._needsDraw=!0},update:function(){var p=this._xSpring.update(),m=this._ySpring.update(),y=this._scaleSpring.update(),x=this._degreesSpring.update();return p||m||y||x?(this._updateForScale(),this._needsDraw=!0,!0):!1},draw:function(){this.opacity!==0||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset(),this.source.destroy&&this.source.destroy()},getBounds:function(p){return this.getBoundsNoRotate(p).rotate(this.getRotation(p),this._getRotationPoint(p))},getBoundsNoRotate:function(p){return p?new i.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new i.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return i.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(p){var m=this.getBoundsNoRotate(p);if(this._clip){var y=p?this._worldWidthCurrent:this._worldWidthTarget,x=y/this.source.dimensions.x,S=this._clip.times(x);m=new i.Rect(m.x+S.x,m.y+S.y,S.width,S.height)}return m.rotate(this.getRotation(p),this._getRotationPoint(p))},getTileBounds:function(p,m,y){var x=this.source.getNumTiles(p),S=(x.x+m%x.x)%x.x,T=(x.y+y%x.y)%x.y,B=this.source.getTileBounds(p,S,T);return this.getFlip()&&(B.x=1-B.x-B.width),B.x+=(m-S)/x.x,B.y+=this._worldHeightCurrent/this._worldWidthCurrent*((y-T)/x.y),B},getContentSize:function(){return new i.Point(this.source.dimensions.x,this.source.dimensions.y)},getSizeInWindowCoordinates:function(){var p=this.imageToWindowCoordinates(new i.Point(0,0)),m=this.imageToWindowCoordinates(this.getContentSize());return new i.Point(m.x-p.x,m.y-p.y)},_viewportToImageDelta:function(p,m,y){var x=y?this._scaleSpring.current.value:this._scaleSpring.target.value;return new i.Point(p*(this.source.dimensions.x/x),m*(this.source.dimensions.y*this.contentAspectX/x))},viewportToImageCoordinates:function(p,m,y){var x;return p instanceof i.Point?(y=m,x=p):x=new i.Point(p,m),x=x.rotate(-this.getRotation(y),this._getRotationPoint(y)),y?this._viewportToImageDelta(x.x-this._xSpring.current.value,x.y-this._ySpring.current.value):this._viewportToImageDelta(x.x-this._xSpring.target.value,x.y-this._ySpring.target.value)},_imageToViewportDelta:function(p,m,y){var x=y?this._scaleSpring.current.value:this._scaleSpring.target.value;return new i.Point(p/this.source.dimensions.x*x,m/this.source.dimensions.y/this.contentAspectX*x)},imageToViewportCoordinates:function(p,m,y){p instanceof i.Point&&(y=m,m=p.y,p=p.x);var x=this._imageToViewportDelta(p,m);return y?(x.x+=this._xSpring.current.value,x.y+=this._ySpring.current.value):(x.x+=this._xSpring.target.value,x.y+=this._ySpring.target.value),x.rotate(this.getRotation(y),this._getRotationPoint(y))},imageToViewportRectangle:function(p,m,y,x,S){var T=p;T instanceof i.Rect?S=m:T=new i.Rect(p,m,y,x);var B=this.imageToViewportCoordinates(T.getTopLeft(),S),L=this._imageToViewportDelta(T.width,T.height,S);return new i.Rect(B.x,B.y,L.x,L.y,T.degrees+this.getRotation(S))},viewportToImageRectangle:function(p,m,y,x,S){var T=p;p instanceof i.Rect?S=m:T=new i.Rect(p,m,y,x);var B=this.viewportToImageCoordinates(T.getTopLeft(),S),L=this._viewportToImageDelta(T.width,T.height,S);return new i.Rect(B.x,B.y,L.x,L.y,T.degrees-this.getRotation(S))},viewerElementToImageCoordinates:function(p){var m=this.viewport.pointFromPixel(p,!0);return this.viewportToImageCoordinates(m)},imageToViewerElementCoordinates:function(p){var m=this.imageToViewportCoordinates(p);return this.viewport.pixelFromPoint(m,!0)},windowToImageCoordinates:function(p){var m=p.minus(c.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(m)},imageToWindowCoordinates:function(p){var m=this.imageToViewerElementCoordinates(p);return m.plus(c.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(p){var m=this._scaleSpring.current.value;return p=p.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new i.Rect((p.x-this._xSpring.current.value)/m,(p.y-this._ySpring.current.value)/m,p.width/m,p.height/m,p.degrees)},viewportToImageZoom:function(p){var m=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return m*p},imageToViewportZoom:function(p){var m=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return p/m},setPosition:function(p,m){var y=this._xSpring.target.value===p.x&&this._ySpring.target.value===p.y;if(m){if(y&&this._xSpring.current.value===p.x&&this._ySpring.current.value===p.y)return;this._xSpring.resetTo(p.x),this._ySpring.resetTo(p.y),this._needsDraw=!0}else{if(y)return;this._xSpring.springTo(p.x),this._ySpring.springTo(p.y),this._needsDraw=!0}y||this._raiseBoundsChange()},setWidth:function(p,m){this._setScale(p,m)},setHeight:function(p,m){this._setScale(p/this.normHeight,m)},setCroppingPolygons:function(p){var m=function(x){return x instanceof i.Point||typeof x.x=="number"&&typeof x.y=="number"},y=function(x){return x.map(function(S){try{if(m(S))return{x:S.x,y:S.y};throw new Error}catch{throw new Error("A Provided cropping polygon point is not supported")}})};try{if(!i.isArray(p))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=p.map(function(x){return y(x)})}catch(x){i.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),i.console.error(x),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(p,m,y){m=m||i.Placement.CENTER;var x=i.Placement.properties[m],S=this.contentAspectX,T=0,B=0,L=1,q=1;if(this._clip&&(S=this._clip.getAspectRatio(),L=this._clip.width/this.source.dimensions.x,q=this._clip.height/this.source.dimensions.y,p.getAspectRatio()>S?(T=this._clip.x/this._clip.height*p.height,B=this._clip.y/this._clip.height*p.height):(T=this._clip.x/this._clip.width*p.width,B=this._clip.y/this._clip.width*p.width)),p.getAspectRatio()>S){var V=p.height/q,G=0;x.isHorizontallyCentered?G=(p.width-p.height*S)/2:x.isRight&&(G=p.width-p.height*S),this.setPosition(new i.Point(p.x-T+G,p.y-B),y),this.setHeight(V,y)}else{var te=p.width/L,se=0;x.isVerticallyCentered?se=(p.height-p.width/S)/2:x.isBottom&&(se=p.height-p.width/S),this.setPosition(new i.Point(p.x-T,p.y-B+se),y),this.setWidth(te,y)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(p){i.console.assert(!p||p instanceof i.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),p instanceof i.Rect?this._clip=p.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getFlip:function(){return!!this.flipped},setFlip:function(p){this.flipped=!!p,this._needsDraw=!0,this._raiseBoundsChange()},getOpacity:function(){return this.opacity},setOpacity:function(p){p!==this.opacity&&(this.opacity=p,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(p){this._preload=!!p,this._needsDraw=!0},getRotation:function(p){return p?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(p,m){this._degreesSpring.target.value===p&&this._degreesSpring.isAtTargetValue()||(m?this._degreesSpring.resetTo(p):this._degreesSpring.springTo(p),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(p){return this.getBoundsNoRotate(p).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(p){p!==this.compositeOperation&&(this.compositeOperation=p,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},setAjaxHeaders:function(p,m){if(p===null&&(p={}),!i.isPlainObject(p)){console.error("[TiledImage.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}this._ownAjaxHeaders=p,this._updateAjaxHeaders(m)},_updateAjaxHeaders:function(p){if(p===void 0&&(p=!0),i.isPlainObject(this.viewer.ajaxHeaders)?this.ajaxHeaders=i.extend({},this.viewer.ajaxHeaders,this._ownAjaxHeaders):this.ajaxHeaders=this._ownAjaxHeaders,p){var m,y,x,S;for(var T in this.tilesMatrix){m=this.source.getNumTiles(T);for(var B in this.tilesMatrix[T]){y=(m.x+B%m.x)%m.x;for(var L in this.tilesMatrix[T][B])if(x=(m.y+L%m.y)%m.y,S=this.tilesMatrix[T][B][L],S.loadWithAjax=this.loadTilesWithAjax,S.loadWithAjax){var q=this.source.getTileAjaxHeaders(T,y,x);S.ajaxHeaders=i.extend({},this.ajaxHeaders,q)}else S.ajaxHeaders=null}}for(var V=0;V<this._imageLoader.jobQueue.length;V++){var G=this._imageLoader.jobQueue[V];G.loadWithAjax=G.tile.loadWithAjax,G.ajaxHeaders=G.tile.loadWithAjax?G.tile.ajaxHeaders:null}}},_setScale:function(p,m){var y=this._scaleSpring.target.value===p;if(m){if(y&&this._scaleSpring.current.value===p)return;this._scaleSpring.resetTo(p),this._updateForScale(),this._needsDraw=!0}else{if(y)return;this._scaleSpring.springTo(p),this._updateForScale(),this._needsDraw=!0}y||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var p=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),m=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,y=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(m/this.minPixelRatio)/Math.log(2))));return y=Math.max(y,this.source.minLevel||0),p=Math.min(p,y),{lowestLevel:p,highestLevel:y}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){var p=this.lastDrawn.pop();p.beingDrawn=!1}var m=this.viewport,y=this._viewportToTiledImageRectangle(m.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var x=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(y=y.intersection(x),y===null)return}for(var S=this._getLevelsInterval(),T=S.lowestLevel,B=S.highestLevel,L=null,q=!1,V=i.now(),G=B;G>=T;G--){var te=!1,se=m.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(G),!0).x*this._scaleSpring.current.value;if(G===T||!q&&se>=this.minPixelRatio)te=!0,q=!0;else if(!q)continue;var Te=m.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(G),!1).x*this._scaleSpring.current.value,Ie=m.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,Ce=this.immediateRender?1:Ie,Ne=Math.min(1,(se-.5)/.5),je=Ce/Math.abs(Ce-Te);if(L=this._updateLevel(q,te,G,Ne,je,y,V,L),this._providesCoverage(this.coverage,G))break}this._drawTiles(this.lastDrawn),L&&!L.context2D?(this._loadTile(L,V),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(this._tilesLoading===0)},_getCornerTiles:function(p,m,y){var x,S;this.wrapHorizontal?(x=i.positiveModulo(m.x,1),S=i.positiveModulo(y.x,1)):(x=Math.max(0,m.x),S=Math.min(1,y.x));var T,B,L=1/this.source.aspectRatio;this.wrapVertical?(T=i.positiveModulo(m.y,L),B=i.positiveModulo(y.y,L)):(T=Math.max(0,m.y),B=Math.min(L,y.y));var q=this.source.getTileAtPoint(p,new i.Point(x,T)),V=this.source.getTileAtPoint(p,new i.Point(S,B)),G=this.source.getNumTiles(p);return this.wrapHorizontal&&(q.x+=G.x*Math.floor(m.x),V.x+=G.x*Math.floor(y.x)),this.wrapVertical&&(q.y+=G.y*Math.floor(m.y/L),V.y+=G.y*Math.floor(y.y/L)),{topLeft:q,bottomRight:V}},_updateLevel:function(p,m,y,x,S,T,B,L){var q=T.getBoundingBox().getTopLeft(),V=T.getBoundingBox().getBottomRight();this.viewer&&this.viewer.raiseEvent("update-level",{tiledImage:this,havedrawn:p,level:y,opacity:x,visibility:S,drawArea:T,topleft:q,bottomright:V,currenttime:B,best:L}),this._resetCoverage(this.coverage,y),this._resetCoverage(this.loadingCoverage,y);var G=this._getCornerTiles(y,q,V),te=G.topLeft,se=G.bottomRight,Te=this.source.getNumTiles(y),Ie=this.viewport.pixelFromPoint(this.viewport.getCenter());this.getFlip()&&(se.x+=1,this.wrapHorizontal||(se.x=Math.min(se.x,Te.x-1)));for(var Ce=te.x;Ce<=se.x;Ce++)for(var Ne=te.y;Ne<=se.y;Ne++){var je;if(this.getFlip()){var ot=(Te.x+Ce%Te.x)%Te.x;je=Ce+Te.x-ot-ot-1}else je=Ce;T.intersection(this.getTileBounds(y,je,Ne))!==null&&(L=this._updateTile(m,p,je,Ne,y,x,S,Ie,Te,B,L))}return L},_updateTile:function(p,m,y,x,S,T,B,L,q,V,G){var te=this._getTile(y,x,S,V,q,this._worldWidthCurrent,this._worldHeightCurrent),se=m;this.viewer&&this.viewer.raiseEvent("update-tile",{tiledImage:this,tile:te}),this._setCoverage(this.coverage,S,y,x,!1);var Te=te.loaded||te.loading||this._isCovered(this.loadingCoverage,S,y,x);if(this._setCoverage(this.loadingCoverage,S,y,x,Te),!te.exists||(p&&!se&&(this._isCovered(this.coverage,S,y,x)?this._setCoverage(this.coverage,S,y,x,!0):se=!0),!se))return G;if(this._positionTile(te,this.source.tileOverlap,this.viewport,L,B),!te.loaded)if(te.context2D)this._setTileLoaded(te);else{var Ie=this._tileCache.getImageRecord(te.cacheKey);Ie&&this._setTileLoaded(te,Ie.getData())}if(te.loaded){var Ce=this._blendTile(te,y,x,S,T,V);Ce&&(this._needsDraw=!0)}else te.loading?this._tilesLoading++:Te||(G=this._compareTiles(G,te));return G},_getTile:function(p,m,y,x,S,T,B){var L,q,V,G,te,se,Te,Ie,Ce,Ne,je=this.tilesMatrix,ot=this.source;return je[y]||(je[y]={}),je[y][p]||(je[y][p]={}),(!je[y][p][m]||!je[y][p][m].flipped!=!this.flipped)&&(L=(S.x+p%S.x)%S.x,q=(S.y+m%S.y)%S.y,V=this.getTileBounds(y,p,m),G=ot.getTileBounds(y,L,q,!0),te=ot.tileExists(y,L,q),se=ot.getTileUrl(y,L,q),Te=ot.getTilePostData(y,L,q),this.loadTilesWithAjax?(Ie=ot.getTileAjaxHeaders(y,L,q),i.isPlainObject(this.ajaxHeaders)&&(Ie=i.extend({},this.ajaxHeaders,Ie))):Ie=null,Ce=ot.getContext2D?ot.getContext2D(y,L,q):void 0,Ne=new i.Tile(y,p,m,V,te,se,Ce,this.loadTilesWithAjax,Ie,G,Te,ot.getTileHashKey(y,L,q,se,Ie,Te)),this.getFlip()?L===0&&(Ne.isRightMost=!0):L===S.x-1&&(Ne.isRightMost=!0),q===S.y-1&&(Ne.isBottomMost=!0),Ne.flipped=this.flipped,je[y][p][m]=Ne),Ne=je[y][p][m],Ne.lastTouchTime=x,Ne},_loadTile:function(p,m){var y=this;p.loading=!0,this._imageLoader.addJob({src:p.getUrl(),tile:p,source:this.source,postData:p.postData,loadWithAjax:p.loadWithAjax,ajaxHeaders:p.ajaxHeaders,crossOriginPolicy:this.crossOriginPolicy,ajaxWithCredentials:this.ajaxWithCredentials,callback:function(x,S,T){y._onTileLoad(p,m,x,S,T)},abort:function(){p.loading=!1}})},_onTileLoad:function(p,m,y,x,S){if(y)p.exists=!0;else{i.console.error("Tile %s failed to load: %s - error: %s",p,p.getUrl(),x),this.viewer.raiseEvent("tile-load-failed",{tile:p,tiledImage:this,time:m,message:x,tileRequest:S}),p.loading=!1,p.exists=!1;return}if(m<this.lastResetTime){i.console.warn("Ignoring tile %s loaded before reset: %s",p,p.getUrl()),p.loading=!1;return}var T=this,B=function(){var L=T.source,q=L.getClosestLevel();T._setTileLoaded(p,y,q,S)};this._midDraw?window.setTimeout(B,1):B()},_setTileLoaded:function(p,m,y,x){var S=0,T=!1,B=this;function L(){return T&&i.console.error("Event 'tile-loaded' argument getCompletionCallback must be called synchronously. Its return value should be called asynchronously."),S++,q}function q(){S--,S===0&&(p.loading=!1,p.loaded=!0,p.hasTransparency=B.source.hasTransparency(p.context2D,p.getUrl(),p.ajaxHeaders,p.postData),p.context2D||B._tileCache.cacheTile({data:m,tile:p,cutoff:y,tiledImage:B}),B._needsDraw=!0)}var V=L();this.viewer.raiseEvent("tile-loaded",{tile:p,tiledImage:this,tileRequest:x,get image(){return i.console.error("[tile-loaded] event 'image' has been deprecated. Use 'data' property instead."),m},data:m,getCompletionCallback:L}),T=!0,V()},_positionTile:function(p,m,y,x,S){var T=p.bounds.getTopLeft();T.x*=this._scaleSpring.current.value,T.y*=this._scaleSpring.current.value,T.x+=this._xSpring.current.value,T.y+=this._ySpring.current.value;var B=p.bounds.getSize();B.x*=this._scaleSpring.current.value,B.y*=this._scaleSpring.current.value;var L=y.pixelFromPointNoRotate(T,!0),q=y.pixelFromPointNoRotate(T,!1),V=y.deltaPixelsFromPointsNoRotate(B,!0),G=y.deltaPixelsFromPointsNoRotate(B,!1),te=q.plus(G.divide(2)),se=x.squaredDistanceTo(te);m||(V=V.plus(new i.Point(1,1))),p.isRightMost&&this.wrapHorizontal&&(V.x+=.75),p.isBottomMost&&this.wrapVertical&&(V.y+=.75),p.position=L,p.size=V,p.squaredDistance=se,p.visibility=S},_blendTile:function(p,m,y,x,S,T){var B=1e3*this.blendTime,L,q;if(p.blendStart||(p.blendStart=T),L=T-p.blendStart,q=B?Math.min(1,L/B):1,this.alwaysBlend&&(q*=S),p.opacity=q,this.lastDrawn.push(p),q===1)this._setCoverage(this.coverage,x,m,y,!0),this._hasOpaqueTile=!0;else if(L<B)return!0;return!1},_compareTiles:function(p,m){return!p||m.visibility>p.visibility||m.visibility===p.visibility&&m.squaredDistance<p.squaredDistance?m:p},_drawTiles:function(p){if(!(this.opacity===0||p.length===0&&!this.placeholderFillStyle)){var m=p[0],y;m&&(y=this.opacity<1||this.compositeOperation&&this.compositeOperation!=="source-over"||!this._isBottomItem()&&this.source.hasTransparency(m.context2D,m.getUrl(),m.ajaxHeaders,m.postData));var x,S,T=this.viewport.getZoom(!0),B=this.viewportToImageZoom(T);p.length>1&&B>this.smoothTileEdgesMinZoom&&!this.iOSDevice&&this.getRotation(!0)%360===0&&i.supportsCanvas&&this.viewer.useCanvas&&(y=!0,x=m.getScaleForEdgeSmoothing(),S=m.getTranslationForEdgeSmoothing(x,this._drawer.getCanvasSize(!1),this._drawer.getCanvasSize(!0)));var L;y&&(x||(L=this.viewport.viewportToViewerElementRectangle(this.getClippedBounds(!0)).getIntegerBoundingBox(),this._drawer.viewer.viewport.getFlip()&&(this.viewport.getRotation(!0)%360!==0||this.getRotation(!0)%360!==0)&&(L.x=this._drawer.viewer.container.clientWidth-(L.x+L.width)),L=L.times(i.pixelDensityRatio)),this._drawer._clear(!0,L)),x||(this.viewport.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:y}),this.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:y}),this.viewport.getRotation(!0)%360===0&&this.getRotation(!0)%360===0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip());var q=!1;if(this._clip){this._drawer.saveContext(y);var V=this.imageToViewportRectangle(this._clip,!0);V=V.rotate(-this.getRotation(!0),this._getRotationPoint(!0));var G=this._drawer.viewportToDrawerRectangle(V);x&&(G=G.times(x)),S&&(G=G.translate(S)),this._drawer.setClip(G,y),q=!0}if(this._croppingPolygons){var te=this;this._drawer.saveContext(y);try{var se=this._croppingPolygons.map(function(at){return at.map(function(vt){var Ct=te.imageToViewportCoordinates(vt.x,vt.y,!0).rotate(-te.getRotation(!0),te._getRotationPoint(!0)),Rt=te._drawer.viewportCoordToDrawerCoord(Ct);return x&&(Rt=Rt.times(x)),S&&(Rt=Rt.plus(S)),Rt})});this._drawer.clipWithPolygons(se,y)}catch(at){i.console.error(at)}q=!0}if(this.placeholderFillStyle&&this._hasOpaqueTile===!1){var Te=this._drawer.viewportToDrawerRectangle(this.getBounds(!0));x&&(Te=Te.times(x)),S&&(Te=Te.translate(S));var Ie=null;typeof this.placeholderFillStyle=="function"?Ie=this.placeholderFillStyle(this,this._drawer.context):Ie=this.placeholderFillStyle,this._drawer.drawRectangle(Te,Ie,y)}var Ce=w(this.subPixelRoundingForTransparency),Ne=!1;if(Ce===i.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS)Ne=!0;else if(Ce===i.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST){var je=this.viewer&&this.viewer.isAnimating();Ne=!je}for(var ot=p.length-1;ot>=0;ot--)m=p[ot],this._drawer.drawTile(m,this._drawingHandler,y,x,S,Ne,this.source),m.beingDrawn=!0,this.viewer&&this.viewer.raiseEvent("tile-drawn",{tiledImage:this,tile:m});q&&this._drawer.restoreContext(y),x||(this.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(y),this.viewport.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(y)),y&&(x&&(this.viewport.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:!1}),this.getRotation(!0)%360!==0&&this._drawer._offsetForRotation({degrees:this.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(this._getRotationPoint(!0),!0),useSketch:!1})),this._drawer.blendSketch({opacity:this.opacity,scale:x,translate:S,compositeOperation:this.compositeOperation,bounds:L}),x&&(this.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(!1),this.viewport.getRotation(!0)%360!==0&&this._drawer._restoreRotationChanges(!1))),x||this.viewport.getRotation(!0)%360===0&&this.getRotation(!0)%360===0&&this._drawer.viewer.viewport.getFlip()&&this._drawer._flip(),this._drawDebugInfo(p)}},_drawDebugInfo:function(p){if(this.debugMode)for(var m=p.length-1;m>=0;m--){var y=p[m];try{this._drawer.drawDebugInfo(y,p.length,m,this)}catch(x){i.console.error(x)}}},_providesCoverage:function(p,m,y,x){var S,T,B,L;if(!p[m])return!1;if(y===void 0||x===void 0){S=p[m];for(B in S)if(Object.prototype.hasOwnProperty.call(S,B)){T=S[B];for(L in T)if(Object.prototype.hasOwnProperty.call(T,L)&&!T[L])return!1}return!0}return p[m][y]===void 0||p[m][y][x]===void 0||p[m][y][x]===!0},_isCovered:function(p,m,y,x){return y===void 0||x===void 0?this._providesCoverage(p,m+1):this._providesCoverage(p,m+1,2*y,2*x)&&this._providesCoverage(p,m+1,2*y,2*x+1)&&this._providesCoverage(p,m+1,2*y+1,2*x)&&this._providesCoverage(p,m+1,2*y+1,2*x+1)},_setCoverage:function(p,m,y,x,S){if(!p[m]){i.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",m);return}p[m][y]||(p[m][y]={}),p[m][y][x]=S},_resetCoverage:function(p,m){p[m]={}}});var a=i.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER;function u(p){return p!==i.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS&&p!==i.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST&&p!==i.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER}function d(p){return u(p)?a:p}function w(p){if(typeof p=="number")return d(p);if(!p||!i.Browser)return a;var m=p[i.Browser.vendor];return u(m)&&(m=p["*"]),d(m)}}(c),function(i){var a=function(d){i.console.assert(d,"[TileCache.cacheTile] options is required"),i.console.assert(d.tile,"[TileCache.cacheTile] options.tile is required"),i.console.assert(d.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=d.tile,this.tiledImage=d.tiledImage},u=function(d){i.console.assert(d,"[ImageRecord] options is required"),i.console.assert(d.data,"[ImageRecord] options.data is required"),this._tiles=[],d.create.apply(null,[this,d.data,d.ownerTile]),this._destroyImplementation=d.destroy.bind(null,this),this.getImage=d.getImage.bind(null,this),this.getData=d.getData.bind(null,this),this.getRenderedContext=d.getRenderedContext.bind(null,this)};u.prototype={destroy:function(){this._destroyImplementation(),this._tiles=null},addTile:function(d){i.console.assert(d,"[ImageRecord.addTile] tile is required"),this._tiles.push(d)},removeTile:function(d){for(var w=0;w<this._tiles.length;w++)if(this._tiles[w]===d){this._tiles.splice(w,1);return}i.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",d)},getTileCount:function(){return this._tiles.length}},i.TileCache=function(d){d=d||{},this._maxImageCacheCount=d.maxImageCacheCount||i.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},i.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(d){i.console.assert(d,"[TileCache.cacheTile] options is required"),i.console.assert(d.tile,"[TileCache.cacheTile] options.tile is required"),i.console.assert(d.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),i.console.assert(d.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var w=d.cutoff||0,p=this._tilesLoaded.length,m=this._imagesLoaded[d.tile.cacheKey];if(m||(d.data||(i.console.error("[TileCache.cacheTile] options.image was renamed to options.data. '.image' attribute has been deprecated and will be removed in the future."),d.data=d.image),i.console.assert(d.data,"[TileCache.cacheTile] options.data is required to create an ImageRecord"),m=this._imagesLoaded[d.tile.cacheKey]=new u({data:d.data,ownerTile:d.tile,create:d.tiledImage.source.createTileCache,destroy:d.tiledImage.source.destroyTileCache,getImage:d.tiledImage.source.getTileCacheDataAsImage,getData:d.tiledImage.source.getTileCacheData,getRenderedContext:d.tiledImage.source.getTileCacheDataAsContext2D}),this._imagesLoadedCount++),m.addTile(d.tile),d.tile.cacheImageRecord=m,this._imagesLoadedCount>this._maxImageCacheCount){for(var y=null,x=-1,S=null,T,B,L,q,V,G,te=this._tilesLoaded.length-1;te>=0;te--)if(G=this._tilesLoaded[te],T=G.tile,!(T.level<=w||T.beingDrawn)){if(!y){y=T,x=te,S=G;continue}q=T.lastTouchTime,B=y.lastTouchTime,V=T.level,L=y.level,(q<B||q===B&&V>L)&&(y=T,x=te,S=G)}y&&x>=0&&(this._unloadTile(S),p=x)}this._tilesLoaded[p]=new a({tile:d.tile,tiledImage:d.tiledImage})},clearTilesFor:function(d){i.console.assert(d,"[TileCache.clearTilesFor] tiledImage is required");for(var w,p=0;p<this._tilesLoaded.length;++p)w=this._tilesLoaded[p],w.tiledImage===d&&(this._unloadTile(w),this._tilesLoaded.splice(p,1),p--)},getImageRecord:function(d){return i.console.assert(d,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[d]},_unloadTile:function(d){i.console.assert(d,"[TileCache._unloadTile] tileRecord is required");var w=d.tile,p=d.tiledImage;w.unload(),w.cacheImageRecord=null;var m=this._imagesLoaded[w.cacheKey];m.removeTile(w),m.getTileCount()||(m.destroy(),delete this._imagesLoaded[w.cacheKey],this._imagesLoadedCount--),p.viewer.raiseEvent("tile-unloaded",{tile:w,tiledImage:p})}}}(c),function(i){i.World=function(a){var u=this;i.console.assert(a.viewer,"[World] options.viewer is required"),i.EventSource.call(this),this.viewer=a.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(d){u._autoRefigureSizes?u._figureSizes():u._needsSizesFigured=!0},this._figureSizes()},i.extend(i.World.prototype,i.EventSource.prototype,{addItem:function(a,u){if(i.console.assert(a,"[World.addItem] item is required"),i.console.assert(a instanceof i.TiledImage,"[World.addItem] only TiledImages supported at this time"),u=u||{},u.index!==void 0){var d=Math.max(0,Math.min(this._items.length,u.index));this._items.splice(d,0,a)}else this._items.push(a);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,a.addHandler("bounds-change",this._delegatedFigureSizes),a.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:a})},getItemAt:function(a){return i.console.assert(a!==void 0,"[World.getItemAt] index is required"),this._items[a]},getIndexOfItem:function(a){return i.console.assert(a,"[World.getIndexOfItem] item is required"),i.indexOf(this._items,a)},getItemCount:function(){return this._items.length},setItemIndex:function(a,u){i.console.assert(a,"[World.setItemIndex] item is required"),i.console.assert(u!==void 0,"[World.setItemIndex] index is required");var d=this.getIndexOfItem(a);if(u>=this._items.length)throw new Error("Index bigger than number of layers.");u===d||d===-1||(this._items.splice(d,1),this._items.splice(u,0,a),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:a,previousIndex:d,newIndex:u}))},removeItem:function(a){i.console.assert(a,"[World.removeItem] item is required");var u=i.indexOf(this._items,a);u!==-1&&(a.removeHandler("bounds-change",this._delegatedFigureSizes),a.removeHandler("clip-change",this._delegatedFigureSizes),a.destroy(),this._items.splice(u,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(a))},removeAll:function(){this.viewer._cancelPendingImages();var a,u;for(u=0;u<this._items.length;u++)a=this._items[u],a.removeHandler("bounds-change",this._delegatedFigureSizes),a.removeHandler("clip-change",this._delegatedFigureSizes),a.destroy();var d=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,u=0;u<d.length;u++)a=d[u],this._raiseRemoveItem(a)},resetItems:function(){for(var a=0;a<this._items.length;a++)this._items[a].reset()},update:function(){for(var a=!1,u=0;u<this._items.length;u++)a=this._items[u].update()||a;return a},draw:function(){for(var a=0;a<this._items.length;a++)this._items[a].draw();this._needsDraw=!1},needsDraw:function(){for(var a=0;a<this._items.length;a++)if(this._items[a].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(a){this._autoRefigureSizes=a,a&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(a){a=a||{};var u=a.immediately||!1,d=a.layout||i.DEFAULT_SETTINGS.collectionLayout,w=a.rows||i.DEFAULT_SETTINGS.collectionRows,p=a.columns||i.DEFAULT_SETTINGS.collectionColumns,m=a.tileSize||i.DEFAULT_SETTINGS.collectionTileSize,y=a.tileMargin||i.DEFAULT_SETTINGS.collectionTileMargin,x=m+y,S;!a.rows&&p?S=p:S=Math.ceil(this._items.length/w);var T=0,B=0,L,q,V,G,te;this.setAutoRefigureSizes(!1);for(var se=0;se<this._items.length;se++)se&&se%S===0&&(d==="horizontal"?(B+=x,T=0):(T+=x,B=0)),L=this._items[se],q=L.getBounds(),q.width>q.height?V=m:V=m*(q.width/q.height),G=V*(q.height/q.width),te=new i.Point(T+(m-V)/2,B+(m-G)/2),L.setPosition(te,u),L.setWidth(V,u),d==="horizontal"?T+=x:B+=x;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var a=this._homeBounds?this._homeBounds.clone():null,u=this._contentSize?this._contentSize.clone():null,d=this._contentFactor||0;if(!this._items.length)this._homeBounds=new i.Rect(0,0,1,1),this._contentSize=new i.Point(1,1),this._contentFactor=1;else{var w=this._items[0],p=w.getBounds();this._contentFactor=w.getContentSize().x/p.width;for(var m=w.getClippedBounds().getBoundingBox(),y=m.x,x=m.y,S=m.x+m.width,T=m.y+m.height,B=1;B<this._items.length;B++)w=this._items[B],p=w.getBounds(),this._contentFactor=Math.max(this._contentFactor,w.getContentSize().x/p.width),m=w.getClippedBounds().getBoundingBox(),y=Math.min(y,m.x),x=Math.min(x,m.y),S=Math.max(S,m.x+m.width),T=Math.max(T,m.y+m.height);this._homeBounds=new i.Rect(y,x,S-y,T-x),this._contentSize=new i.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}(this._contentFactor!==d||!this._homeBounds.equals(a)||!this._contentSize.equals(u))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(a){this.raiseEvent("remove-item",{item:a})}})}(c)})(ov);var yO=ov.exports;const wO=vO(yO),EO=function(s,c){return c()}(void 0,function(){var s=Object.defineProperty,c=(t,r,e)=>r in t?s(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,i=(t,r,e)=>(c(t,typeof r!="symbol"?r+"":r,e),e),a,u,d,w,p,m,y,x={},S=[],T=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function B(t,r){for(var e in r)t[e]=r[e];return t}function L(t){var r=t.parentNode;r&&r.removeChild(t)}function q(t,r,e){var n,o,l,h={};for(l in r)l=="key"?n=r[l]:l=="ref"?o=r[l]:h[l]=r[l];if(arguments.length>2&&(h.children=arguments.length>3?a.call(arguments,2):e),typeof t=="function"&&t.defaultProps!=null)for(l in t.defaultProps)h[l]===void 0&&(h[l]=t.defaultProps[l]);return V(t,h,n,o,null)}function V(t,r,e,n,o){var l={type:t,props:r,key:e,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:o??++d};return o==null&&u.vnode!=null&&u.vnode(l),l}function G(){return{current:null}}function te(t){return t.children}function se(t,r){this.props=t,this.context=r}function Te(t,r){if(r==null)return t.__?Te(t.__,t.__.__k.indexOf(t)+1):null;for(var e;r<t.__k.length;r++)if((e=t.__k[r])!=null&&e.__e!=null)return e.__e;return typeof t.type=="function"?Te(t):null}function Ie(t){var r,e;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,r=0;r<t.__k.length;r++)if((e=t.__k[r])!=null&&e.__e!=null){t.__e=t.__c.base=e.__e;break}return Ie(t)}}function Ce(t){(!t.__d&&(t.__d=!0)&&w.push(t)&&!Ne.__r++||m!==u.debounceRendering)&&((m=u.debounceRendering)||p)(Ne)}function Ne(){for(var t;Ne.__r=w.length;)t=w.sort(function(r,e){return r.__v.__b-e.__v.__b}),w=[],t.some(function(r){var e,n,o,l,h,f;r.__d&&(h=(l=(e=r).__v).__e,(f=e.__P)&&(n=[],(o=B({},l)).__v=l.__v+1,nt(f,l,o,e.__n,f.ownerSVGElement!==void 0,l.__h!=null?[h]:null,n,h??Te(l),l.__h),it(n,l),l.__e!=h&&Ie(l)))})}function je(t,r,e,n,o,l,h,f,g,v){var E,_,C,k,I,X,U,$=n&&n.__k||S,P=$.length;for(e.__k=[],E=0;E<r.length;E++)if((k=e.__k[E]=(k=r[E])==null||typeof k=="boolean"?null:typeof k=="string"||typeof k=="number"||typeof k=="bigint"?V(null,k,null,null,k):Array.isArray(k)?V(te,{children:k},null,null,null):k.__b>0?V(k.type,k.props,k.key,null,k.__v):k)!=null){if(k.__=e,k.__b=e.__b+1,(C=$[E])===null||C&&k.key==C.key&&k.type===C.type)$[E]=void 0;else for(_=0;_<P;_++){if((C=$[_])&&k.key==C.key&&k.type===C.type){$[_]=void 0;break}C=null}nt(t,k,C=C||x,o,l,h,f,g,v),I=k.__e,(_=k.ref)&&C.ref!=_&&(U||(U=[]),C.ref&&U.push(C.ref,null,k),U.push(_,k.__c||I,k)),I!=null?(X==null&&(X=I),typeof k.type=="function"&&k.__k===C.__k?k.__d=g=ot(k,g,t):g=vt(t,k,C,$,I,g),typeof e.type=="function"&&(e.__d=g)):g&&C.__e==g&&g.parentNode!=t&&(g=Te(C))}for(e.__e=X,E=P;E--;)$[E]!=null&&(typeof e.type=="function"&&$[E].__e!=null&&$[E].__e==e.__d&&(e.__d=Te(n,E+1)),Yt($[E],$[E]));if(U)for(E=0;E<U.length;E++)Ht(U[E],U[++E],U[++E])}function ot(t,r,e){for(var n,o=t.__k,l=0;o&&l<o.length;l++)(n=o[l])&&(n.__=t,r=typeof n.type=="function"?ot(n,r,e):vt(e,n,n,o,n.__e,r));return r}function at(t,r){return r=r||[],t==null||typeof t=="boolean"||(Array.isArray(t)?t.some(function(e){at(e,r)}):r.push(t)),r}function vt(t,r,e,n,o,l){var h,f,g;if(r.__d!==void 0)h=r.__d,r.__d=void 0;else if(e==null||o!=l||o.parentNode==null)e:if(l==null||l.parentNode!==t)t.appendChild(o),h=null;else{for(f=l,g=0;(f=f.nextSibling)&&g<n.length;g+=2)if(f==o)break e;t.insertBefore(o,l),h=l}return h!==void 0?h:o.nextSibling}function Ct(t,r,e,n,o){var l;for(l in e)l==="children"||l==="key"||l in r||Lt(t,l,null,e[l],n);for(l in r)o&&typeof r[l]!="function"||l==="children"||l==="key"||l==="value"||l==="checked"||e[l]===r[l]||Lt(t,l,r[l],e[l],n)}function Rt(t,r,e){r[0]==="-"?t.setProperty(r,e):t[r]=e==null?"":typeof e!="number"||T.test(r)?e:e+"px"}function Lt(t,r,e,n,o){var l;e:if(r==="style")if(typeof e=="string")t.style.cssText=e;else{if(typeof n=="string"&&(t.style.cssText=n=""),n)for(r in n)e&&r in e||Rt(t.style,r,"");if(e)for(r in e)n&&e[r]===n[r]||Rt(t.style,r,e[r])}else if(r[0]==="o"&&r[1]==="n")l=r!==(r=r.replace(/Capture$/,"")),r=r.toLowerCase()in t?r.toLowerCase().slice(2):r.slice(2),t.l||(t.l={}),t.l[r+l]=e,e?n||t.addEventListener(r,l?ft:ln,l):t.removeEventListener(r,l?ft:ln,l);else if(r!=="dangerouslySetInnerHTML"){if(o)r=r.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(r!=="href"&&r!=="list"&&r!=="form"&&r!=="tabIndex"&&r!=="download"&&r in t)try{t[r]=e??"";break e}catch{}typeof e=="function"||(e!=null&&(e!==!1||r[0]==="a"&&r[1]==="r")?t.setAttribute(r,e):t.removeAttribute(r))}}function ln(t){this.l[t.type+!1](u.event?u.event(t):t)}function ft(t){this.l[t.type+!0](u.event?u.event(t):t)}function nt(t,r,e,n,o,l,h,f,g){var v,E,_,C,k,I,X,U,$,P,N,J=r.type;if(r.constructor!==void 0)return null;e.__h!=null&&(g=e.__h,f=r.__e=e.__e,r.__h=null,l=[f]),(v=u.__b)&&v(r);try{e:if(typeof J=="function"){if(U=r.props,$=(v=J.contextType)&&n[v.__c],P=v?$?$.props.value:v.__:n,e.__c?X=(E=r.__c=e.__c).__=E.__E:("prototype"in J&&J.prototype.render?r.__c=E=new J(U,P):(r.__c=E=new se(U,P),E.constructor=J,E.render=Nt),$&&$.sub(E),E.props=U,E.state||(E.state={}),E.context=P,E.__n=n,_=E.__d=!0,E.__h=[]),E.__s==null&&(E.__s=E.state),J.getDerivedStateFromProps!=null&&(E.__s==E.state&&(E.__s=B({},E.__s)),B(E.__s,J.getDerivedStateFromProps(U,E.__s))),C=E.props,k=E.state,_)J.getDerivedStateFromProps==null&&E.componentWillMount!=null&&E.componentWillMount(),E.componentDidMount!=null&&E.__h.push(E.componentDidMount);else{if(J.getDerivedStateFromProps==null&&U!==C&&E.componentWillReceiveProps!=null&&E.componentWillReceiveProps(U,P),!E.__e&&E.shouldComponentUpdate!=null&&E.shouldComponentUpdate(U,E.__s,P)===!1||r.__v===e.__v){E.props=U,E.state=E.__s,r.__v!==e.__v&&(E.__d=!1),E.__v=r,r.__e=e.__e,r.__k=e.__k,r.__k.forEach(function(K){K&&(K.__=r)}),E.__h.length&&h.push(E);break e}E.componentWillUpdate!=null&&E.componentWillUpdate(U,E.__s,P),E.componentDidUpdate!=null&&E.__h.push(function(){E.componentDidUpdate(C,k,I)})}E.context=P,E.props=U,E.state=E.__s,(v=u.__r)&&v(r),E.__d=!1,E.__v=r,E.__P=t,v=E.render(E.props,E.state,E.context),E.state=E.__s,E.getChildContext!=null&&(n=B(B({},n),E.getChildContext())),_||E.getSnapshotBeforeUpdate==null||(I=E.getSnapshotBeforeUpdate(C,k)),N=v!=null&&v.type===te&&v.key==null?v.props.children:v,je(t,Array.isArray(N)?N:[N],r,e,n,o,l,h,f,g),E.base=r.__e,r.__h=null,E.__h.length&&h.push(E),X&&(E.__E=E.__=null),E.__e=!1}else l==null&&r.__v===e.__v?(r.__k=e.__k,r.__e=e.__e):r.__e=jt(e.__e,r,e,n,o,l,h,g);(v=u.diffed)&&v(r)}catch(K){r.__v=null,(g||l!=null)&&(r.__e=f,r.__h=!!g,l[l.indexOf(f)]=null),u.__e(K,r,e)}}function it(t,r){u.__c&&u.__c(r,t),t.some(function(e){try{t=e.__h,e.__h=[],t.some(function(n){n.call(e)})}catch(n){u.__e(n,e.__v)}})}function jt(t,r,e,n,o,l,h,f){var g,v,E,_=e.props,C=r.props,k=r.type,I=0;if(k==="svg"&&(o=!0),l!=null){for(;I<l.length;I++)if((g=l[I])&&"setAttribute"in g==!!k&&(k?g.localName===k:g.nodeType===3)){t=g,l[I]=null;break}}if(t==null){if(k===null)return document.createTextNode(C);t=o?document.createElementNS("http://www.w3.org/2000/svg",k):document.createElement(k,C.is&&C),l=null,f=!1}if(k===null)_===C||f&&t.data===C||(t.data=C);else{if(l=l&&a.call(t.childNodes),v=(_=e.props||x).dangerouslySetInnerHTML,E=C.dangerouslySetInnerHTML,!f){if(l!=null)for(_={},I=0;I<t.attributes.length;I++)_[t.attributes[I].name]=t.attributes[I].value;(E||v)&&(E&&(v&&E.__html==v.__html||E.__html===t.innerHTML)||(t.innerHTML=E&&E.__html||""))}if(Ct(t,C,_,o,f),E)r.__k=[];else if(I=r.props.children,je(t,Array.isArray(I)?I:[I],r,e,n,o&&k!=="foreignObject",l,h,l?l[0]:e.__k&&Te(e,0),f),l!=null)for(I=l.length;I--;)l[I]!=null&&L(l[I]);f||("value"in C&&(I=C.value)!==void 0&&(I!==_.value||I!==t.value||k==="progress"&&!I)&&Lt(t,"value",I,_.value,!1),"checked"in C&&(I=C.checked)!==void 0&&I!==t.checked&&Lt(t,"checked",I,_.checked,!1))}return t}function Ht(t,r,e){try{typeof t=="function"?t(r):t.current=r}catch(n){u.__e(n,e)}}function Yt(t,r,e){var n,o;if(u.unmount&&u.unmount(t),(n=t.ref)&&(n.current&&n.current!==t.__e||Ht(n,null,r)),(n=t.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(l){u.__e(l,r)}n.base=n.__P=null}if(n=t.__k)for(o=0;o<n.length;o++)n[o]&&Yt(n[o],r,typeof t.type!="function");e||t.__e==null||L(t.__e),t.__e=t.__d=void 0}function Nt(t,r,e){return this.constructor(t,e)}function We(t,r,e){var n,o,l;u.__&&u.__(t,r),o=(n=typeof e=="function")?null:e&&e.__k||r.__k,l=[],nt(r,t=(!n&&e||r).__k=q(te,null,[t]),o||x,x,r.ownerSVGElement!==void 0,!n&&e?[e]:o?null:r.firstChild?a.call(r.childNodes):null,l,!n&&e?e:o?o.__e:r.firstChild,n),it(l,t)}function hn(t,r){We(t,r,hn)}function Dn(t,r,e){var n,o,l,h=B({},t.props);for(l in r)l=="key"?n=r[l]:l=="ref"?o=r[l]:h[l]=r[l];return arguments.length>2&&(h.children=arguments.length>3?a.call(arguments,2):e),V(t.type,h,n||t.key,o||t.ref,null)}function Pt(t,r){var e={__c:r="__cC"+y++,__:t,Consumer:function(n,o){return n.children(o)},Provider:function(n){var o,l;return this.getChildContext||(o=[],(l={})[r]=this,this.getChildContext=function(){return l},this.shouldComponentUpdate=function(h){this.props.value!==h.value&&o.some(Ce)},this.sub=function(h){o.push(h);var f=h.componentWillUnmount;h.componentWillUnmount=function(){o.splice(o.indexOf(h),1),f&&f.call(h)}}),n.children}};return e.Provider.__=e.Consumer.contextType=e}a=S.slice,u={__e:function(t,r){for(var e,n,o;r=r.__;)if((e=r.__c)&&!e.__)try{if((n=e.constructor)&&n.getDerivedStateFromError!=null&&(e.setState(n.getDerivedStateFromError(t)),o=e.__d),e.componentDidCatch!=null&&(e.componentDidCatch(t),o=e.__d),o)return e.__E=e}catch(l){t=l}throw t}},d=0,se.prototype.setState=function(t,r){var e;e=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=B({},this.state),typeof t=="function"&&(t=t(B({},e),this.props)),t&&B(e,t),t!=null&&this.__v&&(r&&this.__h.push(r),Ce(this))},se.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Ce(this))},se.prototype.render=te,w=[],p=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ne.__r=0,y=0;var pe,_e,Re,ke=0,st=[],yt=u.__b,Z=u.__r,Q=u.diffed,le=u.__c,ge=u.unmount;function b(t,r){u.__h&&u.__h(_e,t,ke||r),ke=0;var e=_e.__H||(_e.__H={__:[],__h:[]});return t>=e.__.length&&e.__.push({}),e.__[t]}function F(t){return ke=1,ee(ye,t)}function ee(t,r,e){var n=b(pe++,2);return n.t=t,n.__c||(n.__=[e?e(r):ye(void 0,r),function(o){var l=n.t(n.__[0],o);n.__[0]!==l&&(n.__=[l,n.__[1]],n.__c.setState({}))}],n.__c=_e),n.__}function ne(t,r){var e=b(pe++,3);!u.__s&&ce(e.__H,r)&&(e.__=t,e.__H=r,_e.__H.__h.push(e))}function re(t,r){var e=b(pe++,4);!u.__s&&ce(e.__H,r)&&(e.__=t,e.__H=r,_e.__h.push(e))}function ae(t){return ke=5,xe(function(){return{current:t}},[])}function ue(t,r,e){ke=6,re(function(){typeof t=="function"?t(r()):t&&(t.current=r())},e==null?e:e.concat(t))}function xe(t,r){var e=b(pe++,7);return ce(e.__H,r)&&(e.__=t(),e.__H=r,e.__h=t),e.__}function Ee(t,r){return ke=8,xe(function(){return t},r)}function Ae(t){var r=_e.context[t.__c],e=b(pe++,9);return e.c=t,r?(e.__==null&&(e.__=!0,r.sub(_e)),r.props.value):t.__}function Pe(t,r){u.useDebugValue&&u.useDebugValue(r?r(t):t)}function Ge(t){var r=b(pe++,10),e=F();return r.__=t,_e.componentDidCatch||(_e.componentDidCatch=function(n){r.__&&r.__(n),e[1](n)}),[e[0],function(){e[1](void 0)}]}function D(){var t;for(st.sort(function(r,e){return r.__v.__b-e.__v.__b});t=st.pop();)if(t.__P)try{t.__H.__h.forEach(H),t.__H.__h.forEach(j),t.__H.__h=[]}catch(r){t.__H.__h=[],u.__e(r,t.__v)}}u.__b=function(t){_e=null,yt&&yt(t)},u.__r=function(t){Z&&Z(t),pe=0;var r=(_e=t.__c).__H;r&&(r.__h.forEach(H),r.__h.forEach(j),r.__h=[])},u.diffed=function(t){Q&&Q(t);var r=t.__c;r&&r.__H&&r.__H.__h.length&&(st.push(r)!==1&&Re===u.requestAnimationFrame||((Re=u.requestAnimationFrame)||function(e){var n,o=function(){clearTimeout(l),A&&cancelAnimationFrame(n),setTimeout(e)},l=setTimeout(o,100);A&&(n=requestAnimationFrame(o))})(D)),_e=null},u.__c=function(t,r){r.some(function(e){try{e.__h.forEach(H),e.__h=e.__h.filter(function(n){return!n.__||j(n)})}catch(n){r.some(function(o){o.__h&&(o.__h=[])}),r=[],u.__e(n,e.__v)}}),le&&le(t,r)},u.unmount=function(t){ge&&ge(t);var r,e=t.__c;e&&e.__H&&(e.__H.__.forEach(function(n){try{H(n)}catch(o){r=o}}),r&&u.__e(r,e.__v))};var A=typeof requestAnimationFrame=="function";function H(t){var r=_e,e=t.__c;typeof e=="function"&&(t.__c=void 0,e()),_e=r}function j(t){var r=_e;t.__c=t.__(),_e=r}function ce(t,r){return!t||t.length!==r.length||r.some(function(e,n){return e!==t[n]})}function ye(t,r){return typeof r=="function"?r(t):r}function He(t,r){for(var e in r)t[e]=r[e];return t}function Je(t,r){for(var e in t)if(e!=="__source"&&!(e in r))return!0;for(var n in r)if(n!=="__source"&&t[n]!==r[n])return!0;return!1}function Fe(t){this.props=t}function Ut(t,r){function e(o){var l=this.props.ref,h=l==o.ref;return!h&&l&&(l.call?l(null):l.current=null),r?!r(this.props,o)||!h:Je(this.props,o)}function n(o){return this.shouldComponentUpdate=e,q(t,o)}return n.displayName="Memo("+(t.displayName||t.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n}(Fe.prototype=new se).isPureReactComponent=!0,Fe.prototype.shouldComponentUpdate=function(t,r){return Je(this.props,t)||Je(this.state,r)};var It=u.__b;u.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),It&&It(t)};var di=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Ki(t){function r(e,n){var o=He({},e);return delete o.ref,t(o,(n=e.ref||n)&&(typeof n!="object"||"current"in n)?n:null)}return r.$$typeof=di,r.render=r,r.prototype.isReactComponent=r.__f=!0,r.displayName="ForwardRef("+(t.displayName||t.name)+")",r}var qr=function(t,r){return t==null?null:at(at(t).map(r))},Zr={map:qr,forEach:qr,count:function(t){return t?at(t).length:0},only:function(t){var r=at(t);if(r.length!==1)throw"Children.only";return r[0]},toArray:at},yv=u.__e;u.__e=function(t,r,e){if(t.then){for(var n,o=r;o=o.__;)if((n=o.__c)&&n.__c)return r.__e==null&&(r.__e=e.__e,r.__k=e.__k),n.__c(t,r)}yv(t,r,e)};var Mc=u.unmount;function Xr(){this.__u=0,this.t=null,this.__b=null}function Fc(t){var r=t.__.__c;return r&&r.__e&&r.__e(t)}function Ic(t){var r,e,n;function o(l){if(r||(r=t()).then(function(h){e=h.default||h},function(h){n=h}),n)throw n;if(!e)throw r;return q(e,l)}return o.displayName="Lazy",o.__f=!0,o}function Ji(){this.u=null,this.o=null}u.unmount=function(t){var r=t.__c;r&&r.__R&&r.__R(),r&&t.__h===!0&&(t.type=null),Mc&&Mc(t)},(Xr.prototype=new se).__c=function(t,r){var e=r.__c,n=this;n.t==null&&(n.t=[]),n.t.push(e);var o=Fc(n.__v),l=!1,h=function(){l||(l=!0,e.__R=null,o?o(f):f())};e.__R=h;var f=function(){if(!--n.__u){if(n.state.__e){var v=n.state.__e;n.__v.__k[0]=function _(C,k,I){return C&&(C.__v=null,C.__k=C.__k&&C.__k.map(function(X){return _(X,k,I)}),C.__c&&C.__c.__P===k&&(C.__e&&I.insertBefore(C.__e,C.__d),C.__c.__e=!0,C.__c.__P=I)),C}(v,v.__c.__P,v.__c.__O)}var E;for(n.setState({__e:n.__b=null});E=n.t.pop();)E.forceUpdate()}},g=r.__h===!0;n.__u++||g||n.setState({__e:n.__b=n.__v.__k[0]}),t.then(h,h)},Xr.prototype.componentWillUnmount=function(){this.t=[]},Xr.prototype.render=function(t,r){if(this.__b){if(this.__v.__k){var e=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=function l(h,f,g){return h&&(h.__c&&h.__c.__H&&(h.__c.__H.__.forEach(function(v){typeof v.__c=="function"&&v.__c()}),h.__c.__H=null),(h=He({},h)).__c!=null&&(h.__c.__P===g&&(h.__c.__P=f),h.__c=null),h.__k=h.__k&&h.__k.map(function(v){return l(v,f,g)})),h}(this.__b,e,n.__O=n.__P)}this.__b=null}var o=r.__e&&q(te,null,t.fallback);return o&&(o.__h=null),[q(te,null,r.__e?null:t.children),o]};var Lc=function(t,r,e){if(++e[1]===e[0]&&t.o.delete(r),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.o.size))for(e=t.u;e;){for(;e.length>3;)e.pop()();if(e[1]<e[0])break;t.u=e=e[2]}};function wv(t){return this.getChildContext=function(){return t.context},t.children}function Ev(t){var r=this,e=t.i;r.componentWillUnmount=function(){We(null,r.l),r.l=null,r.i=null},r.i&&r.i!==e&&r.componentWillUnmount(),t.__v?(r.l||(r.i=e,r.l={nodeType:1,parentNode:e,childNodes:[],appendChild:function(n){this.childNodes.push(n),r.i.appendChild(n)},insertBefore:function(n,o){this.childNodes.push(n),r.i.appendChild(n)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),r.i.removeChild(n)}}),We(q(wv,{context:r.context},t.__v),r.l)):r.l&&r.componentWillUnmount()}function Oa(t,r){return q(Ev,{__v:t,i:r})}(Ji.prototype=new se).__e=function(t){var r=this,e=Fc(r.__v),n=r.o.get(t);return n[0]++,function(o){var l=function(){r.props.revealOrder?(n.push(o),Lc(r,t,n)):o()};e?e(l):l()}},Ji.prototype.render=function(t){this.u=null,this.o=new Map;var r=at(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&r.reverse();for(var e=r.length;e--;)this.o.set(r[e],this.u=[1,0,this.u]);return t.children},Ji.prototype.componentDidUpdate=Ji.prototype.componentDidMount=function(){var t=this;this.o.forEach(function(r,e){Lc(t,e,r)})};var Hc=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,xv=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,bv=typeof document<"u",Sv=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(t)};function Nc(t,r,e){return r.__k==null&&(r.textContent=""),We(t,r),typeof e=="function"&&e(),t?t.__c:null}function zc(t,r,e){return hn(t,r),typeof e=="function"&&e(),t?t.__c:null}se.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(se.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(r){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:r})}})});var jc=u.event;function _v(){}function Tv(){return this.cancelBubble}function Cv(){return this.defaultPrevented}u.event=function(t){return jc&&(t=jc(t)),t.persist=_v,t.isPropagationStopped=Tv,t.isDefaultPrevented=Cv,t.nativeEvent=t};var Uc,Vc={configurable:!0,get:function(){return this.class}},Wc=u.vnode;u.vnode=function(t){var r=t.type,e=t.props,n=e;if(typeof r=="string"){var o=r.indexOf("-")===-1;for(var l in n={},e){var h=e[l];bv&&l==="children"&&r==="noscript"||l==="value"&&"defaultValue"in e&&h==null||(l==="defaultValue"&&"value"in e&&e.value==null?l="value":l==="download"&&h===!0?h="":/ondoubleclick/i.test(l)?l="ondblclick":/^onchange(textarea|input)/i.test(l+r)&&!Sv(e.type)?l="oninput":/^onfocus$/i.test(l)?l="onfocusin":/^onblur$/i.test(l)?l="onfocusout":/^on(Ani|Tra|Tou|BeforeInp)/.test(l)?l=l.toLowerCase():o&&xv.test(l)?l=l.replace(/[A-Z0-9]/,"-$&").toLowerCase():h===null&&(h=void 0),n[l]=h)}r=="select"&&n.multiple&&Array.isArray(n.value)&&(n.value=at(e.children).forEach(function(f){f.props.selected=n.value.indexOf(f.props.value)!=-1})),r=="select"&&n.defaultValue!=null&&(n.value=at(e.children).forEach(function(f){f.props.selected=n.multiple?n.defaultValue.indexOf(f.props.value)!=-1:n.defaultValue==f.props.value})),t.props=n,e.class!=e.className&&(Vc.enumerable="className"in e,e.className!=null&&(n.class=e.className),Object.defineProperty(n,"className",Vc))}t.$$typeof=Hc,Wc&&Wc(t)};var Gc=u.__r;u.__r=function(t){Gc&&Gc(t),Uc=t.__c};var qc={ReactCurrentDispatcher:{current:{readContext:function(t){return Uc.__n[t.__c].props.value}}}},Pv="17.0.2";function Zc(t){return q.bind(null,t)}function ka(t){return!!t&&t.$$typeof===Hc}function Xc(t){return ka(t)?Dn.apply(null,arguments):t}function Yc(t){return!!t.__k&&(We(null,t),!0)}function Kc(t){return t&&(t.base||t.nodeType===1&&t)||null}var Jc=function(t,r){return t(r)},Qc=function(t,r){return t(r)},Rv=te,fe={useState:F,useReducer:ee,useEffect:ne,useLayoutEffect:re,useRef:ae,useImperativeHandle:ue,useMemo:xe,useCallback:Ee,useContext:Ae,useDebugValue:Pe,version:"17.0.2",Children:Zr,render:Nc,hydrate:zc,unmountComponentAtNode:Yc,createPortal:Oa,createElement:q,createContext:Pt,createFactory:Zc,cloneElement:Xc,createRef:G,Fragment:te,isValidElement:ka,findDOMNode:Kc,Component:se,PureComponent:Fe,memo:Ut,forwardRef:Ki,flushSync:Qc,unstable_batchedUpdates:Jc,StrictMode:te,Suspense:Xr,SuspenseList:Ji,lazy:Ic,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:qc},Ba=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:fe,version:Pv,Children:Zr,render:Nc,hydrate:zc,unmountComponentAtNode:Yc,createPortal:Oa,createFactory:Zc,cloneElement:Xc,isValidElement:ka,findDOMNode:Kc,PureComponent:Fe,memo:Ut,forwardRef:Ki,flushSync:Qc,unstable_batchedUpdates:Jc,StrictMode:Rv,Suspense:Xr,SuspenseList:Ji,lazy:Ic,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:qc,createElement:q,createContext:Pt,createRef:G,Fragment:te,Component:se,useState:F,useReducer:ee,useEffect:ne,useLayoutEffect:re,useRef:ae,useImperativeHandle:ue,useMemo:xe,useCallback:Ee,useContext:Ae,useDebugValue:Pe,useErrorBoundary:Ge}),Qn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Av(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ma(t){if(t.__esModule)return t;var r=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})}),r}var Fa={exports:{}};function Ia(){}Ia.prototype={on:function(t,r,e){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:r,ctx:e}),this},once:function(t,r,e){var n=this;function o(){n.off(t,o),r.apply(e,arguments)}return o._=r,this.on(t,o,e)},emit:function(t){var r=[].slice.call(arguments,1),e=((this.e||(this.e={}))[t]||[]).slice(),n=0,o=e.length;for(n;n<o;n++)e[n].fn.apply(e[n].ctx,r);return this},off:function(t,r){var e=this.e||(this.e={}),n=e[t],o=[];if(n&&r)for(var l=0,h=n.length;l<h;l++)n[l].fn!==r&&n[l].fn._!==r&&o.push(n[l]);return o.length?e[t]=o:delete e[t],this}},Fa.exports=Ia,Fa.exports.TinyEmitter=Ia;var Uo=Fa.exports,Vo={exports:{}},$c={},Qi=Ma(Ba),Yr={exports:{}},Dv="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ov=Dv,kv=Ov;function eh(){}function th(){}th.resetWarningCache=eh;var Bv=function(){function t(n,o,l,h,f,g){if(g!==kv){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}t.isRequired=t;function r(){return t}var e={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:th,resetWarningCache:eh};return e.PropTypes=e,e};Yr.exports=Bv();function nh(t){var r,e,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t))for(r=0;r<t.length;r++)t[r]&&(e=nh(t[r]))&&(n&&(n+=" "),n+=e);else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function ih(){for(var t,r,e=0,n="";e<arguments.length;)(t=arguments[e++])&&(r=nh(t))&&(n&&(n+=" "),n+=r);return n}var Mv=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",clsx:ih,default:ih}),Fv=Ma(Mv),Mt={},zn={};Object.defineProperty(zn,"__esModule",{value:!0}),zn.dontSetMe=zv,zn.findInArray=Iv,zn.int=Nv,zn.isFunction=Lv,zn.isNum=Hv;function Iv(t,r){for(let e=0,n=t.length;e<n;e++)if(r.apply(r,[t[e],e,t]))return t[e]}function Lv(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function Hv(t){return typeof t=="number"&&!isNaN(t)}function Nv(t){return parseInt(t,10)}function zv(t,r,e){if(t[r])return new Error("Invalid prop ".concat(r," passed to ").concat(e," - do not set this, set it on the child."))}var Di={};Object.defineProperty(Di,"__esModule",{value:!0}),Di.browserPrefixToKey=oh,Di.browserPrefixToStyle=jv,Di.default=void 0,Di.getPrefix=rh;const La=["Moz","Webkit","O","ms"];function rh(){var t;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const e=(t=window.document)===null||t===void 0||(t=t.documentElement)===null||t===void 0?void 0:t.style;if(!e||r in e)return"";for(let n=0;n<La.length;n++)if(oh(r,La[n])in e)return La[n];return""}function oh(t,r){return r?"".concat(r).concat(Uv(t)):t}function jv(t,r){return r?"-".concat(r.toLowerCase(),"-").concat(t):t}function Uv(t){let r="",e=!0;for(let n=0;n<t.length;n++)e?(r+=t[n].toUpperCase(),e=!1):t[n]==="-"?e=!0:r+=t[n];return r}Di.default=rh(),Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.addClassName=uh,Mt.addEvent=Gv,Mt.addUserSelectStyles=ny,Mt.createCSSTransform=Qv,Mt.createSVGTransform=$v,Mt.getTouch=ey,Mt.getTouchIdentifier=ty,Mt.getTranslation=Ha,Mt.innerHeight=Yv,Mt.innerWidth=Kv,Mt.matchesSelector=lh,Mt.matchesSelectorAndParentsTo=Wv,Mt.offsetXYFromParent=Jv,Mt.outerHeight=Zv,Mt.outerWidth=Xv,Mt.removeClassName=ch,Mt.removeEvent=qv,Mt.removeUserSelectStyles=iy;var En=zn,sh=Vv(Di);function ah(t){if(typeof WeakMap!="function")return null;var r=new WeakMap,e=new WeakMap;return(ah=function(n){return n?e:r})(t)}function Vv(t,r){if(!r&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var e=ah(r);if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var h=o?Object.getOwnPropertyDescriptor(t,l):null;h&&(h.get||h.set)?Object.defineProperty(n,l,h):n[l]=t[l]}return n.default=t,e&&e.set(t,n),n}let Wo="";function lh(t,r){return Wo||(Wo=(0,En.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(e){return(0,En.isFunction)(t[e])})),(0,En.isFunction)(t[Wo])?t[Wo](r):!1}function Wv(t,r,e){let n=t;do{if(lh(n,r))return!0;if(n===e)return!1;n=n.parentNode}while(n);return!1}function Gv(t,r,e,n){if(!t)return;const o={capture:!0,...n};t.addEventListener?t.addEventListener(r,e,o):t.attachEvent?t.attachEvent("on"+r,e):t["on"+r]=e}function qv(t,r,e,n){if(!t)return;const o={capture:!0,...n};t.removeEventListener?t.removeEventListener(r,e,o):t.detachEvent?t.detachEvent("on"+r,e):t["on"+r]=null}function Zv(t){let r=t.clientHeight;const e=t.ownerDocument.defaultView.getComputedStyle(t);return r+=(0,En.int)(e.borderTopWidth),r+=(0,En.int)(e.borderBottomWidth),r}function Xv(t){let r=t.clientWidth;const e=t.ownerDocument.defaultView.getComputedStyle(t);return r+=(0,En.int)(e.borderLeftWidth),r+=(0,En.int)(e.borderRightWidth),r}function Yv(t){let r=t.clientHeight;const e=t.ownerDocument.defaultView.getComputedStyle(t);return r-=(0,En.int)(e.paddingTop),r-=(0,En.int)(e.paddingBottom),r}function Kv(t){let r=t.clientWidth;const e=t.ownerDocument.defaultView.getComputedStyle(t);return r-=(0,En.int)(e.paddingLeft),r-=(0,En.int)(e.paddingRight),r}function Jv(t,r,e){const n=r===r.ownerDocument.body?{left:0,top:0}:r.getBoundingClientRect(),o=(t.clientX+r.scrollLeft-n.left)/e,l=(t.clientY+r.scrollTop-n.top)/e;return{x:o,y:l}}function Qv(t,r){const e=Ha(t,r,"px");return{[(0,sh.browserPrefixToKey)("transform",sh.default)]:e}}function $v(t,r){return Ha(t,r,"")}function Ha(t,r,e){let{x:n,y:o}=t,l="translate(".concat(n).concat(e,",").concat(o).concat(e,")");if(r){const h="".concat(typeof r.x=="string"?r.x:r.x+e),f="".concat(typeof r.y=="string"?r.y:r.y+e);l="translate(".concat(h,", ").concat(f,")")+l}return l}function ey(t,r){return t.targetTouches&&(0,En.findInArray)(t.targetTouches,e=>r===e.identifier)||t.changedTouches&&(0,En.findInArray)(t.changedTouches,e=>r===e.identifier)}function ty(t){if(t.targetTouches&&t.targetTouches[0])return t.targetTouches[0].identifier;if(t.changedTouches&&t.changedTouches[0])return t.changedTouches[0].identifier}function ny(t){if(!t)return;let r=t.getElementById("react-draggable-style-el");r||(r=t.createElement("style"),r.type="text/css",r.id="react-draggable-style-el",r.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,r.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,t.getElementsByTagName("head")[0].appendChild(r)),t.body&&uh(t.body,"react-draggable-transparent-selection")}function iy(t){if(t)try{if(t.body&&ch(t.body,"react-draggable-transparent-selection"),t.selection)t.selection.empty();else{const r=(t.defaultView||window).getSelection();r&&r.type!=="Caret"&&r.removeAllRanges()}}catch{}}function uh(t,r){t.classList?t.classList.add(r):t.className.match(new RegExp("(?:^|\\s)".concat(r,"(?!\\S)")))||(t.className+=" ".concat(r))}function ch(t,r){t.classList?t.classList.remove(r):t.className=t.className.replace(new RegExp("(?:^|\\s)".concat(r,"(?!\\S)"),"g"),"")}var jn={};Object.defineProperty(jn,"__esModule",{value:!0}),jn.canDragX=sy,jn.canDragY=ay,jn.createCoreData=uy,jn.createDraggableData=cy,jn.getBoundPosition=ry,jn.getControlPosition=ly,jn.snapToGrid=oy;var xn=zn,$i=Mt;function ry(t,r,e){if(!t.props.bounds)return[r,e];let{bounds:n}=t.props;n=typeof n=="string"?n:hy(n);const o=Na(t);if(typeof n=="string"){const{ownerDocument:l}=o,h=l.defaultView;let f;if(n==="parent"?f=o.parentNode:f=l.querySelector(n),!(f instanceof h.HTMLElement))throw new Error('Bounds selector "'+n+'" could not find an element.');const g=f,v=h.getComputedStyle(o),E=h.getComputedStyle(g);n={left:-o.offsetLeft+(0,xn.int)(E.paddingLeft)+(0,xn.int)(v.marginLeft),top:-o.offsetTop+(0,xn.int)(E.paddingTop)+(0,xn.int)(v.marginTop),right:(0,$i.innerWidth)(g)-(0,$i.outerWidth)(o)-o.offsetLeft+(0,xn.int)(E.paddingRight)-(0,xn.int)(v.marginRight),bottom:(0,$i.innerHeight)(g)-(0,$i.outerHeight)(o)-o.offsetTop+(0,xn.int)(E.paddingBottom)-(0,xn.int)(v.marginBottom)}}return(0,xn.isNum)(n.right)&&(r=Math.min(r,n.right)),(0,xn.isNum)(n.bottom)&&(e=Math.min(e,n.bottom)),(0,xn.isNum)(n.left)&&(r=Math.max(r,n.left)),(0,xn.isNum)(n.top)&&(e=Math.max(e,n.top)),[r,e]}function oy(t,r,e){const n=Math.round(r/t[0])*t[0],o=Math.round(e/t[1])*t[1];return[n,o]}function sy(t){return t.props.axis==="both"||t.props.axis==="x"}function ay(t){return t.props.axis==="both"||t.props.axis==="y"}function ly(t,r,e){const n=typeof r=="number"?(0,$i.getTouch)(t,r):null;if(typeof r=="number"&&!n)return null;const o=Na(e),l=e.props.offsetParent||o.offsetParent||o.ownerDocument.body;return(0,$i.offsetXYFromParent)(n||t,l,e.props.scale)}function uy(t,r,e){const n=!(0,xn.isNum)(t.lastX),o=Na(t);return n?{node:o,deltaX:0,deltaY:0,lastX:r,lastY:e,x:r,y:e}:{node:o,deltaX:r-t.lastX,deltaY:e-t.lastY,lastX:t.lastX,lastY:t.lastY,x:r,y:e}}function cy(t,r){const e=t.props.scale;return{node:r.node,x:t.state.x+r.deltaX/e,y:t.state.y+r.deltaY/e,deltaX:r.deltaX/e,deltaY:r.deltaY/e,lastX:t.state.x,lastY:t.state.y}}function hy(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}function Na(t){const r=t.findDOMNode();if(!r)throw new Error("<DraggableCore>: Unmounted during event!");return r}var Go={},qo={};Object.defineProperty(qo,"__esModule",{value:!0}),qo.default=dy;function dy(){}Object.defineProperty(Go,"__esModule",{value:!0}),Go.default=void 0;var za=fy(Qi),dn=Ua(Yr.exports),py=Ua(Qi),tn=Mt,pi=jn,ja=zn,Kr=Ua(qo);function Ua(t){return t&&t.__esModule?t:{default:t}}function hh(t){if(typeof WeakMap!="function")return null;var r=new WeakMap,e=new WeakMap;return(hh=function(n){return n?e:r})(t)}function fy(t,r){if(!r&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var e=hh(r);if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var h=o?Object.getOwnPropertyDescriptor(t,l):null;h&&(h.get||h.set)?Object.defineProperty(n,l,h):n[l]=t[l]}return n.default=t,e&&e.set(t,n),n}function un(t,r,e){return r=gy(r),r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function gy(t){var r=my(t,"string");return typeof r=="symbol"?r:String(r)}function my(t,r){if(typeof t!="object"||t===null)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var n=e.call(t,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}const On={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let fi=On.mouse;class Zo extends za.Component{constructor(){super(...arguments),un(this,"dragging",!1),un(this,"lastX",NaN),un(this,"lastY",NaN),un(this,"touchIdentifier",null),un(this,"mounted",!1),un(this,"handleDragStart",r=>{if(this.props.onMouseDown(r),!this.props.allowAnyClick&&typeof r.button=="number"&&r.button!==0)return!1;const e=this.findDOMNode();if(!e||!e.ownerDocument||!e.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:n}=e;if(this.props.disabled||!(r.target instanceof n.defaultView.Node)||this.props.handle&&!(0,tn.matchesSelectorAndParentsTo)(r.target,this.props.handle,e)||this.props.cancel&&(0,tn.matchesSelectorAndParentsTo)(r.target,this.props.cancel,e))return;r.type==="touchstart"&&r.preventDefault();const o=(0,tn.getTouchIdentifier)(r);this.touchIdentifier=o;const l=(0,pi.getControlPosition)(r,o,this);if(l==null)return;const{x:h,y:f}=l,g=(0,pi.createCoreData)(this,h,f);(0,Kr.default)("DraggableCore: handleDragStart: %j",g),(0,Kr.default)("calling",this.props.onStart),!(this.props.onStart(r,g)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,tn.addUserSelectStyles)(n),this.dragging=!0,this.lastX=h,this.lastY=f,(0,tn.addEvent)(n,fi.move,this.handleDrag),(0,tn.addEvent)(n,fi.stop,this.handleDragStop))}),un(this,"handleDrag",r=>{const e=(0,pi.getControlPosition)(r,this.touchIdentifier,this);if(e==null)return;let{x:n,y:o}=e;if(Array.isArray(this.props.grid)){let h=n-this.lastX,f=o-this.lastY;if([h,f]=(0,pi.snapToGrid)(this.props.grid,h,f),!h&&!f)return;n=this.lastX+h,o=this.lastY+f}const l=(0,pi.createCoreData)(this,n,o);if((0,Kr.default)("DraggableCore: handleDrag: %j",l),this.props.onDrag(r,l)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const h=document.createEvent("MouseEvents");h.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(h)}return}this.lastX=n,this.lastY=o}),un(this,"handleDragStop",r=>{if(!this.dragging)return;const e=(0,pi.getControlPosition)(r,this.touchIdentifier,this);if(e==null)return;let{x:n,y:o}=e;if(Array.isArray(this.props.grid)){let f=n-this.lastX||0,g=o-this.lastY||0;[f,g]=(0,pi.snapToGrid)(this.props.grid,f,g),n=this.lastX+f,o=this.lastY+g}const l=(0,pi.createCoreData)(this,n,o);if(this.props.onStop(r,l)===!1||this.mounted===!1)return!1;const h=this.findDOMNode();h&&this.props.enableUserSelectHack&&(0,tn.removeUserSelectStyles)(h.ownerDocument),(0,Kr.default)("DraggableCore: handleDragStop: %j",l),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,h&&((0,Kr.default)("DraggableCore: Removing handlers"),(0,tn.removeEvent)(h.ownerDocument,fi.move,this.handleDrag),(0,tn.removeEvent)(h.ownerDocument,fi.stop,this.handleDragStop))}),un(this,"onMouseDown",r=>(fi=On.mouse,this.handleDragStart(r))),un(this,"onMouseUp",r=>(fi=On.mouse,this.handleDragStop(r))),un(this,"onTouchStart",r=>(fi=On.touch,this.handleDragStart(r))),un(this,"onTouchEnd",r=>(fi=On.touch,this.handleDragStop(r)))}componentDidMount(){this.mounted=!0;const r=this.findDOMNode();r&&(0,tn.addEvent)(r,On.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const r=this.findDOMNode();if(r){const{ownerDocument:e}=r;(0,tn.removeEvent)(e,On.mouse.move,this.handleDrag),(0,tn.removeEvent)(e,On.touch.move,this.handleDrag),(0,tn.removeEvent)(e,On.mouse.stop,this.handleDragStop),(0,tn.removeEvent)(e,On.touch.stop,this.handleDragStop),(0,tn.removeEvent)(r,On.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,tn.removeUserSelectStyles)(e)}}findDOMNode(){var r,e;return(r=this.props)!==null&&r!==void 0&&r.nodeRef?(e=this.props)===null||e===void 0||(e=e.nodeRef)===null||e===void 0?void 0:e.current:py.default.findDOMNode(this)}render(){return za.cloneElement(za.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}Go.default=Zo,un(Zo,"displayName","DraggableCore"),un(Zo,"propTypes",{allowAnyClick:dn.default.bool,children:dn.default.node.isRequired,disabled:dn.default.bool,enableUserSelectHack:dn.default.bool,offsetParent:function(t,r){if(t[r]&&t[r].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:dn.default.arrayOf(dn.default.number),handle:dn.default.string,cancel:dn.default.string,nodeRef:dn.default.object,onStart:dn.default.func,onDrag:dn.default.func,onStop:dn.default.func,onMouseDown:dn.default.func,scale:dn.default.number,className:ja.dontSetMe,style:ja.dontSetMe,transform:ja.dontSetMe}),un(Zo,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return g.default}}),t.default=void 0;var r=C(Qi),e=E(Yr.exports),n=E(Qi),o=E(Fv),l=Mt,h=jn,f=zn,g=E(Go),v=E(qo);function E(P){return P&&P.__esModule?P:{default:P}}function _(P){if(typeof WeakMap!="function")return null;var N=new WeakMap,J=new WeakMap;return(_=function(K){return K?J:N})(P)}function C(P,N){if(!N&&P&&P.__esModule)return P;if(P===null||typeof P!="object"&&typeof P!="function")return{default:P};var J=_(N);if(J&&J.has(P))return J.get(P);var K={},oe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in P)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(P,ie)){var me=oe?Object.getOwnPropertyDescriptor(P,ie):null;me&&(me.get||me.set)?Object.defineProperty(K,ie,me):K[ie]=P[ie]}return K.default=P,J&&J.set(P,K),K}function k(){return k=Object.assign?Object.assign.bind():function(P){for(var N=1;N<arguments.length;N++){var J=arguments[N];for(var K in J)Object.prototype.hasOwnProperty.call(J,K)&&(P[K]=J[K])}return P},k.apply(this,arguments)}function I(P,N,J){return N=X(N),N in P?Object.defineProperty(P,N,{value:J,enumerable:!0,configurable:!0,writable:!0}):P[N]=J,P}function X(P){var N=U(P,"string");return typeof N=="symbol"?N:String(N)}function U(P,N){if(typeof P!="object"||P===null)return P;var J=P[Symbol.toPrimitive];if(J!==void 0){var K=J.call(P,N||"default");if(typeof K!="object")return K;throw new TypeError("@@toPrimitive must return a primitive value.")}return(N==="string"?String:Number)(P)}class $ extends r.Component{static getDerivedStateFromProps(N,J){let{position:K}=N,{prevPropsPosition:oe}=J;return K&&(!oe||K.x!==oe.x||K.y!==oe.y)?((0,v.default)("Draggable: getDerivedStateFromProps %j",{position:K,prevPropsPosition:oe}),{x:K.x,y:K.y,prevPropsPosition:{...K}}):null}constructor(N){super(N),I(this,"onDragStart",(J,K)=>{if((0,v.default)("Draggable: onDragStart: %j",K),this.props.onStart(J,(0,h.createDraggableData)(this,K))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),I(this,"onDrag",(J,K)=>{if(!this.state.dragging)return!1;(0,v.default)("Draggable: onDrag: %j",K);const oe=(0,h.createDraggableData)(this,K),ie={x:oe.x,y:oe.y,slackX:0,slackY:0};if(this.props.bounds){const{x:me,y:we}=ie;ie.x+=this.state.slackX,ie.y+=this.state.slackY;const[De,Be]=(0,h.getBoundPosition)(this,ie.x,ie.y);ie.x=De,ie.y=Be,ie.slackX=this.state.slackX+(me-ie.x),ie.slackY=this.state.slackY+(we-ie.y),oe.x=ie.x,oe.y=ie.y,oe.deltaX=ie.x-this.state.x,oe.deltaY=ie.y-this.state.y}if(this.props.onDrag(J,oe)===!1)return!1;this.setState(ie)}),I(this,"onDragStop",(J,K)=>{if(!this.state.dragging||this.props.onStop(J,(0,h.createDraggableData)(this,K))===!1)return!1;(0,v.default)("Draggable: onDragStop: %j",K);const oe={dragging:!1,slackX:0,slackY:0};if(this.props.position){const{x:ie,y:me}=this.props.position;oe.x=ie,oe.y=me}this.setState(oe)}),this.state={dragging:!1,dragged:!1,x:N.position?N.position.x:N.defaultPosition.x,y:N.position?N.position.y:N.defaultPosition.y,prevPropsPosition:{...N.position},slackX:0,slackY:0,isElementSVG:!1},N.position&&!(N.onDrag||N.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var N,J;return(N=(J=this.props)===null||J===void 0||(J=J.nodeRef)===null||J===void 0?void 0:J.current)!==null&&N!==void 0?N:n.default.findDOMNode(this)}render(){const{axis:N,bounds:J,children:K,defaultPosition:oe,defaultClassName:ie,defaultClassNameDragging:me,defaultClassNameDragged:we,position:De,positionOffset:Be,scale:Oe,...Ue}=this.props;let Ve={},et=null;const $e=!De||this.state.dragging,lt=De||oe,dt={x:(0,h.canDragX)(this)&&$e?this.state.x:lt.x,y:(0,h.canDragY)(this)&&$e?this.state.y:lt.y};this.state.isElementSVG?et=(0,l.createSVGTransform)(dt,Be):Ve=(0,l.createCSSTransform)(dt,Be);const At=(0,o.default)(K.props.className||"",ie,{[me]:this.state.dragging,[we]:this.state.dragged});return r.createElement(g.default,k({},Ue,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),r.cloneElement(r.Children.only(K),{className:At,style:{...K.props.style,...Ve},transform:et}))}}t.default=$,I($,"displayName","Draggable"),I($,"propTypes",{...g.default.propTypes,axis:e.default.oneOf(["both","x","y","none"]),bounds:e.default.oneOfType([e.default.shape({left:e.default.number,right:e.default.number,top:e.default.number,bottom:e.default.number}),e.default.string,e.default.oneOf([!1])]),defaultClassName:e.default.string,defaultClassNameDragging:e.default.string,defaultClassNameDragged:e.default.string,defaultPosition:e.default.shape({x:e.default.number,y:e.default.number}),positionOffset:e.default.shape({x:e.default.oneOfType([e.default.number,e.default.string]),y:e.default.oneOfType([e.default.number,e.default.string])}),position:e.default.shape({x:e.default.number,y:e.default.number}),className:f.dontSetMe,style:f.dontSetMe,transform:f.dontSetMe}),I($,"defaultProps",{...g.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})}($c);const{default:dh,DraggableCore:vy}=$c;Vo.exports=dh,Vo.exports.default=dh,Vo.exports.DraggableCore=vy;var yy=Vo.exports,wy=["second","minute","hour","day","week","month","year"];function Ey(t,r){if(r===0)return["just now","right now"];var e=wy[Math.floor(r/2)];return t>1&&(e+="s"),[t+" "+e+" ago","in "+t+" "+e]}var xy=["","","","","","",""];function by(t,r){if(r===0)return["",""];var e=xy[~~(r/2)];return[t+" "+e+"",t+" "+e+""]}var Va={},Bt=function(t,r){Va[t]=r},ph=function(t){return Va[t]||Va.en_US},Oi=[60,60,24,7,365/7/12,12];function fh(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}function gh(t,r){var e=t<0?1:0;t=Math.abs(t);for(var n=t,o=0;t>=Oi[o]&&o<Oi.length;o++)t/=Oi[o];return t=Math.floor(t),o*=2,t>(o===0?9:1)&&(o+=1),r(t,o,n)[e].replace("%s",t.toString())}function mh(t,r){var e=r?fh(r):new Date;return(+e-+fh(t))/1e3}function Sy(t){for(var r=1,e=0,n=Math.abs(t);t>=Oi[e]&&e<Oi.length;e++)t/=Oi[e],r*=Oi[e];return n=n%r,n=n?r-n:r,Math.ceil(n)}var _y=function(t,r,e){var n=mh(t,e&&e.relativeDate);return gh(n,ph(r))},vh="timeago-id";function Ty(t){return t.getAttribute("datetime")}function Cy(t,r){t.setAttribute(vh,r)}function yh(t){return parseInt(t.getAttribute(vh))}var Wa={},Ga=function(t){clearTimeout(t),delete Wa[t]};function wh(t,r,e,n){Ga(yh(t));var o=n.relativeDate,l=n.minInterval,h=mh(r,o);t.innerText=gh(h,e);var f=setTimeout(function(){wh(t,r,e,n)},Math.min(Math.max(Sy(h),l||1)*1e3,2147483647));Wa[f]=0,Cy(t,f)}function Eh(t){t?Ga(yh(t)):Object.keys(Wa).forEach(Ga)}function Py(t,r,e){var n=t.length?t:[t];return n.forEach(function(o){wh(o,Ty(o),ph(r),e||{})}),n}Bt("en_US",Ey),Bt("zh_CN",by);var Ry=globalThis&&globalThis.__extends||function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var l in o)o.hasOwnProperty(l)&&(n[l]=o[l])},t(r,e)};return function(r,e){t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),qa=globalThis&&globalThis.__assign||function(){return qa=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++){r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},qa.apply(this,arguments)},Ay=globalThis&&globalThis.__rest||function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(e[n[o]]=t[n[o]]);return e},Dy=function(t){return""+(t instanceof Date?t.getTime():t)},Oy=function(t){Ry(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.dom=null,e}return r.prototype.componentDidMount=function(){this.renderTimeAgo()},r.prototype.componentDidUpdate=function(){this.renderTimeAgo()},r.prototype.renderTimeAgo=function(){var e=this.props,n=e.live,o=e.datetime,l=e.locale,h=e.opts;Eh(this.dom),n!==!1&&(this.dom.setAttribute("datetime",Dy(o)),Py(this.dom,l,h))},r.prototype.componentWillUnmount=function(){Eh(this.dom)},r.prototype.render=function(){var e=this,n=this.props,o=n.datetime;n.live;var l=n.locale,h=n.opts,f=Ay(n,["datetime","live","locale","opts"]);return q("time",qa({ref:function(g){e.dom=g}},f),_y(o,l,h))},r.defaultProps={live:!0,className:""},r}(Fe);function ky(t,r){const e=n=>{t.current&&!t.current.contains(event.target)&&r()};ne(()=>(document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)))}var xh=Object.prototype.toString,bh=function(t){var r=xh.call(t),e=r==="[object Arguments]";return e||(e=r!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&xh.call(t.callee)==="[object Function]"),e},Sh;if(!Object.keys){var Xo=Object.prototype.hasOwnProperty,_h=Object.prototype.toString,By=bh,Th=Object.prototype.propertyIsEnumerable,My=!Th.call({toString:null},"toString"),Fy=Th.call(function(){},"prototype"),Yo=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Za=function(t){var r=t.constructor;return r&&r.prototype===t},Iy={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},Ly=function(){if(typeof window>"u")return!1;for(var t in window)try{if(!Iy["$"+t]&&Xo.call(window,t)&&window[t]!==null&&typeof window[t]=="object")try{Za(window[t])}catch{return!0}}catch{return!0}return!1}(),Hy=function(t){if(typeof window>"u"||!Ly)return Za(t);try{return Za(t)}catch{return!1}};Sh=function(t){var r=t!==null&&typeof t=="object",e=_h.call(t)==="[object Function]",n=By(t),o=r&&_h.call(t)==="[object String]",l=[];if(!r&&!e&&!n)throw new TypeError("Object.keys called on a non-object");var h=Fy&&e;if(o&&t.length>0&&!Xo.call(t,0))for(var f=0;f<t.length;++f)l.push(String(f));if(n&&t.length>0)for(var g=0;g<t.length;++g)l.push(String(g));else for(var v in t)!(h&&v==="prototype")&&Xo.call(t,v)&&l.push(String(v));if(My)for(var E=Hy(t),_=0;_<Yo.length;++_)!(E&&Yo[_]==="constructor")&&Xo.call(t,Yo[_])&&l.push(Yo[_]);return l}}var Ny=Sh,zy=Array.prototype.slice,jy=bh,Ch=Object.keys,Ko=Ch?function(t){return Ch(t)}:Ny,Ph=Object.keys;Ko.shim=function(){if(Object.keys){var t=function(){var r=Object.keys(arguments);return r&&r.length===arguments.length}(1,2);t||(Object.keys=function(r){return jy(r)?Ph(zy.call(r)):Ph(r)})}else Object.keys=Ko;return Object.keys||Ko};var Uy=Ko,Rh=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),e=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(e)!=="[object Symbol]")return!1;var n=42;t[r]=n;for(r in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var o=Object.getOwnPropertySymbols(t);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var l=Object.getOwnPropertyDescriptor(t,r);if(l.value!==n||l.enumerable!==!0)return!1}return!0},Ah=typeof Symbol<"u"&&Symbol,Vy=Rh,Dh=function(){return typeof Ah!="function"||typeof Symbol!="function"||typeof Ah("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Vy()},Oh={foo:{}},Wy=Object,Gy=function(){return{__proto__:Oh}.foo===Oh.foo&&!({__proto__:null}instanceof Wy)},qy="Function.prototype.bind called on incompatible ",Zy=Object.prototype.toString,Xy=Math.max,Yy="[object Function]",kh=function(t,r){for(var e=[],n=0;n<t.length;n+=1)e[n]=t[n];for(var o=0;o<r.length;o+=1)e[o+t.length]=r[o];return e},Ky=function(t,r){for(var e=[],n=r||0,o=0;n<t.length;n+=1,o+=1)e[o]=t[n];return e},Jy=function(t,r){for(var e="",n=0;n<t.length;n+=1)e+=t[n],n+1<t.length&&(e+=r);return e},Qy=function(t){var r=this;if(typeof r!="function"||Zy.apply(r)!==Yy)throw new TypeError(qy+r);for(var e=Ky(arguments,1),n,o=function(){if(this instanceof n){var v=r.apply(this,kh(e,arguments));return Object(v)===v?v:this}return r.apply(t,kh(e,arguments))},l=Xy(0,r.length-e.length),h=[],f=0;f<l;f++)h[f]="$"+f;if(n=Function("binder","return function ("+Jy(h,",")+"){ return binder.apply(this,arguments); }")(o),r.prototype){var g=function(){};g.prototype=r.prototype,n.prototype=new g,g.prototype=null}return n},$y=Qy,Jo=Function.prototype.bind||$y,ew=Function.prototype.call,tw=Object.prototype.hasOwnProperty,nw=Jo,iw=nw.call(ew,tw),ut,er=SyntaxError,Bh=Function,tr=TypeError,Xa=function(t){try{return Bh('"use strict"; return ('+t+").constructor;")()}catch{}},ki=Object.getOwnPropertyDescriptor;if(ki)try{ki({},"")}catch{ki=null}var Ya=function(){throw new tr},rw=ki?function(){try{return arguments.callee,Ya}catch{try{return ki(arguments,"callee").get}catch{return Ya}}}():Ya,nr=Dh(),ow=Gy(),qt=Object.getPrototypeOf||(ow?function(t){return t.__proto__}:null),ir={},sw=typeof Uint8Array>"u"||!qt?ut:qt(Uint8Array),Bi={"%AggregateError%":typeof AggregateError>"u"?ut:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?ut:ArrayBuffer,"%ArrayIteratorPrototype%":nr&&qt?qt([][Symbol.iterator]()):ut,"%AsyncFromSyncIteratorPrototype%":ut,"%AsyncFunction%":ir,"%AsyncGenerator%":ir,"%AsyncGeneratorFunction%":ir,"%AsyncIteratorPrototype%":ir,"%Atomics%":typeof Atomics>"u"?ut:Atomics,"%BigInt%":typeof BigInt>"u"?ut:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?ut:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?ut:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?ut:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?ut:Float32Array,"%Float64Array%":typeof Float64Array>"u"?ut:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?ut:FinalizationRegistry,"%Function%":Bh,"%GeneratorFunction%":ir,"%Int8Array%":typeof Int8Array>"u"?ut:Int8Array,"%Int16Array%":typeof Int16Array>"u"?ut:Int16Array,"%Int32Array%":typeof Int32Array>"u"?ut:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":nr&&qt?qt(qt([][Symbol.iterator]())):ut,"%JSON%":typeof JSON=="object"?JSON:ut,"%Map%":typeof Map>"u"?ut:Map,"%MapIteratorPrototype%":typeof Map>"u"||!nr||!qt?ut:qt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?ut:Promise,"%Proxy%":typeof Proxy>"u"?ut:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?ut:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?ut:Set,"%SetIteratorPrototype%":typeof Set>"u"||!nr||!qt?ut:qt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?ut:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":nr&&qt?qt(""[Symbol.iterator]()):ut,"%Symbol%":nr?Symbol:ut,"%SyntaxError%":er,"%ThrowTypeError%":rw,"%TypedArray%":sw,"%TypeError%":tr,"%Uint8Array%":typeof Uint8Array>"u"?ut:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?ut:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?ut:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?ut:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?ut:WeakMap,"%WeakRef%":typeof WeakRef>"u"?ut:WeakRef,"%WeakSet%":typeof WeakSet>"u"?ut:WeakSet};if(qt)try{null.error}catch(t){var aw=qt(qt(t));Bi["%Error.prototype%"]=aw}var lw=function t(r){var e;if(r==="%AsyncFunction%")e=Xa("async function () {}");else if(r==="%GeneratorFunction%")e=Xa("function* () {}");else if(r==="%AsyncGeneratorFunction%")e=Xa("async function* () {}");else if(r==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(e=n.prototype)}else if(r==="%AsyncIteratorPrototype%"){var o=t("%AsyncGenerator%");o&&qt&&(e=qt(o.prototype))}return Bi[r]=e,e},Mh={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Jr=Jo,Qo=iw,uw=Jr.call(Function.call,Array.prototype.concat),cw=Jr.call(Function.apply,Array.prototype.splice),Fh=Jr.call(Function.call,String.prototype.replace),$o=Jr.call(Function.call,String.prototype.slice),hw=Jr.call(Function.call,RegExp.prototype.exec),dw=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,pw=/\\(\\)?/g,fw=function(t){var r=$o(t,0,1),e=$o(t,-1);if(r==="%"&&e!=="%")throw new er("invalid intrinsic syntax, expected closing `%`");if(e==="%"&&r!=="%")throw new er("invalid intrinsic syntax, expected opening `%`");var n=[];return Fh(t,dw,function(o,l,h,f){n[n.length]=h?Fh(f,pw,"$1"):l||o}),n},gw=function(t,r){var e=t,n;if(Qo(Mh,e)&&(n=Mh[e],e="%"+n[0]+"%"),Qo(Bi,e)){var o=Bi[e];if(o===ir&&(o=lw(e)),typeof o>"u"&&!r)throw new tr("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:e,value:o}}throw new er("intrinsic "+t+" does not exist!")},Vt=function(t,r){if(typeof t!="string"||t.length===0)throw new tr("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new tr('"allowMissing" argument must be a boolean');if(hw(/^%?[^%]*%?$/,t)===null)throw new er("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var e=fw(t),n=e.length>0?e[0]:"",o=gw("%"+n+"%",r),l=o.name,h=o.value,f=!1,g=o.alias;g&&(n=g[0],cw(e,uw([0,1],g)));for(var v=1,E=!0;v<e.length;v+=1){var _=e[v],C=$o(_,0,1),k=$o(_,-1);if((C==='"'||C==="'"||C==="`"||k==='"'||k==="'"||k==="`")&&C!==k)throw new er("property names with quotes must have matching quotes");if((_==="constructor"||!E)&&(f=!0),n+="."+_,l="%"+n+"%",Qo(Bi,l))h=Bi[l];else if(h!=null){if(!(_ in h)){if(!r)throw new tr("base intrinsic for "+t+" exists, but the property is not available.");return}if(ki&&v+1>=e.length){var I=ki(h,_);E=!!I,E&&"get"in I&&!("originalValue"in I.get)?h=I.get:h=h[_]}else E=Qo(h,_),h=h[_];E&&!f&&(Bi[l]=h)}}return h},mw=Vt,Ka=mw("%Object.defineProperty%",!0),Ja=function(){if(Ka)try{return Ka({},"a",{value:1}),!0}catch{return!1}return!1};Ja.hasArrayLengthDefineBug=function(){if(!Ja())return null;try{return Ka([],"length",{value:1}).length!==1}catch{return!0}};var Qa=Ja,vw=Uy,yw=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",ww=Object.prototype.toString,Ew=Array.prototype.concat,Ih=Object.defineProperty,xw=function(t){return typeof t=="function"&&ww.call(t)==="[object Function]"},bw=Qa(),Lh=Ih&&bw,Sw=function(t,r,e,n){if(r in t){if(n===!0){if(t[r]===e)return}else if(!xw(n)||!n())return}Lh?Ih(t,r,{configurable:!0,enumerable:!1,value:e,writable:!0}):t[r]=e},Hh=function(t,r){var e=arguments.length>2?arguments[2]:{},n=vw(r);yw&&(n=Ew.call(n,Object.getOwnPropertySymbols(r)));for(var o=0;o<n.length;o+=1)Sw(t,n[o],r[n[o]],e[n[o]])};Hh.supportsDescriptors=!!Lh;var rr=Hh,Qr={exports:{}},_w=Vt,es=_w("%Object.getOwnPropertyDescriptor%",!0);if(es)try{es([],"length")}catch{es=null}var Nh=es,Tw=Qa(),$a=Vt,$r=Tw&&$a("%Object.defineProperty%",!0);if($r)try{$r({},"a",{value:1})}catch{$r=!1}var Cw=$a("%SyntaxError%"),or=$a("%TypeError%"),zh=Nh,Pw=function(t,r,e){if(!t||typeof t!="object"&&typeof t!="function")throw new or("`obj` must be an object or a function`");if(typeof r!="string"&&typeof r!="symbol")throw new or("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new or("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new or("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new or("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new or("`loose`, if provided, must be a boolean");var n=arguments.length>3?arguments[3]:null,o=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,h=arguments.length>6?arguments[6]:!1,f=!!zh&&zh(t,r);if($r)$r(t,r,{configurable:l===null&&f?f.configurable:!l,enumerable:n===null&&f?f.enumerable:!n,value:e,writable:o===null&&f?f.writable:!o});else if(h||!n&&!o&&!l)t[r]=e;else throw new Cw("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},jh=Vt,Uh=Pw,Rw=Qa(),Vh=Nh,Wh=jh("%TypeError%"),Aw=jh("%Math.floor%"),Dw=function(t,r){if(typeof t!="function")throw new Wh("`fn` is not a function");if(typeof r!="number"||r<0||r>4294967295||Aw(r)!==r)throw new Wh("`length` must be a positive 32-bit integer");var e=arguments.length>2&&!!arguments[2],n=!0,o=!0;if("length"in t&&Vh){var l=Vh(t,"length");l&&!l.configurable&&(n=!1),l&&!l.writable&&(o=!1)}return(n||o||!e)&&(Rw?Uh(t,"length",r,!0,!0):Uh(t,"length",r)),t};(function(t){var r=Jo,e=Vt,n=Dw,o=e("%TypeError%"),l=e("%Function.prototype.apply%"),h=e("%Function.prototype.call%"),f=e("%Reflect.apply%",!0)||r.call(h,l),g=e("%Object.defineProperty%",!0),v=e("%Math.max%");if(g)try{g({},"a",{value:1})}catch{g=null}t.exports=function(_){if(typeof _!="function")throw new o("a function is required");var C=f(r,h,arguments);return n(C,1+v(0,_.length-(arguments.length-1)),!0)};var E=function(){return f(r,l,arguments)};g?g(t.exports,"apply",{value:E}):t.exports.apply=E})(Qr);var Gh=Vt,qh=Qr.exports,Ow=qh(Gh("String.prototype.indexOf")),$n=function(t,r){var e=Gh(t,!!r);return typeof e=="function"&&Ow(t,".prototype.")>-1?qh(e):e},kw=Vt,Bw=kw("%TypeError%"),Mw=function(t,r){if(t==null)throw new Bw(r||"Cannot call method on "+t);return t},eo=Mw,Fw=Vt,Zh=Fw("%Array%"),Iw=!Zh.isArray&&$n("Object.prototype.toString"),Lw=Zh.isArray||function(t){return Iw(t)==="[object Array]"},Hw=Lw,Xh=Vt,Nw=$n,zw=Xh("%TypeError%"),jw=Hw,Uw=Xh("%Reflect.apply%",!0)||Nw("Function.prototype.apply"),Vw=function(t,r){var e=arguments.length>2?arguments[2]:[];if(!jw(e))throw new zw("Assertion failed: optional `argumentsList`, if provided, must be a List");return Uw(t,r,e)},Ww={},Gw=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ww}),qw=Ma(Gw),el=typeof Map=="function"&&Map.prototype,tl=Object.getOwnPropertyDescriptor&&el?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,ts=el&&tl&&typeof tl.get=="function"?tl.get:null,Yh=el&&Map.prototype.forEach,nl=typeof Set=="function"&&Set.prototype,il=Object.getOwnPropertyDescriptor&&nl?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,ns=nl&&il&&typeof il.get=="function"?il.get:null,Kh=nl&&Set.prototype.forEach,Zw=typeof WeakMap=="function"&&WeakMap.prototype,to=Zw?WeakMap.prototype.has:null,Xw=typeof WeakSet=="function"&&WeakSet.prototype,no=Xw?WeakSet.prototype.has:null,Yw=typeof WeakRef=="function"&&WeakRef.prototype,Jh=Yw?WeakRef.prototype.deref:null,Kw=Boolean.prototype.valueOf,Jw=Object.prototype.toString,Qw=Function.prototype.toString,$w=String.prototype.match,rl=String.prototype.slice,gi=String.prototype.replace,eE=String.prototype.toUpperCase,Qh=String.prototype.toLowerCase,$h=RegExp.prototype.test,ed=Array.prototype.concat,Un=Array.prototype.join,tE=Array.prototype.slice,td=Math.floor,ol=typeof BigInt=="function"?BigInt.prototype.valueOf:null,sl=Object.getOwnPropertySymbols,al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,sr=typeof Symbol=="function"&&typeof Symbol.iterator=="object",nn=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===sr||!0)?Symbol.toStringTag:null,nd=Object.prototype.propertyIsEnumerable,id=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function rd(t,r){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||$h.call(/e/,r))return r;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-td(-t):td(t);if(n!==t){var o=String(n),l=rl.call(r,o.length+1);return gi.call(o,e,"$&_")+"."+gi.call(gi.call(l,/([0-9]{3})/g,"$&_"),/_$/,"")}}return gi.call(r,e,"$&_")}var ll=qw,od=ll.custom,sd=ud(od)?od:null,nE=function t(r,e,n,o){var l=e||{};if(mi(l,"quoteStyle")&&l.quoteStyle!=="single"&&l.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(mi(l,"maxStringLength")&&(typeof l.maxStringLength=="number"?l.maxStringLength<0&&l.maxStringLength!==1/0:l.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var h=mi(l,"customInspect")?l.customInspect:!0;if(typeof h!="boolean"&&h!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(mi(l,"indent")&&l.indent!==null&&l.indent!=="	"&&!(parseInt(l.indent,10)===l.indent&&l.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(mi(l,"numericSeparator")&&typeof l.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var f=l.numericSeparator;if(typeof r>"u")return"undefined";if(r===null)return"null";if(typeof r=="boolean")return r?"true":"false";if(typeof r=="string")return hd(r,l);if(typeof r=="number"){if(r===0)return 1/0/r>0?"0":"-0";var g=String(r);return f?rd(r,g):g}if(typeof r=="bigint"){var v=String(r)+"n";return f?rd(r,v):v}var E=typeof l.depth>"u"?5:l.depth;if(typeof n>"u"&&(n=0),n>=E&&E>0&&typeof r=="object")return ul(r)?"[Array]":"[Object]";var _=EE(l,n);if(typeof o>"u")o=[];else if(cd(o,r)>=0)return"[Circular]";function C(Ue,Ve,et){if(Ve&&(o=tE.call(o),o.push(Ve)),et){var $e={depth:l.depth};return mi(l,"quoteStyle")&&($e.quoteStyle=l.quoteStyle),t(Ue,$e,n+1,o)}return t(Ue,l,n+1,o)}if(typeof r=="function"&&!ld(r)){var k=hE(r),I=is(r,C);return"[Function"+(k?": "+k:" (anonymous)")+"]"+(I.length>0?" { "+Un.call(I,", ")+" }":"")}if(ud(r)){var X=sr?gi.call(String(r),/^(Symbol\(.*\))_[^)]*$/,"$1"):al.call(r);return typeof r=="object"&&!sr?io(X):X}if(vE(r)){for(var U="<"+Qh.call(String(r.nodeName)),$=r.attributes||[],P=0;P<$.length;P++)U+=" "+$[P].name+"="+ad(iE($[P].value),"double",l);return U+=">",r.childNodes&&r.childNodes.length&&(U+="..."),U+="</"+Qh.call(String(r.nodeName))+">",U}if(ul(r)){if(r.length===0)return"[]";var N=is(r,C);return _&&!wE(N)?"["+hl(N,_)+"]":"[ "+Un.call(N,", ")+" ]"}if(oE(r)){var J=is(r,C);return!("cause"in Error.prototype)&&"cause"in r&&!nd.call(r,"cause")?"{ ["+String(r)+"] "+Un.call(ed.call("[cause]: "+C(r.cause),J),", ")+" }":J.length===0?"["+String(r)+"]":"{ ["+String(r)+"] "+Un.call(J,", ")+" }"}if(typeof r=="object"&&h){if(sd&&typeof r[sd]=="function"&&ll)return ll(r,{depth:E-n});if(h!=="symbol"&&typeof r.inspect=="function")return r.inspect()}if(dE(r)){var K=[];return Yh&&Yh.call(r,function(Ue,Ve){K.push(C(Ve,r,!0)+" => "+C(Ue,r))}),dd("Map",ts.call(r),K,_)}if(gE(r)){var oe=[];return Kh&&Kh.call(r,function(Ue){oe.push(C(Ue,r))}),dd("Set",ns.call(r),oe,_)}if(pE(r))return cl("WeakMap");if(mE(r))return cl("WeakSet");if(fE(r))return cl("WeakRef");if(aE(r))return io(C(Number(r)));if(uE(r))return io(C(ol.call(r)));if(lE(r))return io(Kw.call(r));if(sE(r))return io(C(String(r)));if(typeof window<"u"&&r===window)return"{ [object Window] }";if(r===Qn)return"{ [object globalThis] }";if(!rE(r)&&!ld(r)){var ie=is(r,C),me=id?id(r)===Object.prototype:r instanceof Object||r.constructor===Object,we=r instanceof Object?"":"null prototype",De=!me&&nn&&Object(r)===r&&nn in r?rl.call(vi(r),8,-1):we?"Object":"",Be=me||typeof r.constructor!="function"?"":r.constructor.name?r.constructor.name+" ":"",Oe=Be+(De||we?"["+Un.call(ed.call([],De||[],we||[]),": ")+"] ":"");return ie.length===0?Oe+"{}":_?Oe+"{"+hl(ie,_)+"}":Oe+"{ "+Un.call(ie,", ")+" }"}return String(r)};function ad(t,r,e){var n=(e.quoteStyle||r)==="double"?'"':"'";return n+t+n}function iE(t){return gi.call(String(t),/"/g,"&quot;")}function ul(t){return vi(t)==="[object Array]"&&(!nn||!(typeof t=="object"&&nn in t))}function rE(t){return vi(t)==="[object Date]"&&(!nn||!(typeof t=="object"&&nn in t))}function ld(t){return vi(t)==="[object RegExp]"&&(!nn||!(typeof t=="object"&&nn in t))}function oE(t){return vi(t)==="[object Error]"&&(!nn||!(typeof t=="object"&&nn in t))}function sE(t){return vi(t)==="[object String]"&&(!nn||!(typeof t=="object"&&nn in t))}function aE(t){return vi(t)==="[object Number]"&&(!nn||!(typeof t=="object"&&nn in t))}function lE(t){return vi(t)==="[object Boolean]"&&(!nn||!(typeof t=="object"&&nn in t))}function ud(t){if(sr)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!al)return!1;try{return al.call(t),!0}catch{}return!1}function uE(t){if(!t||typeof t!="object"||!ol)return!1;try{return ol.call(t),!0}catch{}return!1}var cE=Object.prototype.hasOwnProperty||function(t){return t in this};function mi(t,r){return cE.call(t,r)}function vi(t){return Jw.call(t)}function hE(t){if(t.name)return t.name;var r=$w.call(Qw.call(t),/^function\s*([\w$]+)/);return r?r[1]:null}function cd(t,r){if(t.indexOf)return t.indexOf(r);for(var e=0,n=t.length;e<n;e++)if(t[e]===r)return e;return-1}function dE(t){if(!ts||!t||typeof t!="object")return!1;try{ts.call(t);try{ns.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function pE(t){if(!to||!t||typeof t!="object")return!1;try{to.call(t,to);try{no.call(t,no)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function fE(t){if(!Jh||!t||typeof t!="object")return!1;try{return Jh.call(t),!0}catch{}return!1}function gE(t){if(!ns||!t||typeof t!="object")return!1;try{ns.call(t);try{ts.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function mE(t){if(!no||!t||typeof t!="object")return!1;try{no.call(t,no);try{to.call(t,to)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function vE(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function hd(t,r){if(t.length>r.maxStringLength){var e=t.length-r.maxStringLength,n="... "+e+" more character"+(e>1?"s":"");return hd(rl.call(t,0,r.maxStringLength),r)+n}var o=gi.call(gi.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,yE);return ad(o,"single",r)}function yE(t){var r=t.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[r];return e?"\\"+e:"\\x"+(r<16?"0":"")+eE.call(r.toString(16))}function io(t){return"Object("+t+")"}function cl(t){return t+" { ? }"}function dd(t,r,e,n){var o=n?hl(e,n):Un.call(e,", ");return t+" ("+r+") {"+o+"}"}function wE(t){for(var r=0;r<t.length;r++)if(cd(t[r],`
`)>=0)return!1;return!0}function EE(t,r){var e;if(t.indent==="	")e="	";else if(typeof t.indent=="number"&&t.indent>0)e=Un.call(Array(t.indent+1)," ");else return null;return{base:e,prev:Un.call(Array(r+1),e)}}function hl(t,r){if(t.length===0)return"";var e=`
`+r.prev+r.base;return e+Un.call(t,","+e)+`
`+r.prev}function is(t,r){var e=ul(t),n=[];if(e){n.length=t.length;for(var o=0;o<t.length;o++)n[o]=mi(t,o)?r(t[o],t):""}var l=typeof sl=="function"?sl(t):[],h;if(sr){h={};for(var f=0;f<l.length;f++)h["$"+l[f]]=l[f]}for(var g in t)!mi(t,g)||e&&String(Number(g))===g&&g<t.length||sr&&h["$"+g]instanceof Symbol||($h.call(/[^\w$]/,g)?n.push(r(g,t)+": "+r(t[g],t)):n.push(g+": "+r(t[g],t)));if(typeof sl=="function")for(var v=0;v<l.length;v++)nd.call(t,l[v])&&n.push("["+r(l[v])+"]: "+r(t[l[v]],t));return n}var pd=function(t){return typeof t=="string"||typeof t=="symbol"},xE=function(t){if(t===null)return"Null";if(typeof t>"u")return"Undefined";if(typeof t=="function"||typeof t=="object")return"Object";if(typeof t=="number")return"Number";if(typeof t=="boolean")return"Boolean";if(typeof t=="string")return"String"},bE=xE,ro=function(t){return typeof t=="symbol"?"Symbol":typeof t=="bigint"?"BigInt":bE(t)},SE=Vt,fd=SE("%TypeError%"),_E=nE,TE=pd,CE=ro,gd=function(t,r){if(CE(t)!=="Object")throw new fd("Assertion failed: Type(O) is not Object");if(!TE(r))throw new fd("Assertion failed: IsPropertyKey(P) is not true, got "+_E(r));return t[r]},PE=Vt,md=PE("%TypeError%"),RE=pd,AE=ro,DE=function(t,r){if(AE(t)!=="Object")throw new md("Assertion failed: `O` must be an Object");if(!RE(r))throw new md("Assertion failed: `P` must be a Property Key");return r in t},vd=Function.prototype.toString,ar=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,dl,rs;if(typeof ar=="function"&&typeof Object.defineProperty=="function")try{dl=Object.defineProperty({},"length",{get:function(){throw rs}}),rs={},ar(function(){throw 42},null,dl)}catch(t){t!==rs&&(ar=null)}else ar=null;var OE=/^\s*class\b/,pl=function(t){try{var r=vd.call(t);return OE.test(r)}catch{return!1}},fl=function(t){try{return pl(t)?!1:(vd.call(t),!0)}catch{return!1}},os=Object.prototype.toString,kE="[object Object]",BE="[object Function]",ME="[object GeneratorFunction]",FE="[object HTMLAllCollection]",IE="[object HTML document.all class]",LE="[object HTMLCollection]",HE=typeof Symbol=="function"&&!!Symbol.toStringTag,NE=!(0 in[,]),gl=function(){return!1};if(typeof document=="object"){var zE=document.all;os.call(zE)===os.call(document.all)&&(gl=function(t){if((NE||!t)&&(typeof t>"u"||typeof t=="object"))try{var r=os.call(t);return(r===FE||r===IE||r===LE||r===kE)&&t("")==null}catch{}return!1})}var yd=ar?function(t){if(gl(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{ar(t,null,dl)}catch(r){if(r!==rs)return!1}return!pl(t)&&fl(t)}:function(t){if(gl(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(HE)return fl(t);if(pl(t))return!1;var r=os.call(t);return r!==BE&&r!==ME&&!/^\[object HTML/.test(r)?!1:fl(t)},jE=yd,UE=Number.MAX_SAFE_INTEGER||9007199254740991,VE=function(t){return t===null||typeof t!="function"&&typeof t!="object"},WE=function(t){return t===null||typeof t!="function"&&typeof t!="object"},GE=Rh,ml=function(){return GE()&&!!Symbol.toStringTag},qE=Date.prototype.getDay,ZE=function(t){try{return qE.call(t),!0}catch{return!1}},XE=Object.prototype.toString,YE="[object Date]",KE=ml(),JE=function(t){return typeof t!="object"||t===null?!1:KE?ZE(t):XE.call(t)===YE},vl={exports:{}},QE=Object.prototype.toString,$E=Dh();if($E){var e1=Symbol.prototype.toString,t1=/^Symbol\(.*\)$/,n1=function(t){return typeof t.valueOf()!="symbol"?!1:t1.test(e1.call(t))};vl.exports=function(t){if(typeof t=="symbol")return!0;if(QE.call(t)!=="[object Symbol]")return!1;try{return n1(t)}catch{return!1}}}else vl.exports=function(t){return!1};var i1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",yl=WE,wd=yd,r1=JE,Ed=vl.exports,o1=function(t,r){if(typeof t>"u"||t===null)throw new TypeError("Cannot call method on "+t);if(typeof r!="string"||r!=="number"&&r!=="string")throw new TypeError('hint must be "string" or "number"');var e=r==="string"?["toString","valueOf"]:["valueOf","toString"],n,o,l;for(l=0;l<e.length;++l)if(n=t[e[l]],wd(n)&&(o=n.call(t),yl(o)))return o;throw new TypeError("No default value")},s1=function(t,r){var e=t[r];if(e!==null&&typeof e<"u"){if(!wd(e))throw new TypeError(e+" returned for property "+r+" of object "+t+" is not a function");return e}},a1=function(t){if(yl(t))return t;var r="default";arguments.length>1&&(arguments[1]===String?r="string":arguments[1]===Number&&(r="number"));var e;if(i1&&(Symbol.toPrimitive?e=s1(t,Symbol.toPrimitive):Ed(t)&&(e=Symbol.prototype.valueOf)),typeof e<"u"){var n=e.call(t,r);if(yl(n))return n;throw new TypeError("unable to convert exotic object to primitive")}return r==="default"&&(r1(t)||Ed(t))&&(r="string"),o1(t,r==="default"?"number":r)},xd=a1,l1=function(t){return arguments.length>1?xd(t,arguments[1]):xd(t)},wl=$n,bd=ml(),Sd,_d,El,xl;if(bd){Sd=wl("Object.prototype.hasOwnProperty"),_d=wl("RegExp.prototype.exec"),El={};var bl=function(){throw El};xl={toString:bl,valueOf:bl},typeof Symbol.toPrimitive=="symbol"&&(xl[Symbol.toPrimitive]=bl)}var u1=wl("Object.prototype.toString"),c1=Object.getOwnPropertyDescriptor,h1="[object RegExp]",d1=bd?function(t){if(!t||typeof t!="object")return!1;var r=c1(t,"lastIndex"),e=r&&Sd(r,"value");if(!e)return!1;try{_d(t,xl)}catch(n){return n===El}}:function(t){return!t||typeof t!="object"&&typeof t!="function"?!1:u1(t)===h1},p1=$n,f1=Vt,g1=d1,m1=p1("RegExp.prototype.exec"),v1=f1("%TypeError%"),y1=function(t){if(!g1(t))throw new v1("`regex` must be a RegExp");return function(r){return m1(t,r)!==null}},Td=Vt,w1=Td("%String%"),E1=Td("%TypeError%"),Cd=function(t){if(typeof t=="symbol")throw new E1("Cannot convert a Symbol value to a string");return w1(t)},x1=eo,b1=Cd,S1=$n,Pd=S1("String.prototype.replace"),Rd=/^\s$/.test(""),_1=Rd?/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/:/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,T1=Rd?/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/:/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/,Ad=function(){var t=b1(x1(this));return Pd(Pd(t,_1,""),T1,"")},C1=Ad,Dd="",lr="",Od=function(){return String.prototype.trim&&Dd.trim()===Dd&&lr.trim()===lr&&("_"+lr).trim()==="_"+lr&&(lr+"_").trim()===lr+"_"?String.prototype.trim:C1},P1=rr,R1=Od,A1=function(){var t=R1();return P1(String.prototype,{trim:t},{trim:function(){return String.prototype.trim!==t}}),t},D1=Qr.exports,O1=rr,k1=eo,B1=Ad,kd=Od,M1=A1,F1=D1(kd()),Bd=function(t){return k1(t),F1(t)};O1(Bd,{getPolyfill:kd,implementation:B1,shim:M1});var Md=Bd,ss=Vt,Sl=ss("%Number%"),I1=ss("%RegExp%"),L1=ss("%TypeError%"),Fd=ss("%parseInt%"),H1=$n,as=y1,Id=H1("String.prototype.slice"),N1=as(/^0b[01]+$/i),z1=as(/^0o[0-7]+$/i),j1=as(/^[-+]0x[0-9a-f]+$/i),U1=["","",""].join(""),V1=new I1("["+U1+"]","g"),W1=as(V1),G1=Md,q1=ro,Z1=function t(r){if(q1(r)!=="String")throw new L1("Assertion failed: `argument` is not a String");if(N1(r))return Sl(Fd(Id(r,2),2));if(z1(r))return Sl(Fd(Id(r,2),8));if(W1(r)||j1(r))return NaN;var e=G1(r);return e!==r?t(e):Sl(r)},Ld=Vt,Hd=Ld("%TypeError%"),Nd=Ld("%Number%"),X1=VE,Y1=l1,K1=Z1,J1=function(t){var r=X1(t)?t:Y1(t,Nd);if(typeof r=="symbol")throw new Hd("Cannot convert a Symbol value to a number");if(typeof r=="bigint")throw new Hd("Conversion from 'BigInt' to 'number' is not allowed.");return typeof r=="string"?K1(r):Nd(r)},Q1=ro,$1=Math.floor,ex=function(t){return Q1(t)==="BigInt"?t:$1(t)},tx=Vt,zd=ex,nx=tx("%TypeError%"),ix=function(t){if(typeof t!="number"&&typeof t!="bigint")throw new nx("argument must be a Number or a BigInt");var r=t<0?-zd(-t):zd(t);return r===0?0:r},jd=Number.isNaN||function(t){return t!==t},rx=jd,ox=function(t){return(typeof t=="number"||typeof t=="bigint")&&!rx(t)&&t!==1/0&&t!==-1/0},sx=J1,ax=ix,lx=jd,ux=ox,cx=function(t){var r=sx(t);return lx(r)||r===0?0:ux(r)?ax(r):r},Ud=UE,hx=cx,dx=function(t){var r=hx(t);return r<=0?0:r>Ud?Ud:r},px=Vt,fx=px("%TypeError%"),gx=gd,mx=dx,vx=ro,yx=function(t){if(vx(t)!=="Object")throw new fx("Assertion failed: `obj` must be an Object");return mx(gx(t,"length"))},wx=Vt,Ex=wx("%Object%"),xx=eo,bx=function(t){return xx(t),Ex(t)},Sx=String.prototype.valueOf,_x=function(t){try{return Sx.call(t),!0}catch{return!1}},Tx=Object.prototype.toString,Cx="[object String]",Px=ml(),Rx=function(t){return typeof t=="string"?!0:typeof t!="object"?!1:Px?_x(t):Tx.call(t)===Cx},Ax=Vt,Dx=$n,Ox=Ax("%TypeError%"),kx=Vw,Bx=gd,Mx=DE,Fx=jE,Ix=yx,Lx=bx,Hx=Cd,Nx=Rx,zx=Dx("String.prototype.split"),Vd=Object("a"),jx=Vd[0]!=="a"||!(0 in Vd),Wd=function(t){var r=Lx(this),e=jx&&Nx(this)?zx(this,""):r,n=Ix(e);if(!Fx(t))throw new Ox("Array.prototype.forEach callback must be a function");var o;arguments.length>1&&(o=arguments[1]);for(var l=0;l<n;){var h=Hx(l),f=Mx(e,h);if(f){var g=Bx(e,h);kx(t,o,[g,l,e])}l+=1}},Ux=function(t){var r=!0,e=!0,n=!1;if(typeof t=="function"){try{t.call("f",function(o,l,h){typeof h!="object"&&(r=!1)}),t.call([null],function(){"use strict";e=typeof this=="string"},"x")}catch{n=!0}return!n&&r&&e}return!1},Vx=Ux,Wx=Wd,Gd=function(){var t=Array.prototype.forEach;return Vx(t)?t:Wx},Gx=rr,qx=Gd,Zx=function(){var t=qx();return Gx(Array.prototype,{forEach:t},{forEach:function(){return Array.prototype.forEach!==t}}),t},Xx=rr,Yx=Qr.exports,Kx=$n,Jx=eo,Qx=Wd,qd=Gd,$x=qd(),eb=Zx,tb=Kx("Array.prototype.slice"),nb=Yx.apply($x),Zd=function(t,r){return Jx(t),nb(t,tb(arguments,1))};Xx(Zd,{getPolyfill:qd,implementation:Qx,shim:eb});var ib=Zd,rb=eo,Xd=$n,ob=Xd("Object.prototype.propertyIsEnumerable"),sb=Xd("Array.prototype.push"),Yd=function(t){var r=rb(t),e=[];for(var n in r)ob(r,n)&&sb(e,[n,r[n]]);return e},ab=Yd,Kd=function(){return typeof Object.entries=="function"?Object.entries:ab},lb=Kd,ub=rr,cb=function(){var t=lb();return ub(Object,{entries:t},{entries:function(){return Object.entries!==t}}),t},hb=rr,db=Qr.exports,pb=Yd,Jd=Kd,fb=cb,Qd=db(Jd(),Object);hb(Qd,{getPolyfill:Jd,implementation:pb,shim:fb});var gb=Qd,mb=Jo,vb=mb.call(Function.call,Object.prototype.hasOwnProperty),ls=ib,_l=gb,$d=vb,yb=Md,wb=function(t){},ep=String.prototype.replace,tp=String.prototype.split,us="||||",Tl=function(t){var r=t%100,e=r%10;return r!==11&&e===1?0:2<=e&&e<=4&&!(r>=12&&r<=14)?1:2},np={pluralTypes:{arabic:function(t){if(t<3)return t;var r=t%100;return r>=3&&r<=10?3:r>=11?4:5},bosnian_serbian:Tl,chinese:function(){return 0},croatian:Tl,french:function(t){return t>=2?1:0},german:function(t){return t!==1?1:0},russian:Tl,lithuanian:function(t){return t%10===1&&t%100!==11?0:t%10>=2&&t%10<=9&&(t%100<11||t%100>19)?1:2},czech:function(t){return t===1?0:t>=2&&t<=4?1:2},polish:function(t){if(t===1)return 0;var r=t%10;return 2<=r&&r<=4&&(t%100<10||t%100>=20)?1:2},icelandic:function(t){return t%10!==1||t%100===11?1:0},slovenian:function(t){var r=t%100;return r===1?0:r===2?1:r===3||r===4?2:3},romanian:function(t){if(t===1)return 0;var r=t%100;return t===0||r>=2&&r<=19?1:2}},pluralTypeToLanguages:{arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is","mk"],slovenian:["sl-SL"],romanian:["ro"]}};function Eb(t){var r={};return ls(_l(t),function(e){var n=e[0],o=e[1];ls(o,function(l){r[l]=n})}),r}function xb(t,r){var e=Eb(t.pluralTypeToLanguages);return e[r]||e[tp.call(r,/-/,1)[0]]||e.en}function bb(t,r,e){return t.pluralTypes[r](e)}function Sb(){var t={};return function(r,e){var n=t[e];return n&&!r.pluralTypes[n]&&(n=null,t[e]=n),n||(n=xb(r,e),n&&(t[e]=n)),n}}function ip(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function _b(t){var r=t&&t.prefix||"%{",e=t&&t.suffix||"}";if(r===us||e===us)throw new RangeError('"'+us+'" token is reserved for pluralization');return new RegExp(ip(r)+"(.*?)"+ip(e),"g")}var Tb=Sb(),Cb=/%\{(.*?)\}/g;function Cl(t,r,e,n,o,l){if(typeof t!="string")throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(r==null)return t;var h=t,f=n||Cb,g=l||ep,v=typeof r=="number"?{smart_count:r}:r;if(v.smart_count!=null&&t){var E=o||np,_=tp.call(t,us),C=e||"en",k=Tb(E,C),I=bb(E,k,v.smart_count);h=yb(_[I]||_[0])}return h=g.call(h,f,function(X,U){return!$d(v,U)||v[U]==null?X:v[U]}),h}function ei(t){var r=t||{};this.phrases={},this.extend(r.phrases||{}),this.currentLocale=r.locale||"en";var e=r.allowMissing?Cl:null;this.onMissingKey=typeof r.onMissingKey=="function"?r.onMissingKey:e,this.warn=r.warn||wb,this.replaceImplementation=r.replace||ep,this.tokenRegex=_b(r.interpolation),this.pluralRules=r.pluralRules||np}ei.prototype.locale=function(t){return t&&(this.currentLocale=t),this.currentLocale},ei.prototype.extend=function(t,r){ls(_l(t||{}),function(e){var n=e[0],o=e[1],l=r?r+"."+n:n;typeof o=="object"?this.extend(o,l):this.phrases[l]=o},this)},ei.prototype.unset=function(t,r){typeof t=="string"?delete this.phrases[t]:ls(_l(t||{}),function(e){var n=e[0],o=e[1],l=r?r+"."+n:n;typeof o=="object"?this.unset(o,l):delete this.phrases[l]},this)},ei.prototype.clear=function(){this.phrases={}},ei.prototype.replace=function(t){this.clear(),this.extend(t)},ei.prototype.t=function(t,r){var e,n,o=r??{};if(typeof this.phrases[t]=="string")e=this.phrases[t];else if(typeof o._=="string")e=o._;else if(this.onMissingKey){var l=this.onMissingKey;n=l(t,o,this.currentLocale,this.tokenRegex,this.pluralRules,this.replaceImplementation)}else this.warn('Missing translation for key: "'+t+'"'),n=t;return typeof e=="string"&&(n=Cl(e,o,this.currentLocale,this.tokenRegex,this.pluralRules,this.replaceImplementation)),n},ei.prototype.has=function(t){return $d(this.phrases,t)},ei.transformPhrase=function(t,r,e){return Cl(t,r,e)};var Pb=ei,Rb={"Add a comment...":" ","Add a reply...":" ","Add tag...":" ",Cancel:"",Close:"",Edit:"Edit",Delete:"Delete",Ok:""},Ab={"Add a comment...":"Napsat koment...","Add a reply...":"Odpovdt...","Add tag...":"Pidat ttek...",Cancel:"Zruit",Close:"Zavt",Edit:"Upravit",Delete:"Smazat",Ok:"Ok"},Db={"Add a comment...":"Kommentar schreiben...","Add a reply...":"Antwort schreiben...","Add tag...":"Tag...",Cancel:"Abbrechen",Close:"Schliessen",Edit:"Bearbeiten",Delete:"Lschen",Ok:"Ok"},Ob={"Add a comment...":"...","Add a reply...":"...","Add tag...":" tag...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:"Ok"},kb={"Add a comment...":"Agregar un comentario...","Add a reply...":"Agregar una respuesta...","Add tag...":"Etiquetar...",Cancel:"Cancelar",Close:"Cerrar",Edit:"Editar",Delete:"Eliminar",Ok:"Ok"},Bb={"Add a comment...":"Lis kommentti","Add a reply...":"Lis vastaus","Add tag...":"Lis tunniste",Cancel:"Peruuta",Close:"Sulje",Edit:"Muokkaa",Delete:"Poista",Ok:"Ok"},Mb={"Add a comment...":"Ajouter un commentaire...","Add a reply...":"Ajouter une rponse...","Add tag...":"Ajouter une tiquette...",Cancel:"Annuler",Close:"Fermer",Edit:"diter",Delete:"Supprimer",Ok:"Ok"},Fb={"Add a comment...":"Engadir un comentario...","Add a reply...":"Engadir unha resposta...","Add tag...":"Etiquetar...",Cancel:"Cancelar",Close:"Pechar",Edit:"Edit",Delete:"Delete",Ok:"Ok"},Ib={"Add a comment...":" ","Add a reply...":" ","Add tag...":" ",Cancel:" ",Close:" ",Edit:" ",Delete:"",Ok:" "},Lb={"Add a comment...":"Commenta...","Add a reply...":"Rispondi...","Add tag...":"Aggiungi tag...",Cancel:"Annulla",Close:"Chiudi",Edit:"Edit",Delete:"Delete",Ok:"Ok"},Hb={"Add a comment...":"...","Add a reply...":"...","Add tag...":"...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:"Ok"},Nb={"Add a comment...":" ","Add a reply...":" ","Add tag...":" ",Cancel:"",Close:"",Edit:"",Delete:"",Ok:""},zb={"Add a comment...":"Commentaar toevoegen...","Add a reply...":"Antwoord toevoegen...","Add tag...":"Tag toevoegen...",Cancel:"Afbreken",Close:"Sluiten",Edit:"Bewerken",Delete:"Verwijderen",Ok:"Ok"},jb={"Add a comment...":"Adicionar um comentrio...","Add a reply...":"Adicionar uma resposta...","Add tag...":"Etiquetar...",Cancel:"Cancelar",Close:"Fechar",Edit:"Editar",Delete:"Apagar",Ok:"Ok"},Ub={"Add a comment...":" ...","Add a reply...":" ...","Add tag...":" ...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:""},Vb={"Add a comment...":"Skriv en kommentar...","Add a reply...":"Skriv ett svar...","Add tag...":"Tagg...",Cancel:"Cancel",Close:"Stng",Edit:"Edit",Delete:"Delete",Ok:"Ok"},Wb={"Add a comment...":"...","Add a reply...":"...","Add tag...":"...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:""},Gb={"Add a comment...":"Yorum ekle...","Add a reply...":"Cevap ekle...","Add tag...":"Tag Ekle...",Cancel:"ptal",Close:"Kapat",Edit:"Dzenle",Delete:"Sil",Ok:"Tamam"},qb={"Add a comment...":" ","Add a reply...":" ","Add tag...":" ",Cancel:" ",Close:" ",Edit:" ",Delete:"",Ok:" "},Zb={"Add a comment...":"...","Add a reply...":"...","Add tag...":"...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:""},Xb={"Add a comment...":"...","Add a reply...":"...","Add tag...":"...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:""},Yb={"Add a comment...":"...","Add a reply...":"...","Add tag...":"...",Cancel:"",Close:"",Edit:"",Delete:"",Ok:""},rp={};Object.defineProperty(rp,"__esModule",{value:!0});var Pl=[["","","%s ","%s "],["","","%s ","%s "],["","","%s ","%s "],["","","%s ","%s "],["","","%s ","%s "],["","","%s ","%s "],["","","%s ","%s "]];function Kb(t,r){return r<3?Pl[t][r-1]:r>=3&&r<=10?Pl[t][2]:Pl[t][3]}function Jb(t,r){if(r===0)return[" "," "];var e=Kb(Math.floor(r/2),t);return[" "+e," "+e]}var Qb=rp.default=Jb,op={};Object.defineProperty(op,"__esModule",{value:!0});function $b(t,r){var e=0,n=r==1||r==3||r==5||r==7||r==9||r==11||r==13;return n&&t>=5&&(e=1),[[["prv te","prv te"]],[["ped %s vteinami","za %s vteiny"],["ped %s vteinami","za %s vtein"]],[["ped minutou","za minutu"]],[["ped %s minutami","za %s minuty"],["ped %s minutami","za %s minut"]],[["ped hodinou","za hodinu"]],[["ped %s hodinami","za %s hodiny"],["ped %s hodinami","za %s hodin"]],[["vera","ztra"]],[["ped %s dny","za %s dny"],["ped %s dny","za %s dn"]],[["minul tden","pt tden"]],[["ped %s tdny","za %s tdny"],["ped %s tdny","za %s tdn"]],[["minul msc","pst msc"]],[["ped %s msci","za %s msce"],["ped %s msci","za %s msc"]],[["ped rokem","pst rok"]],[["ped %s lety","za %s roky"],["ped %s lety","za %s let"]]][r][e]}var eS=op.default=$b,sp={};Object.defineProperty(sp,"__esModule",{value:!0});function tS(t,r){return[["gerade eben","vor einer Weile"],["vor %s Sekunden","in %s Sekunden"],["vor 1 Minute","in 1 Minute"],["vor %s Minuten","in %s Minuten"],["vor 1 Stunde","in 1 Stunde"],["vor %s Stunden","in %s Stunden"],["vor 1 Tag","in 1 Tag"],["vor %s Tagen","in %s Tagen"],["vor 1 Woche","in 1 Woche"],["vor %s Wochen","in %s Wochen"],["vor 1 Monat","in 1 Monat"],["vor %s Monaten","in %s Monaten"],["vor 1 Jahr","in 1 Jahr"],["vor %s Jahren","in %s Jahren"]][r]}var nS=sp.default=tS,ap={};Object.defineProperty(ap,"__esModule",{value:!0});function iS(t,r){return[[" "," "],["%s  "," %s "],["1  "," 1 "],["%s  "," %s "],["1  "," 1 "],["%s  "," %s "],["1  "," 1 "],["%s  "," %s "],["1  "," 1 "],["%s  "," %s "],["1  "," 1 "],["%s  "," %s "],["1  "," 1 "],["%s  "," %s "]][r]}var rS=ap.default=iS,lp={};Object.defineProperty(lp,"__esModule",{value:!0});function oS(t,r){return[["justo ahora","en un rato"],["hace %s segundos","en %s segundos"],["hace 1 minuto","en 1 minuto"],["hace %s minutos","en %s minutos"],["hace 1 hora","en 1 hora"],["hace %s horas","en %s horas"],["hace 1 da","en 1 da"],["hace %s das","en %s das"],["hace 1 semana","en 1 semana"],["hace %s semanas","en %s semanas"],["hace 1 mes","en 1 mes"],["hace %s meses","en %s meses"],["hace 1 ao","en 1 ao"],["hace %s aos","en %s aos"]][r]}var sS=lp.default=oS,up={};Object.defineProperty(up,"__esModule",{value:!0});function aS(t,r){return[["juuri sken","juuri nyt"],["%s sekuntia sitten","%s sekunnin pst"],["minuutti sitten","minuutin pst"],["%s minuuttia sitten","%s minuutin pst"],["tunti sitten","tunnin pst"],["%s tuntia sitten","%s tunnin pst"],["piv sitten","pivn pst"],["%s piv sitten","%s pivn pst"],["viikko sitten","viikon pst"],["%s viikkoa sitten","%s viikon pst"],["kuukausi sitten","kuukauden pst"],["%s kuukautta sitten","%s kuukauden pst"],["vuosi sitten","vuoden pst"],["%s vuotta sitten","%s vuoden pst"]][r]}var lS=up.default=aS,cp={};Object.defineProperty(cp,"__esModule",{value:!0});function uS(t,r){return[[" l'instant","dans un instant"],["il y a %s secondes","dans %s secondes"],["il y a 1 minute","dans 1 minute"],["il y a %s minutes","dans %s minutes"],["il y a 1 heure","dans 1 heure"],["il y a %s heures","dans %s heures"],["il y a 1 jour","dans 1 jour"],["il y a %s jours","dans %s jours"],["il y a 1 semaine","dans 1 semaine"],["il y a %s semaines","dans %s semaines"],["il y a 1 mois","dans 1 mois"],["il y a %s mois","dans %s mois"],["il y a 1 an","dans 1 an"],["il y a %s ans","dans %s ans"]][r]}var cS=cp.default=uS,hp={};Object.defineProperty(hp,"__esModule",{value:!0});function hS(t,r){return[["xusto agora","daqu a un pouco"],["hai %s segundos","en %s segundos"],["hai 1 minuto","nun minuto"],["hai %s minutos","en %s minutos"],["hai 1 hora","nunha hora"],["hai %s horas","en %s horas"],["hai 1 da","nun da"],["hai %s das","en %s das"],["hai 1 semana","nunha semana"],["hai %s semanas","en %s semanas"],["hai 1 mes","nun mes"],["hai %s meses","en %s meses"],["hai 1 ano","nun ano"],["hai %s anos","en %s anos"]][r]}var dS=hp.default=hS,dp={};Object.defineProperty(dp,"__esModule",{value:!0});function pS(t,r){return[[""," "],["%s  ","%s  "],["1  ","1  "],["%s  ","%s  "],["1  ","1  "],["%s  ","%s  "],["1  ","1  "],["%s  ","%s  "],["1  ","1  "],["%s  ","%s  "],["1  ","1  "],["%s  ","%s  "],["1  ","1  "],["%s  ","%s  "]][r]}var fS=dp.default=pS,pp={};Object.defineProperty(pp,"__esModule",{value:!0});function gS(t,r){return[["poco fa","fra poco"],["%s secondi fa","fra %s secondi"],["un minuto fa","fra un minuto"],["%s minuti fa","fra %s minuti"],["un'ora fa","fra un'ora"],["%s ore fa","fra %s ore"],["un giorno fa","fra un giorno"],["%s giorni fa","fra %s giorni"],["una settimana fa","fra una settimana"],["%s settimane fa","fra %s settimane"],["un mese fa","fra un mese"],["%s mesi fa","fra %s mesi"],["un anno fa","fra un anno"],["%s anni fa","fra %s anni"]][r]}var mS=pp.default=gS,fp={};Object.defineProperty(fp,"__esModule",{value:!0});function vS(t,r){return[["",""],["%s","%s"],["1","1"],["%s","%s"],["1","1"],["%s","%s"],["1","1"],["%s","%s"],["1","1"],["%s","%s"],["1","1"],["%s","%s"],["1","1"],["%s","%s"]][r]}var yS=fp.default=vS,gp={};Object.defineProperty(gp,"__esModule",{value:!0});function wS(t,r){return[["",""],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "]][r]}var ES=gp.default=wS,mp={};Object.defineProperty(mp,"__esModule",{value:!0});function xS(t,r){return[["recent","binnenkort"],["%s seconden geleden","binnen %s seconden"],["1 minuut geleden","binnen 1 minuut"],["%s minuten geleden","binnen %s minuten"],["1 uur geleden","binnen 1 uur"],["%s uur geleden","binnen %s uur"],["1 dag geleden","binnen 1 dag"],["%s dagen geleden","binnen %s dagen"],["1 week geleden","binnen 1 week"],["%s weken geleden","binnen %s weken"],["1 maand geleden","binnen 1 maand"],["%s maanden geleden","binnen %s maanden"],["1 jaar geleden","binnen 1 jaar"],["%s jaar geleden","binnen %s jaar"]][r]}var bS=mp.default=xS,vp={};Object.defineProperty(vp,"__esModule",{value:!0});function SS(t,r){return[["agora mesmo","agora"],["h %s segundos","em %s segundos"],["h um minuto","em um minuto"],["h %s minutos","em %s minutos"],["h uma hora","em uma hora"],["h %s horas","em %s horas"],["h um dia","em um dia"],["h %s dias","em %s dias"],["h uma semana","em uma semana"],["h %s semanas","em %s semanas"],["h um ms","em um ms"],["h %s meses","em %s meses"],["h um ano","em um ano"],["h %s anos","em %s anos"]][r]}var _S=vp.default=SS,yp={};Object.defineProperty(yp,"__esModule",{value:!0});function Mi(t,r,e,n,o){var l=o%10,h=n;return o===1?h=t:l===1&&o>20?h=r:l>1&&l<5&&(o>20||o<10)&&(h=e),h}var wp=Mi.bind(null,"","%s ","%s ","%s "),Ep=Mi.bind(null,"","%s ","%s ","%s "),xp=Mi.bind(null,"","%s ","%s ","%s "),bp=Mi.bind(null,"","%s ","%s ","%s "),Sp=Mi.bind(null,"","%s ","%s ","%s "),_p=Mi.bind(null,"","%s ","%s ","%s "),Tp=Mi.bind(null,"","%s ","%s ","%s ");function TS(t,r){switch(r){case 0:return[" ","  "];case 1:return[wp(t)+" "," "+wp(t)];case 2:case 3:return[Ep(t)+" "," "+Ep(t)];case 4:case 5:return[xp(t)+" "," "+xp(t)];case 6:return["",""];case 7:return[bp(t)+" "," "+bp(t)];case 8:case 9:return[Sp(t)+" "," "+Sp(t)];case 10:case 11:return[_p(t)+" "," "+_p(t)];case 12:case 13:return[Tp(t)+" "," "+Tp(t)];default:return["",""]}}var CS=yp.default=TS,Cp={};Object.defineProperty(Cp,"__esModule",{value:!0});function PS(t,r){return[["just nu","om en stund"],["%s sekunder sedan","om %s sekunder"],["1 minut sedan","om 1 minut"],["%s minuter sedan","om %s minuter"],["1 timme sedan","om 1 timme"],["%s timmar sedan","om %s timmar"],["1 dag sedan","om 1 dag"],["%s dagar sedan","om %s dagar"],["1 vecka sedan","om 1 vecka"],["%s veckor sedan","om %s veckor"],["1 mnad sedan","om 1 mnad"],["%s mnader sedan","om %s mnader"],["1 r sedan","om 1 r"],["%s r sedan","om %s r"]][r]}var RS=Cp.default=PS,Pp={};Object.defineProperty(Pp,"__esModule",{value:!0});function AS(t,r){return[["",""],["%s "," %s "],["1 "," 1 "],["%s "," %s "],["1 "," 1 "],["%s "," %s "],["1 "," 1 "],["%s "," %s "],["1 "," 1 "],["%s "," %s "],["1 "," 1 "],["%s "," %s "],["1 "," 1 "],["%s "," %s "]][r]}var DS=Pp.default=AS,Rp={};Object.defineProperty(Rp,"__esModule",{value:!0});function OS(t,r){return[["az nce","imdi"],["%s saniye nce","%s saniye iinde"],["1 dakika nce","1 dakika iinde"],["%s dakika nce","%s dakika iinde"],["1 saat nce","1 saat iinde"],["%s saat nce","%s saat iinde"],["1 gn nce","1 gn iinde"],["%s gn nce","%s gn iinde"],["1 hafta nce","1 hafta iinde"],["%s hafta nce","%s hafta iinde"],["1 ay nce","1 ay iinde"],["%s ay nce","%s ay iinde"],["1 yl nce","1 yl iinde"],["%s yl nce","%s yl iinde"]][r]}var kS=Rp.default=OS,Ap={};Object.defineProperty(Ap,"__esModule",{value:!0});var BS=["","","","","","",""];function MS(t,r){if(r===0)return["",""];var e=BS[~~(r/2)];return[t+" "+e+"",t+" "+e+""]}var Dp=Ap.default=MS,Op={};Object.defineProperty(Op,"__esModule",{value:!0});function FS(t,r){return[["",""],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "],["1 ","1 "],["%s ","%s "]][r]}var IS=Op.default=FS;const ur={ar:Rb,cs:Ab,de:Db,el:Ob,es:kb,fi:Bb,fr:Mb,gl:Fb,hi:Ib,it:Lb,ja:Hb,ko:Nb,nl:zb,pt:jb,ru:Ub,sv:Vb,th:Wb,tr:Gb,ur:qb,zh:Zb,"zh-CN":Xb,"zh-TW":Yb},LS=Object.keys(ur),Fi=new Pb({allowMissing:!0});Fi.init=(t,r)=>{Fi.clear(),t&&(Fi.locale(t),Fi.extend(ur[t])),r&&Fi.extend(r)},Bt("ar",Qb),Bt("cs",eS),Bt("de",nS),Bt("el",rS),Bt("es",sS),Bt("fi",lS),Bt("fr",cS),Bt("gl",dS),Bt("hi",fS),Bt("it",mS),Bt("ja",yS),Bt("ko",ES),Bt("nl",bS),Bt("pt",_S),Bt("ru",CS),Bt("sv",RS),Bt("th",DS),Bt("tr",kS),Bt("zh",Dp),Bt("zh-CN",Dp),Bt("zh-TW",IS),Fi.registerMessages=(t,r)=>{ur[t]?ur[t]={...ur[t],...r}:ur[t]=r};var bn=Fi,HS=t=>{const r=ae();return ky(r,()=>t.onClickOutside()),fe.createElement("ul",{ref:r,className:"r6o-comment-dropdown-menu"},fe.createElement("li",{onClick:t.onEdit},bn.t("Edit")),fe.createElement("li",{onClick:t.onDelete},bn.t("Delete")))},kp={},Rl={},Al={exports:{}};/*!
	autosize 4.0.4
	license: MIT
	http://www.jacklmoore.com/autosize
*/(function(t,r){(function(e,n){n(t,r)})(Qn,function(e,n){var o=typeof Map=="function"?new Map:function(){var E=[],_=[];return{has:function(C){return E.indexOf(C)>-1},get:function(C){return _[E.indexOf(C)]},set:function(C,k){E.indexOf(C)===-1&&(E.push(C),_.push(k))},delete:function(C){var k=E.indexOf(C);k>-1&&(E.splice(k,1),_.splice(k,1))}}}(),l=function(E){return new Event(E,{bubbles:!0})};try{new Event("test")}catch{l=function(E){var _=document.createEvent("Event");return _.initEvent(E,!0,!1),_}}function h(E){if(!E||!E.nodeName||E.nodeName!=="TEXTAREA"||o.has(E))return;var _=null,C=null,k=null;function I(){var K=window.getComputedStyle(E,null);K.resize==="vertical"?E.style.resize="none":K.resize==="both"&&(E.style.resize="horizontal"),K.boxSizing==="content-box"?_=-(parseFloat(K.paddingTop)+parseFloat(K.paddingBottom)):_=parseFloat(K.borderTopWidth)+parseFloat(K.borderBottomWidth),isNaN(_)&&(_=0),P()}function X(K){{var oe=E.style.width;E.style.width="0px",E.offsetWidth,E.style.width=oe}E.style.overflowY=K}function U(K){for(var oe=[];K&&K.parentNode&&K.parentNode instanceof Element;)K.parentNode.scrollTop&&oe.push({node:K.parentNode,scrollTop:K.parentNode.scrollTop}),K=K.parentNode;return oe}function $(){if(E.scrollHeight!==0){var K=U(E),oe=document.documentElement&&document.documentElement.scrollTop;E.style.height="",E.style.height=E.scrollHeight+_+"px",C=E.clientWidth,K.forEach(function(ie){ie.node.scrollTop=ie.scrollTop}),oe&&(document.documentElement.scrollTop=oe)}}function P(){$();var K=Math.round(parseFloat(E.style.height)),oe=window.getComputedStyle(E,null),ie=oe.boxSizing==="content-box"?Math.round(parseFloat(oe.height)):E.offsetHeight;if(ie<K?oe.overflowY==="hidden"&&(X("scroll"),$(),ie=oe.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(E,null).height)):E.offsetHeight):oe.overflowY!=="hidden"&&(X("hidden"),$(),ie=oe.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(E,null).height)):E.offsetHeight),k!==ie){k=ie;var me=l("autosize:resized");try{E.dispatchEvent(me)}catch{}}}var N=function(){E.clientWidth!==C&&P()},J=(function(K){window.removeEventListener("resize",N,!1),E.removeEventListener("input",P,!1),E.removeEventListener("keyup",P,!1),E.removeEventListener("autosize:destroy",J,!1),E.removeEventListener("autosize:update",P,!1),Object.keys(K).forEach(function(oe){E.style[oe]=K[oe]}),o.delete(E)}).bind(E,{height:E.style.height,resize:E.style.resize,overflowY:E.style.overflowY,overflowX:E.style.overflowX,wordWrap:E.style.wordWrap});E.addEventListener("autosize:destroy",J,!1),"onpropertychange"in E&&"oninput"in E&&E.addEventListener("keyup",P,!1),window.addEventListener("resize",N,!1),E.addEventListener("input",P,!1),E.addEventListener("autosize:update",P,!1),E.style.overflowX="hidden",E.style.wordWrap="break-word",o.set(E,{destroy:J,update:P}),I()}function f(E){var _=o.get(E);_&&_.destroy()}function g(E){var _=o.get(E);_&&_.update()}var v=null;typeof window>"u"||typeof window.getComputedStyle!="function"?(v=function(E){return E},v.destroy=function(E){return E},v.update=function(E){return E}):(v=function(E,_){return E&&Array.prototype.forEach.call(E.length?E:[E],function(C){return h(C)}),E},v.destroy=function(E){return E&&Array.prototype.forEach.call(E.length?E:[E],f),E},v.update=function(E){return E&&Array.prototype.forEach.call(E.length?E:[E],g),E}),n.default=v,e.exports=n.default})})(Al,Al.exports);var NS=function(t,r,e){return e=window.getComputedStyle,(e?e(t):t.currentStyle)[r.replace(/-(\w)/gi,function(n,o){return o.toUpperCase()})]},zS=NS,Dl=zS;function jS(t){var r=Dl(t,"line-height"),e=parseFloat(r,10);if(r===e+""){var n=t.style.lineHeight;t.style.lineHeight=r+"em",r=Dl(t,"line-height"),e=parseFloat(r,10),n?t.style.lineHeight=n:delete t.style.lineHeight}if(r.indexOf("pt")!==-1?(e*=4,e/=3):r.indexOf("mm")!==-1?(e*=96,e/=25.4):r.indexOf("cm")!==-1?(e*=96,e/=2.54):r.indexOf("in")!==-1?e*=96:r.indexOf("pc")!==-1&&(e*=16),e=Math.round(e),r==="normal"){var o=t.nodeName,l=document.createElement(o);l.innerHTML="&nbsp;",o.toUpperCase()==="TEXTAREA"&&l.setAttribute("rows","1");var h=Dl(t,"font-size");l.style.fontSize=h,l.style.padding="0px",l.style.border="0px";var f=document.body;f.appendChild(l);var g=l.offsetHeight;e=g,f.removeChild(l)}return e}var US=jS,VS=Qn&&Qn.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n])};return function(r,e){t(r,e);function n(){this.constructor=r}r.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ol=Qn&&Qn.__assign||Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++){r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},WS=Qn&&Qn.__rest||function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)r.indexOf(n[o])<0&&(e[n[o]]=t[n[o]]);return e};Rl.__esModule=!0;var cs=Qi,oo=Yr.exports,hs=Al.exports,GS=US,qS=GS,Bp="autosize:resized",ZS=function(t){VS(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.state={lineHeight:null},e.textarea=null,e.onResize=function(n){e.props.onResize&&e.props.onResize(n)},e.updateLineHeight=function(){e.textarea&&e.setState({lineHeight:qS(e.textarea)})},e.onChange=function(n){var o=e.props.onChange;e.currentValue=n.currentTarget.value,o&&o(n)},e}return r.prototype.componentDidMount=function(){var e=this,n=this.props,o=n.maxRows,l=n.async;typeof o=="number"&&this.updateLineHeight(),typeof o=="number"||l?setTimeout(function(){return e.textarea&&hs(e.textarea)}):this.textarea&&hs(this.textarea),this.textarea&&this.textarea.addEventListener(Bp,this.onResize)},r.prototype.componentWillUnmount=function(){this.textarea&&(this.textarea.removeEventListener(Bp,this.onResize),hs.destroy(this.textarea))},r.prototype.render=function(){var e=this,n=this,o=n.props;o.onResize;var l=o.maxRows;o.onChange;var h=o.style;o.innerRef;var f=o.children,g=WS(o,["onResize","maxRows","onChange","style","innerRef","children"]),v=n.state.lineHeight,E=l&&v?v*l:null;return cs.createElement("textarea",Ol({},g,{onChange:this.onChange,style:E?Ol({},h,{maxHeight:E}):h,ref:function(_){e.textarea=_,typeof e.props.innerRef=="function"?e.props.innerRef(_):e.props.innerRef&&(e.props.innerRef.current=_)}}),f)},r.prototype.componentDidUpdate=function(){this.textarea&&hs.update(this.textarea)},r.defaultProps={rows:1,async:!1},r.propTypes={rows:oo.number,maxRows:oo.number,onResize:oo.func,innerRef:oo.any,async:oo.bool},r}(cs.Component);Rl.TextareaAutosize=cs.forwardRef(function(t,r){return cs.createElement(ZS,Ol({},t,{innerRef:r}))}),function(t){t.__esModule=!0;var r=Rl;t.default=r.TextareaAutosize}(kp);var XS=Av(kp);class Mp extends se{constructor(r){super(r),i(this,"onKeyDown",e=>{e.which===13&&e.ctrlKey&&this.props.onSaveAndClose()}),i(this,"onKeyUp",e=>{e.which===46&&e.stopPropagation()}),this.element=G()}componentDidMount(){this.props.focus&&this.element.current&&this.element.current.focus({preventScroll:!0})}render(){return fe.createElement(XS,{ref:this.element,className:"r6o-editable-text",value:this.props.content,placeholder:this.props.placeholder||bn.t("Add a comment..."),disabled:!this.props.editable,onChange:this.props.onChange,onKeyUp:this.onKeyUp,onKeyDown:this.onKeyDown})}}function Ye(){return Ye=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Ye.apply(this,arguments)}function YS(t){if(t.sheet)return t.sheet;for(var r=0;r<document.styleSheets.length;r++)if(document.styleSheets[r].ownerNode===t)return document.styleSheets[r]}function KS(t){var r=document.createElement("style");return r.setAttribute("data-emotion",t.key),t.nonce!==void 0&&r.setAttribute("nonce",t.nonce),r.appendChild(document.createTextNode("")),r.setAttribute("data-s",""),r}var JS=function(){function t(e){var n=this;this._insertTag=function(o){var l;n.tags.length===0?n.insertionPoint?l=n.insertionPoint.nextSibling:n.prepend?l=n.container.firstChild:l=n.before:l=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(o,l),n.tags.push(o)},this.isSpeedy=e.speedy===void 0?!0:e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var r=t.prototype;return r.hydrate=function(e){e.forEach(this._insertTag)},r.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(KS(this));var n=this.tags[this.tags.length-1];if(this.isSpeedy){var o=YS(n);try{o.insertRule(e,o.cssRules.length)}catch{}}else n.appendChild(document.createTextNode(e));this.ctr++},r.flush=function(){this.tags.forEach(function(e){return e.parentNode&&e.parentNode.removeChild(e)}),this.tags=[],this.ctr=0},t}(),rn="-ms-",ds="-moz-",wt="-webkit-",Fp="comm",kl="rule",Bl="decl",QS="@import",Ip="@keyframes",$S="@layer",e_=Math.abs,ps=String.fromCharCode,t_=Object.assign;function n_(t,r){return Kt(t,0)^45?(((r<<2^Kt(t,0))<<2^Kt(t,1))<<2^Kt(t,2))<<2^Kt(t,3):0}function Lp(t){return t.trim()}function i_(t,r){return(t=r.exec(t))?t[0]:t}function Et(t,r,e){return t.replace(r,e)}function Ml(t,r){return t.indexOf(r)}function Kt(t,r){return t.charCodeAt(r)|0}function so(t,r,e){return t.slice(r,e)}function Vn(t){return t.length}function Fl(t){return t.length}function fs(t,r){return r.push(t),t}function r_(t,r){return t.map(r).join("")}var gs=1,cr=1,Hp=0,pn=0,zt=0,hr="";function ms(t,r,e,n,o,l,h){return{value:t,root:r,parent:e,type:n,props:o,children:l,line:gs,column:cr,length:h,return:""}}function ao(t,r){return t_(ms("",null,null,"",null,null,0),t,{length:-t.length},r)}function o_(){return zt}function s_(){return zt=pn>0?Kt(hr,--pn):0,cr--,zt===10&&(cr=1,gs--),zt}function Sn(){return zt=pn<Hp?Kt(hr,pn++):0,cr++,zt===10&&(cr=1,gs++),zt}function Wn(){return Kt(hr,pn)}function vs(){return pn}function lo(t,r){return so(hr,t,r)}function uo(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Np(t){return gs=cr=1,Hp=Vn(hr=t),pn=0,[]}function zp(t){return hr="",t}function ys(t){return Lp(lo(pn-1,Il(t===91?t+2:t===40?t+1:t)))}function a_(t){for(;(zt=Wn())&&zt<33;)Sn();return uo(t)>2||uo(zt)>3?"":" "}function l_(t,r){for(;--r&&Sn()&&!(zt<48||zt>102||zt>57&&zt<65||zt>70&&zt<97););return lo(t,vs()+(r<6&&Wn()==32&&Sn()==32))}function Il(t){for(;Sn();)switch(zt){case t:return pn;case 34:case 39:t!==34&&t!==39&&Il(zt);break;case 40:t===41&&Il(t);break;case 92:Sn();break}return pn}function u_(t,r){for(;Sn()&&t+zt!==57&&!(t+zt===84&&Wn()===47););return"/*"+lo(r,pn-1)+"*"+ps(t===47?t:Sn())}function c_(t){for(;!uo(Wn());)Sn();return lo(t,pn)}function h_(t){return zp(ws("",null,null,null,[""],t=Np(t),0,[0],t))}function ws(t,r,e,n,o,l,h,f,g){for(var v=0,E=0,_=h,C=0,k=0,I=0,X=1,U=1,$=1,P=0,N="",J=o,K=l,oe=n,ie=N;U;)switch(I=P,P=Sn()){case 40:if(I!=108&&Kt(ie,_-1)==58){Ml(ie+=Et(ys(P),"&","&\f"),"&\f")!=-1&&($=-1);break}case 34:case 39:case 91:ie+=ys(P);break;case 9:case 10:case 13:case 32:ie+=a_(I);break;case 92:ie+=l_(vs()-1,7);continue;case 47:switch(Wn()){case 42:case 47:fs(d_(u_(Sn(),vs()),r,e),g);break;default:ie+="/"}break;case 123*X:f[v++]=Vn(ie)*$;case 125*X:case 59:case 0:switch(P){case 0:case 125:U=0;case 59+E:$==-1&&(ie=Et(ie,/\f/g,"")),k>0&&Vn(ie)-_&&fs(k>32?Up(ie+";",n,e,_-1):Up(Et(ie," ","")+";",n,e,_-2),g);break;case 59:ie+=";";default:if(fs(oe=jp(ie,r,e,v,E,o,f,N,J=[],K=[],_),l),P===123)if(E===0)ws(ie,r,oe,oe,J,l,_,f,K);else switch(C===99&&Kt(ie,3)===110?100:C){case 100:case 108:case 109:case 115:ws(t,oe,oe,n&&fs(jp(t,oe,oe,0,0,o,f,N,o,J=[],_),K),o,K,_,f,n?J:K);break;default:ws(ie,oe,oe,oe,[""],K,0,f,K)}}v=E=k=0,X=$=1,N=ie="",_=h;break;case 58:_=1+Vn(ie),k=I;default:if(X<1){if(P==123)--X;else if(P==125&&X++==0&&s_()==125)continue}switch(ie+=ps(P),P*X){case 38:$=E>0?1:(ie+="\f",-1);break;case 44:f[v++]=(Vn(ie)-1)*$,$=1;break;case 64:Wn()===45&&(ie+=ys(Sn())),C=Wn(),E=_=Vn(N=ie+=c_(vs())),P++;break;case 45:I===45&&Vn(ie)==2&&(X=0)}}return l}function jp(t,r,e,n,o,l,h,f,g,v,E){for(var _=o-1,C=o===0?l:[""],k=Fl(C),I=0,X=0,U=0;I<n;++I)for(var $=0,P=so(t,_+1,_=e_(X=h[I])),N=t;$<k;++$)(N=Lp(X>0?C[$]+" "+P:Et(P,/&\f/g,C[$])))&&(g[U++]=N);return ms(t,r,e,o===0?kl:f,g,v,E)}function d_(t,r,e){return ms(t,r,e,Fp,ps(o_()),so(t,2,-2),0)}function Up(t,r,e,n){return ms(t,r,e,Bl,so(t,0,n),so(t,n+1,-1),n)}function dr(t,r){for(var e="",n=Fl(t),o=0;o<n;o++)e+=r(t[o],o,t,r)||"";return e}function p_(t,r,e,n){switch(t.type){case $S:if(t.children.length)break;case QS:case Bl:return t.return=t.return||t.value;case Fp:return"";case Ip:return t.return=t.value+"{"+dr(t.children,n)+"}";case kl:t.value=t.props.join(",")}return Vn(e=dr(t.children,n))?t.return=t.value+"{"+e+"}":""}function f_(t){var r=Fl(t);return function(e,n,o,l){for(var h="",f=0;f<r;f++)h+=t[f](e,n,o,l)||"";return h}}function g_(t){return function(r){r.root||(r=r.return)&&t(r)}}function m_(t){var r=Object.create(null);return function(e){return r[e]===void 0&&(r[e]=t(e)),r[e]}}var v_=function(t,r,e){for(var n=0,o=0;n=o,o=Wn(),n===38&&o===12&&(r[e]=1),!uo(o);)Sn();return lo(t,pn)},y_=function(t,r){var e=-1,n=44;do switch(uo(n)){case 0:n===38&&Wn()===12&&(r[e]=1),t[e]+=v_(pn-1,r,e);break;case 2:t[e]+=ys(n);break;case 4:if(n===44){t[++e]=Wn()===58?"&\f":"",r[e]=t[e].length;break}default:t[e]+=ps(n)}while(n=Sn());return t},w_=function(t,r){return zp(y_(Np(t),r))},Vp=new WeakMap,E_=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var r=t.value,e=t.parent,n=t.column===e.column&&t.line===e.line;e.type!=="rule";)if(e=e.parent,!e)return;if(!(t.props.length===1&&r.charCodeAt(0)!==58&&!Vp.get(e))&&!n){Vp.set(t,!0);for(var o=[],l=w_(r,o),h=e.props,f=0,g=0;f<l.length;f++)for(var v=0;v<h.length;v++,g++)t.props[g]=o[f]?l[f].replace(/&\f/g,h[v]):h[v]+" "+l[f]}}},x_=function(t){if(t.type==="decl"){var r=t.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(t.return="",t.value="")}};function Wp(t,r){switch(n_(t,r)){case 5103:return wt+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return wt+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return wt+t+ds+t+rn+t+t;case 6828:case 4268:return wt+t+rn+t+t;case 6165:return wt+t+rn+"flex-"+t+t;case 5187:return wt+t+Et(t,/(\w+).+(:[^]+)/,wt+"box-$1$2"+rn+"flex-$1$2")+t;case 5443:return wt+t+rn+"flex-item-"+Et(t,/flex-|-self/,"")+t;case 4675:return wt+t+rn+"flex-line-pack"+Et(t,/align-content|flex-|-self/,"")+t;case 5548:return wt+t+rn+Et(t,"shrink","negative")+t;case 5292:return wt+t+rn+Et(t,"basis","preferred-size")+t;case 6060:return wt+"box-"+Et(t,"-grow","")+wt+t+rn+Et(t,"grow","positive")+t;case 4554:return wt+Et(t,/([^-])(transform)/g,"$1"+wt+"$2")+t;case 6187:return Et(Et(Et(t,/(zoom-|grab)/,wt+"$1"),/(image-set)/,wt+"$1"),t,"")+t;case 5495:case 3959:return Et(t,/(image-set\([^]*)/,wt+"$1$`$1");case 4968:return Et(Et(t,/(.+:)(flex-)?(.*)/,wt+"box-pack:$3"+rn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+wt+t+t;case 4095:case 3583:case 4068:case 2532:return Et(t,/(.+)-inline(.+)/,wt+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Vn(t)-1-r>6)switch(Kt(t,r+1)){case 109:if(Kt(t,r+4)!==45)break;case 102:return Et(t,/(.+:)(.+)-([^]+)/,"$1"+wt+"$2-$3$1"+ds+(Kt(t,r+3)==108?"$3":"$2-$3"))+t;case 115:return~Ml(t,"stretch")?Wp(Et(t,"stretch","fill-available"),r)+t:t}break;case 4949:if(Kt(t,r+1)!==115)break;case 6444:switch(Kt(t,Vn(t)-3-(~Ml(t,"!important")&&10))){case 107:return Et(t,":",":"+wt)+t;case 101:return Et(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+wt+(Kt(t,14)===45?"inline-":"")+"box$3$1"+wt+"$2$3$1"+rn+"$2box$3")+t}break;case 5936:switch(Kt(t,r+11)){case 114:return wt+t+rn+Et(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return wt+t+rn+Et(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return wt+t+rn+Et(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return wt+t+rn+t+t}return t}var b_=function(t,r,e,n){if(t.length>-1&&!t.return)switch(t.type){case Bl:t.return=Wp(t.value,t.length);break;case Ip:return dr([ao(t,{value:Et(t.value,"@","@"+wt)})],n);case kl:if(t.length)return r_(t.props,function(o){switch(i_(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return dr([ao(t,{props:[Et(o,/:(read-\w+)/,":"+ds+"$1")]})],n);case"::placeholder":return dr([ao(t,{props:[Et(o,/:(plac\w+)/,":"+wt+"input-$1")]}),ao(t,{props:[Et(o,/:(plac\w+)/,":"+ds+"$1")]}),ao(t,{props:[Et(o,/:(plac\w+)/,rn+"input-$1")]})],n)}return""})}},S_=[b_],__=function(t){var r=t.key;if(r==="css"){var e=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(e,function(I){var X=I.getAttribute("data-emotion");X.indexOf(" ")!==-1&&(document.head.appendChild(I),I.setAttribute("data-s",""))})}var n=t.stylisPlugins||S_,o={},l,h=[];l=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(I){for(var X=I.getAttribute("data-emotion").split(" "),U=1;U<X.length;U++)o[X[U]]=!0;h.push(I)});var f,g=[E_,x_];{var v,E=[p_,g_(function(I){v.insert(I)})],_=f_(g.concat(n,E)),C=function(I){return dr(h_(I),_)};f=function(I,X,U,$){v=U,C(I?I+"{"+X.styles+"}":X.styles),$&&(k.inserted[X.name]=!0)}}var k={key:r,sheet:new JS({key:r,container:l,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:o,registered:{},insert:f};return k.sheet.hydrate(h),k},Gp={exports:{}},St={};/** @license React v16.13.1
* react-is.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Zt=typeof Symbol=="function"&&Symbol.for,Ll=Zt?Symbol.for("react.element"):60103,Hl=Zt?Symbol.for("react.portal"):60106,Es=Zt?Symbol.for("react.fragment"):60107,xs=Zt?Symbol.for("react.strict_mode"):60108,bs=Zt?Symbol.for("react.profiler"):60114,Ss=Zt?Symbol.for("react.provider"):60109,_s=Zt?Symbol.for("react.context"):60110,Nl=Zt?Symbol.for("react.async_mode"):60111,Ts=Zt?Symbol.for("react.concurrent_mode"):60111,Cs=Zt?Symbol.for("react.forward_ref"):60112,Ps=Zt?Symbol.for("react.suspense"):60113,T_=Zt?Symbol.for("react.suspense_list"):60120,Rs=Zt?Symbol.for("react.memo"):60115,As=Zt?Symbol.for("react.lazy"):60116,C_=Zt?Symbol.for("react.block"):60121,P_=Zt?Symbol.for("react.fundamental"):60117,R_=Zt?Symbol.for("react.responder"):60118,A_=Zt?Symbol.for("react.scope"):60119;function _n(t){if(typeof t=="object"&&t!==null){var r=t.$$typeof;switch(r){case Ll:switch(t=t.type,t){case Nl:case Ts:case Es:case bs:case xs:case Ps:return t;default:switch(t=t&&t.$$typeof,t){case _s:case Cs:case As:case Rs:case Ss:return t;default:return r}}case Hl:return r}}}function qp(t){return _n(t)===Ts}St.AsyncMode=Nl,St.ConcurrentMode=Ts,St.ContextConsumer=_s,St.ContextProvider=Ss,St.Element=Ll,St.ForwardRef=Cs,St.Fragment=Es,St.Lazy=As,St.Memo=Rs,St.Portal=Hl,St.Profiler=bs,St.StrictMode=xs,St.Suspense=Ps,St.isAsyncMode=function(t){return qp(t)||_n(t)===Nl},St.isConcurrentMode=qp,St.isContextConsumer=function(t){return _n(t)===_s},St.isContextProvider=function(t){return _n(t)===Ss},St.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ll},St.isForwardRef=function(t){return _n(t)===Cs},St.isFragment=function(t){return _n(t)===Es},St.isLazy=function(t){return _n(t)===As},St.isMemo=function(t){return _n(t)===Rs},St.isPortal=function(t){return _n(t)===Hl},St.isProfiler=function(t){return _n(t)===bs},St.isStrictMode=function(t){return _n(t)===xs},St.isSuspense=function(t){return _n(t)===Ps},St.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Es||t===Ts||t===bs||t===xs||t===Ps||t===T_||typeof t=="object"&&t!==null&&(t.$$typeof===As||t.$$typeof===Rs||t.$$typeof===Ss||t.$$typeof===_s||t.$$typeof===Cs||t.$$typeof===P_||t.$$typeof===R_||t.$$typeof===A_||t.$$typeof===C_)},St.typeOf=_n,Gp.exports=St;var Zp=Gp.exports,D_={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},O_={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Xp={};Xp[Zp.ForwardRef]=D_,Xp[Zp.Memo]=O_;var k_=!0;function Yp(t,r,e){var n="";return e.split(" ").forEach(function(o){t[o]!==void 0?r.push(t[o]+";"):n+=o+" "}),n}var zl=function(t,r,e){var n=t.key+"-"+r.name;(e===!1||k_===!1)&&t.registered[n]===void 0&&(t.registered[n]=r.styles)},Kp=function(t,r,e){zl(t,r,e);var n=t.key+"-"+r.name;if(t.inserted[r.name]===void 0){var o=r;do t.insert(r===o?"."+n:"",o,t.sheet,!0),o=o.next;while(o!==void 0)}};function B_(t){for(var r=0,e,n=0,o=t.length;o>=4;++n,o-=4)e=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,e=(e&65535)*1540483477+((e>>>16)*59797<<16),e^=e>>>24,r=(e&65535)*1540483477+((e>>>16)*59797<<16)^(r&65535)*1540483477+((r>>>16)*59797<<16);switch(o){case 3:r^=(t.charCodeAt(n+2)&255)<<16;case 2:r^=(t.charCodeAt(n+1)&255)<<8;case 1:r^=t.charCodeAt(n)&255,r=(r&65535)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,r=(r&65535)*1540483477+((r>>>16)*59797<<16),((r^r>>>15)>>>0).toString(36)}var M_={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},F_=/[A-Z]|^ms/g,I_=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Jp=function(t){return t.charCodeAt(1)===45},Qp=function(t){return t!=null&&typeof t!="boolean"},jl=m_(function(t){return Jp(t)?t:t.replace(F_,"-$&").toLowerCase()}),$p=function(t,r){switch(t){case"animation":case"animationName":if(typeof r=="string")return r.replace(I_,function(e,n,o){return Gn={name:n,styles:o,next:Gn},n})}return M_[t]!==1&&!Jp(t)&&typeof r=="number"&&r!==0?r+"px":r};function co(t,r,e){if(e==null)return"";if(e.__emotion_styles!==void 0)return e;switch(typeof e){case"boolean":return"";case"object":{if(e.anim===1)return Gn={name:e.name,styles:e.styles,next:Gn},e.name;if(e.styles!==void 0){var n=e.next;if(n!==void 0)for(;n!==void 0;)Gn={name:n.name,styles:n.styles,next:Gn},n=n.next;var o=e.styles+";";return o}return L_(t,r,e)}case"function":{if(t!==void 0){var l=Gn,h=e(t);return Gn=l,co(t,r,h)}break}}if(r==null)return e;var f=r[e];return f!==void 0?f:e}function L_(t,r,e){var n="";if(Array.isArray(e))for(var o=0;o<e.length;o++)n+=co(t,r,e[o])+";";else for(var l in e){var h=e[l];if(typeof h!="object")r!=null&&r[h]!==void 0?n+=l+"{"+r[h]+"}":Qp(h)&&(n+=jl(l)+":"+$p(l,h)+";");else if(Array.isArray(h)&&typeof h[0]=="string"&&(r==null||r[h[0]]===void 0))for(var f=0;f<h.length;f++)Qp(h[f])&&(n+=jl(l)+":"+$p(l,h[f])+";");else{var g=co(t,r,h);switch(l){case"animation":case"animationName":{n+=jl(l)+":"+g+";";break}default:n+=l+"{"+g+"}"}}}return n}var ef=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Gn,Ul=function(t,r,e){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,o="";Gn=void 0;var l=t[0];l==null||l.raw===void 0?(n=!1,o+=co(e,r,l)):o+=l[0];for(var h=1;h<t.length;h++)o+=co(e,r,t[h]),n&&(o+=l[h]);ef.lastIndex=0;for(var f="",g;(g=ef.exec(o))!==null;)f+="-"+g[1];var v=B_(o)+f;return{name:v,styles:o,next:Gn}},H_=function(t){return t()},N_=Ba.useInsertionEffect?Ba.useInsertionEffect:!1,tf=N_||H_,Vl={}.hasOwnProperty,nf=Pt(typeof HTMLElement<"u"?__({key:"css"}):null);nf.Provider;var rf=function(t){return Ki(function(r,e){var n=Ae(nf);return t(r,n,e)})},of=Pt({}),Wl="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",z_=function(t,r){var e={};for(var n in r)Vl.call(r,n)&&(e[n]=r[n]);return e[Wl]=t,e},j_=function(t){var r=t.cache,e=t.serialized,n=t.isStringTag;return zl(r,e,n),tf(function(){return Kp(r,e,n)}),null},U_=rf(function(t,r,e){var n=t.css;typeof n=="string"&&r.registered[n]!==void 0&&(n=r.registered[n]);var o=t[Wl],l=[n],h="";typeof t.className=="string"?h=Yp(r.registered,l,t.className):t.className!=null&&(h=t.className+" ");var f=Ul(l,void 0,Ae(of));h+=r.key+"-"+f.name;var g={};for(var v in t)Vl.call(t,v)&&v!=="css"&&v!==Wl&&(g[v]=t[v]);return g.ref=e,g.className=h,q(te,null,q(j_,{cache:r,serialized:f,isStringTag:typeof o=="string"}),q(o,g))}),V_=U_,Ke=function(t,r){var e=arguments;if(r==null||!Vl.call(r,"css"))return q.apply(void 0,e);var n=e.length,o=new Array(n);o[0]=V_,o[1]=z_(t,r);for(var l=2;l<n;l++)o[l]=e[l];return q.apply(null,o)};function Gl(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return Ul(r)}var W_=function(){var t=Gl.apply(void 0,arguments),r="animation-"+t.name;return{name:r,styles:"@keyframes "+r+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},G_=function t(r){for(var e=r.length,n=0,o="";n<e;n++){var l=r[n];if(l!=null){var h=void 0;switch(typeof l){case"boolean":break;case"object":{if(Array.isArray(l))h=t(l);else{h="";for(var f in l)l[f]&&f&&(h&&(h+=" "),h+=f)}break}default:h=l}h&&(o&&(o+=" "),o+=h)}}return o};function q_(t,r,e){var n=[],o=Yp(t,n,e);return n.length<2?e:o+r(n)}var Z_=function(t){var r=t.cache,e=t.serializedArr;return tf(function(){for(var n=0;n<e.length;n++)Kp(r,e[n],!1)}),null},X_=rf(function(t,r){var e=[],n=function(){for(var f=arguments.length,g=new Array(f),v=0;v<f;v++)g[v]=arguments[v];var E=Ul(g,r.registered);return e.push(E),zl(r,E,!1),r.key+"-"+E.name},o=function(){for(var f=arguments.length,g=new Array(f),v=0;v<f;v++)g[v]=arguments[v];return q_(r.registered,n,G_(g))},l={css:n,cx:o,theme:Ae(of)},h=t.children(l);return q(te,null,q(Z_,{cache:r,serializedArr:e}),h)});function Y_(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function ql(t,r){if(t==null)return{};var e={},n=Object.keys(t),o,l;for(l=0;l<n.length;l++)o=n[l],!(r.indexOf(o)>=0)&&(e[o]=t[o]);return e}function pr(t,r){if(t==null)return{};var e=ql(t,r),n,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(o=0;o<l.length;o++)n=l[o],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(e[n]=t[n]))}return e}function fr(t){return fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},fr(t)}var sf={};Object.defineProperty(sf,"__esModule",{value:!0});var Zl=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},af=function(){function t(r,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}return function(r,e,n){return e&&t(r.prototype,e),n&&t(r,n),r}}(),lf=Qi,ho=uf(lf),K_=Yr.exports,Wt=uf(K_);function uf(t){return t&&t.__esModule?t:{default:t}}function J_(t,r){var e={};for(var n in t)r.indexOf(n)>=0||!Object.prototype.hasOwnProperty.call(t,n)||(e[n]=t[n]);return e}function Q_(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function $_(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:t}function eT(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}var cf={position:"absolute",top:0,left:0,visibility:"hidden",height:0,overflow:"scroll",whiteSpace:"pre"},tT=["extraWidth","injectStyles","inputClassName","inputRef","inputStyle","minWidth","onAutosize","placeholderIsMinWidth"],nT=function(t){return tT.forEach(function(r){return delete t[r]}),t},hf=function(t,r){r.style.fontSize=t.fontSize,r.style.fontFamily=t.fontFamily,r.style.fontWeight=t.fontWeight,r.style.fontStyle=t.fontStyle,r.style.letterSpacing=t.letterSpacing,r.style.textTransform=t.textTransform},df=typeof window<"u"&&window.navigator?/MSIE |Trident\/|Edge\//.test(window.navigator.userAgent):!1,pf=function(){return df?"_"+Math.random().toString(36).substr(2,12):void 0},Xl=function(t){eT(r,t),af(r,null,[{key:"getDerivedStateFromProps",value:function(e,n){var o=e.id;return o!==n.prevId?{inputId:o||pf(),prevId:o}:null}}]);function r(e){Q_(this,r);var n=$_(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return n.inputRef=function(o){n.input=o,typeof n.props.inputRef=="function"&&n.props.inputRef(o)},n.placeHolderSizerRef=function(o){n.placeHolderSizer=o},n.sizerRef=function(o){n.sizer=o},n.state={inputWidth:e.minWidth,inputId:e.id||pf(),prevId:e.id},n}return af(r,[{key:"componentDidMount",value:function(){this.mounted=!0,this.copyInputStyles(),this.updateInputWidth()}},{key:"componentDidUpdate",value:function(e,n){n.inputWidth!==this.state.inputWidth&&typeof this.props.onAutosize=="function"&&this.props.onAutosize(this.state.inputWidth),this.updateInputWidth()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"copyInputStyles",value:function(){if(!(!this.mounted||!window.getComputedStyle)){var e=this.input&&window.getComputedStyle(this.input);!e||(hf(e,this.sizer),this.placeHolderSizer&&hf(e,this.placeHolderSizer))}}},{key:"updateInputWidth",value:function(){if(!(!this.mounted||!this.sizer||typeof this.sizer.scrollWidth>"u")){var e=void 0;this.props.placeholder&&(!this.props.value||this.props.value&&this.props.placeholderIsMinWidth)?e=Math.max(this.sizer.scrollWidth,this.placeHolderSizer.scrollWidth)+2:e=this.sizer.scrollWidth+2;var n=this.props.type==="number"&&this.props.extraWidth===void 0?16:parseInt(this.props.extraWidth)||0;e+=n,e<this.props.minWidth&&(e=this.props.minWidth),e!==this.state.inputWidth&&this.setState({inputWidth:e})}}},{key:"getInput",value:function(){return this.input}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"select",value:function(){this.input.select()}},{key:"renderStyles",value:function(){var e=this.props.injectStyles;return df&&e?ho.default.createElement("style",{dangerouslySetInnerHTML:{__html:"input#"+this.state.inputId+"::-ms-clear {display: none;}"}}):null}},{key:"render",value:function(){var e=[this.props.defaultValue,this.props.value,""].reduce(function(h,f){return h??f}),n=Zl({},this.props.style);n.display||(n.display="inline-block");var o=Zl({boxSizing:"content-box",width:this.state.inputWidth+"px"},this.props.inputStyle),l=J_(this.props,[]);return nT(l),l.className=this.props.inputClassName,l.id=this.state.inputId,l.style=o,ho.default.createElement("div",{className:this.props.className,style:n},this.renderStyles(),ho.default.createElement("input",Zl({},l,{ref:this.inputRef})),ho.default.createElement("div",{ref:this.sizerRef,style:cf},e),this.props.placeholder?ho.default.createElement("div",{ref:this.placeHolderSizerRef,style:cf},this.props.placeholder):null)}}]),r}(lf.Component);Xl.propTypes={className:Wt.default.string,defaultValue:Wt.default.any,extraWidth:Wt.default.oneOfType([Wt.default.number,Wt.default.string]),id:Wt.default.string,injectStyles:Wt.default.bool,inputClassName:Wt.default.string,inputRef:Wt.default.func,inputStyle:Wt.default.object,minWidth:Wt.default.oneOfType([Wt.default.number,Wt.default.string]),onAutosize:Wt.default.func,onChange:Wt.default.func,placeholder:Wt.default.string,placeholderIsMinWidth:Wt.default.bool,style:Wt.default.object,value:Wt.default.any},Xl.defaultProps={minWidth:1,injectStyles:!0};var iT=sf.default=Xl;function Ds(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function rT(t,r){if(fr(t)!=="object"||t===null)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var n=e.call(t,r||"default");if(fr(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function ff(t){var r=rT(t,"string");return fr(r)==="symbol"?r:String(r)}function gf(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ff(n.key),n)}}function Os(t,r,e){return r&&gf(t.prototype,r),e&&gf(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function ks(t,r){return ks=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},ks(t,r)}function Bs(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&ks(t,r)}function ti(t,r,e){return r=ff(r),r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function oT(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function mf(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),e.push.apply(e,n)}return e}function Jt(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?mf(Object(e),!0).forEach(function(n){oT(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):mf(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function Ms(t){return Ms=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Ms(t)}function sT(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function aT(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lT(t,r){return r&&(typeof r=="object"||typeof r=="function")?r:aT(t)}function Fs(t){var r=sT();return function(){var e=Ms(t),n;if(r){var o=Ms(this).constructor;n=Reflect.construct(e,arguments,o)}else n=e.apply(this,arguments);return lT(this,n)}}var Is=function(){};function uT(t,r){return r?r[0]==="-"?t+r:t+"__"+r:t}function cT(t,r,e){var n=[e];if(r&&t)for(var o in r)r.hasOwnProperty(o)&&r[o]&&n.push("".concat(uT(t,o)));return n.filter(function(l){return l}).map(function(l){return String(l).trim()}).join(" ")}var vf=function(t){return Array.isArray(t)?t.filter(Boolean):fr(t)==="object"&&t!==null?[t]:[]},yf=function(t){t.className,t.clearValue,t.cx,t.getStyles,t.getValue,t.hasValue,t.isMulti,t.isRtl,t.options,t.selectOption,t.selectProps,t.setValue,t.theme;var r=pr(t,["className","clearValue","cx","getStyles","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"]);return Jt({},r)};function Yl(t){return[document.documentElement,document.body,window].indexOf(t)>-1}function wf(t){return Yl(t)?window.pageYOffset:t.scrollTop}function Ls(t,r){if(Yl(t)){window.scrollTo(0,r);return}t.scrollTop=r}function hT(t){var r=getComputedStyle(t),e=r.position==="absolute",n=/(auto|scroll)/,o=document.documentElement;if(r.position==="fixed")return o;for(var l=t;l=l.parentElement;)if(r=getComputedStyle(l),!(e&&r.position==="static")&&n.test(r.overflow+r.overflowY+r.overflowX))return l;return o}function dT(t,r,e,n){return e*((t=t/n-1)*t*t+1)+r}function Hs(t,r){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Is,o=wf(t),l=r-o,h=10,f=0;function g(){f+=h;var v=dT(f,o,l,e);Ls(t,v),f<e?window.requestAnimationFrame(g):n(t)}g()}function pT(t,r){var e=t.getBoundingClientRect(),n=r.getBoundingClientRect(),o=r.offsetHeight/3;n.bottom+o>e.bottom?Ls(t,Math.min(r.offsetTop+r.clientHeight-t.offsetHeight+o,t.scrollHeight)):n.top-o<e.top&&Ls(t,Math.max(r.offsetTop-o,0))}function fT(t){var r=t.getBoundingClientRect();return{bottom:r.bottom,height:r.height,left:r.left,right:r.right,top:r.top,width:r.width}}function Ef(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function gT(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var xf=!1,mT={get passive(){return xf=!0}},Ns=typeof window<"u"?window:{};Ns.addEventListener&&Ns.removeEventListener&&(Ns.addEventListener("p",Is,mT),Ns.removeEventListener("p",Is,!1));var vT=xf;function yT(t){var r=t.maxHeight,e=t.menuEl,n=t.minHeight,o=t.placement,l=t.shouldScroll,h=t.isFixedPosition,f=t.theme,g=f.spacing,v=hT(e),E={placement:"bottom",maxHeight:r};if(!e||!e.offsetParent)return E;var _=v.getBoundingClientRect(),C=_.height,k=e.getBoundingClientRect(),I=k.bottom,X=k.height,U=k.top,$=e.offsetParent.getBoundingClientRect(),P=$.top,N=window.innerHeight,J=wf(v),K=parseInt(getComputedStyle(e).marginBottom,10),oe=parseInt(getComputedStyle(e).marginTop,10),ie=P-oe,me=N-U,we=ie+J,De=C-J-U,Be=I-N+J+K,Oe=J+U-oe,Ue=160;switch(o){case"auto":case"bottom":if(me>=X)return{placement:"bottom",maxHeight:r};if(De>=X&&!h)return l&&Hs(v,Be,Ue),{placement:"bottom",maxHeight:r};if(!h&&De>=n||h&&me>=n){l&&Hs(v,Be,Ue);var Ve=h?me-K:De-K;return{placement:"bottom",maxHeight:Ve}}if(o==="auto"||h){var et=r,$e=h?ie:we;return $e>=n&&(et=Math.min($e-K-g.controlHeight,r)),{placement:"top",maxHeight:et}}if(o==="bottom")return l&&Ls(v,Be),{placement:"bottom",maxHeight:r};break;case"top":if(ie>=X)return{placement:"top",maxHeight:r};if(we>=X&&!h)return l&&Hs(v,Oe,Ue),{placement:"top",maxHeight:r};if(!h&&we>=n||h&&ie>=n){var lt=r;return(!h&&we>=n||h&&ie>=n)&&(lt=h?ie-oe:we-oe),l&&Hs(v,Oe,Ue),{placement:"top",maxHeight:lt}}return{placement:"bottom",maxHeight:r};default:throw new Error('Invalid placement provided "'.concat(o,'".'))}return E}function wT(t){var r={bottom:"top",top:"bottom"};return t?r[t]:"bottom"}var Kl=function(t){return t==="auto"?"bottom":t},ET=function(t){var r,e=t.placement,n=t.theme,o=n.borderRadius,l=n.spacing,h=n.colors;return r={label:"menu"},ti(r,wT(e),"100%"),ti(r,"backgroundColor",h.neutral0),ti(r,"borderRadius",o),ti(r,"boxShadow","0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)"),ti(r,"marginBottom",l.menuGutter),ti(r,"marginTop",l.menuGutter),ti(r,"position","absolute"),ti(r,"width","100%"),ti(r,"zIndex",1),r},bf=Pt({getPortalPlacement:null}),Sf=function(t){Bs(e,t);var r=Fs(e);function e(){var n;Ds(this,e);for(var o=arguments.length,l=new Array(o),h=0;h<o;h++)l[h]=arguments[h];return n=r.call.apply(r,[this].concat(l)),n.state={maxHeight:n.props.maxMenuHeight,placement:null},n.getPlacement=function(f){var g=n.props,v=g.minMenuHeight,E=g.maxMenuHeight,_=g.menuPlacement,C=g.menuPosition,k=g.menuShouldScrollIntoView,I=g.theme;if(f){var X=C==="fixed",U=k&&!X,$=yT({maxHeight:E,menuEl:f,minHeight:v,placement:_,shouldScroll:U,isFixedPosition:X,theme:I}),P=n.context.getPortalPlacement;P&&P($),n.setState($)}},n.getUpdatedProps=function(){var f=n.props.menuPlacement,g=n.state.placement||Kl(f);return Jt(Jt({},n.props),{},{placement:g,maxHeight:n.state.maxHeight})},n}return Os(e,[{key:"render",value:function(){var n=this.props.children;return n({ref:this.getPlacement,placerProps:this.getUpdatedProps()})}}]),e}(se);Sf.contextType=bf;var xT=function(t){var r=t.children,e=t.className,n=t.cx,o=t.getStyles,l=t.innerRef,h=t.innerProps;return Ke("div",Ye({css:o("menu",t),className:n({menu:!0},e),ref:l},h),r)},bT=function(t){var r=t.maxHeight,e=t.theme.spacing.baseUnit;return{maxHeight:r,overflowY:"auto",paddingBottom:e,paddingTop:e,position:"relative",WebkitOverflowScrolling:"touch"}},ST=function(t){var r=t.children,e=t.className,n=t.cx,o=t.getStyles,l=t.innerProps,h=t.innerRef,f=t.isMulti;return Ke("div",Ye({css:o("menuList",t),className:n({"menu-list":!0,"menu-list--is-multi":f},e),ref:h},l),r)},_f=function(t){var r=t.theme,e=r.spacing.baseUnit,n=r.colors;return{color:n.neutral40,padding:"".concat(e*2,"px ").concat(e*3,"px"),textAlign:"center"}},_T=_f,TT=_f,Tf=function(t){var r=t.children,e=t.className,n=t.cx,o=t.getStyles,l=t.innerProps;return Ke("div",Ye({css:o("noOptionsMessage",t),className:n({"menu-notice":!0,"menu-notice--no-options":!0},e)},l),r)};Tf.defaultProps={children:"No options"};var Cf=function(t){var r=t.children,e=t.className,n=t.cx,o=t.getStyles,l=t.innerProps;return Ke("div",Ye({css:o("loadingMessage",t),className:n({"menu-notice":!0,"menu-notice--loading":!0},e)},l),r)};Cf.defaultProps={children:"Loading..."};var CT=function(t){var r=t.rect,e=t.offset,n=t.position;return{left:r.left,position:n,top:e,width:r.width,zIndex:1}},PT=function(t){Bs(e,t);var r=Fs(e);function e(){var n;Ds(this,e);for(var o=arguments.length,l=new Array(o),h=0;h<o;h++)l[h]=arguments[h];return n=r.call.apply(r,[this].concat(l)),n.state={placement:null},n.getPortalPlacement=function(f){var g=f.placement,v=Kl(n.props.menuPlacement);g!==v&&n.setState({placement:g})},n}return Os(e,[{key:"render",value:function(){var n=this.props,o=n.appendTo,l=n.children,h=n.className,f=n.controlElement,g=n.cx,v=n.innerProps,E=n.menuPlacement,_=n.menuPosition,C=n.getStyles,k=_==="fixed";if(!o&&!k||!f)return null;var I=this.state.placement||Kl(E),X=fT(f),U=k?0:window.pageYOffset,$=X[I]+U,P={offset:$,position:_,rect:X},N=Ke("div",Ye({css:C("menuPortal",P),className:g({"menu-portal":!0},h)},v),l);return Ke(bf.Provider,{value:{getPortalPlacement:this.getPortalPlacement}},o?Oa(N,o):N)}}]),e}(se),RT=function(t){var r=t.isDisabled,e=t.isRtl;return{label:"container",direction:e?"rtl":null,pointerEvents:r?"none":null,position:"relative"}},AT=function(t){var r=t.children,e=t.className,n=t.cx,o=t.getStyles,l=t.innerProps,h=t.isDisabled,f=t.isRtl;return Ke("div",Ye({css:o("container",t),className:n({"--is-disabled":h,"--is-rtl":f},e)},l),r)},DT=function(t){var r=t.theme.spacing;return{alignItems:"center",display:"flex",flex:1,flexWrap:"wrap",padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px"),WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"}},OT=function(t){var r=t.children,e=t.className,n=t.cx,o=t.innerProps,l=t.isMulti,h=t.getStyles,f=t.hasValue;return Ke("div",Ye({css:h("valueContainer",t),className:n({"value-container":!0,"value-container--is-multi":l,"value-container--has-value":f},e)},o),r)},kT=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},BT=function(t){var r=t.children,e=t.className,n=t.cx,o=t.innerProps,l=t.getStyles;return Ke("div",Ye({css:l("indicatorsContainer",t),className:n({indicators:!0},e)},o),r)},Pf,MT={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},Rf=function(t){var r=t.size,e=pr(t,["size"]);return Ke("svg",Ye({height:r,width:r,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:MT},e))},Jl=function(t){return Ke(Rf,Ye({size:20},t),Ke("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Af=function(t){return Ke(Rf,Ye({size:20},t),Ke("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},Df=function(t){var r=t.isFocused,e=t.theme,n=e.spacing.baseUnit,o=e.colors;return{label:"indicatorContainer",color:r?o.neutral60:o.neutral20,display:"flex",padding:n*2,transition:"color 150ms",":hover":{color:r?o.neutral80:o.neutral40}}},FT=Df,IT=function(t){var r=t.children,e=t.className,n=t.cx,o=t.getStyles,l=t.innerProps;return Ke("div",Ye({css:o("dropdownIndicator",t),className:n({indicator:!0,"dropdown-indicator":!0},e)},l),r||Ke(Af,null))},LT=Df,HT=function(t){var r=t.children,e=t.className,n=t.cx,o=t.getStyles,l=t.innerProps;return Ke("div",Ye({css:o("clearIndicator",t),className:n({indicator:!0,"clear-indicator":!0},e)},l),r||Ke(Jl,null))},NT=function(t){var r=t.isDisabled,e=t.theme,n=e.spacing.baseUnit,o=e.colors;return{label:"indicatorSeparator",alignSelf:"stretch",backgroundColor:r?o.neutral10:o.neutral20,marginBottom:n*2,marginTop:n*2,width:1}},zT=function(t){var r=t.className,e=t.cx,n=t.getStyles,o=t.innerProps;return Ke("span",Ye({},o,{css:n("indicatorSeparator",t),className:e({"indicator-separator":!0},r)}))},jT=W_(Pf||(Pf=Y_([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),UT=function(t){var r=t.isFocused,e=t.size,n=t.theme,o=n.colors,l=n.spacing.baseUnit;return{label:"loadingIndicator",color:r?o.neutral60:o.neutral20,display:"flex",padding:l*2,transition:"color 150ms",alignSelf:"center",fontSize:e,lineHeight:1,marginRight:e,textAlign:"center",verticalAlign:"middle"}},Ql=function(t){var r=t.delay,e=t.offset;return Ke("span",{css:Gl({animation:"".concat(jT," 1s ease-in-out ").concat(r,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:e?"1em":null,height:"1em",verticalAlign:"top",width:"1em"},"","")})},Of=function(t){var r=t.className,e=t.cx,n=t.getStyles,o=t.innerProps,l=t.isRtl;return Ke("div",Ye({css:n("loadingIndicator",t),className:e({indicator:!0,"loading-indicator":!0},r)},o),Ke(Ql,{delay:0,offset:l}),Ke(Ql,{delay:160,offset:!0}),Ke(Ql,{delay:320,offset:!l}))};Of.defaultProps={size:4};var VT=function(t){var r=t.isDisabled,e=t.isFocused,n=t.theme,o=n.colors,l=n.borderRadius,h=n.spacing;return{label:"control",alignItems:"center",backgroundColor:r?o.neutral5:o.neutral0,borderColor:r?o.neutral10:e?o.primary:o.neutral20,borderRadius:l,borderStyle:"solid",borderWidth:1,boxShadow:e?"0 0 0 1px ".concat(o.primary):null,cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:h.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms","&:hover":{borderColor:e?o.primary:o.neutral30}}},WT=function(t){var r=t.children,e=t.cx,n=t.getStyles,o=t.className,l=t.isDisabled,h=t.isFocused,f=t.innerRef,g=t.innerProps,v=t.menuIsOpen;return Ke("div",Ye({ref:f,css:n("control",t),className:e({control:!0,"control--is-disabled":l,"control--is-focused":h,"control--menu-is-open":v},o)},g),r)},GT=function(t){var r=t.theme.spacing;return{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},qT=function(t){var r=t.children,e=t.className,n=t.cx,o=t.getStyles,l=t.Heading,h=t.headingProps,f=t.innerProps,g=t.label,v=t.theme,E=t.selectProps;return Ke("div",Ye({css:o("group",t),className:n({group:!0},e)},f),Ke(l,Ye({},h,{selectProps:E,theme:v,getStyles:o,cx:n}),g),Ke("div",null,r))},ZT=function(t){var r=t.theme.spacing;return{label:"group",color:"#999",cursor:"default",display:"block",fontSize:"75%",fontWeight:"500",marginBottom:"0.25em",paddingLeft:r.baseUnit*3,paddingRight:r.baseUnit*3,textTransform:"uppercase"}},XT=function(t){var r=t.getStyles,e=t.cx,n=t.className,o=yf(t);o.data;var l=pr(o,["data"]);return Ke("div",Ye({css:r("groupHeading",t),className:e({"group-heading":!0},n)},l))},YT=function(t){var r=t.isDisabled,e=t.theme,n=e.spacing,o=e.colors;return{margin:n.baseUnit/2,paddingBottom:n.baseUnit/2,paddingTop:n.baseUnit/2,visibility:r?"hidden":"visible",color:o.neutral80}},KT=function(t){return{label:"input",background:0,border:0,fontSize:"inherit",opacity:t?0:1,outline:0,padding:0,color:"inherit"}},JT=function(t){var r=t.className,e=t.cx,n=t.getStyles,o=yf(t),l=o.innerRef,h=o.isDisabled,f=o.isHidden,g=pr(o,["innerRef","isDisabled","isHidden"]);return Ke("div",{css:n("input",t)},Ke(iT,Ye({className:e({input:!0},r),inputRef:l,inputStyle:KT(f),disabled:h},g)))},QT=function(t){var r=t.theme,e=r.spacing,n=r.borderRadius,o=r.colors;return{label:"multiValue",backgroundColor:o.neutral10,borderRadius:n/2,display:"flex",margin:e.baseUnit/2,minWidth:0}},$T=function(t){var r=t.theme,e=r.borderRadius,n=r.colors,o=t.cropWithEllipsis;return{borderRadius:e/2,color:n.neutral80,fontSize:"85%",overflow:"hidden",padding:3,paddingLeft:6,textOverflow:o?"ellipsis":null,whiteSpace:"nowrap"}},eC=function(t){var r=t.theme,e=r.spacing,n=r.borderRadius,o=r.colors,l=t.isFocused;return{alignItems:"center",borderRadius:n/2,backgroundColor:l&&o.dangerLight,display:"flex",paddingLeft:e.baseUnit,paddingRight:e.baseUnit,":hover":{backgroundColor:o.dangerLight,color:o.danger}}},kf=function(t){var r=t.children,e=t.innerProps;return Ke("div",e,r)},tC=kf,nC=kf;function iC(t){var r=t.children,e=t.innerProps;return Ke("div",e,r||Ke(Jl,{size:14}))}var Bf=function(t){var r=t.children,e=t.className,n=t.components,o=t.cx,l=t.data,h=t.getStyles,f=t.innerProps,g=t.isDisabled,v=t.removeProps,E=t.selectProps,_=n.Container,C=n.Label,k=n.Remove;return Ke(X_,null,function(I){var X=I.css,U=I.cx;return Ke(_,{data:l,innerProps:Jt({className:U(X(h("multiValue",t)),o({"multi-value":!0,"multi-value--is-disabled":g},e))},f),selectProps:E},Ke(C,{data:l,innerProps:{className:U(X(h("multiValueLabel",t)),o({"multi-value__label":!0},e))},selectProps:E},r),Ke(k,{data:l,innerProps:Jt({className:U(X(h("multiValueRemove",t)),o({"multi-value__remove":!0},e))},v),selectProps:E}))})};Bf.defaultProps={cropWithEllipsis:!0};var rC=function(t){var r=t.isDisabled,e=t.isFocused,n=t.isSelected,o=t.theme,l=o.spacing,h=o.colors;return{label:"option",backgroundColor:n?h.primary:e?h.primary25:"transparent",color:r?h.neutral20:n?h.neutral0:"inherit",cursor:"default",display:"block",fontSize:"inherit",padding:"".concat(l.baseUnit*2,"px ").concat(l.baseUnit*3,"px"),width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",":active":{backgroundColor:!r&&(n?h.primary:h.primary50)}}},oC=function(t){var r=t.children,e=t.className,n=t.cx,o=t.getStyles,l=t.isDisabled,h=t.isFocused,f=t.isSelected,g=t.innerRef,v=t.innerProps;return Ke("div",Ye({css:o("option",t),className:n({option:!0,"option--is-disabled":l,"option--is-focused":h,"option--is-selected":f},e),ref:g},v),r)},sC=function(t){var r=t.theme,e=r.spacing,n=r.colors;return{label:"placeholder",color:n.neutral50,marginLeft:e.baseUnit/2,marginRight:e.baseUnit/2,position:"absolute",top:"50%",transform:"translateY(-50%)"}},aC=function(t){var r=t.children,e=t.className,n=t.cx,o=t.getStyles,l=t.innerProps;return Ke("div",Ye({css:o("placeholder",t),className:n({placeholder:!0},e)},l),r)},lC=function(t){var r=t.isDisabled,e=t.theme,n=e.spacing,o=e.colors;return{label:"singleValue",color:r?o.neutral40:o.neutral80,marginLeft:n.baseUnit/2,marginRight:n.baseUnit/2,maxWidth:"calc(100% - ".concat(n.baseUnit*2,"px)"),overflow:"hidden",position:"absolute",textOverflow:"ellipsis",whiteSpace:"nowrap",top:"50%",transform:"translateY(-50%)"}},uC=function(t){var r=t.children,e=t.className,n=t.cx,o=t.getStyles,l=t.isDisabled,h=t.innerProps;return Ke("div",Ye({css:o("singleValue",t),className:n({"single-value":!0,"single-value--is-disabled":l},e)},h),r)},cC={ClearIndicator:HT,Control:WT,DropdownIndicator:IT,DownChevron:Af,CrossIcon:Jl,Group:qT,GroupHeading:XT,IndicatorsContainer:BT,IndicatorSeparator:zT,Input:JT,LoadingIndicator:Of,Menu:xT,MenuList:ST,MenuPortal:PT,LoadingMessage:Cf,NoOptionsMessage:Tf,MultiValue:Bf,MultiValueContainer:tC,MultiValueLabel:nC,MultiValueRemove:iC,Option:oC,Placeholder:aC,SelectContainer:AT,SingleValue:uC,ValueContainer:OT},hC=function(t){return Jt(Jt({},cC),t.components)};function $l(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function dC(t){if(Array.isArray(t))return $l(t)}function pC(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function fC(t,r){if(t){if(typeof t=="string")return $l(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return $l(t,r)}}function gC(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mf(t){return dC(t)||pC(t)||fC(t)||gC()}var Ff=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function mC(t,r){return!!(t===r||Ff(t)&&Ff(r))}function vC(t,r){if(t.length!==r.length)return!1;for(var e=0;e<t.length;e++)if(!mC(t[e],r[e]))return!1;return!0}function yC(t,r){r===void 0&&(r=vC);var e,n=[],o,l=!1;function h(){for(var f=[],g=0;g<arguments.length;g++)f[g]=arguments[g];return l&&e===this&&r(f,n)||(o=t.apply(this,f),l=!0,e=this,n=f),o}return h}for(var wC={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},EC=function(t){return Ke("span",Ye({css:wC},t))},xC={guidance:function(t){var r=t.isSearchable,e=t.isMulti,n=t.isDisabled,o=t.tabSelectsValue,l=t.context;switch(l){case"menu":return"Use Up and Down to choose options".concat(n?"":", press Enter to select the currently focused option",", press Escape to exit the menu").concat(o?", press Tab to select the option and exit the menu":"",".");case"input":return"".concat(t["aria-label"]||"Select"," is focused ").concat(r?",type to refine list":"",", press Down to open the menu, ").concat(e?" press left to focus selected values":"");case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(t){var r=t.action,e=t.label,n=e===void 0?"":e,o=t.isDisabled;switch(r){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(n,", deselected.");case"select-option":return o?"option ".concat(n," is disabled. Select another option."):"option ".concat(n,", selected.");default:return""}},onFocus:function(t){var r=t.context,e=t.focused,n=e===void 0?{}:e,o=t.options,l=t.label,h=l===void 0?"":l,f=t.selectValue,g=t.isDisabled,v=t.isSelected,E=function(k,I){return k&&k.length?"".concat(k.indexOf(I)+1," of ").concat(k.length):""};if(r==="value"&&f)return"value ".concat(h," focused, ").concat(E(f,n),".");if(r==="menu"){var _=g?" disabled":"",C="".concat(v?"selected":"focused").concat(_);return"option ".concat(h," ").concat(C,", ").concat(E(o,n),".")}return""},onFilter:function(t){var r=t.inputValue,e=t.resultsMessage;return"".concat(e).concat(r?" for search term "+r:"",".")}},bC=function(t){var r=t.ariaSelection,e=t.focusedOption,n=t.focusedValue,o=t.focusableOptions,l=t.isFocused,h=t.selectValue,f=t.selectProps,g=f.ariaLiveMessages,v=f.getOptionLabel,E=f.inputValue,_=f.isMulti,C=f.isOptionDisabled,k=f.isSearchable,I=f.menuIsOpen,X=f.options,U=f.screenReaderStatus,$=f.tabSelectsValue,P=f["aria-label"],N=f["aria-live"],J=xe(function(){return Jt(Jt({},xC),g||{})},[g]),K=xe(function(){var De="";if(r&&J.onChange){var Be=r.option,Oe=r.removedValue,Ue=r.value,Ve=function(lt){return Array.isArray(lt)?null:lt},et=Oe||Be||Ve(Ue),$e=Jt({isDisabled:et&&C(et),label:et?v(et):""},r);De=J.onChange($e)}return De},[r,C,v,J]),oe=xe(function(){var De="",Be=e||n,Oe=!!(e&&h&&h.includes(e));if(Be&&J.onFocus){var Ue={focused:Be,label:v(Be),isDisabled:C(Be),isSelected:Oe,options:X,context:Be===e?"menu":"value",selectValue:h};De=J.onFocus(Ue)}return De},[e,n,v,C,J,X,h]),ie=xe(function(){var De="";if(I&&X.length&&J.onFilter){var Be=U({count:o.length});De=J.onFilter({inputValue:E,resultsMessage:Be})}return De},[o,E,I,J,X,U]),me=xe(function(){var De="";if(J.guidance){var Be=n?"value":I?"menu":"input";De=J.guidance({"aria-label":P,context:Be,isDisabled:e&&C(e),isMulti:_,isSearchable:k,tabSelectsValue:$})}return De},[P,e,n,_,C,k,I,J,$]),we="".concat(oe," ").concat(ie," ").concat(me);return Ke(EC,{"aria-live":N,"aria-atomic":"false","aria-relevant":"additions text"},l&&Ke(fe.Fragment,null,Ke("span",{id:"aria-selection"},K),Ke("span",{id:"aria-context"},we)))},eu=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],SC=new RegExp("["+eu.map(function(t){return t.letters}).join("")+"]","g"),If={},tu=0;tu<eu.length;tu++)for(var nu=eu[tu],iu=0;iu<nu.letters.length;iu++)If[nu.letters[iu]]=nu.base;var Lf=function(t){return t.replace(SC,function(r){return If[r]})},_C=yC(Lf),Hf=function(t){return t.replace(/^\s+|\s+$/g,"")},TC=function(t){return"".concat(t.label," ").concat(t.value)},CC=function(t){return function(r,e){var n=Jt({ignoreCase:!0,ignoreAccents:!0,stringify:TC,trim:!0,matchFrom:"any"},t),o=n.ignoreCase,l=n.ignoreAccents,h=n.stringify,f=n.trim,g=n.matchFrom,v=f?Hf(e):e,E=f?Hf(h(r)):h(r);return o&&(v=v.toLowerCase(),E=E.toLowerCase()),l&&(v=_C(v),E=Lf(E)),g==="start"?E.substr(0,v.length)===v:E.indexOf(v)>-1}};function PC(t){t.in,t.out,t.onExited,t.appear,t.enter,t.exit;var r=t.innerRef;t.emotion;var e=pr(t,["in","out","onExited","appear","enter","exit","innerRef","emotion"]);return Ke("input",Ye({ref:r},e,{css:Gl({label:"dummyInput",background:0,border:0,fontSize:"inherit",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(0)"},"","")}))}var RC=function(t){t.preventDefault(),t.stopPropagation()};function AC(t){var r=t.isEnabled,e=t.onBottomArrive,n=t.onBottomLeave,o=t.onTopArrive,l=t.onTopLeave,h=ae(!1),f=ae(!1),g=ae(0),v=ae(null),E=Ee(function(U,$){if(v.current!==null){var P=v.current,N=P.scrollTop,J=P.scrollHeight,K=P.clientHeight,oe=v.current,ie=$>0,me=J-K-N,we=!1;me>$&&h.current&&(n&&n(U),h.current=!1),ie&&f.current&&(l&&l(U),f.current=!1),ie&&$>me?(e&&!h.current&&e(U),oe.scrollTop=J,we=!0,h.current=!0):!ie&&-$>N&&(o&&!f.current&&o(U),oe.scrollTop=0,we=!0,f.current=!0),we&&RC(U)}},[]),_=Ee(function(U){E(U,U.deltaY)},[E]),C=Ee(function(U){g.current=U.changedTouches[0].clientY},[]),k=Ee(function(U){var $=g.current-U.changedTouches[0].clientY;E(U,$)},[E]),I=Ee(function(U){if(U){var $=vT?{passive:!1}:!1;typeof U.addEventListener=="function"&&U.addEventListener("wheel",_,$),typeof U.addEventListener=="function"&&U.addEventListener("touchstart",C,$),typeof U.addEventListener=="function"&&U.addEventListener("touchmove",k,$)}},[k,C,_]),X=Ee(function(U){!U||(typeof U.removeEventListener=="function"&&U.removeEventListener("wheel",_,!1),typeof U.removeEventListener=="function"&&U.removeEventListener("touchstart",C,!1),typeof U.removeEventListener=="function"&&U.removeEventListener("touchmove",k,!1))},[k,C,_]);return ne(function(){if(r){var U=v.current;return I(U),function(){X(U)}}},[r,I,X]),function(U){v.current=U}}var Nf=["boxSizing","height","overflow","paddingRight","position"],zf={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function jf(t){t.preventDefault()}function Uf(t){t.stopPropagation()}function Vf(){var t=this.scrollTop,r=this.scrollHeight,e=t+this.offsetHeight;t===0?this.scrollTop=1:e===r&&(this.scrollTop=t-1)}function Wf(){return"ontouchstart"in window||navigator.maxTouchPoints}var Gf=!!(typeof window<"u"&&window.document&&window.document.createElement),po=0,gr={capture:!1,passive:!1};function DC(t){var r=t.isEnabled,e=t.accountForScrollbars,n=e===void 0?!0:e,o=ae({}),l=ae(null),h=Ee(function(g){if(Gf){var v=document.body,E=v&&v.style;if(n&&Nf.forEach(function(I){var X=E&&E[I];o.current[I]=X}),n&&po<1){var _=parseInt(o.current.paddingRight,10)||0,C=document.body?document.body.clientWidth:0,k=window.innerWidth-C+_||0;Object.keys(zf).forEach(function(I){var X=zf[I];E&&(E[I]=X)}),E&&(E.paddingRight="".concat(k,"px"))}v&&Wf()&&(v.addEventListener("touchmove",jf,gr),g&&(g.addEventListener("touchstart",Vf,gr),g.addEventListener("touchmove",Uf,gr))),po+=1}},[]),f=Ee(function(g){if(Gf){var v=document.body,E=v&&v.style;po=Math.max(po-1,0),n&&po<1&&Nf.forEach(function(_){var C=o.current[_];E&&(E[_]=C)}),v&&Wf()&&(v.removeEventListener("touchmove",jf,gr),g&&(g.removeEventListener("touchstart",Vf,gr),g.removeEventListener("touchmove",Uf,gr)))}},[]);return ne(function(){if(r){var g=l.current;return h(g),function(){f(g)}}},[r,h,f]),function(g){l.current=g}}var OC=function(){return document.activeElement&&document.activeElement.blur()},kC={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function BC(t){var r=t.children,e=t.lockEnabled,n=t.captureEnabled,o=n===void 0?!0:n,l=t.onBottomArrive,h=t.onBottomLeave,f=t.onTopArrive,g=t.onTopLeave,v=AC({isEnabled:o,onBottomArrive:l,onBottomLeave:h,onTopArrive:f,onTopLeave:g}),E=DC({isEnabled:e}),_=function(C){v(C),E(C)};return Ke(fe.Fragment,null,e&&Ke("div",{onClick:OC,css:kC}),r(_))}var MC=function(t){return t.label},FC=function(t){return t.label},IC=function(t){return t.value},LC=function(t){return!!t.isDisabled},HC={clearIndicator:LT,container:RT,control:VT,dropdownIndicator:FT,group:GT,groupHeading:ZT,indicatorsContainer:kT,indicatorSeparator:NT,input:YT,loadingIndicator:UT,loadingMessage:TT,menu:ET,menuList:bT,menuPortal:CT,multiValue:QT,multiValueLabel:$T,multiValueRemove:eC,noOptionsMessage:_T,option:rC,placeholder:sC,singleValue:lC,valueContainer:DT},NC={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},zC=4,qf=4,jC=38,UC=qf*2,VC={baseUnit:qf,controlHeight:jC,menuGutter:UC},ru={borderRadius:zC,colors:NC,spacing:VC},WC={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:Ef(),captureMenuScroll:!Ef(),closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:CC(),formatGroupLabel:MC,getOptionLabel:FC,getOptionValue:IC,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:LC,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!gT(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(t){var r=t.count;return"".concat(r," result").concat(r!==1?"s":""," available")},styles:{},tabIndex:"0",tabSelectsValue:!0};function Zf(t,r,e,n){var o=Qf(t,r,e),l=$f(t,r,e),h=Jf(t,r),f=zs(t,r);return{type:"option",data:r,isDisabled:o,isSelected:l,label:h,value:f,index:n}}function Xf(t,r){return t.options.map(function(e,n){if(e.options){var o=e.options.map(function(h,f){return Zf(t,h,r,f)}).filter(function(h){return Kf(t,h)});return o.length>0?{type:"group",data:e,options:o,index:n}:void 0}var l=Zf(t,e,r,n);return Kf(t,l)?l:void 0}).filter(function(e){return!!e})}function Yf(t){return t.reduce(function(r,e){return e.type==="group"?r.push.apply(r,Mf(e.options.map(function(n){return n.data}))):r.push(e.data),r},[])}function GC(t,r){return Yf(Xf(t,r))}function Kf(t,r){var e=t.inputValue,n=e===void 0?"":e,o=r.data,l=r.isSelected,h=r.label,f=r.value;return(!tg(t)||!l)&&eg(t,{label:h,value:f,data:o},n)}function qC(t,r){var e=t.focusedValue,n=t.selectValue,o=n.indexOf(e);if(o>-1){var l=r.indexOf(e);if(l>-1)return e;if(o<r.length)return r[o]}return null}function ZC(t,r){var e=t.focusedOption;return e&&r.indexOf(e)>-1?e:r[0]}var Jf=function(t,r){return t.getOptionLabel(r)},zs=function(t,r){return t.getOptionValue(r)};function Qf(t,r,e){return typeof t.isOptionDisabled=="function"?t.isOptionDisabled(r,e):!1}function $f(t,r,e){if(e.indexOf(r)>-1)return!0;if(typeof t.isOptionSelected=="function")return t.isOptionSelected(r,e);var n=zs(t,r);return e.some(function(o){return zs(t,o)===n})}function eg(t,r,e){return t.filterOption?t.filterOption(r,e):!0}var tg=function(t){var r=t.hideSelectedOptions,e=t.isMulti;return r===void 0?e:r},XC=1,ng=function(t){Bs(e,t);var r=Fs(e);function e(n){var o;return Ds(this,e),o=r.call(this,n),o.state={ariaSelection:null,focusedOption:null,focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0},o.blockOptionHover=!1,o.isComposing=!1,o.commonProps=void 0,o.initialTouchX=0,o.initialTouchY=0,o.instancePrefix="",o.openAfterFocus=!1,o.scrollToFocusedOptionOnUpdate=!1,o.userIsDragging=void 0,o.controlRef=null,o.getControlRef=function(l){o.controlRef=l},o.focusedOptionRef=null,o.getFocusedOptionRef=function(l){o.focusedOptionRef=l},o.menuListRef=null,o.getMenuListRef=function(l){o.menuListRef=l},o.inputRef=null,o.getInputRef=function(l){o.inputRef=l},o.focus=o.focusInput,o.blur=o.blurInput,o.onChange=function(l,h){var f=o.props,g=f.onChange,v=f.name;h.name=v,o.ariaOnChange(l,h),g(l,h)},o.setValue=function(l){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"set-value",f=arguments.length>2?arguments[2]:void 0,g=o.props,v=g.closeMenuOnSelect,E=g.isMulti;o.onInputChange("",{action:"set-value"}),v&&(o.setState({inputIsHiddenAfterUpdate:!E}),o.onMenuClose()),o.setState({clearFocusValueOnUpdate:!0}),o.onChange(l,{action:h,option:f})},o.selectOption=function(l){var h=o.props,f=h.blurInputOnSelect,g=h.isMulti,v=h.name,E=o.state.selectValue,_=g&&o.isOptionSelected(l,E),C=o.isOptionDisabled(l,E);if(_){var k=o.getOptionValue(l);o.setValue(E.filter(function(I){return o.getOptionValue(I)!==k}),"deselect-option",l)}else if(!C)g?o.setValue([].concat(Mf(E),[l]),"select-option",l):o.setValue(l,"select-option");else{o.ariaOnChange(l,{action:"select-option",name:v});return}f&&o.blurInput()},o.removeValue=function(l){var h=o.props.isMulti,f=o.state.selectValue,g=o.getOptionValue(l),v=f.filter(function(_){return o.getOptionValue(_)!==g}),E=h?v:v[0]||null;o.onChange(E,{action:"remove-value",removedValue:l}),o.focusInput()},o.clearValue=function(){var l=o.state.selectValue;o.onChange(o.props.isMulti?[]:null,{action:"clear",removedValues:l})},o.popValue=function(){var l=o.props.isMulti,h=o.state.selectValue,f=h[h.length-1],g=h.slice(0,h.length-1),v=l?g:g[0]||null;o.onChange(v,{action:"pop-value",removedValue:f})},o.getValue=function(){return o.state.selectValue},o.cx=function(){for(var l=arguments.length,h=new Array(l),f=0;f<l;f++)h[f]=arguments[f];return cT.apply(void 0,[o.props.classNamePrefix].concat(h))},o.getOptionLabel=function(l){return Jf(o.props,l)},o.getOptionValue=function(l){return zs(o.props,l)},o.getStyles=function(l,h){var f=HC[l](h);f.boxSizing="border-box";var g=o.props.styles[l];return g?g(f,h):f},o.getElementId=function(l){return"".concat(o.instancePrefix,"-").concat(l)},o.getComponents=function(){return hC(o.props)},o.buildCategorizedOptions=function(){return Xf(o.props,o.state.selectValue)},o.getCategorizedOptions=function(){return o.props.menuIsOpen?o.buildCategorizedOptions():[]},o.buildFocusableOptions=function(){return Yf(o.buildCategorizedOptions())},o.getFocusableOptions=function(){return o.props.menuIsOpen?o.buildFocusableOptions():[]},o.ariaOnChange=function(l,h){o.setState({ariaSelection:Jt({value:l},h)})},o.onMenuMouseDown=function(l){l.button===0&&(l.stopPropagation(),l.preventDefault(),o.focusInput())},o.onMenuMouseMove=function(l){o.blockOptionHover=!1},o.onControlMouseDown=function(l){var h=o.props.openMenuOnClick;o.state.isFocused?o.props.menuIsOpen?l.target.tagName!=="INPUT"&&l.target.tagName!=="TEXTAREA"&&o.onMenuClose():h&&o.openMenu("first"):(h&&(o.openAfterFocus=!0),o.focusInput()),l.target.tagName!=="INPUT"&&l.target.tagName!=="TEXTAREA"&&l.preventDefault()},o.onDropdownIndicatorMouseDown=function(l){if(!(l&&l.type==="mousedown"&&l.button!==0)&&!o.props.isDisabled){var h=o.props,f=h.isMulti,g=h.menuIsOpen;o.focusInput(),g?(o.setState({inputIsHiddenAfterUpdate:!f}),o.onMenuClose()):o.openMenu("first"),l.preventDefault(),l.stopPropagation()}},o.onClearIndicatorMouseDown=function(l){l&&l.type==="mousedown"&&l.button!==0||(o.clearValue(),l.stopPropagation(),o.openAfterFocus=!1,l.type==="touchend"?o.focusInput():setTimeout(function(){return o.focusInput()}))},o.onScroll=function(l){typeof o.props.closeMenuOnScroll=="boolean"?l.target instanceof HTMLElement&&Yl(l.target)&&o.props.onMenuClose():typeof o.props.closeMenuOnScroll=="function"&&o.props.closeMenuOnScroll(l)&&o.props.onMenuClose()},o.onCompositionStart=function(){o.isComposing=!0},o.onCompositionEnd=function(){o.isComposing=!1},o.onTouchStart=function(l){var h=l.touches,f=h&&h.item(0);!f||(o.initialTouchX=f.clientX,o.initialTouchY=f.clientY,o.userIsDragging=!1)},o.onTouchMove=function(l){var h=l.touches,f=h&&h.item(0);if(f){var g=Math.abs(f.clientX-o.initialTouchX),v=Math.abs(f.clientY-o.initialTouchY),E=5;o.userIsDragging=g>E||v>E}},o.onTouchEnd=function(l){o.userIsDragging||(o.controlRef&&!o.controlRef.contains(l.target)&&o.menuListRef&&!o.menuListRef.contains(l.target)&&o.blurInput(),o.initialTouchX=0,o.initialTouchY=0)},o.onControlTouchEnd=function(l){o.userIsDragging||o.onControlMouseDown(l)},o.onClearIndicatorTouchEnd=function(l){o.userIsDragging||o.onClearIndicatorMouseDown(l)},o.onDropdownIndicatorTouchEnd=function(l){o.userIsDragging||o.onDropdownIndicatorMouseDown(l)},o.handleInputChange=function(l){var h=l.currentTarget.value;o.setState({inputIsHiddenAfterUpdate:!1}),o.onInputChange(h,{action:"input-change"}),o.props.menuIsOpen||o.onMenuOpen()},o.onInputFocus=function(l){o.props.onFocus&&o.props.onFocus(l),o.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(o.openAfterFocus||o.props.openMenuOnFocus)&&o.openMenu("first"),o.openAfterFocus=!1},o.onInputBlur=function(l){if(o.menuListRef&&o.menuListRef.contains(document.activeElement)){o.inputRef.focus();return}o.props.onBlur&&o.props.onBlur(l),o.onInputChange("",{action:"input-blur"}),o.onMenuClose(),o.setState({focusedValue:null,isFocused:!1})},o.onOptionHover=function(l){o.blockOptionHover||o.state.focusedOption===l||o.setState({focusedOption:l})},o.shouldHideSelectedOptions=function(){return tg(o.props)},o.onKeyDown=function(l){var h=o.props,f=h.isMulti,g=h.backspaceRemovesValue,v=h.escapeClearsValue,E=h.inputValue,_=h.isClearable,C=h.isDisabled,k=h.menuIsOpen,I=h.onKeyDown,X=h.tabSelectsValue,U=h.openMenuOnFocus,$=o.state,P=$.focusedOption,N=$.focusedValue,J=$.selectValue;if(!C&&!(typeof I=="function"&&(I(l),l.defaultPrevented))){switch(o.blockOptionHover=!0,l.key){case"ArrowLeft":if(!f||E)return;o.focusValue("previous");break;case"ArrowRight":if(!f||E)return;o.focusValue("next");break;case"Delete":case"Backspace":if(E)return;if(N)o.removeValue(N);else{if(!g)return;f?o.popValue():_&&o.clearValue()}break;case"Tab":if(o.isComposing||l.shiftKey||!k||!X||!P||U&&o.isOptionSelected(P,J))return;o.selectOption(P);break;case"Enter":if(l.keyCode===229)break;if(k){if(!P||o.isComposing)return;o.selectOption(P);break}return;case"Escape":k?(o.setState({inputIsHiddenAfterUpdate:!1}),o.onInputChange("",{action:"menu-close"}),o.onMenuClose()):_&&v&&o.clearValue();break;case" ":if(E)return;if(!k){o.openMenu("first");break}if(!P)return;o.selectOption(P);break;case"ArrowUp":k?o.focusOption("up"):o.openMenu("last");break;case"ArrowDown":k?o.focusOption("down"):o.openMenu("first");break;case"PageUp":if(!k)return;o.focusOption("pageup");break;case"PageDown":if(!k)return;o.focusOption("pagedown");break;case"Home":if(!k)return;o.focusOption("first");break;case"End":if(!k)return;o.focusOption("last");break;default:return}l.preventDefault()}},o.instancePrefix="react-select-"+(o.props.instanceId||++XC),o.state.selectValue=vf(n.value),o}return Os(e,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput()}},{key:"componentDidUpdate",value:function(n){var o=this.props,l=o.isDisabled,h=o.menuIsOpen,f=this.state.isFocused;(f&&!l&&n.isDisabled||f&&h&&!n.menuIsOpen)&&this.focusInput(),f&&l&&!n.isDisabled&&this.setState({isFocused:!1},this.onMenuClose),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(pT(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close"}),this.props.onMenuClose()}},{key:"onInputChange",value:function(n,o){this.props.onInputChange(n,o)}},{key:"focusInput",value:function(){!this.inputRef||this.inputRef.focus()}},{key:"blurInput",value:function(){!this.inputRef||this.inputRef.blur()}},{key:"openMenu",value:function(n){var o=this,l=this.state,h=l.selectValue,f=l.isFocused,g=this.buildFocusableOptions(),v=n==="first"?0:g.length-1;if(!this.props.isMulti){var E=g.indexOf(h[0]);E>-1&&(v=E)}this.scrollToFocusedOptionOnUpdate=!(f&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:g[v]},function(){return o.onMenuOpen()})}},{key:"focusValue",value:function(n){var o=this.state,l=o.selectValue,h=o.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var f=l.indexOf(h);h||(f=-1);var g=l.length-1,v=-1;if(l.length){switch(n){case"previous":f===0?v=0:f===-1?v=g:v=f-1;break;case"next":f>-1&&f<g&&(v=f+1);break}this.setState({inputIsHidden:v!==-1,focusedValue:l[v]})}}}},{key:"focusOption",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",o=this.props.pageSize,l=this.state.focusedOption,h=this.getFocusableOptions();if(h.length){var f=0,g=h.indexOf(l);l||(g=-1),n==="up"?f=g>0?g-1:h.length-1:n==="down"?f=(g+1)%h.length:n==="pageup"?(f=g-o,f<0&&(f=0)):n==="pagedown"?(f=g+o,f>h.length-1&&(f=h.length-1)):n==="last"&&(f=h.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:h[f],focusedValue:null})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(ru):Jt(Jt({},ru),this.props.theme):ru}},{key:"getCommonProps",value:function(){var n=this.clearValue,o=this.cx,l=this.getStyles,h=this.getValue,f=this.selectOption,g=this.setValue,v=this.props,E=v.isMulti,_=v.isRtl,C=v.options,k=this.hasValue();return{clearValue:n,cx:o,getStyles:l,getValue:h,hasValue:k,isMulti:E,isRtl:_,options:C,selectOption:f,selectProps:v,setValue:g,theme:this.getTheme()}}},{key:"hasValue",value:function(){var n=this.state.selectValue;return n.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var n=this.props,o=n.isClearable,l=n.isMulti;return o===void 0?l:o}},{key:"isOptionDisabled",value:function(n,o){return Qf(this.props,n,o)}},{key:"isOptionSelected",value:function(n,o){return $f(this.props,n,o)}},{key:"filterOption",value:function(n,o){return eg(this.props,n,o)}},{key:"formatOptionLabel",value:function(n,o){if(typeof this.props.formatOptionLabel=="function"){var l=this.props.inputValue,h=this.state.selectValue;return this.props.formatOptionLabel(n,{context:o,inputValue:l,selectValue:h})}else return this.getOptionLabel(n)}},{key:"formatGroupLabel",value:function(n){return this.props.formatGroupLabel(n)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var n=this.props,o=n.isDisabled,l=n.isSearchable,h=n.inputId,f=n.inputValue,g=n.tabIndex,v=n.form,E=this.getComponents(),_=E.Input,C=this.state.inputIsHidden,k=this.commonProps,I=h||this.getElementId("input"),X={"aria-autocomplete":"list","aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"]};return l?fe.createElement(_,Ye({},k,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:I,innerRef:this.getInputRef,isDisabled:o,isHidden:C,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:g,form:v,type:"text",value:f},X)):fe.createElement(PC,Ye({id:I,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Is,onFocus:this.onInputFocus,readOnly:!0,disabled:o,tabIndex:g,form:v,value:""},X))}},{key:"renderPlaceholderOrValue",value:function(){var n=this,o=this.getComponents(),l=o.MultiValue,h=o.MultiValueContainer,f=o.MultiValueLabel,g=o.MultiValueRemove,v=o.SingleValue,E=o.Placeholder,_=this.commonProps,C=this.props,k=C.controlShouldRenderValue,I=C.isDisabled,X=C.isMulti,U=C.inputValue,$=C.placeholder,P=this.state,N=P.selectValue,J=P.focusedValue,K=P.isFocused;if(!this.hasValue()||!k)return U?null:fe.createElement(E,Ye({},_,{key:"placeholder",isDisabled:I,isFocused:K}),$);if(X){var oe=N.map(function(me,we){var De=me===J;return fe.createElement(l,Ye({},_,{components:{Container:h,Label:f,Remove:g},isFocused:De,isDisabled:I,key:"".concat(n.getOptionValue(me)).concat(we),index:we,removeProps:{onClick:function(){return n.removeValue(me)},onTouchEnd:function(){return n.removeValue(me)},onMouseDown:function(Be){Be.preventDefault(),Be.stopPropagation()}},data:me}),n.formatOptionLabel(me,"value"))});return oe}if(U)return null;var ie=N[0];return fe.createElement(v,Ye({},_,{data:ie,isDisabled:I}),this.formatOptionLabel(ie,"value"))}},{key:"renderClearIndicator",value:function(){var n=this.getComponents(),o=n.ClearIndicator,l=this.commonProps,h=this.props,f=h.isDisabled,g=h.isLoading,v=this.state.isFocused;if(!this.isClearable()||!o||f||!this.hasValue()||g)return null;var E={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return fe.createElement(o,Ye({},l,{innerProps:E,isFocused:v}))}},{key:"renderLoadingIndicator",value:function(){var n=this.getComponents(),o=n.LoadingIndicator,l=this.commonProps,h=this.props,f=h.isDisabled,g=h.isLoading,v=this.state.isFocused;if(!o||!g)return null;var E={"aria-hidden":"true"};return fe.createElement(o,Ye({},l,{innerProps:E,isDisabled:f,isFocused:v}))}},{key:"renderIndicatorSeparator",value:function(){var n=this.getComponents(),o=n.DropdownIndicator,l=n.IndicatorSeparator;if(!o||!l)return null;var h=this.commonProps,f=this.props.isDisabled,g=this.state.isFocused;return fe.createElement(l,Ye({},h,{isDisabled:f,isFocused:g}))}},{key:"renderDropdownIndicator",value:function(){var n=this.getComponents(),o=n.DropdownIndicator;if(!o)return null;var l=this.commonProps,h=this.props.isDisabled,f=this.state.isFocused,g={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return fe.createElement(o,Ye({},l,{innerProps:g,isDisabled:h,isFocused:f}))}},{key:"renderMenu",value:function(){var n=this,o=this.getComponents(),l=o.Group,h=o.GroupHeading,f=o.Menu,g=o.MenuList,v=o.MenuPortal,E=o.LoadingMessage,_=o.NoOptionsMessage,C=o.Option,k=this.commonProps,I=this.state.focusedOption,X=this.props,U=X.captureMenuScroll,$=X.inputValue,P=X.isLoading,N=X.loadingMessage,J=X.minMenuHeight,K=X.maxMenuHeight,oe=X.menuIsOpen,ie=X.menuPlacement,me=X.menuPosition,we=X.menuPortalTarget,De=X.menuShouldBlockScroll,Be=X.menuShouldScrollIntoView,Oe=X.noOptionsMessage,Ue=X.onMenuScrollToTop,Ve=X.onMenuScrollToBottom;if(!oe)return null;var et=function(gt,oi){var kn=gt.type,on=gt.data,Tn=gt.isDisabled,qn=gt.isSelected,Rn=gt.label,xr=gt.value,br=I===on,zi=Tn?void 0:function(){return n.onOptionHover(on)},Sr=Tn?void 0:function(){return n.selectOption(on)},_r="".concat(n.getElementId("option"),"-").concat(oi),Tr={id:_r,onClick:Sr,onMouseMove:zi,onMouseOver:zi,tabIndex:-1};return fe.createElement(C,Ye({},k,{innerProps:Tr,data:on,isDisabled:Tn,isSelected:qn,key:_r,label:Rn,type:kn,value:xr,isFocused:br,innerRef:br?n.getFocusedOptionRef:void 0}),n.formatOptionLabel(gt.data,"menu"))},$e;if(this.hasOptions())$e=this.getCategorizedOptions().map(function(gt){if(gt.type==="group"){var oi=gt.data,kn=gt.options,on=gt.index,Tn="".concat(n.getElementId("group"),"-").concat(on),qn="".concat(Tn,"-heading");return fe.createElement(l,Ye({},k,{key:Tn,data:oi,options:kn,Heading:h,headingProps:{id:qn,data:gt.data},label:n.formatGroupLabel(gt.data)}),gt.options.map(function(Rn){return et(Rn,"".concat(on,"-").concat(Rn.index))}))}else if(gt.type==="option")return et(gt,"".concat(gt.index))});else if(P){var lt=N({inputValue:$});if(lt===null)return null;$e=fe.createElement(E,k,lt)}else{var dt=Oe({inputValue:$});if(dt===null)return null;$e=fe.createElement(_,k,dt)}var At={minMenuHeight:J,maxMenuHeight:K,menuPlacement:ie,menuPosition:me,menuShouldScrollIntoView:Be},Le=fe.createElement(Sf,Ye({},k,At),function(gt){var oi=gt.ref,kn=gt.placerProps,on=kn.placement,Tn=kn.maxHeight;return fe.createElement(f,Ye({},k,At,{innerRef:oi,innerProps:{onMouseDown:n.onMenuMouseDown,onMouseMove:n.onMenuMouseMove},isLoading:P,placement:on}),fe.createElement(BC,{captureEnabled:U,onTopArrive:Ue,onBottomArrive:Ve,lockEnabled:De},function(qn){return fe.createElement(g,Ye({},k,{innerRef:function(Rn){n.getMenuListRef(Rn),qn(Rn)},isLoading:P,maxHeight:Tn,focusedOption:I}),$e)}))});return we||me==="fixed"?fe.createElement(v,Ye({},k,{appendTo:we,controlElement:this.controlRef,menuPlacement:ie,menuPosition:me}),Le):Le}},{key:"renderFormField",value:function(){var n=this,o=this.props,l=o.delimiter,h=o.isDisabled,f=o.isMulti,g=o.name,v=this.state.selectValue;if(!(!g||h))if(f)if(l){var E=v.map(function(k){return n.getOptionValue(k)}).join(l);return fe.createElement("input",{name:g,type:"hidden",value:E})}else{var _=v.length>0?v.map(function(k,I){return fe.createElement("input",{key:"i-".concat(I),name:g,type:"hidden",value:n.getOptionValue(k)})}):fe.createElement("input",{name:g,type:"hidden"});return fe.createElement("div",null,_)}else{var C=v[0]?this.getOptionValue(v[0]):"";return fe.createElement("input",{name:g,type:"hidden",value:C})}}},{key:"renderLiveRegion",value:function(){var n=this.commonProps,o=this.state,l=o.ariaSelection,h=o.focusedOption,f=o.focusedValue,g=o.isFocused,v=o.selectValue,E=this.getFocusableOptions();return fe.createElement(bC,Ye({},n,{ariaSelection:l,focusedOption:h,focusedValue:f,isFocused:g,selectValue:v,focusableOptions:E}))}},{key:"render",value:function(){var n=this.getComponents(),o=n.Control,l=n.IndicatorsContainer,h=n.SelectContainer,f=n.ValueContainer,g=this.props,v=g.className,E=g.id,_=g.isDisabled,C=g.menuIsOpen,k=this.state.isFocused,I=this.commonProps=this.getCommonProps();return fe.createElement(h,Ye({},I,{className:v,innerProps:{id:E,onKeyDown:this.onKeyDown},isDisabled:_,isFocused:k}),this.renderLiveRegion(),fe.createElement(o,Ye({},I,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:_,isFocused:k,menuIsOpen:C}),fe.createElement(f,Ye({},I,{isDisabled:_}),this.renderPlaceholderOrValue(),this.renderInput()),fe.createElement(l,Ye({},I,{isDisabled:_}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(n,o){var l=o.prevProps,h=o.clearFocusValueOnUpdate,f=o.inputIsHiddenAfterUpdate,g=n.options,v=n.value,E=n.menuIsOpen,_=n.inputValue,C={};if(l&&(v!==l.value||g!==l.options||E!==l.menuIsOpen||_!==l.inputValue)){var k=vf(v),I=E?GC(n,k):[],X=h?qC(o,k):null,U=ZC(o,I);C={selectValue:k,focusedOption:U,focusedValue:X,clearFocusValueOnUpdate:!1}}var $=f!=null&&n!==l?{inputIsHidden:f,inputIsHiddenAfterUpdate:void 0}:{};return Jt(Jt(Jt({},C),$),{},{prevProps:n})}}]),e}(se);ng.defaultProps=WC;var YC={defaultInputValue:"",defaultMenuIsOpen:!1,defaultValue:null},KC=function(t){var r,e;return e=r=function(n){Bs(l,n);var o=Fs(l);function l(){var h;Ds(this,l);for(var f=arguments.length,g=new Array(f),v=0;v<f;v++)g[v]=arguments[v];return h=o.call.apply(o,[this].concat(g)),h.select=void 0,h.state={inputValue:h.props.inputValue!==void 0?h.props.inputValue:h.props.defaultInputValue,menuIsOpen:h.props.menuIsOpen!==void 0?h.props.menuIsOpen:h.props.defaultMenuIsOpen,value:h.props.value!==void 0?h.props.value:h.props.defaultValue},h.onChange=function(E,_){h.callProp("onChange",E,_),h.setState({value:E})},h.onInputChange=function(E,_){var C=h.callProp("onInputChange",E,_);h.setState({inputValue:C!==void 0?C:E})},h.onMenuOpen=function(){h.callProp("onMenuOpen"),h.setState({menuIsOpen:!0})},h.onMenuClose=function(){h.callProp("onMenuClose"),h.setState({menuIsOpen:!1})},h}return Os(l,[{key:"focus",value:function(){this.select.focus()}},{key:"blur",value:function(){this.select.blur()}},{key:"getProp",value:function(h){return this.props[h]!==void 0?this.props[h]:this.state[h]}},{key:"callProp",value:function(h){if(typeof this.props[h]=="function"){for(var f,g=arguments.length,v=new Array(g>1?g-1:0),E=1;E<g;E++)v[E-1]=arguments[E];return(f=this.props)[h].apply(f,v)}}},{key:"render",value:function(){var h=this,f=this.props;f.defaultInputValue,f.defaultMenuIsOpen,f.defaultValue;var g=pr(f,["defaultInputValue","defaultMenuIsOpen","defaultValue"]);return fe.createElement(t,Ye({},g,{ref:function(v){h.select=v},inputValue:this.getProp("inputValue"),menuIsOpen:this.getProp("menuIsOpen"),onChange:this.onChange,onInputChange:this.onInputChange,onMenuClose:this.onMenuClose,onMenuOpen:this.onMenuOpen,value:this.getProp("value")}))}}]),l}(se),r.defaultProps=YC,e},JC=KC(ng),QC=JC;const ou=[{value:"assessing",label:"Assessing"},{value:"bookmarking",label:"Bookmarking"},{value:"classifying",label:"Classifying"},{value:"commenting",label:"Commenting"},{value:"describing",label:"Describing"},{value:"editing",label:"Editing"},{value:"highlighting",label:"Highlighting"},{value:"identifying",label:"Identifying"},{value:"linking",label:"Linking"},{value:"moderating",label:"Moderating"},{value:"questioning",label:"Questioning"},{value:"replying",label:"Replying"},{value:"supplementing",label:"Transcription"}];var ig=t=>{const r=t.content?ou.find(e=>e.value===t.content):null;return fe.createElement("div",{className:"r6o-purposedropdown"},fe.createElement(QC,{value:r,onChange:t.onChange,options:ou,isDisabled:!t.editable}))};const $C=t=>fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 940",width:t.width},fe.createElement("metadata",null,"IcoFont Icons"),fe.createElement("title",null,"simple-down"),fe.createElement("glyph",{glyphName:"simple-down",unicode:"",horizAdvX:"1000"}),fe.createElement("path",{fill:"currentColor",d:"M200 392.6l300 300 300-300-85.10000000000002-85.10000000000002-214.89999999999998 214.79999999999995-214.89999999999998-214.89999999999998-85.10000000000002 85.20000000000005z"})),eP=t=>fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"180 150 700 800",width:t.width},fe.createElement("metadata",null,"IcoFont Icons"),fe.createElement("title",null,"close"),fe.createElement("glyph",{glyphName:"close",unicode:"",horizAdvX:"1000"}),fe.createElement("path",{fill:"currentColor",d:"M709.8 206.6c-64.39999999999998 65.50000000000003-128.89999999999998 131.20000000000002-194.19999999999993 197.6-8.600000000000023 8.699999999999989-22.400000000000034 8.800000000000011-31 0-65-66-129.70000000000005-131.8-194.5-197.6-8.600000000000023-8.699999999999989-22.400000000000034-8.599999999999994-30.900000000000034 0.09999999999999432-15.699999999999989 16.200000000000017-31.099999999999994 32.30000000000001-47.099999999999994 48.80000000000001-8.5 8.800000000000011-8.299999999999983 23 0.20000000000001705 31.69999999999999 63.099999999999966 64.19999999999999 127.89999999999998 130.10000000000002 193.59999999999997 197 8.600000000000023 8.699999999999989 8.5 22.80000000000001 0 31.599999999999966-65.19999999999999 66.40000000000009-130.2 132.5-194.7 198.10000000000002-8.5 8.700000000000045-8.5 22.800000000000068 0.20000000000001705 31.399999999999977l47.79999999999998 47.90000000000009c8.600000000000023 8.599999999999909 22.600000000000023 8.599999999999909 31.100000000000023-0.10000000000002274l194.2-197.30000000000007c8.600000000000023-8.699999999999932 22.399999999999977-8.699999999999932 31 0 64.70000000000005 65.80000000000007 129.20000000000005 131.4000000000001 194.20000000000005 197.5 8.599999999999909 8.700000000000045 22.5 8.800000000000068 31 0.10000000000002274 16-16.199999999999932 31.699999999999932-32.19999999999993 47.59999999999991-48.299999999999955 8.600000000000023-8.700000000000045 8.600000000000023-22.899999999999977 0.10000000000002274-31.600000000000023-63.799999999999955-65-128.5-130.89999999999998-194.19999999999993-197.79999999999995-8.600000000000023-8.700000000000045-8.600000000000023-22.900000000000034 0-31.600000000000023 65.19999999999993-66.40000000000003 130.0999999999999-132.5 194.5-198.20000000000005 8.599999999999909-8.699999999999989 8.5-22.799999999999955-0.10000000000002274-31.49999999999997l-47.80000000000007-48.099999999999994c-8.5-8.5-22.399999999999977-8.400000000000006-31 0.29999999999998295z"})),tP=t=>fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",width:t.width},fe.createElement("path",{fill:"currentColor",d:"M268 416h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12zM432 80h-82.41l-34-56.7A48 48 0 0 0 274.41 0H173.59a48 48 0 0 0-41.16 23.3L98.41 80H16A16 16 0 0 0 0 96v16a16 16 0 0 0 16 16h16v336a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128h16a16 16 0 0 0 16-16V96a16 16 0 0 0-16-16zM171.84 50.91A6 6 0 0 1 177 48h94a6 6 0 0 1 5.15 2.91L293.61 80H154.39zM368 464H80V128h288zm-212-48h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12z"}));var nP=t=>{const[r,e]=F(!1),[n,o]=F(!1),l=_=>{e(!0),o(!1)},h=_=>{t.onDelete(t.body),o(!1)},f=_=>t.onUpdate(t.body,{...t.body,value:_.target.value}),g=_=>t.onUpdate(t.body,{...t.body,purpose:_.value}),v=t.body.modified||t.body.created,E=t.body.creator&&fe.createElement("div",{className:"r6o-lastmodified"},fe.createElement("span",{className:"r6o-lastmodified-by"},t.body.creator.name||t.body.creator.id),t.body.created&&fe.createElement("span",{className:"r6o-lastmodified-at"},fe.createElement(Oy,{datetime:t.env.toClientTime(v),locale:bn.locale()})));return t.readOnly?fe.createElement("div",{className:"r6o-widget comment"},fe.createElement("div",{className:"r6o-readonly-comment"},t.body.value),E):fe.createElement("div",{className:r?"r6o-widget comment editable":"r6o-widget comment"},fe.createElement(Mp,{editable:r,content:t.body.value,onChange:f,onSaveAndClose:t.onSaveAndClose}),!r&&E,t.purposeSelector&&fe.createElement(ig,{editable:r,content:t.body.purpose,onChange:g,onSaveAndClose:t.onSaveAndClose}),fe.createElement("div",{className:n?"r6o-icon r6o-arrow-down r6o-menu-open":"r6o-icon r6o-arrow-down",onClick:()=>o(!n)},fe.createElement($C,{width:12})),n&&fe.createElement(HS,{onEdit:l,onDelete:h,onClickOutside:()=>o(!1)}))};const iP=ou.map(t=>t.value),rg=(t,r)=>{const e=r?iP.indexOf(t.purpose)>-1:t.purpose=="commenting"||t.purpose=="replying";return t.type==="TextualBody"&&(!Object.prototype.hasOwnProperty.call(t,"purpose")||e)},og=(t,r)=>{var e,n;if(r.editable===!0)return!1;if(r.editable===!1)return!0;if(r.editable==="MINE_ONLY"){const o=(e=t.creator)==null?void 0:e.id;return((n=r.env.user)==null?void 0:n.id)!==o}return r.readOnly},rP=(t,r)=>t||{type:"TextualBody",value:"",purpose:r?"replying":"commenting",draft:!0},sg=t=>{const r=t.annotation?t.annotation.bodies.filter(g=>rg(g,t.purposeSelector)):[],e=rP(r.find(g=>g.draft==!0),r.length>1),n=r.filter(g=>g!=e),o=g=>{const v=e.value,E=g.target.value;v.length===0&&E.length>0?t.onAppendBody({...e,value:E}):v.length>0&&E.length===0?t.onRemoveBody(e):t.onUpdateBody(e,{...e,value:E})},l=g=>t.onUpdateBody(e,{...e,purpose:g.value}),h=!t.readOnly&&t.annotation,f=n.length===0||!t.disableReply;return fe.createElement(fe.Fragment,null,n.map((g,v)=>fe.createElement(nP,{key:v,env:t.env,purposeSelector:t.purposeSelector,readOnly:og(g,t),body:g,onUpdate:t.onUpdateBody,onDelete:t.onRemoveBody,onSaveAndClose:t.onSaveAndClose})),h&&f&&fe.createElement("div",{className:"r6o-widget comment editable"},fe.createElement(Mp,{focus:t.focus,content:e.value,editable:!0,placeholder:n.length>0?bn.t("Add a reply..."):t.textPlaceHolder||bn.t("Add a comment..."),onChange:o,onSaveAndClose:()=>t.onSaveAndClose()}),t.purposeSelector&&e.value.length>0&&fe.createElement(ig,{editable:!0,content:e.purpose,onChange:l,onSaveAndClose:()=>t.onSaveAndClose()})))};sg.disableDelete=(t,r)=>t.bodies.filter(e=>rg(e,r.purposeSelector)).some(e=>og(e,r));var ag=sg;function lg(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,ks(t,r)}function oP(t,r){return t.classList?!!r&&t.classList.contains(r):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+r+" ")!==-1}function sP(t,r){t.classList?t.classList.add(r):oP(t,r)||(typeof t.className=="string"?t.className=t.className+" "+r:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+r))}function ug(t,r){return t.replace(new RegExp("(^|\\s)"+r+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function aP(t,r){t.classList?t.classList.remove(r):typeof t.className=="string"?t.className=ug(t.className,r):t.setAttribute("class",ug(t.className&&t.className.baseVal||"",r))}var cg={disabled:!1},hg=fe.createContext(null),dg=function(t){return t.scrollTop},fo="unmounted",Ii="exited",Li="entering",mr="entered",su="exiting",ni=function(t){lg(r,t);function r(n,o){var l;l=t.call(this,n,o)||this;var h=o,f=h&&!h.isMounting?n.enter:n.appear,g;return l.appearStatus=null,n.in?f?(g=Ii,l.appearStatus=Li):g=mr:n.unmountOnExit||n.mountOnEnter?g=fo:g=Ii,l.state={status:g},l.nextCallback=null,l}r.getDerivedStateFromProps=function(n,o){var l=n.in;return l&&o.status===fo?{status:Ii}:null};var e=r.prototype;return e.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},e.componentDidUpdate=function(n){var o=null;if(n!==this.props){var l=this.state.status;this.props.in?l!==Li&&l!==mr&&(o=Li):(l===Li||l===mr)&&(o=su)}this.updateStatus(!1,o)},e.componentWillUnmount=function(){this.cancelNextCallback()},e.getTimeouts=function(){var n=this.props.timeout,o,l,h;return o=l=h=n,n!=null&&typeof n!="number"&&(o=n.exit,l=n.enter,h=n.appear!==void 0?n.appear:l),{exit:o,enter:l,appear:h}},e.updateStatus=function(n,o){if(n===void 0&&(n=!1),o!==null)if(this.cancelNextCallback(),o===Li){if(this.props.unmountOnExit||this.props.mountOnEnter){var l=this.props.nodeRef?this.props.nodeRef.current:fe.findDOMNode(this);l&&dg(l)}this.performEnter(n)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Ii&&this.setState({status:fo})},e.performEnter=function(n){var o=this,l=this.props.enter,h=this.context?this.context.isMounting:n,f=this.props.nodeRef?[h]:[fe.findDOMNode(this),h],g=f[0],v=f[1],E=this.getTimeouts(),_=h?E.appear:E.enter;if(!n&&!l||cg.disabled){this.safeSetState({status:mr},function(){o.props.onEntered(g)});return}this.props.onEnter(g,v),this.safeSetState({status:Li},function(){o.props.onEntering(g,v),o.onTransitionEnd(_,function(){o.safeSetState({status:mr},function(){o.props.onEntered(g,v)})})})},e.performExit=function(){var n=this,o=this.props.exit,l=this.getTimeouts(),h=this.props.nodeRef?void 0:fe.findDOMNode(this);if(!o||cg.disabled){this.safeSetState({status:Ii},function(){n.props.onExited(h)});return}this.props.onExit(h),this.safeSetState({status:su},function(){n.props.onExiting(h),n.onTransitionEnd(l.exit,function(){n.safeSetState({status:Ii},function(){n.props.onExited(h)})})})},e.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},e.safeSetState=function(n,o){o=this.setNextCallback(o),this.setState(n,o)},e.setNextCallback=function(n){var o=this,l=!0;return this.nextCallback=function(h){l&&(l=!1,o.nextCallback=null,n(h))},this.nextCallback.cancel=function(){l=!1},this.nextCallback},e.onTransitionEnd=function(n,o){this.setNextCallback(o);var l=this.props.nodeRef?this.props.nodeRef.current:fe.findDOMNode(this),h=n==null&&!this.props.addEndListener;if(!l||h){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var f=this.props.nodeRef?[this.nextCallback]:[l,this.nextCallback],g=f[0],v=f[1];this.props.addEndListener(g,v)}n!=null&&setTimeout(this.nextCallback,n)},e.render=function(){var n=this.state.status;if(n===fo)return null;var o=this.props,l=o.children;o.in,o.mountOnEnter,o.unmountOnExit,o.appear,o.enter,o.exit,o.timeout,o.addEndListener,o.onEnter,o.onEntering,o.onEntered,o.onExit,o.onExiting,o.onExited,o.nodeRef;var h=ql(o,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return fe.createElement(hg.Provider,{value:null},typeof l=="function"?l(n,h):fe.cloneElement(fe.Children.only(l),h))},r}(fe.Component);ni.contextType=hg,ni.propTypes={};function vr(){}ni.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:vr,onEntering:vr,onEntered:vr,onExit:vr,onExiting:vr,onExited:vr},ni.UNMOUNTED=fo,ni.EXITED=Ii,ni.ENTERING=Li,ni.ENTERED=mr,ni.EXITING=su;var lP=ni,uP=function(t,r){return t&&r&&r.split(" ").forEach(function(e){return sP(t,e)})},au=function(t,r){return t&&r&&r.split(" ").forEach(function(e){return aP(t,e)})},lu=function(t){lg(r,t);function r(){for(var n,o=arguments.length,l=new Array(o),h=0;h<o;h++)l[h]=arguments[h];return n=t.call.apply(t,[this].concat(l))||this,n.appliedClasses={appear:{},enter:{},exit:{}},n.onEnter=function(f,g){var v=n.resolveArguments(f,g),E=v[0],_=v[1];n.removeClasses(E,"exit"),n.addClass(E,_?"appear":"enter","base"),n.props.onEnter&&n.props.onEnter(f,g)},n.onEntering=function(f,g){var v=n.resolveArguments(f,g),E=v[0],_=v[1],C=_?"appear":"enter";n.addClass(E,C,"active"),n.props.onEntering&&n.props.onEntering(f,g)},n.onEntered=function(f,g){var v=n.resolveArguments(f,g),E=v[0],_=v[1],C=_?"appear":"enter";n.removeClasses(E,C),n.addClass(E,C,"done"),n.props.onEntered&&n.props.onEntered(f,g)},n.onExit=function(f){var g=n.resolveArguments(f),v=g[0];n.removeClasses(v,"appear"),n.removeClasses(v,"enter"),n.addClass(v,"exit","base"),n.props.onExit&&n.props.onExit(f)},n.onExiting=function(f){var g=n.resolveArguments(f),v=g[0];n.addClass(v,"exit","active"),n.props.onExiting&&n.props.onExiting(f)},n.onExited=function(f){var g=n.resolveArguments(f),v=g[0];n.removeClasses(v,"exit"),n.addClass(v,"exit","done"),n.props.onExited&&n.props.onExited(f)},n.resolveArguments=function(f,g){return n.props.nodeRef?[n.props.nodeRef.current,f]:[f,g]},n.getClassNames=function(f){var g=n.props.classNames,v=typeof g=="string",E=v&&g?g+"-":"",_=v?""+E+f:g[f],C=v?_+"-active":g[f+"Active"],k=v?_+"-done":g[f+"Done"];return{baseClassName:_,activeClassName:C,doneClassName:k}},n}var e=r.prototype;return e.addClass=function(n,o,l){var h=this.getClassNames(o)[l+"ClassName"],f=this.getClassNames("enter"),g=f.doneClassName;o==="appear"&&l==="done"&&g&&(h+=" "+g),l==="active"&&n&&dg(n),h&&(this.appliedClasses[o][l]=h,uP(n,h))},e.removeClasses=function(n,o){var l=this.appliedClasses[o],h=l.base,f=l.active,g=l.done;this.appliedClasses[o]={},h&&au(n,h),f&&au(n,f),g&&au(n,g)},e.render=function(){var n=this.props;n.classNames;var o=ql(n,["classNames"]);return fe.createElement(lP,Ye({},o,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},r}(fe.Component);lu.defaultProps={classNames:""},lu.propTypes={};var cP=lu;const hP=(t,r)=>r.filter(e=>(e.label?e.label:e).toLowerCase().startsWith(t.toLowerCase())),dP=(t,r)=>r(t);var pP=t=>{const r=ae(),[e,n]=F(t.initialValue||""),[o,l]=F([]),[h,f]=F(null);ne(()=>{t.focus&&r.current.querySelector("input").focus({preventScroll:!0})},[]),ne(()=>{t.onChange&&t.onChange(e)},[e]);const g=C=>{if(typeof t.vocabulary=="function"){const k=dP(C,t.vocabulary);k.then?k.then(l):l(k)}else{const k=hP(C,t.vocabulary);l(k)}},v=()=>{if(h!==null)t.onSubmit(o[h]);else{const C=e.trim();if(C){const k=Array.isArray(t.vocabulary)?t.vocabulary.find(I=>(I.label||I).toLowerCase()===C.toLowerCase()):null;k?t.onSubmit(k):t.onSubmit(C)}}n(""),l([]),f(null)},E=C=>{if(C.which===13)v();else if(C.which===27)t.onCancel&&t.onCancel();else if(o.length>0){if(C.which===38)if(h===null)f(0);else{const k=Math.max(0,h-1);f(k)}else if(C.which===40)if(h===null)f(0);else{const k=Math.min(o.length-1,h+1);f(k)}}else C.which===40&&Array.isArray(t.vocabulary)&&l(t.vocabulary)},_=C=>{const{value:k}=C.target;n(k),f(null),k?g(k):l([])};return fe.createElement("div",{ref:r,className:"r6o-autocomplete"},fe.createElement("div",null,fe.createElement("input",{onKeyDown:E,onChange:_,value:e,placeholder:t.placeholder})),fe.createElement("ul",null,o.length>0&&o.map((C,k)=>fe.createElement("li",{key:`${C.label?C.label:C}${k}`,onClick:v,onMouseEnter:()=>f(k),style:h===k?{backgroundColor:"#bde4ff"}:{}},C.label?C.label:C))))};const fP=t=>t||{type:"TextualBody",value:"",purpose:"tagging",draft:!0};var pg=t=>{const r=t.annotation?t.annotation.bodies.filter(_=>_.purpose==="tagging"):[],e=fP(r.slice().reverse().find(_=>_.draft)),n=r.filter(_=>_!=e),[o,l]=F(!1),h=_=>C=>{l(o===_?!1:_)},f=_=>{const C=e.value.trim(),k=_.trim();C.length===0&&k.length>0?t.onAppendBody({...e,value:k}):C.length>0&&k.length===0?t.onRemoveBody(e):C!==k&&t.onUpdateBody(e,{...e,value:k})},g=_=>C=>{C.stopPropagation(),t.onRemoveBody(_)},v=_=>{const C=_.uri?{type:"SpecificResource",purpose:"tagging",source:{id:_.uri,label:_.label}}:{type:"TextualBody",purpose:"tagging",value:_.label||_};e.value.trim().length===0?t.onAppendBody(C):t.onUpdateBody(e,C)},E=_=>_.value||_.source.label;return fe.createElement("div",{className:"r6o-widget r6o-tag"},n.length>0&&fe.createElement("ul",{className:"r6o-taglist"},n.map(_=>fe.createElement("li",{key:E(_),onClick:h(_)},fe.createElement("span",{className:"r6o-label"},E(_)),!t.readOnly&&fe.createElement(cP,{in:o===_,timeout:200,classNames:"r6o-delete"},fe.createElement("span",{className:"r6o-delete-wrapper",onClick:g(_)},fe.createElement("span",{className:"r6o-delete"},fe.createElement(eP,{width:12}))))))),!t.readOnly&&fe.createElement(pP,{focus:t.focus,placeholder:t.textPlaceHolder||bn.t("Add tag..."),vocabulary:t.vocabulary||[],onChange:f,onSubmit:v}))};class fg extends se{constructor(r){super(r),this.element=fe.createRef()}renderWidget(r){const e=this.props.widget({annotation:r.annotation,readOnly:r.readOnly,...r.config,onAppendBody:(n,o)=>r.onAppendBody(n,o),onUpdateBody:(n,o,l)=>r.onUpdateBody(n,o,l),onUpsertBody:(n,o,l)=>r.onUpsertBody(n,o,l),onRemoveBody:(n,o)=>r.onRemoveBody(n,o),onBatchModify:(n,o)=>r.onBatchModify(n,o),onSetProperty:(n,o)=>r.onSetProperty(n,o),onAddContext:n=>r.onAddContext(n),onSaveAndClose:()=>r.onSaveAndClose()});for(;this.element.current.firstChild;)this.element.current.removeChild(this.element.current.lastChild);this.element.current.appendChild(e)}componentDidMount(){this.renderWidget(this.props)}componentWillReceiveProps(r){this.element.current&&this.props.annotation!==r.annotation&&this.renderWidget(r)}render(){return fe.createElement("div",{ref:this.element,className:"widget"})}}window.React=fe,window.ReactDOM=fe;const gP={COMMENT:ag,TAG:pg},mP=[fe.createElement(ag,null),fe.createElement(pg,null)],vP=t=>{const r=n=>{var o;return typeof n=="function"&&!!((o=n.prototype)!=null&&o.isReactComponent)},e=n=>typeof n=="function"&&(String(n).match(/return .+\(['|"].+['|"],\s*\{/g)||String(n).match(/return .+preact_compat/)||String(n).match(/return .+\.createElement/g));return r(t)||e(t)},yP=t=>{const r=(e,n,o)=>{if(typeof e=="string"||e instanceof String)return fe.createElement(gP[e],n);if((o==null?void 0:o.toLowerCase())==="react")return fe.createElement(e,n);if((o==null?void 0:o.toLowerCase())==="plainjs")return fe.createElement(fg,{widget:e,config:n});if(vP(e))return fe.createElement(e,n);if(typeof e=="function"||e instanceof Function)return fe.createElement(fg,{widget:e,config:n});throw`${e} is not a valid plugin`};if(t.widget){const{widget:e,force:n,...o}=t;return r(e,o,n)}else return r(t)},gg=14;var mg=(t,r,e,n)=>{const o=t.getBoundingClientRect();r.className="r6o-editor r6o-arrow-top r6o-arrow-left";const{left:l,top:h,right:f,bottom:g}=e.getBoundingClientRect();if(r.style.top=`${g-o.top+gg}px`,r.style.left=`${l-o.left}px`,n){const v=r.children[1].getBoundingClientRect(),{innerWidth:E,innerHeight:_}=t.ownerDocument.defaultView;if(v.right>E&&(r.classList.remove("r6o-arrow-left"),r.classList.add("r6o-arrow-right"),r.style.left=`${f-v.width-o.left}px`),v.bottom>_){r.classList.remove("r6o-arrow-top"),r.classList.add("r6o-arrow-bottom");const k=r.children[1].getBoundingClientRect().height;r.style.top=`${h-o.top-k-gg}px`}const C=r.children[1].getBoundingClientRect();if(C.top<0){r.classList.add("pushed","down"),r.style.top=`${-o.top}px`;const k=g-o.top;C.height-o.top>k&&r.classList.remove("r6o-arrow-bottom")}C.left<0&&(r.classList.add("pushed","right"),r.style.left=`${-o.left}px`),requestAnimationFrame(()=>r.style.opacity=1)}};const vg=t=>{const{top:r,left:e,width:n,height:o}=t.getBoundingClientRect();return`${r}, ${e}, ${n}, ${o}`};class wP extends se{constructor(r){super(r),i(this,"initResizeObserver",()=>{const e=this.props.autoPosition===void 0?!0:this.props.autoPosition;if(window!=null&&window.ResizeObserver){const n=new ResizeObserver(()=>{this.state.dragged||mg(this.props.wrapperEl,this.element.current,this.props.selectedElement,e)});return n.observe(this.props.wrapperEl),()=>n.disconnect()}else this.state.dragged||mg(this.props.wrapperEl,this.element.current,this.props.selectedElement,e)}),i(this,"creationMeta",e=>{const n={},{user:o}=this.props.env;return o&&(n.creator={},o.id&&(n.creator.id=o.id),o.displayName&&(n.creator.name=o.displayName),n[e.created?"modified":"created"]=this.props.env.getCurrentTimeAdjusted()),n}),i(this,"getCurrentAnnotation",()=>this.state.currentAnnotation.clone()),i(this,"hasChanges",()=>{var e;return!((e=this.props.annotation)!=null&&e.isEqual(this.state.currentAnnotation))}),i(this,"updateCurrentAnnotation",(e,n)=>{this.setState({currentAnnotation:this.state.currentAnnotation.clone(e)},()=>{n?this.onOk():this.props.onChanged&&this.props.onChanged()})}),i(this,"onAppendBody",(e,n)=>this.updateCurrentAnnotation({body:[...this.state.currentAnnotation.bodies,{...e,...this.creationMeta(e)}]},n)),i(this,"onUpdateBody",(e,n,o)=>this.updateCurrentAnnotation({body:this.state.currentAnnotation.bodies.map(l=>l===e?{...n,...this.creationMeta(n)}:l)},o)),i(this,"onRemoveBody",(e,n)=>this.updateCurrentAnnotation({body:this.state.currentAnnotation.bodies.filter(o=>o!==e)},n)),i(this,"onUpsertBody",(e,n,o)=>{if(e==null&&n!=null)this.onAppendBody(n,o);else if(e!=null&&n!=null)this.onUpdateBody(e,n,o);else if(e!=null&&n==null){const l=this.state.currentAnnotation.bodies.find(h=>h.purpose===e.purpose);l?this.onUpdateBody(l,e,o):this.onAppendBody(e,o)}}),i(this,"onBatchModify",(e,n)=>{const o=e.filter(v=>v.action==="upsert"&&v.body).map(v=>({previous:this.state.currentAnnotation.bodies.find(E=>E.purpose===v.body.purpose),updated:{...v.body,...this.creationMeta(v.body)}})),l=e.filter(v=>v.action==="remove").map(v=>v.body),h=[...e.filter(v=>v.action==="append"||v.action==="upsert"&&v.updated&&!v.previous).map(v=>({...v.body,...this.creationMeta(v.body)})),...o.filter(v=>!v.previous).map(v=>v.updated)],f=[...e.filter(v=>v.action==="update"||v.action==="upsert"&&v.updated&&v.previous).map(v=>({previous:v.previous,updated:{...v.updated,...this.creationMeta(v.updated)}})),...o.filter(v=>v.previous)],g=[...this.state.currentAnnotation.bodies.filter(v=>!l.includes(v)).map(v=>{const E=f.find(_=>_.previous===v);return E?E.updated:v}),...h];this.updateCurrentAnnotation({body:g},n)}),i(this,"onSetProperty",(e,n)=>{if(["@context","id","type","body","target"].includes(e))throw new Exception(`Cannot set ${e} - not allowed`);if(n)this.updateCurrentAnnotation({[e]:n});else{const o=this.currentAnnotation.clone();delete o[e],this.setState({currentAnnotation:o})}}),i(this,"onAddContext",e=>{const{currentAnnotation:n}=this.state,o=Array.isArray(n.context)?n.context:[n.context];o.indexOf(e)<0&&(o.push(e),this.updateCurrentAnnotation({"@context":o}))}),i(this,"onCancel",()=>this.props.onCancel(this.props.annotation)),i(this,"onOk",()=>{const e=o=>o.clone({body:o.bodies.map(({draft:l,...h})=>h)}),{currentAnnotation:n}=this.state;n.bodies.length===0&&!this.props.allowEmpty?n.isSelection?this.onCancel():this.props.onAnnotationDeleted(this.props.annotation):n.isSelection?this.props.onAnnotationCreated(e(n).toAnnotation()):this.props.onAnnotationUpdated(e(n),this.props.annotation)}),i(this,"onDelete",()=>this.props.onAnnotationDeleted(this.props.annotation)),this.element=fe.createRef(),this.state={currentAnnotation:r.annotation,dragged:!1,selectionBounds:vg(r.selectedElement)}}componentWillReceiveProps(r){var e;const{selectionBounds:n}=this.state,o=vg(r.selectedElement);(e=this.props.annotation)!=null&&e.isEqual(r.annotation)?this.setState({selectionBounds:o}):this.setState({currentAnnotation:r.annotation,selectionBounds:o}),this.props.modifiedTarget!=r.modifiedTarget&&this.state.currentAnnotation&&this.updateCurrentAnnotation({target:this.props.modifiedTarget}),n!=o&&this.element.current&&(this.removeObserver&&this.removeObserver(),this.removeObserver=this.initResizeObserver())}componentDidMount(){this.removeObserver=this.initResizeObserver(),new MutationObserver(()=>{this.element.current&&(this.removeObserver&&this.removeObserver(),this.removeObserver=this.initResizeObserver())}).observe(this.element.current,{childList:!0,subtree:!0})}componentWillUnmount(){this.removeObserver&&this.removeObserver()}render(){const{currentAnnotation:r}=this.state,e=this.props.widgets?this.props.widgets.map(yP):mP,n=l=>l.type.disableDelete?l.type.disableDelete(r,{...l.props,readOnly:this.props.readOnly,env:this.props.env}):!1,o=r&&(r.bodies.length>0||this.props.allowEmpty)&&!this.props.readOnly&&!r.isSelection&&!e.some(n);return fe.createElement(yy,{disabled:!this.props.detachable,handle:".r6o-draggable",cancel:".r6o-btn, .r6o-btn *",onDrag:()=>this.setState({dragged:!0})},fe.createElement("div",{ref:this.element,className:this.state.dragged?"r6o-editor dragged":"r6o-editor"},fe.createElement("div",{className:"r6o-arrow"}),fe.createElement("div",{className:"r6o-editor-inner"},e.map((l,h)=>fe.cloneElement(l,{key:`${h}`,focus:h===0,annotation:r,readOnly:this.props.readOnly,env:this.props.env,onAppendBody:this.onAppendBody,onUpdateBody:this.onUpdateBody,onRemoveBody:this.onRemoveBody,onUpsertBody:this.onUpsertBody,onBatchModify:this.onBatchModify,onSetProperty:this.onSetProperty,onAddContext:this.onAddContext,onSaveAndClose:this.onOk})),this.props.readOnly?fe.createElement("div",{className:"r6o-footer"},fe.createElement("button",{className:"r6o-btn",onClick:this.onCancel},bn.t("Close"))):fe.createElement("div",{className:this.props.detachable?"r6o-footer r6o-draggable":"r6o-footer"},o&&fe.createElement("button",{className:"r6o-btn left delete-annotation",title:bn.t("Delete"),onClick:this.onDelete},fe.createElement(tP,{width:12})),fe.createElement("button",{className:"r6o-btn outline",onClick:this.onCancel},bn.t("Cancel")),fe.createElement("button",{className:"r6o-btn ",onClick:this.onOk},bn.t("Ok"))))))}}var js,EP=new Uint8Array(16);function xP(){if(!js&&(js=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!js))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return js(EP)}var bP=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function SP(t){return typeof t=="string"&&bP.test(t)}for(var Qt=[],uu=0;uu<256;++uu)Qt.push((uu+256).toString(16).substr(1));function _P(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=(Qt[t[r+0]]+Qt[t[r+1]]+Qt[t[r+2]]+Qt[t[r+3]]+"-"+Qt[t[r+4]]+Qt[t[r+5]]+"-"+Qt[t[r+6]]+Qt[t[r+7]]+"-"+Qt[t[r+8]]+Qt[t[r+9]]+"-"+Qt[t[r+10]]+Qt[t[r+11]]+Qt[t[r+12]]+Qt[t[r+13]]+Qt[t[r+14]]+Qt[t[r+15]]).toLowerCase();if(!SP(e))throw TypeError("Stringified UUID is invalid");return e}function yg(t,r,e){t=t||{};var n=t.random||(t.rng||xP)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,r){e=e||0;for(var o=0;o<16;++o)r[e+o]=n[o];return r}return _P(n)}var TP=function t(r,e){if(r===e)return!0;if(r&&e&&typeof r=="object"&&typeof e=="object"){if(r.constructor!==e.constructor)return!1;var n,o,l;if(Array.isArray(r)){if(n=r.length,n!=e.length)return!1;for(o=n;o--!==0;)if(!t(r[o],e[o]))return!1;return!0}if(r.constructor===RegExp)return r.source===e.source&&r.flags===e.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===e.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===e.toString();if(l=Object.keys(r),n=l.length,n!==Object.keys(e).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(e,l[o]))return!1;for(o=n;o--!==0;){var h=l[o];if(!t(r[h],e[h]))return!1}return!0}return r!==r&&e!==e},wg=TP;const cu=class{constructor(t,r){i(this,"clone",(e,n)=>new cu({...this.underlying,...e},{...this.opts,...n})),i(this,"selector",e=>{const{target:n}=this.underlying;if(n.selector)return(Array.isArray(n.selector)?n.selector:[n.selector]).find(o=>o.type===e)}),this.underlying=t,this.opts=r}isEqual(t){return(t==null?void 0:t.type)!=="Annotation"?!1:this.underlying===t.underlying?!0:!this.underlying.id||!t.underlying.id?!1:wg(this.underlying,t.underlying)}get readOnly(){var t;return(t=this.opts)==null?void 0:t.readOnly}get id(){return this.underlying.id}get context(){return this.underlying["@context"]}get type(){return this.underlying.type}get motivation(){return this.underlying.motivation}get body(){return this.underlying.body}get target(){return this.underlying.target}get bodies(){return Array.isArray(this.underlying.body)?this.underlying.body:[this.underlying.body]}set bodies(t){this.underlying.body=t}get targets(){return Array.isArray(this.underlying.target)?this.underlying.target:[this.underlying.target]}get quote(){var t;return(t=this.selector("TextQuoteSelector"))==null?void 0:t.exact}get start(){var t;return(t=this.selector("TextPositionSelector"))==null?void 0:t.start}get end(){var t;return(t=this.selector("TextPositionSelector"))==null?void 0:t.end}};let Hi=cu;i(Hi,"create",t=>{const r={"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:`#${yg()}`,body:[]};return new cu({...r,...t})});class go{constructor(r,e){i(this,"clone",n=>{const o=new go;return o.underlying=JSON.parse(JSON.stringify(this.underlying)),n&&(o.underlying={...o.underlying,...n}),o}),i(this,"selector",n=>{const{target:o}=this.underlying;if(o.selector)return(Array.isArray(o.selector)?o.selector:[o.selector]).find(l=>l.type===n)}),i(this,"toAnnotation",()=>{const n=Object.assign({},this.underlying,{type:"Annotation",id:`#${yg()}`});return new Hi(n)}),this.underlying={"@context":"http://www.w3.org/ns/anno.jsonld",type:"Selection",body:e||[],target:r}}get context(){return this.underlying["@context"]}get type(){return this.underlying.type}get body(){return this.underlying.body}get target(){return this.underlying.target}get targets(){return Array.isArray(this.underlying.target)?this.underlying.target:[this.underlying.target]}isEqual(r){return r?wg(this.underlying,r.underlying):!1}get bodies(){return Array.isArray(this.underlying.body)?this.underlying.body:[this.underlying.body]}get quote(){var r;return(r=this.selector("TextQuoteSelector"))==null?void 0:r.exact}get isSelection(){return!0}}let hu=0;var CP=()=>({setServerTime:t=>{const r=Date.now();hu=t-r},getCurrentTimeAdjusted:()=>new Date(Date.now()+hu).toISOString(),toClientTime:t=>Date.parse(t)-hu});const PP=(t,r)=>{if(t){const e=t==="auto"?window.navigator.userLanguage||window.navigator.language:t,n=e.split("-")[0].toLowerCase(),o=[e,n].find(l=>LS.includes(l));o||console.warn(`Unsupported locale '${e}'. Falling back to default en.`),bn.init(o,r)}else bn.init(null,r)};var Eg={exports:{}};(function(t){//! openseadragon 3.0.0
//! Built on 2021-12-15
//! Git commit: v3.0.0-0-3eded36
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function r(e){return new r.Viewer(e)}(function(e){e.version={versionStr:"3.0.0",major:parseInt("3",10),minor:parseInt("0",10),revision:parseInt("0",10)};var n={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},o=Object.prototype.toString,l=Object.prototype.hasOwnProperty;e.isFunction=function(h){return e.type(h)==="function"},e.isArray=Array.isArray||function(h){return e.type(h)==="array"},e.isWindow=function(h){return h&&typeof h=="object"&&"setInterval"in h},e.type=function(h){return h==null?String(h):n[o.call(h)]||"object"},e.isPlainObject=function(h){if(!h||r.type(h)!=="object"||h.nodeType||e.isWindow(h)||h.constructor&&!l.call(h,"constructor")&&!l.call(h.constructor.prototype,"isPrototypeOf"))return!1;var f;for(var g in h)f=g;return f===void 0||l.call(h,f)},e.isEmptyObject=function(h){for(var f in h)return!1;return!0},e.freezeObject=function(h){return Object.freeze?e.freezeObject=Object.freeze:e.freezeObject=function(f){return f},e.freezeObject(h)},e.supportsCanvas=function(){var h=document.createElement("canvas");return!!(e.isFunction(h.getContext)&&h.getContext("2d"))}(),e.isCanvasTainted=function(h){var f=!1;try{h.getContext("2d").getImageData(0,0,1,1)}catch{f=!0}return f},e.supportsAddEventListener=function(){return!!(document.documentElement.addEventListener&&document.addEventListener)}(),e.supportsRemoveEventListener=function(){return!!(document.documentElement.removeEventListener&&document.removeEventListener)}(),e.supportsEventListenerOptions=function(){var h=0;if(e.supportsAddEventListener)try{var f={get capture(){return h++,!1},get once(){return h++,!1},get passive(){return h++,!1}};window.addEventListener("test",null,f),window.removeEventListener("test",null,f)}catch{h=0}return h>=3}(),e.getCurrentPixelDensityRatio=function(){if(e.supportsCanvas){var h=document.createElement("canvas").getContext("2d"),f=window.devicePixelRatio||1,g=h.webkitBackingStorePixelRatio||h.mozBackingStorePixelRatio||h.msBackingStorePixelRatio||h.oBackingStorePixelRatio||h.backingStorePixelRatio||1;return Math.max(f,1)/g}else return 1},e.pixelDensityRatio=e.getCurrentPixelDensityRatio()})(r),function(e){e.extend=function(){var g,v,E,_,C,k,I=arguments[0]||{},X=arguments.length,U=!1,$=1;for(typeof I=="boolean"&&(U=I,I=arguments[1]||{},$=2),typeof I!="object"&&!r.isFunction(I)&&(I={}),X===$&&(I=this,--$);$<X;$++)if(g=arguments[$],g!==null||g!==void 0)for(v in g)E=I[v],_=g[v],I!==_&&(U&&_&&(r.isPlainObject(_)||(C=r.isArray(_)))?(C?(C=!1,k=E&&r.isArray(E)?E:[]):k=E&&r.isPlainObject(E)?E:{},I[v]=r.extend(U,k,_)):_!==void 0&&(I[v]=_));return I};var n=function(){if(typeof navigator!="object")return!1;var g=navigator.userAgent;return typeof g!="string"?!1:g.indexOf("iPhone")!==-1||g.indexOf("iPad")!==-1||g.indexOf("iPod")!==-1};e.extend(e,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{dragToPan:!0,scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:n(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"]},SIGNAL:"----seadragon----",delegate:function(g,v){return function(){var E=arguments;return E===void 0&&(E=[]),v.apply(g,E)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6,CHROMEEDGE:7},_viewers:new Map,getViewer:function(g){return e._viewers.get(this.getElement(g))},getElement:function(g){return typeof g=="string"&&(g=document.getElementById(g)),g},getElementPosition:function(g){var v=new e.Point,E,_;for(g=e.getElement(g),E=e.getElementStyle(g).position==="fixed",_=f(g,E);_;)v.x+=g.offsetLeft,v.y+=g.offsetTop,E&&(v=v.plus(e.getPageScroll())),g=_,E=e.getElementStyle(g).position==="fixed",_=f(g,E);return v},getElementOffset:function(g){g=e.getElement(g);var v=g&&g.ownerDocument,E,_,C={top:0,left:0};return v?(E=v.documentElement,typeof g.getBoundingClientRect<"u"&&(C=g.getBoundingClientRect()),_=v===v.window?v:v.nodeType===9?v.defaultView||v.parentWindow:!1,new e.Point(C.left+(_.pageXOffset||E.scrollLeft)-(E.clientLeft||0),C.top+(_.pageYOffset||E.scrollTop)-(E.clientTop||0))):new e.Point},getElementSize:function(g){return g=e.getElement(g),new e.Point(g.clientWidth,g.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(g){return g=e.getElement(g),g.currentStyle}:function(g){return g=e.getElement(g),window.getComputedStyle(g,"")},getCssPropertyWithVendorPrefix:function(g){var v={};return e.getCssPropertyWithVendorPrefix=function(E){if(v[E]!==void 0)return v[E];var _=document.createElement("div").style,C=null;if(_[E]!==void 0)C=E;else for(var k=["Webkit","Moz","MS","O","webkit","moz","ms","o"],I=e.capitalizeFirstLetter(E),X=0;X<k.length;X++){var U=k[X]+I;if(_[U]!==void 0){C=U;break}}return v[E]=C,C},e.getCssPropertyWithVendorPrefix(g)},capitalizeFirstLetter:function(g){return g.charAt(0).toUpperCase()+g.slice(1)},positiveModulo:function(g,v){var E=g%v;return E<0&&(E+=v),E},pointInElement:function(g,v){g=e.getElement(g);var E=e.getElementOffset(g),_=e.getElementSize(g);return v.x>=E.x&&v.x<E.x+_.x&&v.y<E.y+_.y&&v.y>=E.y},getMousePosition:function(g){if(typeof g.pageX=="number")e.getMousePosition=function(v){var E=new e.Point;return E.x=v.pageX,E.y=v.pageY,E};else if(typeof g.clientX=="number")e.getMousePosition=function(v){var E=new e.Point;return E.x=v.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,E.y=v.clientY+document.body.scrollTop+document.documentElement.scrollTop,E};else throw new Error("Unknown event mouse position, no known technique.");return e.getMousePosition(g)},getPageScroll:function(){var g=document.documentElement||{},v=document.body||{};if(typeof window.pageXOffset=="number")e.getPageScroll=function(){return new e.Point(window.pageXOffset,window.pageYOffset)};else if(v.scrollLeft||v.scrollTop)e.getPageScroll=function(){return new e.Point(document.body.scrollLeft,document.body.scrollTop)};else if(g.scrollLeft||g.scrollTop)e.getPageScroll=function(){return new e.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)};else return new e.Point(0,0);return e.getPageScroll()},setPageScroll:function(g){if(typeof window.scrollTo<"u")e.setPageScroll=function(_){window.scrollTo(_.x,_.y)};else{var v=e.getPageScroll();if(v.x===g.x&&v.y===g.y)return;document.body.scrollLeft=g.x,document.body.scrollTop=g.y;var E=e.getPageScroll();if(E.x!==v.x&&E.y!==v.y){e.setPageScroll=function(_){document.body.scrollLeft=_.x,document.body.scrollTop=_.y};return}if(document.documentElement.scrollLeft=g.x,document.documentElement.scrollTop=g.y,E=e.getPageScroll(),E.x!==v.x&&E.y!==v.y){e.setPageScroll=function(_){document.documentElement.scrollLeft=_.x,document.documentElement.scrollTop=_.y};return}e.setPageScroll=function(_){}}e.setPageScroll(g)},getWindowSize:function(){var g=document.documentElement||{},v=document.body||{};if(typeof window.innerWidth=="number")e.getWindowSize=function(){return new e.Point(window.innerWidth,window.innerHeight)};else if(g.clientWidth||g.clientHeight)e.getWindowSize=function(){return new e.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else if(v.clientWidth||v.clientHeight)e.getWindowSize=function(){return new e.Point(document.body.clientWidth,document.body.clientHeight)};else throw new Error("Unknown window size, no known technique.");return e.getWindowSize()},makeCenteredNode:function(g){g=e.getElement(g);var v=[e.makeNeutralElement("div"),e.makeNeutralElement("div"),e.makeNeutralElement("div")];return e.extend(v[0].style,{display:"table",height:"100%",width:"100%"}),e.extend(v[1].style,{display:"table-row"}),e.extend(v[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),v[0].appendChild(v[1]),v[1].appendChild(v[2]),v[2].appendChild(g),v[0]},makeNeutralElement:function(g){var v=document.createElement(g),E=v.style;return E.background="transparent none",E.border="none",E.margin="0px",E.padding="0px",E.position="static",v},now:function(){return Date.now?e.now=Date.now:e.now=function(){return new Date().getTime()},e.now()},makeTransparentImage:function(g){var v=e.makeNeutralElement("img");return v.src=g,v},setElementOpacity:function(g,v,E){var _,C;g=e.getElement(g),E&&!e.Browser.alpha&&(v=Math.round(v)),e.Browser.opacity?g.style.opacity=v<1?v:"":v<1?(_=Math.round(100*v),C="alpha(opacity="+_+")",g.style.filter=C):g.style.filter=""},setElementTouchActionNone:function(g){g=e.getElement(g),typeof g.style.touchAction<"u"?g.style.touchAction="none":typeof g.style.msTouchAction<"u"&&(g.style.msTouchAction="none")},setElementPointerEvents:function(g,v){g=e.getElement(g),typeof g.style.pointerEvents<"u"&&(g.style.pointerEvents=v)},setElementPointerEventsNone:function(g){e.setElementPointerEvents(g,"none")},addClass:function(g,v){g=e.getElement(g),g.className?(" "+g.className+" ").indexOf(" "+v+" ")===-1&&(g.className+=" "+v):g.className=v},indexOf:function(g,v,E){return Array.prototype.indexOf?this.indexOf=function(_,C,k){return _.indexOf(C,k)}:this.indexOf=function(_,C,k){var I,X=k||0,U;if(!_)throw new TypeError;if(U=_.length,U===0||X>=U)return-1;for(X<0&&(X=U-Math.abs(X)),I=X;I<U;I++)if(_[I]===C)return I;return-1},this.indexOf(g,v,E)},removeClass:function(g,v){var E,_=[],C;for(g=e.getElement(g),E=g.className.split(/\s+/),C=0;C<E.length;C++)E[C]&&E[C]!==v&&_.push(E[C]);g.className=_.join(" ")},normalizeEventListenerOptions:function(g){var v;return typeof g<"u"?typeof g=="boolean"?v=e.supportsEventListenerOptions?{capture:g}:g:v=e.supportsEventListenerOptions?g:typeof g.capture<"u"?g.capture:!1:v=e.supportsEventListenerOptions?{capture:!1}:!1,v},addEvent:function(){if(e.supportsAddEventListener)return function(g,v,E,_){_=e.normalizeEventListenerOptions(_),g=e.getElement(g),g.addEventListener(v,E,_)};if(document.documentElement.attachEvent&&document.attachEvent)return function(g,v,E){g=e.getElement(g),g.attachEvent("on"+v,E)};throw new Error("No known event model.")}(),removeEvent:function(){if(e.supportsRemoveEventListener)return function(g,v,E,_){_=e.normalizeEventListenerOptions(_),g=e.getElement(g),g.removeEventListener(v,E,_)};if(document.documentElement.detachEvent&&document.detachEvent)return function(g,v,E){g=e.getElement(g),g.detachEvent("on"+v,E)};throw new Error("No known event model.")}(),cancelEvent:function(g){g.preventDefault()},eventIsCanceled:function(g){return g.defaultPrevented},stopEvent:function(g){g.stopPropagation()},createCallback:function(g,v){var E=[],_;for(_=2;_<arguments.length;_++)E.push(arguments[_]);return function(){var C=E.concat([]),k;for(k=0;k<arguments.length;k++)C.push(arguments[k]);return v.apply(g,C)}},getUrlParameter:function(g){var v=h[g];return v||null},getUrlProtocol:function(g){var v=g.match(/^([a-z]+:)\/\//i);return v===null?window.location.protocol:v[1].toLowerCase()},createAjaxRequest:function(g){var v;try{v=!!new ActiveXObject("Microsoft.XMLHTTP")}catch{v=!1}if(v)window.XMLHttpRequest?e.createAjaxRequest=function(E){return E?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:e.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else if(window.XMLHttpRequest)e.createAjaxRequest=function(){return new XMLHttpRequest};else throw new Error("Browser doesn't support XMLHttpRequest.");return e.createAjaxRequest(g)},makeAjaxRequest:function(g,v,E){var _,C,k;e.isPlainObject(g)&&(v=g.success,E=g.error,_=g.withCredentials,C=g.headers,k=g.responseType||null,g=g.url);var I=e.getUrlProtocol(g),X=e.createAjaxRequest(I==="file:");if(!e.isFunction(v))throw new Error("makeAjaxRequest requires a success callback");X.onreadystatechange=function(){X.readyState===4&&(X.onreadystatechange=function(){},X.status>=200&&X.status<300||X.status===0&&I!=="http:"&&I!=="https:"?v(X):(e.console.log("AJAX request returned %d: %s",X.status,g),e.isFunction(E)&&E(X)))};try{if(X.open("GET",g,!0),k&&(X.responseType=k),C)for(var U in C)Object.prototype.hasOwnProperty.call(C,U)&&C[U]&&X.setRequestHeader(U,C[U]);_&&(X.withCredentials=!0),X.send(null)}catch($){e.console.log("%s while making AJAX request: %s",$.name,$.message),X.onreadystatechange=function(){},e.isFunction(E)&&E(X,$)}return X},jsonp:function(g){var v,E=g.url,_=document.head||document.getElementsByTagName("head")[0]||document.documentElement,C=g.callbackName||"openseadragon"+e.now(),k=window[C],I="$1"+C+"$2",X=g.param||"callback",U=g.callback;E=E.replace(/(=)\?(&|$)|\?\?/i,I),E+=(/\?/.test(E)?"&":"?")+X+"="+C,window[C]=function($){if(k)window[C]=k;else try{delete window[C]}catch{}U&&e.isFunction(U)&&U($)},v=document.createElement("script"),(g.async!==void 0||g.async!==!1)&&(v.async="async"),g.scriptCharset&&(v.charset=g.scriptCharset),v.src=E,v.onload=v.onreadystatechange=function($,P){(P||!v.readyState||/loaded|complete/.test(v.readyState))&&(v.onload=v.onreadystatechange=null,_&&v.parentNode&&_.removeChild(v),v=void 0)},_.insertBefore(v,_.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(g){if(window.DOMParser)e.parseXml=function(v){var E=null,_;return _=new DOMParser,E=_.parseFromString(v,"text/xml"),E};else if(window.ActiveXObject)e.parseXml=function(v){var E=null;return E=new ActiveXObject("Microsoft.XMLDOM"),E.async=!1,E.loadXML(v),E};else throw new Error("Browser doesn't support XML DOM.");return e.parseXml(g)},parseJSON:function(g){return e.parseJSON=window.JSON.parse,e.parseJSON(g)},imageFormatSupported:function(g){return g=g||"",!!l[g.toLowerCase()]},setImageFormatsSupported:function(g){e.extend(l,g)}});var o=function(g){};e.console=window.console||{log:o,debug:o,info:o,warn:o,error:o,assert:o},e.Browser={vendor:e.BROWSERS.UNKNOWN,version:0,alpha:!0};var l={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},h={};(function(){var g=navigator.appVersion,v=navigator.userAgent,E;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&(e.Browser.vendor=e.BROWSERS.IE,e.Browser.version=parseFloat(v.substring(v.indexOf("MSIE")+5,v.indexOf(";",v.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(v.indexOf("Edge")>=0?(e.Browser.vendor=e.BROWSERS.EDGE,e.Browser.version=parseFloat(v.substring(v.indexOf("Edge")+5))):v.indexOf("Edg")>=0?(e.Browser.vendor=e.BROWSERS.CHROMEEDGE,e.Browser.version=parseFloat(v.substring(v.indexOf("Edg")+4))):v.indexOf("Firefox")>=0?(e.Browser.vendor=e.BROWSERS.FIREFOX,e.Browser.version=parseFloat(v.substring(v.indexOf("Firefox")+8))):v.indexOf("Safari")>=0?(e.Browser.vendor=v.indexOf("Chrome")>=0?e.BROWSERS.CHROME:e.BROWSERS.SAFARI,e.Browser.version=parseFloat(v.substring(v.substring(0,v.indexOf("Safari")).lastIndexOf("/")+1,v.indexOf("Safari")))):(E=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),E.exec(v)!==null&&(e.Browser.vendor=e.BROWSERS.IE,e.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":e.Browser.vendor=e.BROWSERS.OPERA,e.Browser.version=parseFloat(g);break}var _=window.location.search.substring(1),C=_.split("&"),k,I,X;for(X=0;X<C.length;X++)if(k=C[X],I=k.indexOf("="),I>0){var U=k.substring(0,I),$=k.substring(I+1);try{h[U]=decodeURIComponent($)}catch{e.console.error("Ignoring malformed URL parameter: %s=%s",U,$)}}e.Browser.alpha=!(e.Browser.vendor===e.BROWSERS.CHROME&&e.Browser.version<2),e.Browser.opacity=!0,e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<11&&e.console.error("Internet Explorer versions < 11 are not supported by OpenSeadragon")})(),function(g){var v=g.requestAnimationFrame||g.mozRequestAnimationFrame||g.webkitRequestAnimationFrame||g.msRequestAnimationFrame,E=g.cancelAnimationFrame||g.mozCancelAnimationFrame||g.webkitCancelAnimationFrame||g.msCancelAnimationFrame;if(v&&E)e.requestAnimationFrame=function(){return v.apply(g,arguments)},e.cancelAnimationFrame=function(){return E.apply(g,arguments)};else{var _=[],C=[],k=0,I;e.requestAnimationFrame=function(X){return _.push([++k,X]),I||(I=setInterval(function(){if(_.length){var U=e.now(),$=C;for(C=_,_=$;C.length;)C.shift()[1](U)}else clearInterval(I),I=void 0},1e3/50)),k},e.cancelAnimationFrame=function(X){var U,$;for(U=0,$=_.length;U<$;U+=1)if(_[U][0]===X){_.splice(U,1);return}for(U=0,$=C.length;U<$;U+=1)if(C[U][0]===X){C.splice(U,1);return}}}}(window);function f(g,v){return v&&g!==document.body?document.body:g.offsetParent}}(r),function(e,n){t.exports?t.exports=n():e.OpenSeadragon=n()}(Qn,function(){return r}),function(e){var n={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.fullscreenElement},n.requestFullScreen=function(o){return o.requestFullscreen()},n.exitFullScreen=function(){document.exitFullscreen()},n.fullScreenEventName="fullscreenchange",n.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.msFullscreenElement},n.requestFullScreen=function(o){return o.msRequestFullscreen()},n.exitFullScreen=function(){document.msExitFullscreen()},n.fullScreenEventName="MSFullscreenChange",n.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.webkitFullscreenElement},n.requestFullScreen=function(o){return o.webkitRequestFullscreen()},n.exitFullScreen=function(){document.webkitExitFullscreen()},n.fullScreenEventName="webkitfullscreenchange",n.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},n.requestFullScreen=function(o){return o.webkitRequestFullScreen()},n.exitFullScreen=function(){document.webkitCancelFullScreen()},n.fullScreenEventName="webkitfullscreenchange",n.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.mozFullScreenElement},n.requestFullScreen=function(o){return o.mozRequestFullScreen()},n.exitFullScreen=function(){document.mozCancelFullScreen()},n.fullScreenEventName="mozfullscreenchange",n.fullScreenErrorEventName="mozfullscreenerror"),n.isFullScreen=function(){return n.getFullScreenElement()!==null},n.cancelFullScreen=function(){e.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),n.exitFullScreen()},e.extend(e,n)}(r),function(e){e.EventSource=function(){this.events={}},e.EventSource.prototype={addOnceHandler:function(n,o,l,h){var f=this;h=h||1;var g=0,v=function(E){g++,g===h&&f.removeHandler(n,v),o(E)};this.addHandler(n,v,l)},addHandler:function(n,o,l){var h=this.events[n];h||(this.events[n]=h=[]),o&&e.isFunction(o)&&(h[h.length]={handler:o,userData:l||null})},removeHandler:function(n,o){var l=this.events[n],h=[],f;if(l&&e.isArray(l)){for(f=0;f<l.length;f++)l[f].handler!==o&&h.push(l[f]);this.events[n]=h}},removeAllHandlers:function(n){if(n)this.events[n]=[];else for(var o in this.events)this.events[o]=[]},getHandler:function(n){var o=this.events[n];return!o||!o.length?null:(o=o.length===1?[o[0]]:Array.apply(null,o),function(l,h){var f,g=o.length;for(f=0;f<g;f++)o[f]&&(h.eventSource=l,h.userData=o[f].userData,o[f].handler(h))})},raiseEvent:function(n,o){var l=this.getHandler(n);l&&(o||(o={}),l(this,o))}}}(r),function(e){var n={};e.MouseTracker=function(M){var O=arguments;e.isPlainObject(M)||(M={element:O[0],clickTimeThreshold:O[1],clickDistThreshold:O[2]}),this.hash=Math.random(),this.element=e.getElement(M.element),this.clickTimeThreshold=M.clickTimeThreshold||e.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=M.clickDistThreshold||e.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=M.dblClickTimeThreshold||e.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=M.dblClickDistThreshold||e.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=M.userData||null,this.stopDelay=M.stopDelay||50,this.preProcessEventHandler=M.preProcessEventHandler||null,this.contextMenuHandler=M.contextMenuHandler||null,this.enterHandler=M.enterHandler||null,this.leaveHandler=M.leaveHandler||null,this.exitHandler=M.exitHandler||null,this.overHandler=M.overHandler||null,this.outHandler=M.outHandler||null,this.pressHandler=M.pressHandler||null,this.nonPrimaryPressHandler=M.nonPrimaryPressHandler||null,this.releaseHandler=M.releaseHandler||null,this.nonPrimaryReleaseHandler=M.nonPrimaryReleaseHandler||null,this.moveHandler=M.moveHandler||null,this.scrollHandler=M.scrollHandler||null,this.clickHandler=M.clickHandler||null,this.dblClickHandler=M.dblClickHandler||null,this.dragHandler=M.dragHandler||null,this.dragEndHandler=M.dragEndHandler||null,this.pinchHandler=M.pinchHandler||null,this.stopHandler=M.stopHandler||null,this.keyDownHandler=M.keyDownHandler||null,this.keyUpHandler=M.keyUpHandler||null,this.keyHandler=M.keyHandler||null,this.focusHandler=M.focusHandler||null,this.blurHandler=M.blurHandler||null;var z=this;n[this.hash]={click:function(W){N(z,W)},dblclick:function(W){J(z,W)},keydown:function(W){K(z,W)},keyup:function(W){oe(z,W)},keypress:function(W){ie(z,W)},focus:function(W){me(z,W)},blur:function(W){we(z,W)},contextmenu:function(W){De(z,W)},wheel:function(W){Be(z,W)},mousewheel:function(W){Oe(z,W)},DOMMouseScroll:function(W){Oe(z,W)},MozMousePixelScroll:function(W){Oe(z,W)},losecapture:function(W){Ve(z,W)},mouseenter:function(W){kn(z,W)},mouseleave:function(W){on(z,W)},mouseover:function(W){Tn(z,W)},mouseout:function(W){qn(z,W)},mousedown:function(W){Rn(z,W)},mouseup:function(W){xr(z,W)},mousemove:function(W){Sr(z,W)},touchstart:function(W){et(z,W)},touchend:function(W){$e(z,W)},touchmove:function(W){lt(z,W)},touchcancel:function(W){dt(z,W)},gesturestart:function(W){At(z,W)},gesturechange:function(W){Le(z,W)},gotpointercapture:function(W){gt(z,W)},lostpointercapture:function(W){oi(z,W)},pointerenter:function(W){kn(z,W)},pointerleave:function(W){on(z,W)},pointerover:function(W){Tn(z,W)},pointerout:function(W){qn(z,W)},pointerdown:function(W){Rn(z,W)},pointerup:function(W){xr(z,W)},pointermove:function(W){Sr(z,W)},pointercancel:function(W){R(z,W)},pointerupcaptured:function(W){br(z,W)},pointermovecaptured:function(W){_r(z,W)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null,sentDragEvent:!1},this.hasGestureHandlers=!!(this.pressHandler||this.nonPrimaryPressHandler||this.releaseHandler||this.nonPrimaryReleaseHandler||this.clickHandler||this.dblClickHandler||this.dragHandler||this.dragEndHandler||this.pinchHandler),this.hasScrollHandler=!!this.scrollHandler,e.MouseTracker.havePointerEvents&&e.setElementPointerEvents(this.element,"auto"),this.exitHandler&&e.console.error("MouseTracker.exitHandler is deprecated. Use MouseTracker.leaveHandler instead."),M.startDisabled||this.setTracking(!0)},e.MouseTracker.prototype={destroy:function(){g(this),this.element=null,n[this.hash]=null,delete n[this.hash]},isTracking:function(){return n[this.hash].tracking},setTracking:function(M){return M?f(this):g(this),this},getActivePointersListByType:function(M){var O=n[this.hash],z,W=O.activePointersLists.length,de;for(z=0;z<W;z++)if(O.activePointersLists[z].type===M)return O.activePointersLists[z];return de=new e.MouseTracker.GesturePointList(M),O.activePointersLists.push(de),de},getActivePointerCount:function(){var M=n[this.hash],O,z=M.activePointersLists.length,W=0;for(O=0;O<z;O++)W+=M.activePointersLists[O].getLength();return W},preProcessEventHandler:function(){},contextMenuHandler:function(){},enterHandler:function(){},leaveHandler:function(){},exitHandler:function(){},overHandler:function(){},outHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}};var o=function(){try{return window.self!==window.top}catch{return!0}}();function l(M){try{return M.addEventListener&&M.removeEventListener}catch{return!1}}e.MouseTracker.gesturePointVelocityTracker=function(){var M=[],O=0,z=0,W=function(_t,Ze){return _t.hash.toString()+Ze.type+Ze.id.toString()},de=function(){var _t,Ze=M.length,Cn,Xt,Cr=e.now(),Vg,Wg,Gg;for(Vg=Cr-z,z=Cr,_t=0;_t<Ze;_t++)Cn=M[_t],Xt=Cn.gPoint,Xt.direction=Math.atan2(Xt.currentPos.y-Cn.lastPos.y,Xt.currentPos.x-Cn.lastPos.x),Wg=Cn.lastPos.distanceTo(Xt.currentPos),Cn.lastPos=Xt.currentPos,Gg=1e3*Wg/(Vg+1),Xt.speed=.75*Gg+.25*Xt.speed},Se=function(_t,Ze){var Cn=W(_t,Ze);M.push({guid:Cn,gPoint:Ze,lastPos:Ze.currentPos}),M.length===1&&(z=e.now(),O=window.setInterval(de,50))},qe=function(_t,Ze){var Cn=W(_t,Ze),Xt,Cr=M.length;for(Xt=0;Xt<Cr;Xt++)if(M[Xt].guid===Cn){M.splice(Xt,1),Cr--,Cr===0&&window.clearInterval(O);break}};return{addPoint:Se,removePoint:qe}}(),e.MouseTracker.captureElement=document,e.MouseTracker.wheelEventName=e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll",e.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur","contextmenu",e.MouseTracker.wheelEventName],e.MouseTracker.wheelEventName==="DOMMouseScroll"&&e.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent?(e.MouseTracker.havePointerEvents=!0,e.MouseTracker.subscribeEvents.push("pointerenter","pointerleave","pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),e.MouseTracker.havePointerCapture=function(){var M=document.createElement("div");return e.isFunction(M.setPointerCapture)&&e.isFunction(M.releasePointerCapture)}(),e.MouseTracker.havePointerCapture&&e.MouseTracker.subscribeEvents.push("gotpointercapture","lostpointercapture")):(e.MouseTracker.havePointerEvents=!1,e.MouseTracker.subscribeEvents.push("mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","mousemove"),e.MouseTracker.mousePointerId="legacy-mouse",e.MouseTracker.havePointerCapture=function(){var M=document.createElement("div");return e.isFunction(M.setCapture)&&e.isFunction(M.releaseCapture)}(),e.MouseTracker.havePointerCapture&&e.MouseTracker.subscribeEvents.push("losecapture"),"ontouchstart"in window&&e.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&e.MouseTracker.subscribeEvents.push("gesturestart","gesturechange")),e.MouseTracker.GesturePointList=function(M){this._gPoints=[],this.type=M,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},e.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(M){return this._gPoints.push(M)},removeById:function(M){var O,z=this._gPoints.length;for(O=0;O<z;O++)if(this._gPoints[O].id===M){this._gPoints.splice(O,1);break}return this._gPoints.length},getByIndex:function(M){return M<this._gPoints.length?this._gPoints[M]:null},getById:function(M){var O,z=this._gPoints.length;for(O=0;O<z;O++)if(this._gPoints[O].id===M)return this._gPoints[O];return null},getPrimary:function(M){var O,z=this._gPoints.length;for(O=0;O<z;O++)if(this._gPoints[O].isPrimary)return this._gPoints[O];return null},addContact:function(){++this.contacts,this.contacts>1&&(this.type==="mouse"||this.type==="pen")&&(e.console.warn("GesturePointList.addContact() Implausible contacts value"),this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(e.console.warn("GesturePointList.removeContact() Implausible contacts value"),this.contacts=0)}};function h(M){var O=n[M.hash],z,W,de,Se,qe,_t=O.activePointersLists.length;for(z=0;z<_t;z++)if(de=O.activePointersLists[z],de.getLength()>0){for(qe=[],Se=de.asArray(),W=0;W<Se.length;W++)qe.push(Se[W]);for(W=0;W<qe.length;W++)he(M,de,qe[W])}for(z=0;z<_t;z++)O.activePointersLists.pop();O.sentDragEvent=!1}function f(M){var O=n[M.hash],z,W;if(!O.tracking){for(W=0;W<e.MouseTracker.subscribeEvents.length;W++)z=e.MouseTracker.subscribeEvents[W],e.addEvent(M.element,z,O[z],z===e.MouseTracker.wheelEventName?{passive:!1,capture:!1}:!1);h(M),O.tracking=!0}}function g(M){var O=n[M.hash],z,W;if(O.tracking){for(W=0;W<e.MouseTracker.subscribeEvents.length;W++)z=e.MouseTracker.subscribeEvents[W],e.removeEvent(M.element,z,O[z],!1);h(M),O.tracking=!1}}function v(M,O){var z=n[M.hash];if(O==="pointerevent")return{upName:"pointerup",upHandler:z.pointerupcaptured,moveName:"pointermove",moveHandler:z.pointermovecaptured};if(O==="mouse")return{upName:"pointerup",upHandler:z.pointerupcaptured,moveName:"pointermove",moveHandler:z.pointermovecaptured};if(O==="touch")return{upName:"touchend",upHandler:z.touchendcaptured,moveName:"touchmove",moveHandler:z.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function E(M,O){var z;if(e.MouseTracker.havePointerCapture)if(e.MouseTracker.havePointerEvents)try{M.element.setPointerCapture(O.id)}catch{e.console.warn("setPointerCapture() called on invalid pointer ID");return}else M.element.setCapture(!0);else z=v(M,e.MouseTracker.havePointerEvents?"pointerevent":O.type),o&&l(window.top)&&e.addEvent(window.top,z.upName,z.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,z.upName,z.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,z.moveName,z.moveHandler,!0);ze(M,O,!0)}function _(M,O){var z,W,de;if(e.MouseTracker.havePointerCapture)if(e.MouseTracker.havePointerEvents){if(W=M.getActivePointersListByType(O.type),de=W.getById(O.id),!de||!de.captured)return;try{M.element.releasePointerCapture(O.id)}catch{}}else M.element.releaseCapture();else z=v(M,e.MouseTracker.havePointerEvents?"pointerevent":O.type),o&&l(window.top)&&e.removeEvent(window.top,z.upName,z.upHandler,!0),e.removeEvent(e.MouseTracker.captureElement,z.moveName,z.moveHandler,!0),e.removeEvent(e.MouseTracker.captureElement,z.upName,z.upHandler,!0);ze(M,O,!1)}function C(M){return e.MouseTracker.havePointerEvents?M.pointerId:e.MouseTracker.mousePointerId}function k(M){return e.MouseTracker.havePointerEvents?M.pointerType||(e.Browser.vendor===e.BROWSERS.IE?"mouse":""):"mouse"}function I(M){return e.MouseTracker.havePointerEvents?M.isPrimary:!0}function X(M){return e.getMousePosition(M)}function U(M,O){return $(X(M),O)}function $(M,O){var z=e.getElementOffset(O);return M.minus(z)}function P(M,O){return new e.Point((M.x+O.x)/2,(M.y+O.y)/2)}function N(M,O){var z={originalEvent:O,eventType:"click",pointerType:"mouse",isEmulated:!1};ve(M,z),z.preventDefault&&!z.defaultPrevented&&e.cancelEvent(O),z.stopPropagation&&e.stopEvent(O)}function J(M,O){var z={originalEvent:O,eventType:"dblclick",pointerType:"mouse",isEmulated:!1};ve(M,z),z.preventDefault&&!z.defaultPrevented&&e.cancelEvent(O),z.stopPropagation&&e.stopEvent(O)}function K(M,O){var z=null,W={originalEvent:O,eventType:"keydown",pointerType:"",isEmulated:!1};ve(M,W),M.keyDownHandler&&!W.preventGesture&&!W.defaultPrevented&&(z={eventSource:M,keyCode:O.keyCode?O.keyCode:O.charCode,ctrl:O.ctrlKey,shift:O.shiftKey,alt:O.altKey,meta:O.metaKey,originalEvent:O,preventDefault:W.preventDefault||W.defaultPrevented,userData:M.userData},M.keyDownHandler(z)),(z&&z.preventDefault||W.preventDefault&&!W.defaultPrevented)&&e.cancelEvent(O),W.stopPropagation&&e.stopEvent(O)}function oe(M,O){var z=null,W={originalEvent:O,eventType:"keyup",pointerType:"",isEmulated:!1};ve(M,W),M.keyUpHandler&&!W.preventGesture&&!W.defaultPrevented&&(z={eventSource:M,keyCode:O.keyCode?O.keyCode:O.charCode,ctrl:O.ctrlKey,shift:O.shiftKey,alt:O.altKey,meta:O.metaKey,originalEvent:O,preventDefault:W.preventDefault||W.defaultPrevented,userData:M.userData},M.keyUpHandler(z)),(z&&z.preventDefault||W.preventDefault&&!W.defaultPrevented)&&e.cancelEvent(O),W.stopPropagation&&e.stopEvent(O)}function ie(M,O){var z=null,W={originalEvent:O,eventType:"keypress",pointerType:"",isEmulated:!1};ve(M,W),M.keyHandler&&!W.preventGesture&&!W.defaultPrevented&&(z={eventSource:M,keyCode:O.keyCode?O.keyCode:O.charCode,ctrl:O.ctrlKey,shift:O.shiftKey,alt:O.altKey,meta:O.metaKey,originalEvent:O,preventDefault:W.preventDefault||W.defaultPrevented,userData:M.userData},M.keyHandler(z)),(z&&z.preventDefault||W.preventDefault&&!W.defaultPrevented)&&e.cancelEvent(O),W.stopPropagation&&e.stopEvent(O)}function me(M,O){var z={originalEvent:O,eventType:"focus",pointerType:"",isEmulated:!1};ve(M,z),M.focusHandler&&!z.preventGesture&&M.focusHandler({eventSource:M,originalEvent:O,userData:M.userData})}function we(M,O){var z={originalEvent:O,eventType:"blur",pointerType:"",isEmulated:!1};ve(M,z),M.blurHandler&&!z.preventGesture&&M.blurHandler({eventSource:M,originalEvent:O,userData:M.userData})}function De(M,O){var z=null,W={originalEvent:O,eventType:"contextmenu",pointerType:"mouse",isEmulated:!1};ve(M,W),M.contextMenuHandler&&!W.preventGesture&&!W.defaultPrevented&&(z={eventSource:M,position:$(X(O),M.element),originalEvent:W.originalEvent,preventDefault:W.preventDefault||W.defaultPrevented,userData:M.userData},M.contextMenuHandler(z)),(z&&z.preventDefault||W.preventDefault&&!W.defaultPrevented)&&e.cancelEvent(O),W.stopPropagation&&e.stopEvent(O)}function Be(M,O){Ue(M,O,O)}function Oe(M,O){var z={target:O.target||O.srcElement,type:"wheel",shiftKey:O.shiftKey||!1,clientX:O.clientX,clientY:O.clientY,pageX:O.pageX?O.pageX:O.clientX,pageY:O.pageY?O.pageY:O.clientY,deltaMode:O.type==="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0};e.MouseTracker.wheelEventName==="mousewheel"?z.deltaY=-O.wheelDelta/e.DEFAULT_SETTINGS.pixelsPerWheelLine:z.deltaY=O.detail,Ue(M,z,O)}function Ue(M,O,z){var W=0,de,Se=null;W=O.deltaY<0?1:-1,de={originalEvent:O,eventType:"wheel",pointerType:"mouse",isEmulated:O!==z},ve(M,de),M.scrollHandler&&!de.preventGesture&&!de.defaultPrevented&&(Se={eventSource:M,pointerType:"mouse",position:U(O,M.element),scroll:W,shift:O.shiftKey,isTouchEvent:!1,originalEvent:z,preventDefault:de.preventDefault||de.defaultPrevented,userData:M.userData},M.scrollHandler(Se)),de.stopPropagation&&e.stopEvent(z),(Se&&Se.preventDefault||de.preventDefault&&!de.defaultPrevented)&&e.cancelEvent(z)}function Ve(M,O){var z={id:e.MouseTracker.mousePointerId,type:"mouse"},W={originalEvent:O,eventType:"lostpointercapture",pointerType:"mouse",isEmulated:!1};ve(M,W),O.target===M.element&&ze(M,z,!1),W.stopPropagation&&e.stopEvent(O)}function et(M,O){var z,W,de=O.changedTouches.length,Se,qe=M.getActivePointersListByType("touch");z=e.now(),qe.getLength()>O.touches.length-de&&e.console.warn("Tracked touch contact count doesn't match event.touches.length");var _t={originalEvent:O,eventType:"pointerdown",pointerType:"touch",isEmulated:!1};for(ve(M,_t),W=0;W<de;W++)Se={id:O.changedTouches[W].identifier,type:"touch",isPrimary:qe.getLength()===0,currentPos:X(O.changedTouches[W]),currentTime:z},Me(M,_t,Se),tt(M,_t,Se,0),ze(M,Se,!0);_t.preventDefault&&!_t.defaultPrevented&&e.cancelEvent(O),_t.stopPropagation&&e.stopEvent(O)}function $e(M,O){var z,W,de=O.changedTouches.length,Se;z=e.now();var qe={originalEvent:O,eventType:"pointerup",pointerType:"touch",isEmulated:!1};for(ve(M,qe),W=0;W<de;W++)Se={id:O.changedTouches[W].identifier,type:"touch",currentPos:X(O.changedTouches[W]),currentTime:z},Ft(M,qe,Se,0),ze(M,Se,!1),bt(M,qe,Se);qe.preventDefault&&!qe.defaultPrevented&&e.cancelEvent(O),qe.stopPropagation&&e.stopEvent(O)}function lt(M,O){var z,W,de=O.changedTouches.length,Se;z=e.now();var qe={originalEvent:O,eventType:"pointermove",pointerType:"touch",isEmulated:!1};for(ve(M,qe),W=0;W<de;W++)Se={id:O.changedTouches[W].identifier,type:"touch",currentPos:X(O.changedTouches[W]),currentTime:z},ht(M,qe,Se);qe.preventDefault&&!qe.defaultPrevented&&e.cancelEvent(O),qe.stopPropagation&&e.stopEvent(O)}function dt(M,O){var z=O.changedTouches.length,W,de,Se={originalEvent:O,eventType:"pointercancel",pointerType:"touch",isEmulated:!1};for(ve(M,Se),W=0;W<z;W++)de={id:O.changedTouches[W].identifier,type:"touch"},$t(M,Se,de);Se.stopPropagation&&e.stopEvent(O)}function At(M,O){return e.eventIsCanceled(O)||O.preventDefault(),!1}function Le(M,O){return e.eventIsCanceled(O)||O.preventDefault(),!1}function gt(M,O){var z={originalEvent:O,eventType:"gotpointercapture",pointerType:k(O),isEmulated:!1};ve(M,z),O.target===M.element&&ze(M,{id:O.pointerId,type:k(O)},!0),z.stopPropagation&&e.stopEvent(O)}function oi(M,O){var z={originalEvent:O,eventType:"lostpointercapture",pointerType:k(O),isEmulated:!1};ve(M,z),O.target===M.element&&ze(M,{id:O.pointerId,type:k(O)},!1),z.stopPropagation&&e.stopEvent(O)}function kn(M,O){var z={id:C(O),type:k(O),isPrimary:I(O),currentPos:X(O),currentTime:e.now()},W={originalEvent:O,eventType:"pointerenter",pointerType:z.type,isEmulated:!1};ve(M,W),Me(M,W,z)}function on(M,O){var z={id:C(O),type:k(O),isPrimary:I(O),currentPos:X(O),currentTime:e.now()},W={originalEvent:O,eventType:"pointerleave",pointerType:z.type,isEmulated:!1};ve(M,W),bt(M,W,z)}function Tn(M,O){var z={id:C(O),type:k(O),isPrimary:I(O),currentPos:X(O),currentTime:e.now()},W={originalEvent:O,eventType:"pointerover",pointerType:z.type,isEmulated:!1};ve(M,W),Dt(M,W,z),W.preventDefault&&!W.defaultPrevented&&e.cancelEvent(O),W.stopPropagation&&e.stopEvent(O)}function qn(M,O){var z={id:C(O),type:k(O),isPrimary:I(O),currentPos:X(O),currentTime:e.now()},W={originalEvent:O,eventType:"pointerout",pointerType:z.type,isEmulated:!1};ve(M,W),mt(M,W,z),W.preventDefault&&!W.defaultPrevented&&e.cancelEvent(O),W.stopPropagation&&e.stopEvent(O)}function Rn(M,O){var z={id:C(O),type:k(O),isPrimary:I(O),currentPos:X(O),currentTime:e.now()},W=e.MouseTracker.havePointerEvents&&z.type==="touch"&&e.Browser.vendor!==e.BROWSERS.IE,de={originalEvent:O,eventType:"pointerdown",pointerType:z.type,isEmulated:!1};ve(M,de),tt(M,de,z,O.button),de.preventDefault&&!de.defaultPrevented&&e.cancelEvent(O),de.stopPropagation&&e.stopEvent(O),de.shouldCapture&&(W?ze(M,z,!0):E(M,z))}function xr(M,O){zi(M,O)}function br(M,O){var z=M.getActivePointersListByType(k(O));z.getById(O.pointerId)&&zi(M,O),e.stopEvent(O)}function zi(M,O){var z;z={id:C(O),type:k(O),isPrimary:I(O),currentPos:X(O),currentTime:e.now()};var W={originalEvent:O,eventType:"pointerup",pointerType:z.type,isEmulated:!1};ve(M,W),Ft(M,W,z,O.button),W.preventDefault&&!W.defaultPrevented&&e.cancelEvent(O),W.stopPropagation&&e.stopEvent(O),W.shouldReleaseCapture&&(O.target===M.element?_(M,z):ze(M,z,!1))}function Sr(M,O){Tr(M,O)}function _r(M,O){var z=M.getActivePointersListByType(k(O));z.getById(O.pointerId)&&Tr(M,O),e.stopEvent(O)}function Tr(M,O){var z={id:C(O),type:k(O),isPrimary:I(O),currentPos:X(O),currentTime:e.now()},W={originalEvent:O,eventType:"pointermove",pointerType:z.type,isEmulated:!1};ve(M,W),ht(M,W,z),W.preventDefault&&!W.defaultPrevented&&e.cancelEvent(O),W.stopPropagation&&e.stopEvent(O)}function R(M,O){var z={id:O.pointerId,type:k(O)},W={originalEvent:O,eventType:"pointercancel",pointerType:z.type,isEmulated:!1};ve(M,W),$t(M,W,z),W.stopPropagation&&e.stopEvent(O)}function Y(M,O){return O.speed=0,O.direction=0,O.contactPos=O.currentPos,O.contactTime=O.currentTime,O.lastPos=O.currentPos,O.lastTime=O.currentTime,M.add(O)}function he(M,O,z){var W,de=O.getById(z.id);return de?(de.captured&&(e.console.warn("stopTrackingPointer() called on captured pointer"),_(M,de)),(O.type==="mouse"||O.type==="pen")&&O.contacts>0&&O.removeContact(),W=O.removeById(z.id)):W=O.getLength(),W}function be(M,O){switch(O.eventType){case"pointermove":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!1,O.preventGesture=!M.hasGestureHandlers,O.stopPropagation=!1;break;case"pointerover":case"pointerout":case"contextmenu":case"keydown":case"keyup":case"keypress":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!1,O.preventGesture=!1,O.stopPropagation=!1;break;case"pointerdown":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!1,O.preventGesture=!M.hasGestureHandlers,O.stopPropagation=!1;break;case"pointerup":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!1,O.preventGesture=!M.hasGestureHandlers,O.stopPropagation=!1;break;case"wheel":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!1,O.preventGesture=!M.hasScrollHandler,O.stopPropagation=!1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":O.isStoppable=!0,O.isCancelable=!1,O.preventDefault=!1,O.preventGesture=!1,O.stopPropagation=!1;break;case"click":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!!M.clickHandler,O.preventGesture=!1,O.stopPropagation=!1;break;case"dblclick":O.isStoppable=!0,O.isCancelable=!0,O.preventDefault=!!M.dblClickHandler,O.preventGesture=!1,O.stopPropagation=!1;break;case"focus":case"blur":case"pointerenter":case"pointerleave":default:O.isStoppable=!1,O.isCancelable=!1,O.preventDefault=!1,O.preventGesture=!1,O.stopPropagation=!1;break}}function ve(M,O){O.eventSource=M,O.eventPhase=O.originalEvent&&typeof O.originalEvent.eventPhase<"u"?O.originalEvent.eventPhase:0,O.defaultPrevented=e.eventIsCanceled(O.originalEvent),O.shouldCapture=!1,O.shouldReleaseCapture=!1,O.userData=M.userData,be(M,O),M.preProcessEventHandler&&M.preProcessEventHandler(O)}function ze(M,O,z){var W=M.getActivePointersListByType(O.type),de=W.getById(O.id);de?z&&!de.captured?(de.captured=!0,W.captureCount++):!z&&de.captured&&(de.captured=!1,W.captureCount--,W.captureCount<0&&(W.captureCount=0,e.console.warn("updatePointerCaptured() - pointsList.captureCount went negative"))):e.console.warn("updatePointerCaptured() called on untracked pointer")}function Me(M,O,z){var W=M.getActivePointersListByType(z.type),de;de=W.getById(z.id),de?(de.insideElement=!0,de.lastPos=de.currentPos,de.lastTime=de.currentTime,de.currentPos=z.currentPos,de.currentTime=z.currentTime,z=de):(z.captured=!1,z.insideElementPressed=!1,z.insideElement=!0,Y(W,z)),M.enterHandler&&M.enterHandler({eventSource:M,pointerType:z.type,position:$(z.currentPos,M.element),buttons:W.buttons,pointers:M.getActivePointerCount(),insideElementPressed:z.insideElementPressed,buttonDownAny:W.buttons!==0,isTouchEvent:z.type==="touch",originalEvent:O.originalEvent,userData:M.userData})}function bt(M,O,z){var W=M.getActivePointersListByType(z.type),de,Se;de=W.getById(z.id),de?(de.captured?(de.insideElement=!1,de.lastPos=de.currentPos,de.lastTime=de.currentTime,de.currentPos=z.currentPos,de.currentTime=z.currentTime):he(M,W,de),z=de):(z.captured=!1,z.insideElementPressed=!1),(M.leaveHandler||M.exitHandler)&&(Se={eventSource:M,pointerType:z.type,position:z.currentPos&&$(z.currentPos,M.element),buttons:W.buttons,pointers:M.getActivePointerCount(),insideElementPressed:z.insideElementPressed,buttonDownAny:W.buttons!==0,isTouchEvent:z.type==="touch",originalEvent:O.originalEvent,userData:M.userData},M.leaveHandler&&M.leaveHandler(Se),M.exitHandler&&M.exitHandler(Se))}function Dt(M,O,z){var W,de;W=M.getActivePointersListByType(z.type),de=W.getById(z.id),de?z=de:(z.captured=!1,z.insideElementPressed=!1),M.overHandler&&M.overHandler({eventSource:M,pointerType:z.type,position:$(z.currentPos,M.element),buttons:W.buttons,pointers:M.getActivePointerCount(),insideElementPressed:z.insideElementPressed,buttonDownAny:W.buttons!==0,isTouchEvent:z.type==="touch",originalEvent:O.originalEvent,userData:M.userData})}function mt(M,O,z){var W,de;W=M.getActivePointersListByType(z.type),de=W.getById(z.id),de?z=de:(z.captured=!1,z.insideElementPressed=!1),M.outHandler&&M.outHandler({eventSource:M,pointerType:z.type,position:z.currentPos&&$(z.currentPos,M.element),buttons:W.buttons,pointers:M.getActivePointerCount(),insideElementPressed:z.insideElementPressed,buttonDownAny:W.buttons!==0,isTouchEvent:z.type==="touch",originalEvent:O.originalEvent,userData:M.userData})}function tt(M,O,z,W){var de=n[M.hash],Se=M.getActivePointersListByType(z.type),qe;if(typeof O.originalEvent.buttons<"u"?Se.buttons=O.originalEvent.buttons:W===0?Se.buttons|=1:W===1?Se.buttons|=4:W===2?Se.buttons|=2:W===3?Se.buttons|=8:W===4?Se.buttons|=16:W===5&&(Se.buttons|=32),W!==0){O.shouldCapture=!1,O.shouldReleaseCapture=!1,M.nonPrimaryPressHandler&&!O.preventGesture&&!O.defaultPrevented&&(O.preventDefault=!0,M.nonPrimaryPressHandler({eventSource:M,pointerType:z.type,position:$(z.currentPos,M.element),button:W,buttons:Se.buttons,isTouchEvent:z.type==="touch",originalEvent:O.originalEvent,userData:M.userData}));return}if(qe=Se.getById(z.id),qe)qe.insideElementPressed=!0,qe.insideElement=!0,qe.originalTarget=O.originalEvent.target,qe.contactPos=z.currentPos,qe.contactTime=z.currentTime,qe.lastPos=qe.currentPos,qe.lastTime=qe.currentTime,qe.currentPos=z.currentPos,qe.currentTime=z.currentTime,z=qe;else{e.console.warn("pointerdown event on untracked pointer"),z.captured=!1,z.insideElementPressed=!0,z.insideElement=!0,z.originalTarget=O.originalEvent.target,Y(Se,z);return}Se.addContact(),!O.preventGesture&&!O.defaultPrevented?(O.shouldCapture=!0,O.shouldReleaseCapture=!1,O.preventDefault=!0,(M.dragHandler||M.dragEndHandler||M.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.addPoint(M,z),Se.contacts===1?M.pressHandler&&!O.preventGesture&&M.pressHandler({eventSource:M,pointerType:z.type,position:$(z.contactPos,M.element),buttons:Se.buttons,isTouchEvent:z.type==="touch",originalEvent:O.originalEvent,userData:M.userData}):Se.contacts===2&&M.pinchHandler&&z.type==="touch"&&(de.pinchGPoints=Se.asArray(),de.lastPinchDist=de.currentPinchDist=de.pinchGPoints[0].currentPos.distanceTo(de.pinchGPoints[1].currentPos),de.lastPinchCenter=de.currentPinchCenter=P(de.pinchGPoints[0].currentPos,de.pinchGPoints[1].currentPos))):(O.shouldCapture=!1,O.shouldReleaseCapture=!1)}function Ft(M,O,z,W){var de=n[M.hash],Se=M.getActivePointersListByType(z.type),qe,_t,Ze,Cn=!1,Xt;if(typeof O.originalEvent.buttons<"u"?Se.buttons=O.originalEvent.buttons:W===0?Se.buttons^=-2:W===1?Se.buttons^=-5:W===2?Se.buttons^=-3:W===3?Se.buttons^=-9:W===4?Se.buttons^=-17:W===5&&(Se.buttons^=-33),O.shouldCapture=!1,W!==0){O.shouldReleaseCapture=!1,M.nonPrimaryReleaseHandler&&!O.preventGesture&&!O.defaultPrevented&&(O.preventDefault=!0,M.nonPrimaryReleaseHandler({eventSource:M,pointerType:z.type,position:$(z.currentPos,M.element),button:W,buttons:Se.buttons,isTouchEvent:z.type==="touch",originalEvent:O.originalEvent,userData:M.userData}));return}Ze=Se.getById(z.id),Ze?(Se.removeContact(),Ze.captured&&(Cn=!0),Ze.lastPos=Ze.currentPos,Ze.lastTime=Ze.currentTime,Ze.currentPos=z.currentPos,Ze.currentTime=z.currentTime,Ze.insideElement||he(M,Se,Ze),qe=Ze.currentPos,_t=Ze.currentTime):(e.console.warn("updatePointerUp(): pointerup on untracked gPoint"),z.captured=!1,z.insideElementPressed=!1,z.insideElement=!0,Y(Se,z),Ze=z),!O.preventGesture&&!O.defaultPrevented&&(Cn?(O.shouldReleaseCapture=!0,O.preventDefault=!0,(M.dragHandler||M.dragEndHandler||M.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.removePoint(M,Ze),Se.contacts===0?(M.releaseHandler&&M.releaseHandler({eventSource:M,pointerType:Ze.type,position:$(qe,M.element),buttons:Se.buttons,insideElementPressed:Ze.insideElementPressed,insideElementReleased:Ze.insideElement,isTouchEvent:Ze.type==="touch",originalEvent:O.originalEvent,userData:M.userData}),M.dragEndHandler&&de.sentDragEvent&&M.dragEndHandler({eventSource:M,pointerType:Ze.type,position:$(Ze.currentPos,M.element),speed:Ze.speed,direction:Ze.direction,shift:O.originalEvent.shiftKey,isTouchEvent:Ze.type==="touch",originalEvent:O.originalEvent,userData:M.userData}),de.sentDragEvent=!1,(M.clickHandler||M.dblClickHandler)&&Ze.insideElement&&(Xt=_t-Ze.contactTime<=M.clickTimeThreshold&&Ze.contactPos.distanceTo(qe)<=M.clickDistThreshold,M.clickHandler&&M.clickHandler({eventSource:M,pointerType:Ze.type,position:$(Ze.currentPos,M.element),quick:Xt,shift:O.originalEvent.shiftKey,isTouchEvent:Ze.type==="touch",originalEvent:O.originalEvent,originalTarget:Ze.originalTarget,userData:M.userData}),M.dblClickHandler&&Xt&&(Se.clicks++,Se.clicks===1?(de.lastClickPos=qe,de.dblClickTimeOut=setTimeout(function(){Se.clicks=0},M.dblClickTimeThreshold)):Se.clicks===2&&(clearTimeout(de.dblClickTimeOut),Se.clicks=0,de.lastClickPos.distanceTo(qe)<=M.dblClickDistThreshold&&M.dblClickHandler({eventSource:M,pointerType:Ze.type,position:$(Ze.currentPos,M.element),shift:O.originalEvent.shiftKey,isTouchEvent:Ze.type==="touch",originalEvent:O.originalEvent,userData:M.userData}),de.lastClickPos=null)))):Se.contacts===2&&M.pinchHandler&&Ze.type==="touch"&&(de.pinchGPoints=Se.asArray(),de.lastPinchDist=de.currentPinchDist=de.pinchGPoints[0].currentPos.distanceTo(de.pinchGPoints[1].currentPos),de.lastPinchCenter=de.currentPinchCenter=P(de.pinchGPoints[0].currentPos,de.pinchGPoints[1].currentPos))):(O.shouldReleaseCapture=!1,M.releaseHandler&&(M.releaseHandler({eventSource:M,pointerType:Ze.type,position:$(qe,M.element),buttons:Se.buttons,insideElementPressed:Ze.insideElementPressed,insideElementReleased:Ze.insideElement,isTouchEvent:Ze.type==="touch",originalEvent:O.originalEvent,userData:M.userData}),O.preventDefault=!0)))}function ht(M,O,z){var W=n[M.hash],de=M.getActivePointersListByType(z.type),Se,qe,_t;if(typeof O.originalEvent.buttons<"u"&&(de.buttons=O.originalEvent.buttons),Se=de.getById(z.id),Se)Se.lastPos=Se.currentPos,Se.lastTime=Se.currentTime,Se.currentPos=z.currentPos,Se.currentTime=z.currentTime;else return;O.shouldCapture=!1,O.shouldReleaseCapture=!1,M.stopHandler&&z.type==="mouse"&&(clearTimeout(M.stopTimeOut),M.stopTimeOut=setTimeout(function(){wi(M,O.originalEvent,z.type)},M.stopDelay)),de.contacts===0?M.moveHandler&&M.moveHandler({eventSource:M,pointerType:z.type,position:$(z.currentPos,M.element),buttons:de.buttons,isTouchEvent:z.type==="touch",originalEvent:O.originalEvent,userData:M.userData}):de.contacts===1?(M.moveHandler&&(Se=de.asArray()[0],M.moveHandler({eventSource:M,pointerType:Se.type,position:$(Se.currentPos,M.element),buttons:de.buttons,isTouchEvent:Se.type==="touch",originalEvent:O.originalEvent,userData:M.userData})),M.dragHandler&&!O.preventGesture&&!O.defaultPrevented&&(Se=de.asArray()[0],_t=Se.currentPos.minus(Se.lastPos),M.dragHandler({eventSource:M,pointerType:Se.type,position:$(Se.currentPos,M.element),buttons:de.buttons,delta:_t,speed:Se.speed,direction:Se.direction,shift:O.originalEvent.shiftKey,isTouchEvent:Se.type==="touch",originalEvent:O.originalEvent,userData:M.userData}),O.preventDefault=!0,W.sentDragEvent=!0)):de.contacts===2&&(M.moveHandler&&(qe=de.asArray(),M.moveHandler({eventSource:M,pointerType:qe[0].type,position:$(P(qe[0].currentPos,qe[1].currentPos),M.element),buttons:de.buttons,isTouchEvent:qe[0].type==="touch",originalEvent:O.originalEvent,userData:M.userData})),M.pinchHandler&&z.type==="touch"&&!O.preventGesture&&!O.defaultPrevented&&(_t=W.pinchGPoints[0].currentPos.distanceTo(W.pinchGPoints[1].currentPos),_t!==W.currentPinchDist&&(W.lastPinchDist=W.currentPinchDist,W.currentPinchDist=_t,W.lastPinchCenter=W.currentPinchCenter,W.currentPinchCenter=P(W.pinchGPoints[0].currentPos,W.pinchGPoints[1].currentPos),M.pinchHandler({eventSource:M,pointerType:"touch",gesturePoints:W.pinchGPoints,lastCenter:$(W.lastPinchCenter,M.element),center:$(W.currentPinchCenter,M.element),lastDistance:W.lastPinchDist,distance:W.currentPinchDist,shift:O.originalEvent.shiftKey,originalEvent:O.originalEvent,userData:M.userData}),O.preventDefault=!0)))}function $t(M,O,z){var W=M.getActivePointersListByType(z.type),de;de=W.getById(z.id),de&&he(M,W,de)}function wi(M,O,z){M.stopHandler&&M.stopHandler({eventSource:M,pointerType:z,position:U(O,M.element),buttons:M.getActivePointersListByType(z).buttons,isTouchEvent:z==="touch",originalEvent:O,userData:M.userData})}}(r),function(e){e.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},e.Control=function(n,o,l){var h=n.parentNode;typeof o=="number"&&(e.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),o={anchor:o}),o.attachToViewer=typeof o.attachToViewer>"u"?!0:o.attachToViewer,this.autoFade=typeof o.autoFade>"u"?!0:o.autoFade,this.element=n,this.anchor=o.anchor,this.container=l,this.anchor===e.ControlAnchor.ABSOLUTE?(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top=typeof o.top=="number"?o.top+"px":o.top,this.wrapper.style.left=typeof o.left=="number"?o.left+"px":o.left,this.wrapper.style.height=typeof o.height=="number"?o.height+"px":o.height,this.wrapper.style.width=typeof o.width=="number"?o.width+"px":o.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor===e.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),o.attachToViewer?this.anchor===e.ControlAnchor.TOP_RIGHT||this.anchor===e.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):h.appendChild(this.wrapper)},e.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.anchor!==e.ControlAnchor.NONE&&this.container.removeChild(this.wrapper)},isVisible:function(){return this.wrapper.style.display!=="none"},setVisible:function(n){this.wrapper.style.display=n?this.anchor===e.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(n){this.element[e.SIGNAL]&&e.Browser.vendor===e.BROWSERS.IE?e.setElementOpacity(this.element,n,!0):e.setElementOpacity(this.wrapper,n,!0)}}}(r),function(e){e.ControlDock=function(o){var l=["topleft","topright","bottomright","bottomleft"],h,f;for(e.extend(!0,this,{id:"controldock-"+e.now()+"-"+Math.floor(Math.random()*1e6),container:e.makeNeutralElement("div"),controls:[]},o),this.container.onsubmit=function(){return!1},this.element&&(this.element=e.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),f=0;f<l.length;f++)h=l[f],this.controls[h]=e.makeNeutralElement("div"),this.controls[h].style.position="absolute",h.match("left")&&(this.controls[h].style.left="0px"),h.match("right")&&(this.controls[h].style.right="0px"),h.match("top")&&(this.controls[h].style.top="0px"),h.match("bottom")&&(this.controls[h].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},e.ControlDock.prototype={addControl:function(o,l){o=e.getElement(o);var h=null;if(!(n(this,o)>=0)){switch(l.anchor){case e.ControlAnchor.TOP_RIGHT:h=this.controls.topright,o.style.position="relative",o.style.paddingRight="0px",o.style.paddingTop="0px";break;case e.ControlAnchor.BOTTOM_RIGHT:h=this.controls.bottomright,o.style.position="relative",o.style.paddingRight="0px",o.style.paddingBottom="0px";break;case e.ControlAnchor.BOTTOM_LEFT:h=this.controls.bottomleft,o.style.position="relative",o.style.paddingLeft="0px",o.style.paddingBottom="0px";break;case e.ControlAnchor.TOP_LEFT:h=this.controls.topleft,o.style.position="relative",o.style.paddingLeft="0px",o.style.paddingTop="0px";break;case e.ControlAnchor.ABSOLUTE:h=this.container,o.style.margin="0px",o.style.padding="0px";break;default:case e.ControlAnchor.NONE:h=this.container,o.style.margin="0px",o.style.padding="0px";break}this.controls.push(new e.Control(o,l,h)),o.style.display="inline-block"}},removeControl:function(o){o=e.getElement(o);var l=n(this,o);return l>=0&&(this.controls[l].destroy(),this.controls.splice(l,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var o;for(o=this.controls.length-1;o>=0;o--)if(this.controls[o].isVisible())return!0;return!1},setControlsEnabled:function(o){var l;for(l=this.controls.length-1;l>=0;l--)this.controls[l].setVisible(o);return this}};function n(o,l){var h=o.controls,f;for(f=h.length-1;f>=0;f--)if(h[f].element===l)return f;return-1}}(r),function(e){e.Placement=e.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(r),function(e){var n={},o=1;e.Viewer=function(R){var Y=arguments,he=this,be;if(e.isPlainObject(R)||(R={id:Y[0],xmlPath:Y.length>1?Y[1]:void 0,prefixUrl:Y.length>2?Y[2]:void 0,controls:Y.length>3?Y[3]:void 0,overlays:Y.length>4?Y[4]:void 0}),R.config&&(e.extend(!0,R,R.config),delete R.config),e.extend(!0,this,{id:R.id,hash:R.hash||o++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},e.DEFAULT_SETTINGS,R),typeof this.hash>"u")throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(typeof n[this.hash]<"u"&&e.console.warn("Hash "+this.hash+" has already been used."),n[this.hash]={fsBoundsDelta:new e.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._updatePixelDensityRatioBind=null,this._lastScrollTime=e.now(),e.EventSource.call(this),this.addHandler("open-failed",function(ve){var ze=e.getString("Errors.OpenFailed",ve.eventSource,ve.message);he._showMessage(ze)}),e.ControlDock.call(this,R),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=e.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(ve){ve.width="100%",ve.height="100%",ve.overflow="hidden",ve.position="absolute",ve.top="0px",ve.left="0px"}(this.canvas.style),e.setElementTouchActionNone(this.canvas),R.tabIndex!==""&&(this.canvas.tabIndex=R.tabIndex===void 0?0:R.tabIndex),this.container.className="openseadragon-container",function(ve){ve.width="100%",ve.height="100%",ve.position="relative",ve.overflow="hidden",ve.left="0px",ve.top="0px",ve.textAlign="left"}(this.container.style),e.setElementTouchActionNone(this.container),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new e.MouseTracker({userData:"Viewer.innerTracker",element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,contextMenuHandler:e.delegate(this,U),keyDownHandler:e.delegate(this,$),keyHandler:e.delegate(this,P),clickHandler:e.delegate(this,N),dblClickHandler:e.delegate(this,J),dragHandler:e.delegate(this,K),dragEndHandler:e.delegate(this,oe),enterHandler:e.delegate(this,ie),leaveHandler:e.delegate(this,me),pressHandler:e.delegate(this,we),releaseHandler:e.delegate(this,De),nonPrimaryPressHandler:e.delegate(this,Be),nonPrimaryReleaseHandler:e.delegate(this,Oe),scrollHandler:e.delegate(this,Ve),pinchHandler:e.delegate(this,Ue)}),this.outerTracker=new e.MouseTracker({userData:"Viewer.outerTracker",element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:e.delegate(this,et),leaveHandler:e.delegate(this,$e)}),this.toolbar&&(this.toolbar=new e.ControlDock({element:this.toolbar})),this.bindStandardControls(),n[this.hash].prevContainerSize=l(this.container),this.world=new e.World({viewer:this}),this.world.addHandler("add-item",function(ve){he.source=he.world.getItemAt(0).source,n[he.hash].forceRedraw=!0,he._updateRequestId||(he._updateRequestId=v(he,lt))}),this.world.addHandler("remove-item",function(ve){he.world.getItemCount()?he.source=he.world.getItemAt(0).source:he.source=null,n[he.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(ve){he.viewport&&he.viewport._setContentBounds(he.world.getHomeBounds(),he.world.getContentFactor())}),this.world.addHandler("item-index-change",function(ve){he.source=he.world.getItemAt(0).source}),this.viewport=new e.Viewport({containerSize:n[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new e.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:R.timeout}),this.tileCache=new e.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new e.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=e.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(be=this.buttonGroup.buttons.indexOf(this.rotateLeft),this.buttonGroup.buttons.splice(be,1),this.buttonGroup.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(be=this.buttonGroup.buttons.indexOf(this.rotateRight),this.buttonGroup.buttons.splice(be,1),this.buttonGroup.element.removeChild(this.rotateRight.element))),this._addUpdatePixelDensityRatioEvent(),this.showNavigator&&(this.navigator=new e.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),be=0;be<this.customControls.length;be++)this.addControl(this.customControls[be].id,{anchor:this.customControls[be].anchor});e.requestAnimationFrame(function(){_(he)}),this.imageSmoothingEnabled!==void 0&&!this.imageSmoothingEnabled&&this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled),e._viewers.set(this.element,this)},e.extend(e.Viewer.prototype,e.EventSource.prototype,e.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(R){return e.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(R)},openTileSource:function(R){return e.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(R)},open:function(R,Y){var he=this;if(this.close(),!R)return this;if(this.sequenceMode&&e.isArray(R))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),typeof Y<"u"&&!isNaN(Y)&&(this.initialPage=Y),this.tileSources=R,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),this._updateSequenceButtons(this._sequenceIndex),this;if(e.isArray(R)||(R=[R]),!R.length)return this;this._opening=!0;for(var be=R.length,ve=0,ze=0,Me,bt=function(){if(ve+ze===be)if(ve){(he._firstOpen||!he.preserveViewport)&&(he.viewport.goHome(!0),he.viewport.update()),he._firstOpen=!1;var tt=R[0];if(tt.tileSource&&(tt=tt.tileSource),he.overlays&&!he.preserveOverlays)for(var Ft=0;Ft<he.overlays.length;Ft++)he.currentOverlays[Ft]=f(he,he.overlays[Ft]);he._drawOverlays(),he._opening=!1,he.raiseEvent("open",{source:tt})}else he._opening=!1,he.raiseEvent("open-failed",Me)},Dt=function(tt){(!e.isPlainObject(tt)||!tt.tileSource)&&(tt={tileSource:tt}),tt.index!==void 0&&(e.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete tt.index),tt.collectionImmediately===void 0&&(tt.collectionImmediately=!0);var Ft=tt.success;tt.success=function($t){if(ve++,tt.tileSource.overlays)for(var wi=0;wi<tt.tileSource.overlays.length;wi++)he.addOverlay(tt.tileSource.overlays[wi]);Ft&&Ft($t),bt()};var ht=tt.error;tt.error=function($t){ze++,Me||(Me=$t),ht&&ht($t),bt()},he.addTiledImage(tt)},mt=0;mt<R.length;mt++)Dt(R[mt]);return this},close:function(){return n[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),n[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(n[this.hash]){if(this._removeUpdatePixelDensityRatioEvent(),this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),this._updateRequestId!==null&&(e.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.navigator&&(this.navigator.destroy(),n[this.navigator.hash]=null,delete n[this.navigator.hash],this.navigator=null),this.removeAllHandlers(),this.buttonGroup)this.buttonGroup.destroy();else if(this.customButtons)for(;this.customButtons.length;)this.customButtons.pop().destroy();if(this.paging&&this.paging.destroy(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.container.onsubmit=null,this.clearControls(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),n[this.hash]=null,delete n[this.hash],this.canvas=null,this.container=null,e._viewers.delete(this.element),this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(R){return this.innerTracker.setTracking(R),this.outerTracker.setTracking(R),this.raiseEvent("mouse-enabled",{enabled:R}),this},areControlsEnabled:function(){var R=this.controls.length,Y;for(Y=0;Y<this.controls.length;Y++)R=R&&this.controls[Y].isVisible();return R},setControlsEnabled:function(R){return R?k(this):_(this),this.raiseEvent("controls-enabled",{enabled:R}),this},setDebugMode:function(R){for(var Y=0;Y<this.world.getItemCount();Y++)this.world.getItemAt(Y).debugMode=R;this.debugMode=R,this.forceRedraw()},isFullPage:function(){return n[this.hash].fullPage},setFullPage:function(R){var Y=document.body,he=Y.style,be=document.documentElement.style,ve=this,ze,Me;if(R===this.isFullPage())return this;var bt={fullPage:R,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",bt),bt.preventDefaultAction)return this;if(R){for(this.elementSize=e.getElementSize(this.element),this.pageScroll=e.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=he.margin,this.docMargin=be.margin,he.margin="0",be.margin="0",this.bodyPadding=he.padding,this.docPadding=be.padding,he.padding="0",be.padding="0",this.bodyWidth=he.width,this.docWidth=be.width,he.width="100%",be.width="100%",this.bodyHeight=he.height,this.docHeight=be.height,he.height="100%",be.height="100%",this.bodyDisplay=he.display,he.display="block",this.previousBody=[],n[this.hash].prevElementParent=this.element.parentNode,n[this.hash].prevNextSibling=this.element.nextSibling,n[this.hash].prevElementWidth=this.element.style.width,n[this.hash].prevElementHeight=this.element.style.height,ze=Y.childNodes.length,Me=0;Me<ze;Me++)this.previousBody.push(Y.childNodes[0]),Y.removeChild(Y.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,Y.appendChild(this.toolbar.element),e.addClass(this.toolbar.element,"fullpage")),e.addClass(this.element,"fullpage"),Y.appendChild(this.element),this.element.style.height=e.getWindowSize().y+"px",this.element.style.width=e.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=e.getElementSize(this.element).y-e.getElementSize(this.toolbar.element).y+"px"),n[this.hash].fullPage=!0,e.delegate(this,et)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,he.margin=this.bodyMargin,be.margin=this.docMargin,he.padding=this.bodyPadding,be.padding=this.docPadding,he.width=this.bodyWidth,be.width=this.docWidth,he.height=this.bodyHeight,be.height=this.docHeight,he.display=this.bodyDisplay,Y.removeChild(this.element),ze=this.previousBody.length,Me=0;Me<ze;Me++)Y.appendChild(this.previousBody.shift());e.removeClass(this.element,"fullpage"),n[this.hash].prevElementParent.insertBefore(this.element,n[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(Y.removeChild(this.toolbar.element),e.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=n[this.hash].prevElementWidth,this.element.style.height=n[this.hash].prevElementHeight;var Dt=0,mt=function(){e.setPageScroll(ve.pageScroll);var tt=e.getPageScroll();Dt++,Dt<10&&(tt.x!==ve.pageScroll.x||tt.y!==ve.pageScroll.y)&&e.requestAnimationFrame(mt)};e.requestAnimationFrame(mt),n[this.hash].fullPage=!1,e.delegate(this,$e)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:R}),this},setFullScreen:function(R){var Y=this;if(!e.supportsFullScreen)return this.setFullPage(R);if(e.isFullScreen()===R)return this;var he={fullScreen:R,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",he),he.preventDefaultAction)return this;if(R){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var be=function(){var ve=e.isFullScreen();ve||(e.removeEvent(document,e.fullScreenEventName,be),e.removeEvent(document,e.fullScreenErrorEventName,be),Y.setFullPage(!1),Y.isFullPage()&&(Y.element.style.width=Y.fullPageStyleWidth,Y.element.style.height=Y.fullPageStyleHeight)),Y.navigator&&Y.viewport&&setTimeout(function(){Y.navigator.update(Y.viewport)}),Y.raiseEvent("full-screen",{fullScreen:ve})};e.addEvent(document,e.fullScreenEventName,be),e.addEvent(document,e.fullScreenErrorEventName,be),e.requestFullScreen(document.body)}else e.exitFullScreen();return this},isVisible:function(){return this.container.style.visibility!=="hidden"},setVisible:function(R){return this.container.style.visibility=R?"":"hidden",this.raiseEvent("visible",{visible:R}),this},addTiledImage:function(R){e.console.assert(R,"[Viewer.addTiledImage] options is required"),e.console.assert(R.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),e.console.assert(!R.replace||R.index>-1&&R.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var Y=this;R.replace&&(R.replaceItem=Y.world.getItemAt(R.index)),this._hideMessage(),R.placeholderFillStyle===void 0&&(R.placeholderFillStyle=this.placeholderFillStyle),R.opacity===void 0&&(R.opacity=this.opacity),R.preload===void 0&&(R.preload=this.preload),R.compositeOperation===void 0&&(R.compositeOperation=this.compositeOperation),R.crossOriginPolicy===void 0&&(R.crossOriginPolicy=R.tileSource.crossOriginPolicy!==void 0?R.tileSource.crossOriginPolicy:this.crossOriginPolicy),R.ajaxWithCredentials===void 0&&(R.ajaxWithCredentials=this.ajaxWithCredentials),R.loadTilesWithAjax===void 0&&(R.loadTilesWithAjax=this.loadTilesWithAjax),R.ajaxHeaders===void 0||R.ajaxHeaders===null?R.ajaxHeaders=this.ajaxHeaders:e.isPlainObject(R.ajaxHeaders)&&e.isPlainObject(this.ajaxHeaders)&&(R.ajaxHeaders=e.extend({},this.ajaxHeaders,R.ajaxHeaders));var he={options:R};function be(Me){for(var bt=0;bt<Y._loadQueue.length;bt++)if(Y._loadQueue[bt]===he){Y._loadQueue.splice(bt,1);break}Y._loadQueue.length===0&&ve(he),Y.raiseEvent("add-item-failed",Me),R.error&&R.error(Me)}function ve(Me){Y.collectionMode&&(Y.world.arrange({immediately:Me.options.collectionImmediately,rows:Y.collectionRows,columns:Y.collectionColumns,layout:Y.collectionLayout,tileSize:Y.collectionTileSize,tileMargin:Y.collectionTileMargin}),Y.world.setAutoRefigureSizes(!0))}if(e.isArray(R.tileSource)){setTimeout(function(){be({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:R.tileSource,options:R})});return}this._loadQueue.push(he);function ze(){for(var Me,bt,Dt;Y._loadQueue.length&&(Me=Y._loadQueue[0],!!Me.tileSource);){if(Y._loadQueue.splice(0,1),Me.options.replace){var mt=Y.world.getIndexOfItem(Me.options.replaceItem);mt!==-1&&(Me.options.index=mt),Y.world.removeItem(Me.options.replaceItem)}bt=new e.TiledImage({viewer:Y,source:Me.tileSource,viewport:Y.viewport,drawer:Y.drawer,tileCache:Y.tileCache,imageLoader:Y.imageLoader,x:Me.options.x,y:Me.options.y,width:Me.options.width,height:Me.options.height,fitBounds:Me.options.fitBounds,fitBoundsPlacement:Me.options.fitBoundsPlacement,clip:Me.options.clip,placeholderFillStyle:Me.options.placeholderFillStyle,opacity:Me.options.opacity,preload:Me.options.preload,degrees:Me.options.degrees,flipped:Me.options.flipped,compositeOperation:Me.options.compositeOperation,springStiffness:Y.springStiffness,animationTime:Y.animationTime,minZoomImageRatio:Y.minZoomImageRatio,wrapHorizontal:Y.wrapHorizontal,wrapVertical:Y.wrapVertical,immediateRender:Y.immediateRender,blendTime:Y.blendTime,alwaysBlend:Y.alwaysBlend,minPixelRatio:Y.minPixelRatio,smoothTileEdgesMinZoom:Y.smoothTileEdgesMinZoom,iOSDevice:Y.iOSDevice,crossOriginPolicy:Me.options.crossOriginPolicy,ajaxWithCredentials:Me.options.ajaxWithCredentials,loadTilesWithAjax:Me.options.loadTilesWithAjax,ajaxHeaders:Me.options.ajaxHeaders,debugMode:Y.debugMode}),Y.collectionMode&&Y.world.setAutoRefigureSizes(!1),Y.navigator&&(Dt=e.extend({},Me.options,{replace:!1,originalTiledImage:bt,tileSource:Me.tileSource}),Y.navigator.addTiledImage(Dt)),Y.world.addItem(bt,{index:Me.options.index}),Y._loadQueue.length===0&&ve(Me),Y.world.getItemCount()===1&&!Y.preserveViewport&&Y.viewport.goHome(!0),Me.options.success&&Me.options.success({item:bt})}}h(this,R.tileSource,R,function(Me){he.tileSource=Me,ze()},function(Me){Me.options=R,be(Me),ze()})},addSimpleImage:function(R){e.console.assert(R,"[Viewer.addSimpleImage] options is required"),e.console.assert(R.url,"[Viewer.addSimpleImage] options.url is required");var Y=e.extend({},R,{tileSource:{type:"image",url:R.url}});delete Y.url,this.addTiledImage(Y)},addLayer:function(R){var Y=this;e.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var he=e.extend({},R,{success:function(be){Y.raiseEvent("add-layer",{options:R,drawer:be.item})},error:function(be){Y.raiseEvent("add-layer-failed",be)}});return this.addTiledImage(he),this},getLayerAtLevel:function(R){return e.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(R)},getLevelOfLayer:function(R){return e.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(R)},getLayersCount:function(){return e.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(R,Y){return e.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(R,Y)},removeLayer:function(R){return e.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(R)},forceRedraw:function(){return n[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var R=e.delegate(this,I),Y=e.delegate(this,X),he=e.delegate(this,this.goToNextPage),be=e.delegate(this,this.goToPreviousPage),ve=this.navImages,ze=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(ze=!1),this.previousButton=new e.Button({element:this.previousButton?e.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.PreviousPage"),srcRest:Le(this.prefixUrl,ve.previous.REST),srcGroup:Le(this.prefixUrl,ve.previous.GROUP),srcHover:Le(this.prefixUrl,ve.previous.HOVER),srcDown:Le(this.prefixUrl,ve.previous.DOWN),onRelease:be,onFocus:R,onBlur:Y}),this.nextButton=new e.Button({element:this.nextButton?e.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.NextPage"),srcRest:Le(this.prefixUrl,ve.next.REST),srcGroup:Le(this.prefixUrl,ve.next.GROUP),srcHover:Le(this.prefixUrl,ve.next.HOVER),srcDown:Le(this.prefixUrl,ve.next.DOWN),onRelease:he,onFocus:R,onBlur:Y}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),ze&&(this.paging=new e.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:e.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||e.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var R=e.delegate(this,gt),Y=e.delegate(this,kn),he=e.delegate(this,qn),be=e.delegate(this,oi),ve=e.delegate(this,Rn),ze=e.delegate(this,br),Me=e.delegate(this,zi),bt=e.delegate(this,Sr),Dt=e.delegate(this,_r),mt=e.delegate(this,Tr),tt=e.delegate(this,I),Ft=e.delegate(this,X),ht=this.navImages,$t=[],wi=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(wi=!1),this.showZoomControl&&($t.push(this.zoomInButton=new e.Button({element:this.zoomInButton?e.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomIn"),srcRest:Le(this.prefixUrl,ht.zoomIn.REST),srcGroup:Le(this.prefixUrl,ht.zoomIn.GROUP),srcHover:Le(this.prefixUrl,ht.zoomIn.HOVER),srcDown:Le(this.prefixUrl,ht.zoomIn.DOWN),onPress:R,onRelease:Y,onClick:he,onEnter:R,onExit:Y,onFocus:tt,onBlur:Ft})),$t.push(this.zoomOutButton=new e.Button({element:this.zoomOutButton?e.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomOut"),srcRest:Le(this.prefixUrl,ht.zoomOut.REST),srcGroup:Le(this.prefixUrl,ht.zoomOut.GROUP),srcHover:Le(this.prefixUrl,ht.zoomOut.HOVER),srcDown:Le(this.prefixUrl,ht.zoomOut.DOWN),onPress:be,onRelease:Y,onClick:ve,onEnter:be,onExit:Y,onFocus:tt,onBlur:Ft}))),this.showHomeControl&&$t.push(this.homeButton=new e.Button({element:this.homeButton?e.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Home"),srcRest:Le(this.prefixUrl,ht.home.REST),srcGroup:Le(this.prefixUrl,ht.home.GROUP),srcHover:Le(this.prefixUrl,ht.home.HOVER),srcDown:Le(this.prefixUrl,ht.home.DOWN),onRelease:ze,onFocus:tt,onBlur:Ft})),this.showFullPageControl&&$t.push(this.fullPageButton=new e.Button({element:this.fullPageButton?e.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.FullPage"),srcRest:Le(this.prefixUrl,ht.fullpage.REST),srcGroup:Le(this.prefixUrl,ht.fullpage.GROUP),srcHover:Le(this.prefixUrl,ht.fullpage.HOVER),srcDown:Le(this.prefixUrl,ht.fullpage.DOWN),onRelease:Me,onFocus:tt,onBlur:Ft})),this.showRotationControl&&($t.push(this.rotateLeftButton=new e.Button({element:this.rotateLeftButton?e.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateLeft"),srcRest:Le(this.prefixUrl,ht.rotateleft.REST),srcGroup:Le(this.prefixUrl,ht.rotateleft.GROUP),srcHover:Le(this.prefixUrl,ht.rotateleft.HOVER),srcDown:Le(this.prefixUrl,ht.rotateleft.DOWN),onRelease:bt,onFocus:tt,onBlur:Ft})),$t.push(this.rotateRightButton=new e.Button({element:this.rotateRightButton?e.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateRight"),srcRest:Le(this.prefixUrl,ht.rotateright.REST),srcGroup:Le(this.prefixUrl,ht.rotateright.GROUP),srcHover:Le(this.prefixUrl,ht.rotateright.HOVER),srcDown:Le(this.prefixUrl,ht.rotateright.DOWN),onRelease:Dt,onFocus:tt,onBlur:Ft}))),this.showFlipControl&&$t.push(this.flipButton=new e.Button({element:this.flipButton?e.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Flip"),srcRest:Le(this.prefixUrl,ht.flip.REST),srcGroup:Le(this.prefixUrl,ht.flip.GROUP),srcHover:Le(this.prefixUrl,ht.flip.HOVER),srcDown:Le(this.prefixUrl,ht.flip.DOWN),onRelease:mt,onFocus:tt,onBlur:Ft})),wi?(this.buttonGroup=new e.ButtonGroup({buttons:$t,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttonGroup.element,this.addHandler("open",e.delegate(this,xr)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT})):this.customButtons=$t),this},currentPage:function(){return this._sequenceIndex},goToPage:function(R){return this.tileSources&&R>=0&&R<this.tileSources.length&&(this._sequenceIndex=R,this._updateSequenceButtons(R),this.open(this.tileSources[R]),this.referenceStrip&&this.referenceStrip.setFocus(R),this.raiseEvent("page",{page:R})),this},addOverlay:function(R,Y,he,be){var ve;if(e.isPlainObject(R)?ve=R:ve={element:R,location:Y,placement:he,onDraw:be},R=e.getElement(ve.element),g(this.currentOverlays,R)>=0)return this;var ze=f(this,ve);return this.currentOverlays.push(ze),ze.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:R,location:ve.location,placement:ve.placement}),this},updateOverlay:function(R,Y,he){var be;return R=e.getElement(R),be=g(this.currentOverlays,R),be>=0&&(this.currentOverlays[be].update(Y,he),n[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:R,location:Y,placement:he})),this},removeOverlay:function(R){var Y;return R=e.getElement(R),Y=g(this.currentOverlays,R),Y>=0&&(this.currentOverlays[Y].destroy(),this.currentOverlays.splice(Y,1),n[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:R})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return n[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(R){var Y;return R=e.getElement(R),Y=g(this.currentOverlays,R),Y>=0?this.currentOverlays[Y]:null},_updateSequenceButtons:function(R){this.nextButton&&(!this.tileSources||this.tileSources.length-1===R?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(R>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(R){this._hideMessage();var Y=e.makeNeutralElement("div");Y.appendChild(document.createTextNode(R)),this.messageDiv=e.makeCenteredNode(Y),e.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var R=this.messageDiv;R&&(R.parentNode.removeChild(R),delete this.messageDiv)},gestureSettingsByDeviceType:function(R){switch(R){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var R,Y=this.currentOverlays.length;for(R=0;R<Y;R++)this.currentOverlays[R].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new e.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else e.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')},_addUpdatePixelDensityRatioEvent:function(){this._updatePixelDensityRatioBind=this._updatePixelDensityRatio.bind(this),e.addEvent(window,"resize",this._updatePixelDensityRatioBind)},_removeUpdatePixelDensityRatioEvent:function(){e.removeEvent(window,"resize",this._updatePixelDensityRatioBind)},_updatePixelDensityRatio:function(){var R=e.pixelDensityRatio,Y=e.getCurrentPixelDensityRatio();R!==Y&&(e.pixelDensityRatio=Y,this.world.resetItems(),this.forceRedraw())},goToPreviousPage:function(){var R=this._sequenceIndex-1;this.navPrevNextWrap&&R<0&&(R+=this.tileSources.length),this.goToPage(R)},goToNextPage:function(){var R=this._sequenceIndex+1;this.navPrevNextWrap&&R>=this.tileSources.length&&(R=0),this.goToPage(R)}});function l(R){return R=e.getElement(R),new e.Point(R.clientWidth===0?1:R.clientWidth,R.clientHeight===0?1:R.clientHeight)}function h(R,Y,he,be,ve){var ze=R;if(e.type(Y)==="string"){if(Y.match(/^\s*<.*>\s*$/))Y=e.parseXml(Y);else if(Y.match(/^\s*[{[].*[}\]]\s*$/))try{var Me=e.parseJSON(Y);Y=Me}catch{}}function bt(Dt,mt){Dt.ready?be(Dt):(Dt.addHandler("ready",function(){be(Dt)}),Dt.addHandler("open-failed",function(tt){ve({message:tt.message,source:mt})}))}setTimeout(function(){if(e.type(Y)==="string")Y=new e.TileSource({url:Y,crossOriginPolicy:he.crossOriginPolicy!==void 0?he.crossOriginPolicy:R.crossOriginPolicy,ajaxWithCredentials:R.ajaxWithCredentials,ajaxHeaders:he.ajaxHeaders?he.ajaxHeaders:R.ajaxHeaders,useCanvas:R.useCanvas,success:function(Ft){be(Ft.tileSource)}}),Y.addHandler("open-failed",function(Ft){ve(Ft)});else if(e.isPlainObject(Y)||Y.nodeType)if(Y.crossOriginPolicy===void 0&&(he.crossOriginPolicy!==void 0||R.crossOriginPolicy!==void 0)&&(Y.crossOriginPolicy=he.crossOriginPolicy!==void 0?he.crossOriginPolicy:R.crossOriginPolicy),Y.ajaxWithCredentials===void 0&&(Y.ajaxWithCredentials=R.ajaxWithCredentials),Y.useCanvas===void 0&&(Y.useCanvas=R.useCanvas),e.isFunction(Y.getTileUrl)){var Dt=new e.TileSource(Y);Dt.getTileUrl=Y.getTileUrl,be(Dt)}else{var mt=e.TileSource.determineType(ze,Y);if(!mt){ve({message:"Unable to load TileSource",source:Y});return}var tt=mt.prototype.configure.apply(ze,[Y]);bt(new mt(tt),Y)}else bt(Y,Y)})}function f(R,Y){if(Y instanceof e.Overlay)return Y;var he=null;if(Y.element)he=e.getElement(Y.element);else{var be=Y.id?Y.id:"openseadragon-overlay-"+Math.floor(Math.random()*1e7);he=e.getElement(Y.id),he||(he=document.createElement("a"),he.href="#/overlay/"+be),he.id=be,e.addClass(he,Y.className?Y.className:"openseadragon-overlay")}var ve=Y.location,ze=Y.width,Me=Y.height;if(!ve){var bt=Y.x,Dt=Y.y;if(Y.px!==void 0){var mt=R.viewport.imageToViewportRectangle(new e.Rect(Y.px,Y.py,ze||0,Me||0));bt=mt.x,Dt=mt.y,ze=ze!==void 0?mt.width:void 0,Me=Me!==void 0?mt.height:void 0}ve=new e.Point(bt,Dt)}var tt=Y.placement;return tt&&e.type(tt)==="string"&&(tt=e.Placement[Y.placement.toUpperCase()]),new e.Overlay({element:he,location:ve,placement:tt,onDraw:Y.onDraw,checkResize:Y.checkResize,width:ze,height:Me,rotationMode:Y.rotationMode})}function g(R,Y){var he;for(he=R.length-1;he>=0;he--)if(R[he].element===Y)return he;return-1}function v(R,Y){return e.requestAnimationFrame(function(){Y(R)})}function E(R){e.requestAnimationFrame(function(){C(R)})}function _(R){!R.autoHideControls||(R.controlsShouldFade=!0,R.controlsFadeBeginTime=e.now()+R.controlsFadeDelay,window.setTimeout(function(){E(R)},R.controlsFadeDelay))}function C(R){var Y,he,be,ve;if(R.controlsShouldFade){for(Y=e.now(),he=Y-R.controlsFadeBeginTime,be=1-he/R.controlsFadeLength,be=Math.min(1,be),be=Math.max(0,be),ve=R.controls.length-1;ve>=0;ve--)R.controls[ve].autoFade&&R.controls[ve].setOpacity(be);be>0&&E(R)}}function k(R){var Y;for(R.controlsShouldFade=!1,Y=R.controls.length-1;Y>=0;Y--)R.controls[Y].setOpacity(1)}function I(){k(this)}function X(){_(this)}function U(R){var Y={tracker:R.eventSource,position:R.position,originalEvent:R.originalEvent,preventDefault:R.preventDefault};this.raiseEvent("canvas-contextmenu",Y),R.preventDefault=Y.preventDefault}function $(R){var Y={originalEvent:R.originalEvent,preventDefaultAction:!1,preventVerticalPan:R.preventVerticalPan,preventHorizontalPan:R.preventHorizontalPan};if(this.raiseEvent("canvas-key",Y),!Y.preventDefaultAction&&!R.ctrl&&!R.alt&&!R.meta)switch(R.keyCode){case 38:Y.preventVerticalPan||(R.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),R.preventDefault=!0;break;case 40:Y.preventVerticalPan||(R.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),R.preventDefault=!0;break;case 37:Y.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),R.preventDefault=!0;break;case 39:Y.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),R.preventDefault=!0;break;default:R.preventDefault=!1;break}else R.preventDefault=!1}function P(R){var Y={originalEvent:R.originalEvent,preventDefaultAction:!1,preventVerticalPan:R.preventVerticalPan,preventHorizontalPan:R.preventHorizontalPan};if(this.raiseEvent("canvas-key",Y),!Y.preventDefaultAction&&!R.ctrl&&!R.alt&&!R.meta)switch(R.keyCode){case 43:case 61:this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),R.preventDefault=!0;break;case 45:this.viewport.zoomBy(.9),this.viewport.applyConstraints(),R.preventDefault=!0;break;case 48:this.viewport.goHome(),this.viewport.applyConstraints(),R.preventDefault=!0;break;case 119:case 87:Y.preventVerticalPan||(R.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-40))),this.viewport.applyConstraints()),R.preventDefault=!0;break;case 115:case 83:Y.preventVerticalPan||(R.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,40))),this.viewport.applyConstraints()),R.preventDefault=!0;break;case 97:Y.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-40,0))),this.viewport.applyConstraints()),R.preventDefault=!0;break;case 100:Y.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(40,0))),this.viewport.applyConstraints()),R.preventDefault=!0;break;case 114:this.viewport.flipped?this.viewport.setRotation(e.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)):this.viewport.setRotation(e.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)),this.viewport.applyConstraints(),R.preventDefault=!0;break;case 82:this.viewport.flipped?this.viewport.setRotation(e.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)):this.viewport.setRotation(e.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)),this.viewport.applyConstraints(),R.preventDefault=!0;break;case 102:this.viewport.toggleFlip(),R.preventDefault=!0;break;case 106:this.goToPreviousPage();break;case 107:this.goToNextPage();break;default:R.preventDefault=!1;break}else R.preventDefault=!1}function N(R){var Y,he=document.activeElement===this.canvas;he||this.canvas.focus(),this.viewport.flipped&&(R.position.x=this.viewport.getContainerSize().x-R.position.x);var be={tracker:R.eventSource,position:R.position,quick:R.quick,shift:R.shift,originalEvent:R.originalEvent,originalTarget:R.originalTarget,preventDefaultAction:!1};this.raiseEvent("canvas-click",be),!be.preventDefaultAction&&this.viewport&&R.quick&&(Y=this.gestureSettingsByDeviceType(R.pointerType),Y.clickToZoom&&(this.viewport.zoomBy(R.shift?1/this.zoomPerClick:this.zoomPerClick,Y.zoomToRefPoint?this.viewport.pointFromPixel(R.position,!0):null),this.viewport.applyConstraints()))}function J(R){var Y,he={tracker:R.eventSource,position:R.position,shift:R.shift,originalEvent:R.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-double-click",he),!he.preventDefaultAction&&this.viewport&&(Y=this.gestureSettingsByDeviceType(R.pointerType),Y.dblClickToZoom&&(this.viewport.zoomBy(R.shift?1/this.zoomPerClick:this.zoomPerClick,Y.zoomToRefPoint?this.viewport.pointFromPixel(R.position,!0):null),this.viewport.applyConstraints()))}function K(R){var Y,he={tracker:R.eventSource,pointerType:R.pointerType,position:R.position,delta:R.delta,speed:R.speed,direction:R.direction,shift:R.shift,originalEvent:R.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag",he),Y=this.gestureSettingsByDeviceType(R.pointerType),Y.dragToPan&&!he.preventDefaultAction&&this.viewport){if(this.panHorizontal||(R.delta.x=0),this.panVertical||(R.delta.y=0),this.viewport.flipped&&(R.delta.x=-R.delta.x),this.constrainDuringPan){var be=this.viewport.deltaPointsFromPixels(R.delta.negate());this.viewport.centerSpringX.target.value+=be.x,this.viewport.centerSpringY.target.value+=be.y;var ve=this.viewport.getBounds(),ze=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=be.x,this.viewport.centerSpringY.target.value-=be.y,ve.x!==ze.x&&(R.delta.x=0),ve.y!==ze.y&&(R.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(R.delta.negate()),Y.flickEnabled&&!this.constrainDuringPan)}}function oe(R){var Y={tracker:R.eventSource,pointerType:R.pointerType,position:R.position,speed:R.speed,direction:R.direction,shift:R.shift,originalEvent:R.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag-end",Y),!Y.preventDefaultAction&&this.viewport){var he=this.gestureSettingsByDeviceType(R.pointerType);if(he.flickEnabled&&R.speed>=he.flickMinSpeed){var be=0;this.panHorizontal&&(be=he.flickMomentum*R.speed*Math.cos(R.direction));var ve=0;this.panVertical&&(ve=he.flickMomentum*R.speed*Math.sin(R.direction));var ze=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),Me=this.viewport.pointFromPixel(new e.Point(ze.x-be,ze.y-ve));this.viewport.panTo(Me,!1)}this.viewport.applyConstraints()}}function ie(R){this.raiseEvent("canvas-enter",{tracker:R.eventSource,pointerType:R.pointerType,position:R.position,buttons:R.buttons,pointers:R.pointers,insideElementPressed:R.insideElementPressed,buttonDownAny:R.buttonDownAny,originalEvent:R.originalEvent})}function me(R){this.raiseEvent("canvas-exit",{tracker:R.eventSource,pointerType:R.pointerType,position:R.position,buttons:R.buttons,pointers:R.pointers,insideElementPressed:R.insideElementPressed,buttonDownAny:R.buttonDownAny,originalEvent:R.originalEvent})}function we(R){this.raiseEvent("canvas-press",{tracker:R.eventSource,pointerType:R.pointerType,position:R.position,insideElementPressed:R.insideElementPressed,insideElementReleased:R.insideElementReleased,originalEvent:R.originalEvent})}function De(R){this.raiseEvent("canvas-release",{tracker:R.eventSource,pointerType:R.pointerType,position:R.position,insideElementPressed:R.insideElementPressed,insideElementReleased:R.insideElementReleased,originalEvent:R.originalEvent})}function Be(R){this.raiseEvent("canvas-nonprimary-press",{tracker:R.eventSource,position:R.position,pointerType:R.pointerType,button:R.button,buttons:R.buttons,originalEvent:R.originalEvent})}function Oe(R){this.raiseEvent("canvas-nonprimary-release",{tracker:R.eventSource,position:R.position,pointerType:R.pointerType,button:R.button,buttons:R.buttons,originalEvent:R.originalEvent})}function Ue(R){var Y,he,be,ve,ze={tracker:R.eventSource,pointerType:R.pointerType,gesturePoints:R.gesturePoints,lastCenter:R.lastCenter,center:R.center,lastDistance:R.lastDistance,distance:R.distance,shift:R.shift,originalEvent:R.originalEvent,preventDefaultPanAction:!1,preventDefaultZoomAction:!1,preventDefaultRotateAction:!1};if(this.raiseEvent("canvas-pinch",ze),this.viewport&&(Y=this.gestureSettingsByDeviceType(R.pointerType),Y.pinchToZoom&&(!ze.preventDefaultPanAction||!ze.preventDefaultZoomAction)&&(he=this.viewport.pointFromPixel(R.center,!0),ze.preventDefaultZoomAction||this.viewport.zoomBy(R.distance/R.lastDistance,he,!0),Y.zoomToRefPoint&&!ze.preventDefaultPanAction&&(be=this.viewport.pointFromPixel(R.lastCenter,!0),ve=be.minus(he),this.panHorizontal||(ve.x=0),this.panVertical||(ve.y=0),this.viewport.panBy(ve,!0)),this.viewport.applyConstraints()),Y.pinchRotate&&!ze.preventDefaultRotateAction)){var Me=Math.atan2(R.gesturePoints[0].currentPos.y-R.gesturePoints[1].currentPos.y,R.gesturePoints[0].currentPos.x-R.gesturePoints[1].currentPos.x),bt=Math.atan2(R.gesturePoints[0].lastPos.y-R.gesturePoints[1].lastPos.y,R.gesturePoints[0].lastPos.x-R.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(Me-bt)*(180/Math.PI))}}function Ve(R){var Y,he,be,ve,ze;ve=e.now(),ze=ve-this._lastScrollTime,ze>this.minScrollDeltaTime?(this._lastScrollTime=ve,Y={tracker:R.eventSource,position:R.position,scroll:R.scroll,shift:R.shift,originalEvent:R.originalEvent,preventDefaultAction:!1,preventDefault:!0},this.raiseEvent("canvas-scroll",Y),!Y.preventDefaultAction&&this.viewport&&(this.viewport.flipped&&(R.position.x=this.viewport.getContainerSize().x-R.position.x),he=this.gestureSettingsByDeviceType(R.pointerType),he.scrollToZoom&&(be=Math.pow(this.zoomPerScroll,R.scroll),this.viewport.zoomBy(be,he.zoomToRefPoint?this.viewport.pointFromPixel(R.position,!0):null),this.viewport.applyConstraints())),R.preventDefault=Y.preventDefault):R.preventDefault=!0}function et(R){n[this.hash].mouseInside=!0,k(this),this.raiseEvent("container-enter",{tracker:R.eventSource,pointerType:R.pointerType,position:R.position,buttons:R.buttons,pointers:R.pointers,insideElementPressed:R.insideElementPressed,buttonDownAny:R.buttonDownAny,originalEvent:R.originalEvent})}function $e(R){R.pointers<1&&(n[this.hash].mouseInside=!1,n[this.hash].animating||_(this)),this.raiseEvent("container-exit",{tracker:R.eventSource,pointerType:R.pointerType,position:R.position,buttons:R.buttons,pointers:R.pointers,insideElementPressed:R.insideElementPressed,buttonDownAny:R.buttonDownAny,originalEvent:R.originalEvent})}function lt(R){dt(R),R.isOpen()?R._updateRequestId=v(R,lt):R._updateRequestId=!1}function dt(R){if(!(R._opening||!n[R.hash])){if(R.autoResize){var Y=l(R.container),he=n[R.hash].prevContainerSize;if(!Y.equals(he)){var be=R.viewport;if(R.preserveImageSizeOnResize){var ve=he.x/Y.x,ze=be.getZoom()*ve,Me=be.getCenter();be.resize(Y,!1),be.zoomTo(ze,null,!0),be.panTo(Me,!0)}else{var bt=be.getBounds();be.resize(Y,!0),be.fitBoundsWithConstraints(bt,!0)}n[R.hash].prevContainerSize=Y,n[R.hash].forceRedraw=!0}}var Dt=R.viewport.update(),mt=R.world.update()||Dt;Dt&&R.raiseEvent("viewport-change"),R.referenceStrip&&(mt=R.referenceStrip.update(R.viewport)||mt),!n[R.hash].animating&&mt&&(R.raiseEvent("animation-start"),k(R)),(mt||n[R.hash].forceRedraw||R.world.needsDraw())&&(At(R),R._drawOverlays(),R.navigator&&R.navigator.update(R.viewport),n[R.hash].forceRedraw=!1,mt&&R.raiseEvent("animation")),n[R.hash].animating&&!mt&&(R.raiseEvent("animation-finish"),n[R.hash].mouseInside||_(R)),n[R.hash].animating=mt}}function At(R){R.imageLoader.clear(),R.drawer.clear(),R.world.draw(),R.raiseEvent("update-viewport",{})}function Le(R,Y){return R?R+Y:Y}function gt(){n[this.hash].lastZoomTime=e.now(),n[this.hash].zoomFactor=this.zoomPerSecond,n[this.hash].zooming=!0,on(this)}function oi(){n[this.hash].lastZoomTime=e.now(),n[this.hash].zoomFactor=1/this.zoomPerSecond,n[this.hash].zooming=!0,on(this)}function kn(){n[this.hash].zooming=!1}function on(R){e.requestAnimationFrame(e.delegate(R,Tn))}function Tn(){var R,Y,he;n[this.hash].zooming&&this.viewport&&(R=e.now(),Y=R-n[this.hash].lastZoomTime,he=Math.pow(n[this.hash].zoomFactor,Y/1e3),this.viewport.zoomBy(he),this.viewport.applyConstraints(),n[this.hash].lastZoomTime=R,on(this))}function qn(){this.viewport&&(n[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function Rn(){this.viewport&&(n[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function xr(){this.buttonGroup&&(this.buttonGroup.emulateEnter(),this.buttonGroup.emulateLeave())}function br(){this.viewport&&this.viewport.goHome()}function zi(){this.isFullPage()&&!e.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttonGroup&&this.buttonGroup.emulateLeave(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function Sr(){if(this.viewport){var R=this.viewport.getRotation();this.viewport.flipped?R=e.positiveModulo(R+this.rotationIncrement,360):R=e.positiveModulo(R-this.rotationIncrement,360),this.viewport.setRotation(R)}}function _r(){if(this.viewport){var R=this.viewport.getRotation();this.viewport.flipped?R=e.positiveModulo(R-this.rotationIncrement,360):R=e.positiveModulo(R+this.rotationIncrement,360),this.viewport.setRotation(R)}}function Tr(){this.viewport.toggleFlip()}}(r),function(e){e.Navigator=function(v){var E=v.viewer,_=this,C,k;v.id?(this.element=document.getElementById(v.id),v.controlOptions={anchor:e.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(v.id="navigator-"+e.now(),this.element=e.makeNeutralElement("div"),v.controlOptions={anchor:e.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:v.autoFade},v.position&&(v.position==="BOTTOM_RIGHT"?v.controlOptions.anchor=e.ControlAnchor.BOTTOM_RIGHT:v.position==="BOTTOM_LEFT"?v.controlOptions.anchor=e.ControlAnchor.BOTTOM_LEFT:v.position==="TOP_RIGHT"?v.controlOptions.anchor=e.ControlAnchor.TOP_RIGHT:v.position==="TOP_LEFT"?v.controlOptions.anchor=e.ControlAnchor.TOP_LEFT:v.position==="ABSOLUTE"&&(v.controlOptions.anchor=e.ControlAnchor.ABSOLUTE,v.controlOptions.top=v.top,v.controlOptions.left=v.left,v.controlOptions.height=v.height,v.controlOptions.width=v.width))),this.element.id=v.id,this.element.className+=" navigator",v=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.navigatorSizeRatio},v,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:v.autoResize,minZoomImageRatio:1,background:v.background,opacity:v.opacity,borderColor:v.borderColor,displayRegionColor:v.displayRegionColor}),v.minPixelRatio=this.minPixelRatio=E.minPixelRatio,e.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new e.Point(1,1),this.totalBorderWidths=new e.Point(this.borderWidth*2,this.borderWidth*2).minus(this.fudge),v.controlOptions.anchor!==e.ControlAnchor.NONE&&function(U,$){U.margin="0px",U.border=$+"px solid "+v.borderColor,U.padding="0px",U.background=v.background,U.opacity=v.opacity,U.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=e.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(U,$){U.position="relative",U.top="0px",U.left="0px",U.fontSize="0px",U.overflow="hidden",U.border=$+"px solid "+v.displayRegionColor,U.margin="0px",U.padding="0px",U.background="transparent",U.float="left",U.cssFloat="left",U.styleFloat="left",U.zIndex=999999999,U.cursor="default"}(this.displayRegion.style,this.borderWidth),e.setElementPointerEventsNone(this.displayRegion),e.setElementTouchActionNone(this.displayRegion),this.displayRegionContainer=e.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",e.setElementPointerEventsNone(this.displayRegionContainer),e.setElementTouchActionNone(this.displayRegionContainer),E.addControl(this.element,v.controlOptions),this._resizeWithViewer=v.controlOptions.anchor!==e.ControlAnchor.ABSOLUTE&&v.controlOptions.anchor!==e.ControlAnchor.NONE,v.width&&v.height?(this.setWidth(v.width),this.setHeight(v.height)):this._resizeWithViewer&&(C=e.getElementSize(E.element),this.element.style.height=Math.round(C.y*v.sizeRatio)+"px",this.element.style.width=Math.round(C.x*v.sizeRatio)+"px",this.oldViewerSize=C,k=e.getElementSize(this.element),this.elementArea=k.x*k.y),this.oldContainerSize=new e.Point(0,0),e.Viewer.apply(this,[v]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer);function I(U){f(_.displayRegionContainer,U),f(_.displayRegion,-U),_.viewport.setRotation(U)}if(v.navigatorRotate){var X=v.viewer.viewport?v.viewer.viewport.getRotation():v.viewer.degrees||0;I(X),v.viewer.addHandler("rotate",function(U){I(U.degrees)})}this.innerTracker.destroy(),this.innerTracker=new e.MouseTracker({userData:"Navigator.innerTracker",element:this.element,dragHandler:e.delegate(this,o),clickHandler:e.delegate(this,n),releaseHandler:e.delegate(this,l),scrollHandler:e.delegate(this,h),preProcessEventHandler:function(U){U.eventType==="wheel"&&(U.preventDefault=!0)}}),this.outerTracker.userData="Navigator.outerTracker",e.setElementPointerEventsNone(this.canvas),e.setElementPointerEventsNone(this.container),this.addHandler("reset-size",function(){_.viewport&&_.viewport.goHome(!0)}),E.world.addHandler("item-index-change",function(U){window.setTimeout(function(){var $=_.world.getItemAt(U.previousIndex);_.world.setItemIndex($,U.newIndex)},1)}),E.world.addHandler("remove-item",function(U){var $=U.item,P=_._getMatchingItem($);P&&_.world.removeItem(P)}),this.update(E.viewport)},e.extend(e.Navigator.prototype,e.EventSource.prototype,e.Viewer.prototype,{updateSize:function(){if(this.viewport){var v=new e.Point(this.container.clientWidth===0?1:this.container.clientWidth,this.container.clientHeight===0?1:this.container.clientHeight);v.equals(this.oldContainerSize)||(this.viewport.resize(v,!0),this.viewport.goHome(!0),this.oldContainerSize=v,this.drawer.clear(),this.world.draw())}},setWidth:function(v){this.width=v,this.element.style.width=typeof v=="number"?v+"px":v,this._resizeWithViewer=!1},setHeight:function(v){this.height=v,this.element.style.height=typeof v=="number"?v+"px":v,this._resizeWithViewer=!1},setFlip:function(v){return this.viewport.setFlip(v),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(v){g(this.displayRegion,v),g(this.canvas,v),g(this.element,v)},update:function(v){var E,_,C,k,I,X;if(E=e.getElementSize(this.viewer.element),this._resizeWithViewer&&E.x&&E.y&&!E.equals(this.oldViewerSize)&&(this.oldViewerSize=E,this.maintainSizeRatio||!this.elementArea?(_=E.x*this.sizeRatio,C=E.y*this.sizeRatio):(_=Math.sqrt(this.elementArea*(E.x/E.y)),C=this.elementArea/_),this.element.style.width=Math.round(_)+"px",this.element.style.height=Math.round(C)+"px",this.elementArea||(this.elementArea=_*C),this.updateSize()),v&&this.viewport){k=v.getBoundsNoRotate(!0),I=this.viewport.pixelFromPointNoRotate(k.getTopLeft(),!1),X=this.viewport.pixelFromPointNoRotate(k.getBottomRight(),!1).minus(this.totalBorderWidths);var U=this.displayRegion.style;U.display=this.world.getItemCount()?"block":"none",U.top=Math.round(I.y)+"px",U.left=Math.round(I.x)+"px";var $=Math.abs(I.x-X.x),P=Math.abs(I.y-X.y);U.width=Math.round(Math.max($,0))+"px",U.height=Math.round(Math.max(P,0))+"px"}},addTiledImage:function(v){var E=this,_=v.originalTiledImage;delete v.original;var C=e.extend({},v,{success:function(k){var I=k.item;I._originalForNavigator=_,E._matchBounds(I,_,!0),E._matchOpacity(I,_),E._matchCompositeOperation(I,_);function X(){E._matchBounds(I,_)}function U(){E._matchOpacity(I,_)}function $(){E._matchCompositeOperation(I,_)}_.addHandler("bounds-change",X),_.addHandler("clip-change",X),_.addHandler("opacity-change",U),_.addHandler("composite-operation-change",$)}});return e.Viewer.prototype.addTiledImage.apply(this,[C])},destroy:function(){return e.Viewer.prototype.destroy.apply(this)},_getMatchingItem:function(v){for(var E=this.world.getItemCount(),_,C=0;C<E;C++)if(_=this.world.getItemAt(C),_._originalForNavigator===v)return _;return null},_matchBounds:function(v,E,_){var C=E.getBoundsNoRotate();v.setPosition(C.getTopLeft(),_),v.setWidth(C.width,_),v.setRotation(E.getRotation(),_),v.setClip(E.getClip()),v.setFlip(E.getFlip())},_matchOpacity:function(v,E){v.setOpacity(E.opacity)},_matchCompositeOperation:function(v,E){v.setCompositeOperation(E.compositeOperation)}});function n(v){var E={tracker:v.eventSource,position:v.position,quick:v.quick,shift:v.shift,originalEvent:v.originalEvent,preventDefaultAction:!1};if(this.viewer.raiseEvent("navigator-click",E),!E.preventDefaultAction&&v.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(v.position.x=this.viewport.getContainerSize().x-v.position.x);var _=this.viewport.pointFromPixel(v.position);this.panVertical?this.panHorizontal||(_.x=this.viewer.viewport.getCenter(!0).x):_.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(_),this.viewer.viewport.applyConstraints()}}function o(v){var E={tracker:v.eventSource,position:v.position,delta:v.delta,speed:v.speed,direction:v.direction,shift:v.shift,originalEvent:v.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-drag",E),!E.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(v.delta.x=0),this.panVertical||(v.delta.y=0),this.viewer.viewport.flipped&&(v.delta.x=-v.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(v.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function l(v){v.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function h(v){var E={tracker:v.eventSource,position:v.position,scroll:v.scroll,shift:v.shift,originalEvent:v.originalEvent,preventDefault:v.preventDefault};this.viewer.raiseEvent("navigator-scroll",E),v.preventDefault=E.preventDefault}function f(v,E){g(v,"rotate("+E+"deg)")}function g(v,E){v.style.webkitTransform=E,v.style.mozTransform=E,v.style.msTransform=E,v.style.oTransform=E,v.style.transform=E}}(r),function(e){var n={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};e.extend(e,{getString:function(o){var l=o.split("."),h=null,f=arguments,g=n,v;for(v=0;v<l.length-1;v++)g=g[l[v]]||{};return h=g[l[v]],typeof h!="string"&&(e.console.log("Untranslated source string:",o),h=""),h.replace(/\{\d+\}/g,function(E){var _=parseInt(E.match(/\d+/),10)+1;return _<f.length?f[_]:""})},setString:function(o,l){var h=o.split("."),f=n,g;for(g=0;g<h.length-1;g++)f[h[g]]||(f[h[g]]={}),f=f[h[g]];f[h[g]]=l}})}(r),function(e){e.Point=function(n,o){this.x=typeof n=="number"?n:0,this.y=typeof o=="number"?o:0},e.Point.prototype={clone:function(){return new e.Point(this.x,this.y)},plus:function(n){return new e.Point(this.x+n.x,this.y+n.y)},minus:function(n){return new e.Point(this.x-n.x,this.y-n.y)},times:function(n){return new e.Point(this.x*n,this.y*n)},divide:function(n){return new e.Point(this.x/n,this.y/n)},negate:function(){return new e.Point(-this.x,-this.y)},distanceTo:function(n){return Math.sqrt(Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2))},squaredDistanceTo:function(n){return Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2)},apply:function(n){return new e.Point(n(this.x),n(this.y))},equals:function(n){return n instanceof e.Point&&this.x===n.x&&this.y===n.y},rotate:function(n,o){o=o||new e.Point(0,0);var l,h;if(n%90===0){var f=e.positiveModulo(n,360);switch(f){case 0:l=1,h=0;break;case 90:l=0,h=1;break;case 180:l=-1,h=0;break;case 270:l=0,h=-1;break}}else{var g=n*Math.PI/180;l=Math.cos(g),h=Math.sin(g)}var v=l*(this.x-o.x)-h*(this.y-o.y)+o.x,E=h*(this.x-o.x)+l*(this.y-o.y)+o.y;return new e.Point(v,E)},toString:function(){return"("+Math.round(this.x*100)/100+","+Math.round(this.y*100)/100+")"}}}(r),function(e){e.TileSource=function(o,l,h,f,g,v){var E=this,_=arguments,C,k;if(e.isPlainObject(o)?C=o:C={width:_[0],height:_[1],tileSize:_[2],tileOverlap:_[3],minLevel:_[4],maxLevel:_[5]},e.EventSource.call(this),e.extend(!0,this,C),!this.success){for(k=0;k<arguments.length;k++)if(e.isFunction(arguments[k])){this.success=arguments[k];break}}this.success&&this.addHandler("ready",function(I){E.success(I)}),e.type(arguments[0])==="string"&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new e.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=C.width&&C.height?C.width/C.height:1,this.dimensions=new e.Point(C.width,C.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=C.tileOverlap?C.tileOverlap:0,this.minLevel=C.minLevel?C.minLevel:0,this.maxLevel=C.maxLevel!==void 0&&C.maxLevel!==null?C.maxLevel:C.width&&C.height?Math.ceil(Math.log(Math.max(C.width,C.height))/Math.log(2)):0,this.success&&e.isFunction(this.success)&&this.success(this))},e.TileSource.prototype={getTileSize:function(o){return e.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(o){return this._tileWidth?this._tileWidth:this.getTileSize(o)},getTileHeight:function(o){return this._tileHeight?this._tileHeight:this.getTileSize(o)},setMaxLevel:function(o){this.maxLevel=o,this._memoizeLevelScale()},getLevelScale:function(o){return this._memoizeLevelScale(),this.getLevelScale(o)},_memoizeLevelScale:function(){var o={},l;for(l=0;l<=this.maxLevel;l++)o[l]=1/Math.pow(2,this.maxLevel-l);this.getLevelScale=function(h){return o[h]}},getNumTiles:function(o){var l=this.getLevelScale(o),h=Math.ceil(l*this.dimensions.x/this.getTileWidth(o)),f=Math.ceil(l*this.dimensions.y/this.getTileHeight(o));return new e.Point(h,f)},getPixelRatio:function(o){var l=this.dimensions.times(this.getLevelScale(o)),h=1/l.x*e.pixelDensityRatio,f=1/l.y*e.pixelDensityRatio;return new e.Point(h,f)},getClosestLevel:function(){var o,l;for(o=this.minLevel+1;o<=this.maxLevel&&(l=this.getNumTiles(o),!(l.x>1||l.y>1));o++);return o-1},getTileAtPoint:function(o,l){var h=l.x>=0&&l.x<=1&&l.y>=0&&l.y<=1/this.aspectRatio;e.console.assert(h,"[TileSource.getTileAtPoint] must be called with a valid point.");var f=this.dimensions.x*this.getLevelScale(o),g=l.x*f,v=l.y*f,E=Math.floor(g/this.getTileWidth(o)),_=Math.floor(v/this.getTileHeight(o));l.x>=1&&(E=this.getNumTiles(o).x-1);var C=1e-15;return l.y>=1/this.aspectRatio-C&&(_=this.getNumTiles(o).y-1),new e.Point(E,_)},getTileBounds:function(o,l,h,f){var g=this.dimensions.times(this.getLevelScale(o)),v=this.getTileWidth(o),E=this.getTileHeight(o),_=l===0?0:v*l-this.tileOverlap,C=h===0?0:E*h-this.tileOverlap,k=v+(l===0?1:2)*this.tileOverlap,I=E+(h===0?1:2)*this.tileOverlap,X=1/g.x;return k=Math.min(k,g.x-_),I=Math.min(I,g.y-C),f?new e.Rect(0,0,k,I):new e.Rect(_*X,C*X,k*X,I*X)},getImageInfo:function(o){var l=this,h,f,g,v,E,_,C;o&&(E=o.split("/"),_=E[E.length-1],C=_.lastIndexOf("."),C>-1&&(E[E.length-1]=_.slice(0,C))),f=function(k){typeof k=="string"&&(k=e.parseXml(k));var I=e.TileSource.determineType(l,k,o);if(!I){l.raiseEvent("open-failed",{message:"Unable to load TileSource",source:o});return}v=I.prototype.configure.apply(l,[k,o]),v.ajaxWithCredentials===void 0&&(v.ajaxWithCredentials=l.ajaxWithCredentials),g=new I(v),l.ready=!0,l.raiseEvent("ready",{tileSource:g})},o.match(/\.js$/)?(h=o.split("/").pop().replace(".js",""),e.jsonp({url:o,async:!1,callbackName:h,callback:f})):e.makeAjaxRequest({url:o,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(k){var I=n(k);f(I)},error:function(k,I){var X;try{X="HTTP "+k.status+" attempting to load TileSource"}catch{var U;typeof I>"u"||!I.toString?U="Unknown error":U=I.toString(),X=U+" attempting to load TileSource"}l.raiseEvent("open-failed",{message:X,source:o})}})},supports:function(o,l){return!1},configure:function(o,l){throw new Error("Method not implemented.")},getTileUrl:function(o,l,h){throw new Error("Method not implemented.")},getTileAjaxHeaders:function(o,l,h){return{}},tileExists:function(o,l,h){var f=this.getNumTiles(o);return o>=this.minLevel&&o<=this.maxLevel&&l>=0&&h>=0&&l<f.x&&h<f.y}},e.extend(!0,e.TileSource.prototype,e.EventSource.prototype);function n(o){var l=o.responseText,h=o.status,f,g;if(o){if(o.status!==200&&o.status!==0)throw h=o.status,f=h===404?"Not Found":o.statusText,new Error(e.getString("Errors.Status",h,f))}else throw new Error(e.getString("Errors.Security"));if(l.match(/\s*<.*/))try{g=o.responseXML&&o.responseXML.documentElement?o.responseXML:e.parseXml(l)}catch{g=o.responseText}else if(l.match(/\s*[{[].*/))try{g=e.parseJSON(l)}catch{g=l}else g=l;return g}e.TileSource.determineType=function(o,l,h){var f;for(f in r)if(f.match(/.+TileSource$/)&&e.isFunction(r[f])&&e.isFunction(r[f].prototype.supports)&&r[f].prototype.supports.call(o,l,h))return r[f];return e.console.error("No TileSource was able to open %s %s",h,l),null}}(r),function(e){e.DziTileSource=function(l,h,f,g,v,E,_,C,k){var I,X,U,$;if(e.isPlainObject(l)?$=l:$={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=$.tilesUrl,this.fileFormat=$.fileFormat,this.displayRects=$.displayRects,this.displayRects)for(I=this.displayRects.length-1;I>=0;I--)for(X=this.displayRects[I],U=X.minLevel;U<=X.maxLevel;U++)this._levelRects[U]||(this._levelRects[U]=[]),this._levelRects[U].push(X);e.TileSource.apply(this,[$])},e.extend(e.DziTileSource.prototype,e.TileSource.prototype,{supports:function(l,h){var f;return l.Image?f=l.Image.xmlns:l.documentElement&&(l.documentElement.localName==="Image"||l.documentElement.tagName==="Image")&&(f=l.documentElement.namespaceURI),f=(f||"").toLowerCase(),f.indexOf("schemas.microsoft.com/deepzoom/2008")!==-1||f.indexOf("schemas.microsoft.com/deepzoom/2009")!==-1},configure:function(l,h){var f;return e.isPlainObject(l)?f=o(this,l):f=n(this,l),h&&!f.tilesUrl&&(f.tilesUrl=h.replace(/([^/]+?)(\.(dzi|xml|js)?(\?[^/]*)?)?\/?$/,"$1_files/"),h.search(/\.(dzi|xml|js)\?/)!==-1?f.queryParams=h.match(/\?.*/):f.queryParams=""),f},getTileUrl:function(l,h,f){return[this.tilesUrl,l,"/",h,"_",f,".",this.fileFormat,this.queryParams].join("")},tileExists:function(l,h,f){var g=this._levelRects[l],v,E,_,C,k,I,X;if(this.minLevel&&l<this.minLevel||this.maxLevel&&l>this.maxLevel)return!1;if(!g||!g.length)return!0;for(X=g.length-1;X>=0;X--)if(v=g[X],!(l<v.minLevel||l>v.maxLevel)&&(E=this.getLevelScale(l),_=v.x*E,C=v.y*E,k=_+v.width*E,I=C+v.height*E,_=Math.floor(_/this._tileWidth),C=Math.floor(C/this._tileWidth),k=Math.ceil(k/this._tileWidth),I=Math.ceil(I/this._tileWidth),_<=h&&h<k&&C<=f&&f<I))return!0;return!1}});function n(l,h){if(!h||!h.documentElement)throw new Error(e.getString("Errors.Xml"));var f=h.documentElement,g=f.localName||f.tagName,v=h.documentElement.namespaceURI,E=null,_=[],C,k,I,X,U;if(g==="Image")try{if(X=f.getElementsByTagName("Size")[0],X===void 0&&(X=f.getElementsByTagNameNS(v,"Size")[0]),E={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:f.getAttribute("Url"),Format:f.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(f.getAttribute("Overlap"),10),TileSize:parseInt(f.getAttribute("TileSize"),10),Size:{Height:parseInt(X.getAttribute("Height"),10),Width:parseInt(X.getAttribute("Width"),10)}}},!e.imageFormatSupported(E.Image.Format))throw new Error(e.getString("Errors.ImageFormat",E.Image.Format.toUpperCase()));for(C=f.getElementsByTagName("DisplayRect"),C===void 0&&(C=f.getElementsByTagNameNS(v,"DisplayRect")[0]),U=0;U<C.length;U++)k=C[U],I=k.getElementsByTagName("Rect")[0],I===void 0&&(I=k.getElementsByTagNameNS(v,"Rect")[0]),_.push({Rect:{X:parseInt(I.getAttribute("X"),10),Y:parseInt(I.getAttribute("Y"),10),Width:parseInt(I.getAttribute("Width"),10),Height:parseInt(I.getAttribute("Height"),10),MinLevel:parseInt(k.getAttribute("MinLevel"),10),MaxLevel:parseInt(k.getAttribute("MaxLevel"),10)}});return _.length&&(E.Image.DisplayRect=_),o(l,E)}catch(N){throw N instanceof Error?N:new Error(e.getString("Errors.Dzi"))}else{if(g==="Collection")throw new Error(e.getString("Errors.Dzc"));if(g==="Error"){var $=f.getElementsByTagName("Message")[0],P=$.firstChild.nodeValue;throw new Error(P)}}throw new Error(e.getString("Errors.Dzi"))}function o(l,h){var f=h.Image,g=f.Url,v=f.Format,E=f.Size,_=f.DisplayRect||[],C=parseInt(E.Width,10),k=parseInt(E.Height,10),I=parseInt(f.TileSize,10),X=parseInt(f.Overlap,10),U=[],$,P;for(P=0;P<_.length;P++)$=_[P].Rect,U.push(new e.DisplayRect(parseInt($.X,10),parseInt($.Y,10),parseInt($.Width,10),parseInt($.Height,10),parseInt($.MinLevel,10),parseInt($.MaxLevel,10)));return e.extend(!0,{width:C,height:k,tileSize:I,tileOverlap:X,minLevel:null,maxLevel:null,tilesUrl:g,fileFormat:v,displayRects:U},h)}}(r),function(e){e.IIIFTileSource=function(f){if(e.extend(!0,this,f),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(f.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=f.version,this.tile_width&&this.tile_height)f.tileWidth=this.tile_width,f.tileHeight=this.tile_height;else if(this.tile_width)f.tileSize=this.tile_width;else if(this.tile_height)f.tileSize=this.tile_height;else if(this.tiles)if(this.tiles.length===1)f.tileWidth=this.tiles[0].width,f.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var g=0;g<this.tiles.length;g++)for(var v=0;v<this.tiles[g].scaleFactors.length;v++){var E=this.tiles[g].scaleFactors[v];this.scale_factors.push(E),f.tileSizePerScaleFactor[E]={width:this.tiles[g].width,height:this.tiles[g].height||this.tiles[g].width}}}else if(n(f)){for(var _=Math.min(this.height,this.width),C=[256,512,1024],k=[],I=0;I<C.length;I++)C[I]<=_&&k.push(C[I]);k.length>0?f.tileSize=Math.max.apply(null,k):f.tileSize=_}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,f.levels=o(this),e.extend(!0,f,{width:f.levels[f.levels.length-1].width,height:f.levels[f.levels.length-1].height,tileSize:Math.max(f.height,f.width),tileOverlap:0,minLevel:0,maxLevel:f.levels.length-1}),this.levels=f.levels):e.console.error("Nothing in the info.json to construct image pyramids from");if(!f.maxLevel&&!this.emulateLegacyImagePyramid)if(!this.scale_factors)f.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)));else{var X=Math.max.apply(null,this.scale_factors);f.maxLevel=Math.round(Math.log(X)*Math.LOG2E)}e.TileSource.apply(this,[f])},e.extend(e.IIIFTileSource.prototype,e.TileSource.prototype,{supports:function(f,g){return f.protocol&&f.protocol==="http://iiif.io/api/image"||f["@context"]&&(f["@context"]==="http://library.stanford.edu/iiif/image-api/1.1/context.json"||f["@context"]==="http://iiif.io/api/image/1/context.json")||f.profile&&f.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")===0||f.identifier&&f.width&&f.height?!0:!!(f.documentElement&&f.documentElement.tagName==="info"&&f.documentElement.namespaceURI==="http://library.stanford.edu/iiif/image-api/ns/")},configure:function(f,g){if(e.isPlainObject(f)){if(!f["@context"])f["@context"]="http://iiif.io/api/image/1.0/context.json",f["@id"]=g.replace("/info.json",""),f.version=1;else{var v=f["@context"];if(Array.isArray(v)){for(var E=0;E<v.length;E++)if(typeof v[E]=="string"&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(v[E])||v[E]==="http://library.stanford.edu/iiif/image-api/1.1/context.json")){v=v[E];break}}switch(v){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":f.version=1;break;case"http://iiif.io/api/image/2/context.json":f.version=2;break;case"http://iiif.io/api/image/3/context.json":f.version=3;break;default:e.console.error("Data has a @context property which contains no known IIIF context URI.")}}if(!f["@id"]&&f.id&&(f["@id"]=f.id),f.preferredFormats){for(var _=0;_<f.preferredFormats.length;_++)if(r.imageFormatSupported(f.preferredFormats[_])){f.tileFormat=f.preferredFormats[_];break}}return f}else{var C=l(f);return C["@context"]="http://iiif.io/api/image/1.0/context.json",C["@id"]=g.replace("/info.xml",""),C.version=1,C}},getTileWidth:function(f){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileWidth.call(this,f);var g=Math.pow(2,this.maxLevel-f);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[g]?this.tileSizePerScaleFactor[g].width:this._tileWidth},getTileHeight:function(f){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileHeight.call(this,f);var g=Math.pow(2,this.maxLevel-f);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[g]?this.tileSizePerScaleFactor[g].height:this._tileHeight},getLevelScale:function(f){if(this.emulateLegacyImagePyramid){var g=NaN;return this.levels.length>0&&f>=this.minLevel&&f<=this.maxLevel&&(g=this.levels[f].width/this.levels[this.maxLevel].width),g}return e.TileSource.prototype.getLevelScale.call(this,f)},getNumTiles:function(f){if(this.emulateLegacyImagePyramid){var g=this.getLevelScale(f);return g?new e.Point(1,1):new e.Point(0,0)}return e.TileSource.prototype.getNumTiles.call(this,f)},getTileAtPoint:function(f,g){return this.emulateLegacyImagePyramid?new e.Point(0,0):e.TileSource.prototype.getTileAtPoint.call(this,f,g)},getTileUrl:function(f,g,v){if(this.emulateLegacyImagePyramid){var E=null;return this.levels.length>0&&f>=this.minLevel&&f<=this.maxLevel&&(E=this.levels[f].url),E}var _="0",C=Math.pow(.5,this.maxLevel-f),k=Math.ceil(this.width*C),I=Math.ceil(this.height*C),X,U,$,P,N,J,K,oe,ie,me,we,De,Be,Oe;return X=this.getTileWidth(f),U=this.getTileHeight(f),$=Math.ceil(X/C),P=Math.ceil(U/C),this.version===1?Be="native."+this.tileFormat:Be="default."+this.tileFormat,k<X&&I<U?(this.version===2&&k===this.width?me="full":this.version===3&&k===this.width&&I===this.height?me="max":this.version===3?me=k+","+I:me=k+",",N="full"):(J=g*$,K=v*P,oe=Math.min($,this.width-J),ie=Math.min(P,this.height-K),g===0&&v===0&&oe===this.width&&ie===this.height?N="full":N=[J,K,oe,ie].join(","),we=Math.ceil(oe*C),De=Math.ceil(ie*C),this.version===2&&we===this.width?me="full":this.version===3&&we===this.width&&De===this.height?me="max":this.version===3?me=we+","+De:me=we+","),Oe=[this["@id"],N,me,_,Be].join("/"),Oe},__testonly__:{canBeTiled:n,constructLevels:o}});function n(f){var g=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"],v=Array.isArray(f.profile)?f.profile[0]:f.profile,E=g.indexOf(v)!==-1,_=!1;return f.version===2&&f.profile.length>1&&f.profile[1].supports&&(_=f.profile[1].supports.indexOf("sizeByW")!==-1),f.version===3&&f.extraFeatures&&(_=f.extraFeatures.indexOf("sizeByWh")!==-1),!E||_}function o(f){for(var g=[],v=0;v<f.sizes.length;v++)g.push({url:f["@id"]+"/full/"+f.sizes[v].width+","+(f.version===3?f.sizes[v].height:"")+"/0/default."+f.tileFormat,width:f.sizes[v].width,height:f.sizes[v].height});return g.sort(function(E,_){return E.width-_.width})}function l(f){if(!f||!f.documentElement)throw new Error(e.getString("Errors.Xml"));var g=f.documentElement,v=g.tagName,E=null;if(v==="info")try{return E={},h(g,E),E}catch(_){throw _ instanceof Error?_:new Error(e.getString("Errors.IIIF"))}throw new Error(e.getString("Errors.IIIF"))}function h(f,g,v){var E,_;if(f.nodeType===3&&v)_=f.nodeValue.trim(),_.match(/^\d*$/)&&(_=Number(_)),g[v]?(e.isArray(g[v])||(g[v]=[g[v]]),g[v].push(_)):g[v]=_;else if(f.nodeType===1)for(E=0;E<f.childNodes.length;E++)h(f.childNodes[E],g,f.nodeName)}}(r),function(e){e.OsmTileSource=function(n,o,l,h,f){var g;e.isPlainObject(n)?g=n:g={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},(!g.width||!g.height)&&(g.width=65572864,g.height=65572864),g.tileSize||(g.tileSize=256,g.tileOverlap=0),g.tilesUrl||(g.tilesUrl="http://tile.openstreetmap.org/"),g.minLevel=8,e.TileSource.apply(this,[g])},e.extend(e.OsmTileSource.prototype,e.TileSource.prototype,{supports:function(n,o){return n.type&&n.type==="openstreetmaps"},configure:function(n,o){return n},getTileUrl:function(n,o,l){return this.tilesUrl+(n-8)+"/"+o+"/"+l+".png"}})}(r),function(e){e.TmsTileSource=function(n,o,l,h,f){var g;e.isPlainObject(n)?g=n:g={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var v=Math.ceil(g.width/256)*256,E=Math.ceil(g.height/256)*256,_;v>E?_=v/256:_=E/256,g.maxLevel=Math.ceil(Math.log(_)/Math.log(2))-1,g.tileSize=256,g.width=v,g.height=E,e.TileSource.apply(this,[g])},e.extend(e.TmsTileSource.prototype,e.TileSource.prototype,{supports:function(n,o){return n.type&&n.type==="tiledmapservice"},configure:function(n,o){return n},getTileUrl:function(n,o,l){var h=this.getNumTiles(n).y-1;return this.tilesUrl+n+"/"+o+"/"+(h-l)+".png"}})}(r),function(e){e.ZoomifyTileSource=function(n){typeof n.tileSize>"u"&&(n.tileSize=256),typeof n.fileFormat>"u"&&(n.fileFormat="jpg",this.fileFormat=n.fileFormat);var o={x:n.width,y:n.height};for(n.imageSizes=[{x:n.width,y:n.height}],n.gridSize=[this._getGridSize(n.width,n.height,n.tileSize)];parseInt(o.x,10)>n.tileSize||parseInt(o.y,10)>n.tileSize;)o.x=Math.floor(o.x/2),o.y=Math.floor(o.y/2),n.imageSizes.push({x:o.x,y:o.y}),n.gridSize.push(this._getGridSize(o.x,o.y,n.tileSize));n.imageSizes.reverse(),n.gridSize.reverse(),n.minLevel=0,n.maxLevel=n.gridSize.length-1,r.TileSource.apply(this,[n])},e.extend(e.ZoomifyTileSource.prototype,e.TileSource.prototype,{_getGridSize:function(n,o,l){return{x:Math.ceil(n/l),y:Math.ceil(o/l)}},_calculateAbsoluteTileNumber:function(n,o,l){for(var h=0,f={},g=0;g<n;g++)f=this.gridSize[g],h+=f.x*f.y;return f=this.gridSize[n],h+=f.x*l+o,h},supports:function(n,o){return n.type&&n.type==="zoomifytileservice"},configure:function(n,o){return n},getTileUrl:function(n,o,l){var h=0,f=this._calculateAbsoluteTileNumber(n,o,l);return h=Math.floor(f/256),this.tilesUrl+"TileGroup"+h+"/"+n+"-"+o+"-"+l+"."+this.fileFormat}})}(r),function(e){e.LegacyTileSource=function(h){var f,g,v;e.isArray(h)&&(f={type:"legacy-image-pyramid",levels:h}),f.levels=n(f.levels),f.levels.length>0?(g=f.levels[f.levels.length-1].width,v=f.levels[f.levels.length-1].height):(g=0,v=0,e.console.error("No supported image formats found")),e.extend(!0,f,{width:g,height:v,tileSize:Math.max(v,g),tileOverlap:0,minLevel:0,maxLevel:f.levels.length>0?f.levels.length-1:0}),e.TileSource.apply(this,[f]),this.levels=f.levels},e.extend(e.LegacyTileSource.prototype,e.TileSource.prototype,{supports:function(h,f){return h.type&&h.type==="legacy-image-pyramid"||h.documentElement&&h.documentElement.getAttribute("type")==="legacy-image-pyramid"},configure:function(h,f){var g;return e.isPlainObject(h)?g=l(this,h):g=o(this,h),g},getLevelScale:function(h){var f=NaN;return this.levels.length>0&&h>=this.minLevel&&h<=this.maxLevel&&(f=this.levels[h].width/this.levels[this.maxLevel].width),f},getNumTiles:function(h){var f=this.getLevelScale(h);return f?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(h,f,g){var v=null;return this.levels.length>0&&h>=this.minLevel&&h<=this.maxLevel&&(v=this.levels[h].url),v}});function n(h){var f=[],g,v;for(v=0;v<h.length;v++)g=h[v],g.height&&g.width&&g.url?f.push({url:g.url,width:Number(g.width),height:Number(g.height)}):e.console.error("Unsupported image format: %s",g.url?g.url:"<no URL>");return f.sort(function(E,_){return E.height-_.height})}function o(h,f){if(!f||!f.documentElement)throw new Error(e.getString("Errors.Xml"));var g=f.documentElement,v=g.tagName,E=null,_=[],C,k;if(v==="image")try{for(E={type:g.getAttribute("type"),levels:[]},_=g.getElementsByTagName("level"),k=0;k<_.length;k++)C=_[k],E.levels.push({url:C.getAttribute("url"),width:parseInt(C.getAttribute("width"),10),height:parseInt(C.getAttribute("height"),10)});return l(h,E)}catch(I){throw I instanceof Error?I:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if(v==="collection")throw new Error("Legacy Image Pyramid Collections not yet supported.");if(v==="error")throw new Error("Error: "+f)}throw new Error("Unknown element "+v)}function l(h,f){return f.levels}}(r),function(e){e.ImageTileSource=function(n){n=e.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},n),e.TileSource.apply(this,[n])},e.extend(e.ImageTileSource.prototype,e.TileSource.prototype,{supports:function(n,o){return n.type&&n.type==="image"},configure:function(n,o){return n},getImageInfo:function(n){var o=this._image=new Image,l=this;this.crossOriginPolicy&&(o.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(o.useCredentials=this.ajaxWithCredentials),e.addEvent(o,"load",function(){l.width=o.naturalWidth,l.height=o.naturalHeight,l.aspectRatio=l.width/l.height,l.dimensions=new e.Point(l.width,l.height),l._tileWidth=l.width,l._tileHeight=l.height,l.tileOverlap=0,l.minLevel=0,l.levels=l._buildLevels(),l.maxLevel=l.levels.length-1,l.ready=!0,l.raiseEvent("ready",{tileSource:l})}),e.addEvent(o,"error",function(){l.raiseEvent("open-failed",{message:"Error loading image at "+n,source:n})}),o.src=n},getLevelScale:function(n){var o=NaN;return n>=this.minLevel&&n<=this.maxLevel&&(o=this.levels[n].width/this.levels[this.maxLevel].width),o},getNumTiles:function(n){var o=this.getLevelScale(n);return o?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(n,o,l){var h=null;return n>=this.minLevel&&n<=this.maxLevel&&(h=this.levels[n].url),h},getContext2D:function(n,o,l){var h=null;return n>=this.minLevel&&n<=this.maxLevel&&(h=this.levels[n].context2D),h},destroy:function(){this._freeupCanvasMemory()},_buildLevels:function(){var n=[{url:this._image.src,width:this._image.naturalWidth,height:this._image.naturalHeight}];if(!this.buildPyramid||!e.supportsCanvas||!this.useCanvas)return delete this._image,n;var o=this._image.naturalWidth,l=this._image.naturalHeight,h=document.createElement("canvas"),f=h.getContext("2d");if(h.width=o,h.height=l,f.drawImage(this._image,0,0,o,l),n[0].context2D=f,delete this._image,e.isCanvasTainted(h))return n;for(;o>=2&&l>=2;){o=Math.floor(o/2),l=Math.floor(l/2);var g=document.createElement("canvas"),v=g.getContext("2d");g.width=o,g.height=l,v.drawImage(h,0,0,o,l),n.splice(0,0,{context2D:v,width:o,height:l}),h=g,f=v}return n},_freeupCanvasMemory:function(){for(var n=0;n<this.levels.length;n++)this.levels[n].context2D.canvas.height=0,this.levels[n].context2D.canvas.width=0}})}(r),function(e){e.TileSourceCollection=function(n,o,l,h){e.console.error("TileSourceCollection is deprecated; use World instead")}}(r),function(e){e.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},e.Button=function(v){var E=this;e.EventSource.call(this),e.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null,userData:null},v),this.element=v.element||e.makeNeutralElement("div"),v.element||(this.imgRest=e.makeTransparentImage(this.srcRest),this.imgGroup=e.makeTransparentImage(this.srcGroup),this.imgHover=e.makeTransparentImage(this.srcHover),this.imgDown=e.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,e.setElementPointerEventsNone(this.imgRest),e.setElementPointerEventsNone(this.imgGroup),e.setElementPointerEventsNone(this.imgHover),e.setElementPointerEventsNone(this.imgDown),this.element.style.position="relative",e.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",e.Browser.vendor===e.BROWSERS.FIREFOX&&e.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=e.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new e.MouseTracker({userData:"Button.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(_){_.insideElementPressed?(f(E,e.ButtonState.DOWN),E.raiseEvent("enter",{originalEvent:_.originalEvent})):_.buttonDownAny||f(E,e.ButtonState.HOVER)},focusHandler:function(_){E.tracker.enterHandler(_),E.raiseEvent("focus",{originalEvent:_.originalEvent})},leaveHandler:function(_){g(E,e.ButtonState.GROUP),_.insideElementPressed&&E.raiseEvent("exit",{originalEvent:_.originalEvent})},blurHandler:function(_){E.tracker.leaveHandler(_),E.raiseEvent("blur",{originalEvent:_.originalEvent})},pressHandler:function(_){f(E,e.ButtonState.DOWN),E.raiseEvent("press",{originalEvent:_.originalEvent})},releaseHandler:function(_){_.insideElementPressed&&_.insideElementReleased?(g(E,e.ButtonState.HOVER),E.raiseEvent("release",{originalEvent:_.originalEvent})):_.insideElementPressed?g(E,e.ButtonState.GROUP):f(E,e.ButtonState.HOVER)},clickHandler:function(_){_.quick&&E.raiseEvent("click",{originalEvent:_.originalEvent})},keyHandler:function(_){_.keyCode===13?(E.raiseEvent("click",{originalEvent:_.originalEvent}),E.raiseEvent("release",{originalEvent:_.originalEvent}),_.preventDefault=!0):_.preventDefault=!1}}),g(this,e.ButtonState.REST)},e.extend(e.Button.prototype,e.EventSource.prototype,{notifyGroupEnter:function(){f(this,e.ButtonState.GROUP)},notifyGroupExit:function(){g(this,e.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,e.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,e.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()},destroy:function(){this.imgRest&&(this.element.removeChild(this.imgRest),this.imgRest=null),this.imgGroup&&(this.element.removeChild(this.imgGroup),this.imgGroup=null),this.imgHover&&(this.element.removeChild(this.imgHover),this.imgHover=null),this.imgDown&&(this.element.removeChild(this.imgDown),this.imgDown=null),this.removeAllHandlers(),this.tracker.destroy(),this.element=null}});function n(v){e.requestAnimationFrame(function(){o(v)})}function o(v){var E,_,C;v.shouldFade&&(E=e.now(),_=E-v.fadeBeginTime,C=1-_/v.fadeLength,C=Math.min(1,C),C=Math.max(0,C),v.imgGroup&&e.setElementOpacity(v.imgGroup,C,!0),C>0&&n(v))}function l(v){v.shouldFade=!0,v.fadeBeginTime=e.now()+v.fadeDelay,window.setTimeout(function(){n(v)},v.fadeDelay)}function h(v){v.shouldFade=!1,v.imgGroup&&e.setElementOpacity(v.imgGroup,1,!0)}function f(v,E){v.element.disabled||(E>=e.ButtonState.GROUP&&v.currentState===e.ButtonState.REST&&(h(v),v.currentState=e.ButtonState.GROUP),E>=e.ButtonState.HOVER&&v.currentState===e.ButtonState.GROUP&&(v.imgHover&&(v.imgHover.style.visibility=""),v.currentState=e.ButtonState.HOVER),E>=e.ButtonState.DOWN&&v.currentState===e.ButtonState.HOVER&&(v.imgDown&&(v.imgDown.style.visibility=""),v.currentState=e.ButtonState.DOWN))}function g(v,E){v.element.disabled||(E<=e.ButtonState.HOVER&&v.currentState===e.ButtonState.DOWN&&(v.imgDown&&(v.imgDown.style.visibility="hidden"),v.currentState=e.ButtonState.HOVER),E<=e.ButtonState.GROUP&&v.currentState===e.ButtonState.HOVER&&(v.imgHover&&(v.imgHover.style.visibility="hidden"),v.currentState=e.ButtonState.GROUP),E<=e.ButtonState.REST&&v.currentState===e.ButtonState.GROUP&&(l(v),v.currentState=e.ButtonState.REST))}}(r),function(e){e.ButtonGroup=function(n){e.extend(!0,this,{buttons:[],clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},n);var o=this.buttons.concat([]),l=this,h;if(this.element=n.element||e.makeNeutralElement("div"),!n.group)for(this.element.style.display="inline-block",h=0;h<o.length;h++)this.element.appendChild(o[h].element);e.setElementTouchActionNone(this.element),this.tracker=new e.MouseTracker({userData:"ButtonGroup.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(f){var g;for(g=0;g<l.buttons.length;g++)l.buttons[g].notifyGroupEnter()},leaveHandler:function(f){var g;if(!f.insideElementPressed)for(g=0;g<l.buttons.length;g++)l.buttons[g].notifyGroupExit()}})},e.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateLeave:function(){this.tracker.leaveHandler({eventSource:this.tracker})},destroy:function(){for(;this.buttons.length;){var n=this.buttons.pop();this.element.removeChild(n.element),n.destroy()}this.tracker.destroy(),this.element=null}}}(r),function(e){e.Rect=function(n,o,l,h,f){this.x=typeof n=="number"?n:0,this.y=typeof o=="number"?o:0,this.width=typeof l=="number"?l:0,this.height=typeof h=="number"?h:0,this.degrees=typeof f=="number"?f:0,this.degrees=e.positiveModulo(this.degrees,360);var g,v;this.degrees>=270?(g=this.getTopRight(),this.x=g.x,this.y=g.y,v=this.height,this.height=this.width,this.width=v,this.degrees-=270):this.degrees>=180?(g=this.getBottomRight(),this.x=g.x,this.y=g.y,this.degrees-=180):this.degrees>=90&&(g=this.getBottomLeft(),this.x=g.x,this.y=g.y,v=this.height,this.height=this.width,this.width=v,this.degrees-=90)},e.Rect.fromSummits=function(n,o,l){var h=n.distanceTo(o),f=n.distanceTo(l),g=o.minus(n),v=Math.atan(g.y/g.x);return g.x<0?v+=Math.PI:g.y<0&&(v+=2*Math.PI),new e.Rect(n.x,n.y,h,f,v/Math.PI*180)},e.Rect.prototype={clone:function(){return new e.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new e.Point(this.x,this.y)},getBottomRight:function(){return new e.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new e.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new e.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new e.Point(this.width,this.height)},equals:function(n){return n instanceof e.Rect&&this.x===n.x&&this.y===n.y&&this.width===n.width&&this.height===n.height&&this.degrees===n.degrees},times:function(n){return new e.Rect(this.x*n,this.y*n,this.width*n,this.height*n,this.degrees)},translate:function(n){return new e.Rect(this.x+n.x,this.y+n.y,this.width,this.height,this.degrees)},union:function(n){var o=this.getBoundingBox(),l=n.getBoundingBox(),h=Math.min(o.x,l.x),f=Math.min(o.y,l.y),g=Math.max(o.x+o.width,l.x+l.width),v=Math.max(o.y+o.height,l.y+l.height);return new e.Rect(h,f,g-h,v-f)},intersection:function(n){var o=1e-10,l=[],h=this.getTopLeft();n.containsPoint(h,o)&&l.push(h);var f=this.getTopRight();n.containsPoint(f,o)&&l.push(f);var g=this.getBottomLeft();n.containsPoint(g,o)&&l.push(g);var v=this.getBottomRight();n.containsPoint(v,o)&&l.push(v);var E=n.getTopLeft();this.containsPoint(E,o)&&l.push(E);var _=n.getTopRight();this.containsPoint(_,o)&&l.push(_);var C=n.getBottomLeft();this.containsPoint(C,o)&&l.push(C);var k=n.getBottomRight();this.containsPoint(k,o)&&l.push(k);for(var I=this._getSegments(),X=n._getSegments(),U=0;U<I.length;U++)for(var $=I[U],P=0;P<X.length;P++){var N=X[P],J=K($[0],$[1],N[0],N[1]);J&&l.push(J)}function K(Oe,Ue,Ve,et){var $e=Ue.minus(Oe),lt=et.minus(Ve),dt=-lt.x*$e.y+$e.x*lt.y;if(dt===0)return null;var At=($e.x*(Oe.y-Ve.y)-$e.y*(Oe.x-Ve.x))/dt,Le=(lt.x*(Oe.y-Ve.y)-lt.y*(Oe.x-Ve.x))/dt;return-o<=At&&At<=1-o&&-o<=Le&&Le<=1-o?new e.Point(Oe.x+Le*$e.x,Oe.y+Le*$e.y):null}if(l.length===0)return null;for(var oe=l[0].x,ie=l[0].x,me=l[0].y,we=l[0].y,De=1;De<l.length;De++){var Be=l[De];Be.x<oe&&(oe=Be.x),Be.x>ie&&(ie=Be.x),Be.y<me&&(me=Be.y),Be.y>we&&(we=Be.y)}return new e.Rect(oe,me,ie-oe,we-me)},_getSegments:function(){var n=this.getTopLeft(),o=this.getTopRight(),l=this.getBottomLeft(),h=this.getBottomRight();return[[n,o],[o,h],[h,l],[l,n]]},rotate:function(n,o){if(n=e.positiveModulo(n,360),n===0)return this.clone();o=o||this.getCenter();var l=this.getTopLeft().rotate(n,o),h=this.getTopRight().rotate(n,o),f=h.minus(l);f=f.apply(function(v){var E=1e-15;return Math.abs(v)<E?0:v});var g=Math.atan(f.y/f.x);return f.x<0?g+=Math.PI:f.y<0&&(g+=2*Math.PI),new e.Rect(l.x,l.y,this.width,this.height,g/Math.PI*180)},getBoundingBox:function(){if(this.degrees===0)return this.clone();var n=this.getTopLeft(),o=this.getTopRight(),l=this.getBottomLeft(),h=this.getBottomRight(),f=Math.min(n.x,o.x,l.x,h.x),g=Math.max(n.x,o.x,l.x,h.x),v=Math.min(n.y,o.y,l.y,h.y),E=Math.max(n.y,o.y,l.y,h.y);return new e.Rect(f,v,g-f,E-v)},getIntegerBoundingBox:function(){var n=this.getBoundingBox(),o=Math.floor(n.x),l=Math.floor(n.y),h=Math.ceil(n.width+n.x-o),f=Math.ceil(n.height+n.y-l);return new e.Rect(o,l,h,f)},containsPoint:function(n,o){o=o||0;var l=this.getTopLeft(),h=this.getTopRight(),f=this.getBottomLeft(),g=h.minus(l),v=f.minus(l);return(n.x-l.x)*g.x+(n.y-l.y)*g.y>=-o&&(n.x-h.x)*g.x+(n.y-h.y)*g.y<=o&&(n.x-l.x)*v.x+(n.y-l.y)*v.y>=-o&&(n.x-f.x)*v.x+(n.y-f.y)*v.y<=o},toString:function(){return"["+Math.round(this.x*100)/100+", "+Math.round(this.y*100)/100+", "+Math.round(this.width*100)/100+"x"+Math.round(this.height*100)/100+", "+Math.round(this.degrees*100)/100+"deg]"}}}(r),function(e){var n={};e.ReferenceStrip=function(C){var k=this,I=C.viewer,X=e.getElementSize(I.element),U,$,P;for(C.id||(C.id="referencestrip-"+e.now(),this.element=e.makeNeutralElement("div"),this.element.id=C.id,this.element.className="referencestrip"),C=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.referenceStripSizeRatio,position:e.DEFAULT_SETTINGS.referenceStripPosition,scroll:e.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold},C,{element:this.element}),e.extend(this,C),n[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,this.element.tabIndex=0,$=this.element.style,$.marginTop="0px",$.marginRight="0px",$.marginBottom="0px",$.marginLeft="0px",$.left="0px",$.bottom="0px",$.border="0px",$.background="#000",$.position="relative",e.setElementTouchActionNone(this.element),e.setElementOpacity(this.element,.8),this.viewer=I,this.tracker=new e.MouseTracker({userData:"ReferenceStrip.tracker",element:this.element,clickHandler:e.delegate(this,o),dragHandler:e.delegate(this,l),scrollHandler:e.delegate(this,h),enterHandler:e.delegate(this,g),leaveHandler:e.delegate(this,v),keyDownHandler:e.delegate(this,E),keyHandler:e.delegate(this,_),preProcessEventHandler:function(N){N.eventType==="wheel"&&(N.preventDefault=!0)}}),C.width&&C.height?(this.element.style.width=C.width+"px",this.element.style.height=C.height+"px",I.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):C.scroll==="horizontal"?(this.element.style.width=X.x*C.sizeRatio*I.tileSources.length+12*I.tileSources.length+"px",this.element.style.height=X.y*C.sizeRatio+"px",I.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=X.y*C.sizeRatio*I.tileSources.length+12*I.tileSources.length+"px",this.element.style.width=X.x*C.sizeRatio+"px",I.addControl(this.element,{anchor:e.ControlAnchor.TOP_LEFT})),this.panelWidth=X.x*this.sizeRatio+8,this.panelHeight=X.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},P=0;P<I.tileSources.length;P++)U=e.makeNeutralElement("div"),U.id=this.element.id+"-"+P,U.style.width=k.panelWidth+"px",U.style.height=k.panelHeight+"px",U.style.display="inline",U.style.float="left",U.style.cssFloat="left",U.style.styleFloat="left",U.style.padding="2px",e.setElementTouchActionNone(U),e.setElementPointerEventsNone(U),this.element.appendChild(U),U.activePanel=!1,this.panels.push(U);f(this,this.scroll==="vertical"?X.y:X.x,0),this.setFocus(0)},e.ReferenceStrip.prototype={setFocus:function(C){var k=this.element.querySelector("#"+this.element.id+"-"+C),I=e.getElementSize(this.viewer.canvas),X=Number(this.element.style.width.replace("px","")),U=Number(this.element.style.height.replace("px","")),$=-Number(this.element.style.marginLeft.replace("px","")),P=-Number(this.element.style.marginTop.replace("px","")),N;this.currentSelected!==k&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=k,this.currentSelected.style.background="#999",this.scroll==="horizontal"?(N=Number(C)*(this.panelWidth+3),N>$+I.x-this.panelWidth?(N=Math.min(N,X-I.x),this.element.style.marginLeft=-N+"px",f(this,I.x,-N)):N<$&&(N=Math.max(0,N-I.x/2),this.element.style.marginLeft=-N+"px",f(this,I.x,-N))):(N=Number(C)*(this.panelHeight+3),N>P+I.y-this.panelHeight?(N=Math.min(N,U-I.y),this.element.style.marginTop=-N+"px",f(this,I.y,-N)):N<P&&(N=Math.max(0,N-I.y/2),this.element.style.marginTop=-N+"px",f(this,I.y,-N))),this.currentPage=C,g.call(this,{eventSource:this.tracker}))},update:function(){return n[this.id].animating?(e.console.log("image reference strip update"),!0):!1},destroy:function(){if(this.miniViewers)for(var C in this.miniViewers)this.miniViewers[C].destroy();this.tracker.destroy(),this.element&&this.viewer.removeControl(this.element)}};function o(C){if(C.quick){var k;this.scroll==="horizontal"?k=Math.floor(C.position.x/this.panelWidth):k=Math.floor(C.position.y/this.panelHeight),this.viewer.goToPage(k)}this.element.focus()}function l(C){if(this.dragging=!0,this.element){var k=Number(this.element.style.marginLeft.replace("px","")),I=Number(this.element.style.marginTop.replace("px","")),X=Number(this.element.style.width.replace("px","")),U=Number(this.element.style.height.replace("px","")),$=e.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?-C.delta.x>0?k>-(X-$.x)&&(this.element.style.marginLeft=k+C.delta.x*2+"px",f(this,$.x,k+C.delta.x*2)):-C.delta.x<0&&k<0&&(this.element.style.marginLeft=k+C.delta.x*2+"px",f(this,$.x,k+C.delta.x*2)):-C.delta.y>0?I>-(U-$.y)&&(this.element.style.marginTop=I+C.delta.y*2+"px",f(this,$.y,I+C.delta.y*2)):-C.delta.y<0&&I<0&&(this.element.style.marginTop=I+C.delta.y*2+"px",f(this,$.y,I+C.delta.y*2))}}function h(C){if(this.element){var k=Number(this.element.style.marginLeft.replace("px","")),I=Number(this.element.style.marginTop.replace("px","")),X=Number(this.element.style.width.replace("px","")),U=Number(this.element.style.height.replace("px","")),$=e.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?C.scroll>0?k>-(X-$.x)&&(this.element.style.marginLeft=k-C.scroll*60+"px",f(this,$.x,k-C.scroll*60)):C.scroll<0&&k<0&&(this.element.style.marginLeft=k-C.scroll*60+"px",f(this,$.x,k-C.scroll*60)):C.scroll<0?I>$.y-U&&(this.element.style.marginTop=I+C.scroll*60+"px",f(this,$.y,I+C.scroll*60)):C.scroll>0&&I<0&&(this.element.style.marginTop=I+C.scroll*60+"px",f(this,$.y,I+C.scroll*60)),C.preventDefault=!0}}function f(C,k,I){var X,U,$,P,N,J;for(C.scroll==="horizontal"?X=C.panelWidth:X=C.panelHeight,U=Math.ceil(k/X)+5,$=Math.ceil((Math.abs(I)+k)/X)+1,U=$-U,U=U<0?0:U,N=U;N<$&&N<C.panels.length;N++)if(J=C.panels[N],!J.activePanel){var K,oe=C.viewer.tileSources[N];oe.referenceStripThumbnailUrl?K={type:"image",url:oe.referenceStripThumbnailUrl}:K=oe,P=new e.Viewer({id:J.id,tileSources:[K],element:J,navigatorSizeRatio:C.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:C.viewer.loadTilesWithAjax,ajaxHeaders:C.viewer.ajaxHeaders,useCanvas:C.useCanvas}),e.setElementPointerEventsNone(P.canvas),e.setElementPointerEventsNone(P.container),P.innerTracker.setTracking(!1),P.outerTracker.setTracking(!1),C.miniViewers[J.id]=P,J.activePanel=!0}}function g(C){var k=C.eventSource.element;this.scroll==="horizontal"?k.style.marginBottom="0px":k.style.marginLeft="0px"}function v(C){var k=C.eventSource.element;this.scroll==="horizontal"?k.style.marginBottom="-"+e.getElementSize(k).y/2+"px":k.style.marginLeft="-"+e.getElementSize(k).x/2+"px"}function E(C){if(!C.ctrl&&!C.alt&&!C.meta)switch(C.keyCode){case 38:h.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),C.preventDefault=!0;break;case 40:h.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),C.preventDefault=!0;break;case 37:h.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),C.preventDefault=!0;break;case 39:h.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),C.preventDefault=!0;break;default:C.preventDefault=!1;break}else C.preventDefault=!1}function _(C){if(!C.ctrl&&!C.alt&&!C.meta)switch(C.keyCode){case 61:h.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),C.preventDefault=!0;break;case 45:h.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),C.preventDefault=!0;break;case 48:case 119:case 87:h.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),C.preventDefault=!0;break;case 115:case 83:h.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),C.preventDefault=!0;break;case 97:h.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),C.preventDefault=!0;break;case 100:h.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),C.preventDefault=!0;break;default:C.preventDefault=!1;break}else C.preventDefault=!1}}(r),function(e){e.DisplayRect=function(n,o,l,h,f,g){e.Rect.apply(this,[n,o,l,h]),this.minLevel=f,this.maxLevel=g},e.extend(e.DisplayRect.prototype,e.Rect.prototype)}(r),function(e){e.Spring=function(o){var l=arguments;typeof o!="object"&&(o={initial:l.length&&typeof l[0]=="number"?l[0]:void 0,springStiffness:l.length>1?l[1].springStiffness:5,animationTime:l.length>1?l[1].animationTime:1.5}),e.console.assert(typeof o.springStiffness=="number"&&o.springStiffness!==0,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),e.console.assert(typeof o.animationTime=="number"&&o.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),o.exponential&&(this._exponential=!0,delete o.exponential),e.extend(!0,this,o),this.current={value:typeof this.initial=="number"?this.initial:this._exponential?0:1,time:e.now()},e.console.assert(!this._exponential||this.current.value!==0,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},e.Spring.prototype={resetTo:function(o){e.console.assert(!this._exponential||o!==0,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=o,this.start.time=this.target.time=this.current.time=e.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(o){e.console.assert(!this._exponential||o!==0,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=o,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(o){this.start.value+=o,this.target.value+=o,this._exponential&&(e.console.assert(this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(o){this._exponential=o,this._exponential&&(e.console.assert(this.current.value!==0&&this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=e.now();var o,l;this._exponential?(o=this.start._logValue,l=this.target._logValue):(o=this.start.value,l=this.target.value);var h=this.current.time>=this.target.time?l:o+(l-o)*n(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),f=this.current.value;return this._exponential?this.current.value=Math.exp(h):this.current.value=h,f!==this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}};function n(o,l){return(1-Math.exp(o*-l))/(1-Math.exp(-o))}}(r),function(e){function n(l){e.extend(!0,this,{timeout:e.DEFAULT_SETTINGS.timeout,jobId:null},l),this.image=null}n.prototype={errorMsg:null,start:function(){var l=this,h=this.abort;this.image=new Image,this.image.onload=function(){l.finish(!0)},this.image.onabort=this.image.onerror=function(){l.errorMsg="Image load aborted",l.finish(!1)},this.jobId=window.setTimeout(function(){l.errorMsg="Image load exceeded timeout ("+l.timeout+" ms)",l.finish(!1)},this.timeout),this.loadWithAjax?(this.request=e.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",success:function(f){var g;try{g=new window.Blob([f.response])}catch(C){var v=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(C.name==="TypeError"&&v){var E=new v;E.append(f.response),g=E.getBlob()}}g.size===0&&(l.errorMsg="Empty image response.",l.finish(!1));var _=(window.URL||window.webkitURL).createObjectURL(g);l.image.src=_},error:function(f){l.errorMsg="Image load aborted - XHR error",l.finish(!1)}}),this.abort=function(){l.request.abort(),typeof h=="function"&&h()}):(this.crossOriginPolicy!==!1&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(l){this.image.onload=this.image.onerror=this.image.onabort=null,l||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},e.ImageLoader=function(l){e.extend(!0,this,{jobLimit:e.DEFAULT_SETTINGS.imageLoaderLimit,timeout:e.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},l)},e.ImageLoader.prototype={addJob:function(l){var h=this,f=function(E){o(h,E,l.callback)},g={src:l.src,loadWithAjax:l.loadWithAjax,ajaxHeaders:l.loadWithAjax?l.ajaxHeaders:null,crossOriginPolicy:l.crossOriginPolicy,ajaxWithCredentials:l.ajaxWithCredentials,callback:f,abort:l.abort,timeout:this.timeout},v=new n(g);!this.jobLimit||this.jobsInProgress<this.jobLimit?(v.start(),this.jobsInProgress++):this.jobQueue.push(v)},clear:function(){for(var l=0;l<this.jobQueue.length;l++){var h=this.jobQueue[l];typeof h.abort=="function"&&h.abort()}this.jobQueue=[]}};function o(l,h,f){var g;l.jobsInProgress--,(!l.jobLimit||l.jobsInProgress<l.jobLimit)&&l.jobQueue.length>0&&(g=l.jobQueue.shift(),g.start(),l.jobsInProgress++),f(h.image,h.errorMsg,h.request)}}(r),function(e){e.Tile=function(n,o,l,h,f,g,v,E,_,C){this.level=n,this.x=o,this.y=l,this.bounds=h,this.sourceBounds=C,this.exists=f,this.url=g,this.context2D=v,this.loadWithAjax=E,this.ajaxHeaders=_,this.ajaxHeaders?this.cacheKey=this.url+"+"+JSON.stringify(this.ajaxHeaders):this.cacheKey=this.url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.flipped=!1,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},e.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(n){if(!this.cacheImageRecord){e.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString());return}if(!this.loaded){e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}this.element||(this.element=e.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!==n&&n.appendChild(this.element),this.imgElement.parentNode!==this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",this.flipped&&(this.style.transform="scaleX(-1)"),e.setElementOpacity(this.element,this.opacity)},drawCanvas:function(n,o,l,h){var f=this.position.times(e.pixelDensityRatio),g=this.size.times(e.pixelDensityRatio),v;if(!this.context2D&&!this.cacheImageRecord){e.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString());return}if(v=this.context2D||this.cacheImageRecord.getRenderedContext(),!this.loaded||!v){e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}n.save(),n.globalAlpha=this.opacity,typeof l=="number"&&l!==1&&(f=f.times(l),g=g.times(l)),h instanceof e.Point&&(f=f.plus(h)),n.globalAlpha===1&&this._hasTransparencyChannel()&&n.clearRect(f.x,f.y,g.x,g.y),o({context:n,tile:this,rendered:v});var E,_;this.sourceBounds?(E=Math.min(this.sourceBounds.width,v.canvas.width),_=Math.min(this.sourceBounds.height,v.canvas.height)):(E=v.canvas.width,_=v.canvas.height),n.translate(f.x+g.x/2,0),this.flipped&&n.scale(-1,1),n.drawImage(v.canvas,0,0,E,_,-g.x/2,f.y,g.x,g.y),n.restore()},getScaleForEdgeSmoothing:function(){var n;if(this.cacheImageRecord)n=this.cacheImageRecord.getRenderedContext();else if(this.context2D)n=this.context2D;else return e.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;return n.canvas.width/(this.size.x*e.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(n,o,l){var h=Math.max(1,Math.ceil((l.x-o.x)/2)),f=Math.max(1,Math.ceil((l.y-o.y)/2));return new e.Point(h,f).minus(this.position.times(e.pixelDensityRatio).times(n||1).apply(function(g){return g%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(r),function(e){e.OverlayPlacement=e.Placement,e.OverlayRotationMode=e.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),e.Overlay=function(n,o,l){var h;e.isPlainObject(n)?h=n:h={element:n,location:o,placement:l},this.element=h.element,this.style=h.element.style,this._init(h)},e.Overlay.prototype={_init:function(n){this.location=n.location,this.placement=n.placement===void 0?e.Placement.TOP_LEFT:n.placement,this.onDraw=n.onDraw,this.checkResize=n.checkResize===void 0?!0:n.checkResize,this.width=n.width===void 0?null:n.width,this.height=n.height===void 0?null:n.height,this.rotationMode=n.rotationMode||e.OverlayRotationMode.EXACT,this.location instanceof e.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=e.Placement.TOP_LEFT),this.scales=this.width!==null&&this.height!==null,this.bounds=new e.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(n,o){var l=e.Placement.properties[this.placement];!l||(l.isHorizontallyCentered?n.x-=o.x/2:l.isRight&&(n.x-=o.x),l.isVerticallyCentered?n.y-=o.y/2:l.isBottom&&(n.y-=o.y))},destroy:function(){var n=this.element,o=this.style;n.parentNode&&(n.parentNode.removeChild(n),n.prevElementParent&&(o.display="none",document.body.appendChild(n))),this.onDraw=null,o.top="",o.left="",o.position="",this.width!==null&&(o.width=""),this.height!==null&&(o.height="");var l=e.getCssPropertyWithVendorPrefix("transformOrigin"),h=e.getCssPropertyWithVendorPrefix("transform");l&&h&&(o[l]="",o[h]="")},drawHTML:function(n,o){var l=this.element;l.parentNode!==n&&(l.prevElementParent=l.parentNode,l.prevNextSibling=l.nextSibling,n.appendChild(l),this.style.position="absolute",this.size=e.getElementSize(l));var h=this._getOverlayPositionAndSize(o),f=h.position,g=this.size=h.size,v=h.rotate;if(this.onDraw)this.onDraw(f,g,this.element);else{var E=this.style;E.left=f.x+"px",E.top=f.y+"px",this.width!==null&&(E.width=g.x+"px"),this.height!==null&&(E.height=g.y+"px");var _=e.getCssPropertyWithVendorPrefix("transformOrigin"),C=e.getCssPropertyWithVendorPrefix("transform");_&&C&&(v?(E[_]=this._getTransformOrigin(),E[C]="rotate("+v+"deg)"):(E[_]="",E[C]="")),E.display="block"}},_getOverlayPositionAndSize:function(n){var o=n.pixelFromPoint(this.location,!0),l=this._getSizeInPixels(n);this.adjust(o,l);var h=0;if(n.degrees&&this.rotationMode!==e.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX&&this.width!==null&&this.height!==null){var f=new e.Rect(o.x,o.y,l.x,l.y),g=this._getBoundingBox(f,n.degrees);o=g.getTopLeft(),l=g.getSize()}else h=n.degrees;return{position:o,size:l,rotate:h}},_getSizeInPixels:function(n){var o=this.size.x,l=this.size.y;if(this.width!==null||this.height!==null){var h=n.deltaPixelsFromPointsNoRotate(new e.Point(this.width||0,this.height||0),!0);this.width!==null&&(o=h.x),this.height!==null&&(l=h.y)}if(this.checkResize&&(this.width===null||this.height===null)){var f=this.size=e.getElementSize(this.element);this.width===null&&(o=f.x),this.height===null&&(l=f.y)}return new e.Point(o,l)},_getBoundingBox:function(n,o){var l=this._getPlacementPoint(n);return n.rotate(o,l).getBoundingBox()},_getPlacementPoint:function(n){var o=new e.Point(n.x,n.y),l=e.Placement.properties[this.placement];return l&&(l.isHorizontallyCentered?o.x+=n.width/2:l.isRight&&(o.x+=n.width),l.isVerticallyCentered?o.y+=n.height/2:l.isBottom&&(o.y+=n.height)),o},_getTransformOrigin:function(){var n="",o=e.Placement.properties[this.placement];return o&&(o.isLeft?n="left":o.isRight&&(n="right"),o.isTop?n+=" top":o.isBottom&&(n+=" bottom")),n},update:function(n,o){var l=e.isPlainObject(n)?n:{location:n,placement:o};this._init({location:l.location||this.location,placement:l.placement!==void 0?l.placement:this.placement,onDraw:l.onDraw||this.onDraw,checkResize:l.checkResize||this.checkResize,width:l.width!==void 0?l.width:this.width,height:l.height!==void 0?l.height:this.height,rotationMode:l.rotationMode||this.rotationMode})},getBounds:function(n){e.console.assert(n,"A viewport must now be passed to Overlay.getBounds.");var o=this.width,l=this.height;if(o===null||l===null){var h=n.deltaPointsFromPixelsNoRotate(this.size,!0);o===null&&(o=h.x),l===null&&(l=h.y)}var f=this.location.clone();return this.adjust(f,new e.Point(o,l)),this._adjustBoundsForRotation(n,new e.Rect(f.x,f.y,o,l))},_adjustBoundsForRotation:function(n,o){if(!n||n.degrees===0||this.rotationMode===e.OverlayRotationMode.EXACT)return o;if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX){if(this.width===null||this.height===null)return o;var l=this._getOverlayPositionAndSize(n);return n.viewerElementToViewportRectangle(new e.Rect(l.position.x,l.position.y,l.size.x,l.size.y))}return o.rotate(-n.degrees,this._getPlacementPoint(o))}}}(r),function(e){e.Drawer=function(n){e.console.assert(n.viewer,"[Drawer] options.viewer is required");var o=arguments;if(e.isPlainObject(n)||(n={source:o[0],viewport:o[1],element:o[2]}),e.console.assert(n.viewport,"[Drawer] options.viewport is required"),e.console.assert(n.element,"[Drawer] options.element is required"),n.source&&e.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=n.viewer,this.viewport=n.viewport,this.debugGridColor=typeof n.debugGridColor=="string"?[n.debugGridColor]:n.debugGridColor||e.DEFAULT_SETTINGS.debugGridColor,n.opacity&&e.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=e.supportsCanvas&&(this.viewer?this.viewer.useCanvas:!0),this.container=e.getElement(n.element),this.canvas=e.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var l=this._calculateCanvasSize();this.canvas.width=l.x,this.canvas.height=l.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",e.setElementOpacity(this.canvas,this.opacity,!0),e.setElementPointerEventsNone(this.canvas),e.setElementTouchActionNone(this.canvas),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},e.Drawer.prototype={addOverlay:function(n,o,l,h){return e.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(n,o,l,h),this},updateOverlay:function(n,o,l){return e.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(n,o,l),this},removeOverlay:function(n){return e.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(n),this},clearOverlays:function(){return e.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(n){var o=this.viewport.pixelFromPointNoRotate(n,!0);return new e.Point(o.x*e.pixelDensityRatio,o.y*e.pixelDensityRatio)},clipWithPolygons:function(n,o){if(this.useCanvas){var l=this._getContext(o);l.beginPath(),n.forEach(function(h){h.forEach(function(f,g){l[g===0?"moveTo":"lineTo"](f.x,f.y)})}),l.clip()}},setOpacity:function(n){e.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var o=this.viewer.world,l=0;l<o.getItemCount();l++)o.getItemAt(l).setOpacity(n);return this},getOpacity:function(){e.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var n=this.viewer.world,o=0,l=0;l<n.getItemCount();l++){var h=n.getItemAt(l).getOpacity();h>o&&(o=h)}return o},needsUpdate:function(){return e.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return e.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return e.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return e.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var n=this._calculateCanvasSize();if((this.canvas.width!==n.x||this.canvas.height!==n.y)&&(this.canvas.width=n.x,this.canvas.height=n.y,this._updateImageSmoothingEnabled(this.context),this.sketchCanvas!==null)){var o=this._calculateSketchCanvasSize();this.sketchCanvas.width=o.x,this.sketchCanvas.height=o.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(n,o){if(this.useCanvas){var l=this._getContext(n);if(o)l.clearRect(o.x,o.y,o.width,o.height);else{var h=l.canvas;l.clearRect(0,0,h.width,h.height)}}},viewportToDrawerRectangle:function(n){var o=this.viewport.pixelFromPointNoRotate(n.getTopLeft(),!0),l=this.viewport.deltaPixelsFromPointsNoRotate(n.getSize(),!0);return new e.Rect(o.x*e.pixelDensityRatio,o.y*e.pixelDensityRatio,l.x*e.pixelDensityRatio,l.y*e.pixelDensityRatio)},drawTile:function(n,o,l,h,f){if(e.console.assert(n,"[Drawer.drawTile] tile is required"),e.console.assert(o,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var g=this._getContext(l);h=h||1,n.drawCanvas(g,o,h,f)}else n.drawHTML(this.canvas)},_getContext:function(n){var o=this.context;if(n){if(this.sketchCanvas===null){this.sketchCanvas=document.createElement("canvas");var l=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=l.x,this.sketchCanvas.height=l.y,this.sketchContext=this.sketchCanvas.getContext("2d"),this.viewport.getRotation()===0){var h=this;this.viewer.addHandler("rotate",function f(){if(h.viewport.getRotation()!==0){h.viewer.removeHandler("rotate",f);var g=h._calculateSketchCanvasSize();h.sketchCanvas.width=g.x,h.sketchCanvas.height=g.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}o=this.sketchContext}return o},saveContext:function(n){!this.useCanvas||this._getContext(n).save()},restoreContext:function(n){!this.useCanvas||this._getContext(n).restore()},setClip:function(n,o){if(this.useCanvas){var l=this._getContext(o);l.beginPath(),l.rect(n.x,n.y,n.width,n.height),l.clip()}},drawRectangle:function(n,o,l){if(this.useCanvas){var h=this._getContext(l);h.save(),h.fillStyle=o,h.fillRect(n.x,n.y,n.width,n.height),h.restore()}},blendSketch:function(n,o,l,h){var f=n;if(e.isPlainObject(f)||(f={opacity:n,scale:o,translate:l,compositeOperation:h}),!(!this.useCanvas||!this.sketchCanvas)){n=f.opacity,h=f.compositeOperation;var g=f.bounds;if(this.context.save(),this.context.globalAlpha=n,h&&(this.context.globalCompositeOperation=h),g)g.x<0&&(g.width+=g.x,g.x=0),g.x+g.width>this.canvas.width&&(g.width=this.canvas.width-g.x),g.y<0&&(g.height+=g.y,g.y=0),g.y+g.height>this.canvas.height&&(g.height=this.canvas.height-g.y),this.context.drawImage(this.sketchCanvas,g.x,g.y,g.width,g.height,g.x,g.y,g.width,g.height);else{o=f.scale||1,l=f.translate;var v=l instanceof e.Point?l:new e.Point(0,0),E=0,_=0;if(l){var C=this.sketchCanvas.width-this.canvas.width,k=this.sketchCanvas.height-this.canvas.height;E=Math.round(C/2),_=Math.round(k/2)}this.context.drawImage(this.sketchCanvas,v.x-E*o,v.y-_*o,(this.canvas.width+2*E)*o,(this.canvas.height+2*_)*o,-E,-_,this.canvas.width+2*E,this.canvas.height+2*_)}this.context.restore()}},drawDebugInfo:function(n,o,l,h){if(this.useCanvas){var f=this.viewer.world.getIndexOfItem(h)%this.debugGridColor.length,g=this.context;g.save(),g.lineWidth=2*e.pixelDensityRatio,g.font="small-caps bold "+13*e.pixelDensityRatio+"px arial",g.strokeStyle=this.debugGridColor[f],g.fillStyle=this.debugGridColor[f],this.viewport.degrees!==0&&this._offsetForRotation({degrees:this.viewport.degrees}),h.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:h.getRotation(!0),point:h.viewport.pixelFromPointNoRotate(h._getRotationPoint(!0),!0)}),h.viewport.degrees===0&&h.getRotation(!0)%360===0&&h._drawer.viewer.viewport.getFlip()&&h._drawer._flip(),g.strokeRect(n.position.x*e.pixelDensityRatio,n.position.y*e.pixelDensityRatio,n.size.x*e.pixelDensityRatio,n.size.y*e.pixelDensityRatio);var v=(n.position.x+n.size.x/2)*e.pixelDensityRatio,E=(n.position.y+n.size.y/2)*e.pixelDensityRatio;g.translate(v,E),g.rotate(Math.PI/180*-this.viewport.degrees),g.translate(-v,-E),n.x===0&&n.y===0&&(g.fillText("Zoom: "+this.viewport.getZoom(),n.position.x*e.pixelDensityRatio,(n.position.y-30)*e.pixelDensityRatio),g.fillText("Pan: "+this.viewport.getBounds().toString(),n.position.x*e.pixelDensityRatio,(n.position.y-20)*e.pixelDensityRatio)),g.fillText("Level: "+n.level,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+20)*e.pixelDensityRatio),g.fillText("Column: "+n.x,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+30)*e.pixelDensityRatio),g.fillText("Row: "+n.y,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+40)*e.pixelDensityRatio),g.fillText("Order: "+l+" of "+o,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+50)*e.pixelDensityRatio),g.fillText("Size: "+n.size.toString(),(n.position.x+10)*e.pixelDensityRatio,(n.position.y+60)*e.pixelDensityRatio),g.fillText("Position: "+n.position.toString(),(n.position.x+10)*e.pixelDensityRatio,(n.position.y+70)*e.pixelDensityRatio),this.viewport.degrees!==0&&this._restoreRotationChanges(),h.getRotation(!0)%360!==0&&this._restoreRotationChanges(),h.viewport.degrees===0&&h.getRotation(!0)%360===0&&h._drawer.viewer.viewport.getFlip()&&h._drawer._flip(),g.restore()}},debugRect:function(n){if(this.useCanvas){var o=this.context;o.save(),o.lineWidth=2*e.pixelDensityRatio,o.strokeStyle=this.debugGridColor[0],o.fillStyle=this.debugGridColor[0],o.strokeRect(n.x*e.pixelDensityRatio,n.y*e.pixelDensityRatio,n.width*e.pixelDensityRatio,n.height*e.pixelDensityRatio),o.restore()}},setImageSmoothingEnabled:function(n){this.useCanvas&&(this._imageSmoothingEnabled=n,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(n){n.msImageSmoothingEnabled=this._imageSmoothingEnabled,n.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(n){var o=this._getContext(n).canvas;return new e.Point(o.width,o.height)},getCanvasCenter:function(){return new e.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(n){var o=n.point?n.point.times(e.pixelDensityRatio):this.getCanvasCenter(),l=this._getContext(n.useSketch);l.save(),l.translate(o.x,o.y),this.viewer.viewport.flipped?(l.rotate(Math.PI/180*-n.degrees),l.scale(-1,1)):l.rotate(Math.PI/180*n.degrees),l.translate(-o.x,-o.y)},_flip:function(n){n=n||{};var o=n.point?n.point.times(e.pixelDensityRatio):this.getCanvasCenter(),l=this._getContext(n.useSketch);l.translate(o.x,0),l.scale(-1,1),l.translate(-o.x,0)},_restoreRotationChanges:function(n){var o=this._getContext(n);o.restore()},_calculateCanvasSize:function(){var n=e.pixelDensityRatio,o=this.viewport.getContainerSize();return{x:Math.round(o.x*n),y:Math.round(o.y*n)}},_calculateSketchCanvasSize:function(){var n=this._calculateCanvasSize();if(this.viewport.getRotation()===0)return n;var o=Math.ceil(Math.sqrt(n.x*n.x+n.y*n.y));return{x:o,y:o}}}}(r),function(e){e.Viewport=function(n){var o=arguments;o.length&&o[0]instanceof e.Point&&(n={containerSize:o[0],contentSize:o[1],config:o[2]}),n.config&&(e.extend(!0,n,n.config),delete n.config),this._margins=e.extend({left:0,top:0,right:0,bottom:0},n.margins||{}),delete n.margins,e.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:e.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:e.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:e.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:e.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:e.DEFAULT_SETTINGS.maxZoomLevel,degrees:e.DEFAULT_SETTINGS.degrees,flipped:e.DEFAULT_SETTINGS.flipped,homeFillsViewer:e.DEFAULT_SETTINGS.homeFillsViewer},n),this._updateContainerInnerSize(),this.centerSpringX=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new e.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new e.Rect(0,0,1,1),1),this.goHome(!0),this.update()},e.Viewport.prototype={resetContentSize:function(n){return e.console.assert(n,"[Viewport.resetContentSize] contentSize is required"),e.console.assert(n instanceof e.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),e.console.assert(n.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),e.console.assert(n.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new e.Rect(0,0,1,n.y/n.x),n.x),this},setHomeBounds:function(n,o){e.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(n,o)},_setContentBounds:function(n,o){e.console.assert(n,"[Viewport._setContentBounds] bounds is required"),e.console.assert(n instanceof e.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),e.console.assert(n.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),e.console.assert(n.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=n.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(o),this._contentBounds=n.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(o),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:o,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var n=this._contentAspectRatio/this.getAspectRatio(),o;return this.homeFillsViewer?o=n>=1?n:1:o=n>=1?1:n,o/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var n=this._contentBounds.getCenter(),o=1/this.getHomeZoom(),l=o/this.getAspectRatio();return new e.Rect(n.x-o/2,n.y-l/2,o,l)},goHome:function(n){return this.viewer&&this.viewer.raiseEvent("home",{immediately:n}),this.fitBounds(this.getHomeBounds(),n)},getMinZoom:function(){var n=this.getHomeZoom(),o=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*n;return o},getMaxZoom:function(){var n=this.maxZoomLevel;return n||(n=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,n/=this._contentBounds.width),Math.max(n,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new e.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return e.extend({},this._margins)},setMargins:function(n){e.console.assert(e.type(n)==="object","[Viewport.setMargins] margins must be an object"),this._margins=e.extend({left:0,top:0,right:0,bottom:0},n),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(n){return this.getBoundsNoRotate(n).rotate(-this.getRotation())},getBoundsNoRotate:function(n){var o=this.getCenter(n),l=1/this.getZoom(n),h=l/this.getAspectRatio();return new e.Rect(o.x-l/2,o.y-h/2,l,h)},getBoundsWithMargins:function(n){return this.getBoundsNoRotateWithMargins(n).rotate(-this.getRotation(),this.getCenter(n))},getBoundsNoRotateWithMargins:function(n){var o=this.getBoundsNoRotate(n),l=this._containerInnerSize.x*this.getZoom(n);return o.x-=this._margins.left/l,o.y-=this._margins.top/l,o.width+=(this._margins.left+this._margins.right)/l,o.height+=(this._margins.top+this._margins.bottom)/l,o},getCenter:function(n){var o=new e.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),l=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value),h,f,g,v,E,_,C,k;return n?o:this.zoomPoint?(h=this.pixelFromPoint(this.zoomPoint,!0),f=this.getZoom(),g=1/f,v=g/this.getAspectRatio(),E=new e.Rect(o.x-g/2,o.y-v/2,g,v),_=this._pixelFromPoint(this.zoomPoint,E),C=_.minus(h),k=C.divide(this._containerInnerSize.x*f),l.plus(k)):l},getZoom:function(n){return n?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(n){return Math.max(Math.min(n,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(n){var o=new e.Rect(n.x,n.y,n.width,n.height);if(!this.wrapHorizontal){var l=this.visibilityRatio*o.width,h=o.x+o.width,f=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width,g=this._contentBoundsNoRotate.x-h+l,v=f-o.x-l;l>this._contentBoundsNoRotate.width?o.x+=(g+v)/2:v<0?o.x+=v:g>0&&(o.x+=g)}if(!this.wrapVertical){var E=this.visibilityRatio*o.height,_=o.y+o.height,C=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height,k=this._contentBoundsNoRotate.y-_+E,I=C-o.y-E;E>this._contentBoundsNoRotate.height?o.y+=(k+I)/2:I<0?o.y+=I:k>0&&(o.y+=k)}return o},_raiseConstraintsEvent:function(n){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:n})},applyConstraints:function(n){var o=this.getZoom(),l=this._applyZoomConstraints(o);o!==l&&this.zoomTo(l,this.zoomPoint,n);var h=this.getBoundsNoRotate(),f=this._applyBoundaryConstraints(h);return this._raiseConstraintsEvent(n),(h.x!==f.x||h.y!==f.y||n)&&this.fitBounds(f.rotate(-this.getRotation()),n),this},ensureVisible:function(n){return this.applyConstraints(n)},_fitBounds:function(n,o){o=o||{};var l=o.immediately||!1,h=o.constraints||!1,f=this.getAspectRatio(),g=n.getCenter(),v=new e.Rect(n.x,n.y,n.width,n.height,n.degrees+this.getRotation()).getBoundingBox();v.getAspectRatio()>=f?v.height=v.width/f:v.width=v.height*f,v.x=g.x-v.width/2,v.y=g.y-v.height/2;var E=1/v.width;if(h){var _=v.getAspectRatio(),C=this._applyZoomConstraints(E);E!==C&&(E=C,v.width=1/E,v.x=g.x-v.width/2,v.height=v.width/_,v.y=g.y-v.height/2),v=this._applyBoundaryConstraints(v),g=v.getCenter(),this._raiseConstraintsEvent(l)}if(l)return this.panTo(g,!0),this.zoomTo(E,null,!0);this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0);var k=this.getBounds(),I=this.getZoom();if(I===0||Math.abs(E/I-1)<1e-8)return this.zoomTo(E,!0),this.panTo(g,l);v=v.rotate(-this.getRotation());var X=v.getTopLeft().times(E).minus(k.getTopLeft().times(I)).divide(E-I);return this.zoomTo(E,X,l)},fitBounds:function(n,o){return this._fitBounds(n,{immediately:o,constraints:!1})},fitBoundsWithConstraints:function(n,o){return this._fitBounds(n,{immediately:o,constraints:!0})},fitVertically:function(n){var o=new e.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(o,n)},fitHorizontally:function(n){var o=new e.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(o,n)},getConstrainedBounds:function(n){var o,l;return o=this.getBounds(n),l=this._applyBoundaryConstraints(o),l},panBy:function(n,o){var l=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(l.plus(n),o)},panTo:function(n,o){return o?(this.centerSpringX.resetTo(n.x),this.centerSpringY.resetTo(n.y)):(this.centerSpringX.springTo(n.x),this.centerSpringY.springTo(n.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:n,immediately:o}),this},zoomBy:function(n,o,l){return this.zoomTo(this.zoomSpring.target.value*n,o,l)},zoomTo:function(n,o,l){var h=this;return this.zoomPoint=o instanceof e.Point&&!isNaN(o.x)&&!isNaN(o.y)?o:null,l?this._adjustCenterSpringsForZoomPoint(function(){h.zoomSpring.resetTo(n)}):this.zoomSpring.springTo(n),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:n,refPoint:o,immediately:l}),this},setRotation:function(n){return!this.viewer||!this.viewer.drawer.canRotate()?this:(this.degrees=e.positiveModulo(n,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:n}),this)},getRotation:function(){return this.degrees},resize:function(n,o){var l=this.getBoundsNoRotate(),h=l,f;return this.containerSize.x=n.x,this.containerSize.y=n.y,this._updateContainerInnerSize(),o&&(f=n.x/this.containerSize.x,h.width=l.width*f,h.height=h.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:n,maintain:o}),this.fitBounds(h,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new e.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var n=this;this._adjustCenterSpringsForZoomPoint(function(){n.zoomSpring.update()}),this.centerSpringX.update(),this.centerSpringY.update();var o=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,o},_adjustCenterSpringsForZoomPoint:function(n){if(this.zoomPoint){var o=this.pixelFromPoint(this.zoomPoint,!0);n();var l=this.pixelFromPoint(this.zoomPoint,!0),h=l.minus(o),f=this.deltaPointsFromPixels(h,!0);this.centerSpringX.shiftBy(f.x),this.centerSpringY.shiftBy(f.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else n()},deltaPixelsFromPointsNoRotate:function(n,o){return n.times(this._containerInnerSize.x*this.getZoom(o))},deltaPixelsFromPoints:function(n,o){return this.deltaPixelsFromPointsNoRotate(n.rotate(this.getRotation()),o)},deltaPointsFromPixelsNoRotate:function(n,o){return n.divide(this._containerInnerSize.x*this.getZoom(o))},deltaPointsFromPixels:function(n,o){return this.deltaPointsFromPixelsNoRotate(n,o).rotate(-this.getRotation())},pixelFromPointNoRotate:function(n,o){return this._pixelFromPointNoRotate(n,this.getBoundsNoRotate(o))},pixelFromPoint:function(n,o){return this._pixelFromPoint(n,this.getBoundsNoRotate(o))},_pixelFromPointNoRotate:function(n,o){return n.minus(o.getTopLeft()).times(this._containerInnerSize.x/o.width).plus(new e.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(n,o){return this._pixelFromPointNoRotate(n.rotate(this.getRotation(),this.getCenter(!0)),o)},pointFromPixelNoRotate:function(n,o){var l=this.getBoundsNoRotate(o);return n.minus(new e.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/l.width).plus(l.getTopLeft())},pointFromPixel:function(n,o){return this.pointFromPixelNoRotate(n,o).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(n,o){var l=this._contentBoundsNoRotate.width;return new e.Point(n*this._contentSizeNoRotate.x/l,o*this._contentSizeNoRotate.x/l)},viewportToImageCoordinates:function(n,o){if(n instanceof e.Point)return this.viewportToImageCoordinates(n.x,n.y);if(this.viewer){var l=this.viewer.world.getItemCount();if(l>1)e.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(l===1){var h=this.viewer.world.getItemAt(0);return h.viewportToImageCoordinates(n,o,!0)}}return this._viewportToImageDelta(n-this._contentBoundsNoRotate.x,o-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(n,o){var l=this._contentBoundsNoRotate.width;return new e.Point(n/this._contentSizeNoRotate.x*l,o/this._contentSizeNoRotate.x*l)},imageToViewportCoordinates:function(n,o){if(n instanceof e.Point)return this.imageToViewportCoordinates(n.x,n.y);if(this.viewer){var l=this.viewer.world.getItemCount();if(l>1)e.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(l===1){var h=this.viewer.world.getItemAt(0);return h.imageToViewportCoordinates(n,o,!0)}}var f=this._imageToViewportDelta(n,o);return f.x+=this._contentBoundsNoRotate.x,f.y+=this._contentBoundsNoRotate.y,f},imageToViewportRectangle:function(n,o,l,h){var f=n;if(f instanceof e.Rect||(f=new e.Rect(n,o,l,h)),this.viewer){var g=this.viewer.world.getItemCount();if(g>1)e.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(g===1){var v=this.viewer.world.getItemAt(0);return v.imageToViewportRectangle(n,o,l,h,!0)}}var E=this.imageToViewportCoordinates(f.x,f.y),_=this._imageToViewportDelta(f.width,f.height);return new e.Rect(E.x,E.y,_.x,_.y,f.degrees)},viewportToImageRectangle:function(n,o,l,h){var f=n;if(f instanceof e.Rect||(f=new e.Rect(n,o,l,h)),this.viewer){var g=this.viewer.world.getItemCount();if(g>1)e.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(g===1){var v=this.viewer.world.getItemAt(0);return v.viewportToImageRectangle(n,o,l,h,!0)}}var E=this.viewportToImageCoordinates(f.x,f.y),_=this._viewportToImageDelta(f.width,f.height);return new e.Rect(E.x,E.y,_.x,_.y,f.degrees)},viewerElementToImageCoordinates:function(n){var o=this.pointFromPixel(n,!0);return this.viewportToImageCoordinates(o)},imageToViewerElementCoordinates:function(n){var o=this.imageToViewportCoordinates(n);return this.pixelFromPoint(o,!0)},windowToImageCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var o=n.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(o)},imageToWindowCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var o=this.imageToViewerElementCoordinates(n);return o.plus(e.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(n){return this.pointFromPixel(n,!0)},viewportToViewerElementCoordinates:function(n){return this.pixelFromPoint(n,!0)},viewerElementToViewportRectangle:function(n){return e.Rect.fromSummits(this.pointFromPixel(n.getTopLeft(),!0),this.pointFromPixel(n.getTopRight(),!0),this.pointFromPixel(n.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(n){return e.Rect.fromSummits(this.pixelFromPoint(n.getTopLeft(),!0),this.pixelFromPoint(n.getTopRight(),!0),this.pixelFromPoint(n.getBottomLeft(),!0))},windowToViewportCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var o=n.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(o)},viewportToWindowCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var o=this.viewportToViewerElementCoordinates(n);return o.plus(e.getElementPosition(this.viewer.element))},viewportToImageZoom:function(n){if(this.viewer){var o=this.viewer.world.getItemCount();if(o>1)e.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(o===1){var l=this.viewer.world.getItemAt(0);return l.viewportToImageZoom(n)}}var h=this._contentSizeNoRotate.x,f=this._containerInnerSize.x,g=this._contentBoundsNoRotate.width,v=f/h*g;return n*v},imageToViewportZoom:function(n){if(this.viewer){var o=this.viewer.world.getItemCount();if(o>1)e.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(o===1){var l=this.viewer.world.getItemAt(0);return l.imageToViewportZoom(n)}}var h=this._contentSizeNoRotate.x,f=this._containerInnerSize.x,g=this._contentBoundsNoRotate.width,v=h/f/g;return n*v},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(n){return this.flipped===n?this:(this.flipped=n,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:n}),this)}}}(r),function(e){e.TiledImage=function(P){var N=this;e.console.assert(P.tileCache,"[TiledImage] options.tileCache is required"),e.console.assert(P.drawer,"[TiledImage] options.drawer is required"),e.console.assert(P.viewer,"[TiledImage] options.viewer is required"),e.console.assert(P.imageLoader,"[TiledImage] options.imageLoader is required"),e.console.assert(P.source,"[TiledImage] options.source is required"),e.console.assert(!P.clip||P.clip instanceof e.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),e.EventSource.call(this),this._tileCache=P.tileCache,delete P.tileCache,this._drawer=P.drawer,delete P.drawer,this._imageLoader=P.imageLoader,delete P.imageLoader,P.clip instanceof e.Rect&&(this._clip=P.clip.clone()),delete P.clip;var J=P.x||0;delete P.x;var K=P.y||0;delete P.y,this.normHeight=P.source.dimensions.y/P.source.dimensions.x,this.contentAspectX=P.source.dimensions.x/P.source.dimensions.y;var oe=1;P.width?(oe=P.width,delete P.width,P.height&&(e.console.error("specifying both width and height to a tiledImage is not supported"),delete P.height)):P.height&&(oe=P.height/this.normHeight,delete P.height);var ie=P.fitBounds;delete P.fitBounds;var me=P.fitBoundsPlacement||r.Placement.CENTER;delete P.fitBoundsPlacement;var we=P.degrees||0;delete P.degrees,e.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,immediateRender:e.DEFAULT_SETTINGS.immediateRender,blendTime:e.DEFAULT_SETTINGS.blendTime,alwaysBlend:e.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:e.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:e.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:e.DEFAULT_SETTINGS.iOSDevice,debugMode:e.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:e.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:e.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:e.DEFAULT_SETTINGS.placeholderFillStyle,opacity:e.DEFAULT_SETTINGS.opacity,preload:e.DEFAULT_SETTINGS.preload,compositeOperation:e.DEFAULT_SETTINGS.compositeOperation},P),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new e.Spring({initial:J,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new e.Spring({initial:K,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new e.Spring({initial:oe,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new e.Spring({initial:we,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),ie&&this.fitBounds(ie,me,!0),this._drawingHandler=function(De){N.viewer.raiseEvent("tile-drawing",e.extend({tiledImage:N},De))}},e.extend(e.TiledImage.prototype,e.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(P){P!==this._fullyLoaded&&(this._fullyLoaded=P,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=e.now(),this._needsDraw=!0},update:function(){var P=this._xSpring.update(),N=this._ySpring.update(),J=this._scaleSpring.update(),K=this._degreesSpring.update();return P||N||J||K?(this._updateForScale(),this._needsDraw=!0,!0):!1},draw:function(){this.opacity!==0||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset(),this.source.destroy&&this.source.destroy()},getBounds:function(P){return this.getBoundsNoRotate(P).rotate(this.getRotation(P),this._getRotationPoint(P))},getBoundsNoRotate:function(P){return P?new e.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new e.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return e.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(P){var N=this.getBoundsNoRotate(P);if(this._clip){var J=P?this._worldWidthCurrent:this._worldWidthTarget,K=J/this.source.dimensions.x,oe=this._clip.times(K);N=new e.Rect(N.x+oe.x,N.y+oe.y,oe.width,oe.height)}return N.rotate(this.getRotation(P),this._getRotationPoint(P))},getTileBounds:function(P,N,J){var K=this.source.getNumTiles(P),oe=(K.x+N%K.x)%K.x,ie=(K.y+J%K.y)%K.y,me=this.source.getTileBounds(P,oe,ie);return this.getFlip()&&(me.x=1-me.x-me.width),me.x+=(N-oe)/K.x,me.y+=this._worldHeightCurrent/this._worldWidthCurrent*((J-ie)/K.y),me},getContentSize:function(){return new e.Point(this.source.dimensions.x,this.source.dimensions.y)},getSizeInWindowCoordinates:function(){var P=this.imageToWindowCoordinates(new e.Point(0,0)),N=this.imageToWindowCoordinates(this.getContentSize());return new e.Point(N.x-P.x,N.y-P.y)},_viewportToImageDelta:function(P,N,J){var K=J?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(P*(this.source.dimensions.x/K),N*(this.source.dimensions.y*this.contentAspectX/K))},viewportToImageCoordinates:function(P,N,J){var K;return P instanceof e.Point?(J=N,K=P):K=new e.Point(P,N),K=K.rotate(-this.getRotation(J),this._getRotationPoint(J)),J?this._viewportToImageDelta(K.x-this._xSpring.current.value,K.y-this._ySpring.current.value):this._viewportToImageDelta(K.x-this._xSpring.target.value,K.y-this._ySpring.target.value)},_imageToViewportDelta:function(P,N,J){var K=J?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(P/this.source.dimensions.x*K,N/this.source.dimensions.y/this.contentAspectX*K)},imageToViewportCoordinates:function(P,N,J){P instanceof e.Point&&(J=N,N=P.y,P=P.x);var K=this._imageToViewportDelta(P,N);return J?(K.x+=this._xSpring.current.value,K.y+=this._ySpring.current.value):(K.x+=this._xSpring.target.value,K.y+=this._ySpring.target.value),K.rotate(this.getRotation(J),this._getRotationPoint(J))},imageToViewportRectangle:function(P,N,J,K,oe){var ie=P;ie instanceof e.Rect?oe=N:ie=new e.Rect(P,N,J,K);var me=this.imageToViewportCoordinates(ie.getTopLeft(),oe),we=this._imageToViewportDelta(ie.width,ie.height,oe);return new e.Rect(me.x,me.y,we.x,we.y,ie.degrees+this.getRotation(oe))},viewportToImageRectangle:function(P,N,J,K,oe){var ie=P;P instanceof e.Rect?oe=N:ie=new e.Rect(P,N,J,K);var me=this.viewportToImageCoordinates(ie.getTopLeft(),oe),we=this._viewportToImageDelta(ie.width,ie.height,oe);return new e.Rect(me.x,me.y,we.x,we.y,ie.degrees-this.getRotation(oe))},viewerElementToImageCoordinates:function(P){var N=this.viewport.pointFromPixel(P,!0);return this.viewportToImageCoordinates(N)},imageToViewerElementCoordinates:function(P){var N=this.imageToViewportCoordinates(P);return this.viewport.pixelFromPoint(N,!0)},windowToImageCoordinates:function(P){var N=P.minus(r.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(N)},imageToWindowCoordinates:function(P){var N=this.imageToViewerElementCoordinates(P);return N.plus(r.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(P){var N=this._scaleSpring.current.value;return P=P.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new e.Rect((P.x-this._xSpring.current.value)/N,(P.y-this._ySpring.current.value)/N,P.width/N,P.height/N,P.degrees)},viewportToImageZoom:function(P){var N=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return N*P},imageToViewportZoom:function(P){var N=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return P/N},setPosition:function(P,N){var J=this._xSpring.target.value===P.x&&this._ySpring.target.value===P.y;if(N){if(J&&this._xSpring.current.value===P.x&&this._ySpring.current.value===P.y)return;this._xSpring.resetTo(P.x),this._ySpring.resetTo(P.y),this._needsDraw=!0}else{if(J)return;this._xSpring.springTo(P.x),this._ySpring.springTo(P.y),this._needsDraw=!0}J||this._raiseBoundsChange()},setWidth:function(P,N){this._setScale(P,N)},setHeight:function(P,N){this._setScale(P/this.normHeight,N)},setCroppingPolygons:function(P){var N=function(K){return K instanceof e.Point||typeof K.x=="number"&&typeof K.y=="number"},J=function(K){return K.map(function(oe){try{if(N(oe))return{x:oe.x,y:oe.y};throw new Error}catch{throw new Error("A Provided cropping polygon point is not supported")}})};try{if(!e.isArray(P))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=P.map(function(K){return J(K)})}catch(K){e.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),e.console.error(K),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(P,N,J){N=N||e.Placement.CENTER;var K=e.Placement.properties[N],oe=this.contentAspectX,ie=0,me=0,we=1,De=1;if(this._clip&&(oe=this._clip.getAspectRatio(),we=this._clip.width/this.source.dimensions.x,De=this._clip.height/this.source.dimensions.y,P.getAspectRatio()>oe?(ie=this._clip.x/this._clip.height*P.height,me=this._clip.y/this._clip.height*P.height):(ie=this._clip.x/this._clip.width*P.width,me=this._clip.y/this._clip.width*P.width)),P.getAspectRatio()>oe){var Be=P.height/De,Oe=0;K.isHorizontallyCentered?Oe=(P.width-P.height*oe)/2:K.isRight&&(Oe=P.width-P.height*oe),this.setPosition(new e.Point(P.x-ie+Oe,P.y-me),J),this.setHeight(Be,J)}else{var Ue=P.width/we,Ve=0;K.isVerticallyCentered?Ve=(P.height-P.width/oe)/2:K.isBottom&&(Ve=P.height-P.width/oe),this.setPosition(new e.Point(P.x-ie,P.y-me+Ve),J),this.setWidth(Ue,J)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(P){e.console.assert(!P||P instanceof e.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),P instanceof e.Rect?this._clip=P.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getFlip:function(){return!!this.flipped},setFlip:function(P){this.flipped=!!P,this._needsDraw=!0,this._raiseBoundsChange()},getOpacity:function(){return this.opacity},setOpacity:function(P){P!==this.opacity&&(this.opacity=P,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(P){this._preload=!!P,this._needsDraw=!0},getRotation:function(P){return P?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(P,N){this._degreesSpring.target.value===P&&this._degreesSpring.isAtTargetValue()||(N?this._degreesSpring.resetTo(P):this._degreesSpring.springTo(P),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(P){return this.getBoundsNoRotate(P).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(P){P!==this.compositeOperation&&(this.compositeOperation=P,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(P,N){var J=this._scaleSpring.target.value===P;if(N){if(J&&this._scaleSpring.current.value===P)return;this._scaleSpring.resetTo(P),this._updateForScale(),this._needsDraw=!0}else{if(J)return;this._scaleSpring.springTo(P),this._updateForScale(),this._needsDraw=!0}J||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var P=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),N=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,J=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(N/this.minPixelRatio)/Math.log(2))));return J=Math.max(J,this.source.minLevel||0),P=Math.min(P,J),{lowestLevel:P,highestLevel:J}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){var P=this.lastDrawn.pop();P.beingDrawn=!1}var N=this.viewport,J=this._viewportToTiledImageRectangle(N.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var K=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(J=J.intersection(K),J===null)return}for(var oe=this._getLevelsInterval(),ie=oe.lowestLevel,me=oe.highestLevel,we=null,De=!1,Be=e.now(),Oe=me;Oe>=ie;Oe--){var Ue=!1,Ve=N.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Oe),!0).x*this._scaleSpring.current.value;if(Oe===ie||!De&&Ve>=this.minPixelRatio)Ue=!0,De=!0;else if(!De)continue;var et=N.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Oe),!1).x*this._scaleSpring.current.value,$e=N.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,lt=this.immediateRender?1:$e,dt=Math.min(1,(Ve-.5)/.5),At=lt/Math.abs(lt-et);if(we=n(this,De,Ue,Oe,dt,At,J,Be,we),_(this.coverage,Oe))break}U(this,this.lastDrawn),we&&!we.context2D?(h(this,we,Be),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(this._tilesLoading===0)},_getCornerTiles:function(P,N,J){var K,oe;this.wrapHorizontal?(K=e.positiveModulo(N.x,1),oe=e.positiveModulo(J.x,1)):(K=Math.max(0,N.x),oe=Math.min(1,J.x));var ie,me,we=1/this.source.aspectRatio;this.wrapVertical?(ie=e.positiveModulo(N.y,we),me=e.positiveModulo(J.y,we)):(ie=Math.max(0,N.y),me=Math.min(we,J.y));var De=this.source.getTileAtPoint(P,new e.Point(K,ie)),Be=this.source.getTileAtPoint(P,new e.Point(oe,me)),Oe=this.source.getNumTiles(P);return this.wrapHorizontal&&(De.x+=Oe.x*Math.floor(N.x),Be.x+=Oe.x*Math.floor(J.x)),this.wrapVertical&&(De.y+=Oe.y*Math.floor(N.y/we),Be.y+=Oe.y*Math.floor(J.y/we)),{topLeft:De,bottomRight:Be}}});function n(P,N,J,K,oe,ie,me,we,De){var Be=me.getBoundingBox().getTopLeft(),Oe=me.getBoundingBox().getBottomRight();P.viewer&&P.viewer.raiseEvent("update-level",{tiledImage:P,havedrawn:N,level:K,opacity:oe,visibility:ie,drawArea:me,topleft:Be,bottomright:Oe,currenttime:we,best:De}),I(P.coverage,K),I(P.loadingCoverage,K);var Ue=P._getCornerTiles(K,Be,Oe),Ve=Ue.topLeft,et=Ue.bottomRight,$e=P.source.getNumTiles(K),lt=P.viewport.pixelFromPoint(P.viewport.getCenter());P.getFlip()&&(et.x+=1,P.wrapHorizontal||(et.x=Math.min(et.x,$e.x-1)));for(var dt=Ve.x;dt<=et.x;dt++)for(var At=Ve.y;At<=et.y;At++){var Le;if(P.getFlip()){var gt=($e.x+dt%$e.x)%$e.x;Le=dt+$e.x-gt-gt-1}else Le=dt;me.intersection(P.getTileBounds(K,Le,At))!==null&&(De=o(P,J,N,Le,At,K,oe,ie,lt,$e,we,De))}return De}function o(P,N,J,K,oe,ie,me,we,De,Be,Oe,Ue){var Ve=l(K,oe,ie,P,P.source,P.tilesMatrix,Oe,Be,P._worldWidthCurrent,P._worldHeightCurrent),et=J;P.viewer&&P.viewer.raiseEvent("update-tile",{tiledImage:P,tile:Ve}),k(P.coverage,ie,K,oe,!1);var $e=Ve.loaded||Ve.loading||C(P.loadingCoverage,ie,K,oe);if(k(P.loadingCoverage,ie,K,oe,$e),!Ve.exists||(N&&!et&&(C(P.coverage,ie,K,oe)?k(P.coverage,ie,K,oe,!0):et=!0),!et))return Ue;if(v(Ve,P.source.tileOverlap,P.viewport,De,we,P),!Ve.loaded)if(Ve.context2D)g(P,Ve);else{var lt=P._tileCache.getImageRecord(Ve.cacheKey);if(lt){var dt=lt.getImage();g(P,Ve,dt)}}if(Ve.loaded){var At=E(P,Ve,K,oe,ie,me,Oe);At&&(P._needsDraw=!0)}else Ve.loading?P._tilesLoading++:$e||(Ue=X(Ue,Ve));return Ue}function l(P,N,J,K,oe,ie,me,we,De,Be){var Oe,Ue,Ve,et,$e,lt,dt,At,Le;return ie[J]||(ie[J]={}),ie[J][P]||(ie[J][P]={}),(!ie[J][P][N]||!ie[J][P][N].flipped!=!K.flipped)&&(Oe=(we.x+P%we.x)%we.x,Ue=(we.y+N%we.y)%we.y,Ve=K.getTileBounds(J,P,N),et=oe.getTileBounds(J,Oe,Ue,!0),$e=oe.tileExists(J,Oe,Ue),lt=oe.getTileUrl(J,Oe,Ue),K.loadTilesWithAjax?(dt=oe.getTileAjaxHeaders(J,Oe,Ue),e.isPlainObject(K.ajaxHeaders)&&(dt=e.extend({},K.ajaxHeaders,dt))):dt=null,At=oe.getContext2D?oe.getContext2D(J,Oe,Ue):void 0,Le=new e.Tile(J,P,N,Ve,$e,lt,At,K.loadTilesWithAjax,dt,et),K.getFlip()?Oe===0&&(Le.isRightMost=!0):Oe===we.x-1&&(Le.isRightMost=!0),Ue===we.y-1&&(Le.isBottomMost=!0),Le.flipped=K.flipped,ie[J][P][N]=Le),Le=ie[J][P][N],Le.lastTouchTime=me,Le}function h(P,N,J){N.loading=!0,P._imageLoader.addJob({src:N.url,loadWithAjax:N.loadWithAjax,ajaxHeaders:N.ajaxHeaders,crossOriginPolicy:P.crossOriginPolicy,ajaxWithCredentials:P.ajaxWithCredentials,callback:function(K,oe,ie){f(P,N,J,K,oe,ie)},abort:function(){N.loading=!1}})}function f(P,N,J,K,oe,ie){if(!K){e.console.log("Tile %s failed to load: %s - error: %s",N,N.url,oe),P.viewer.raiseEvent("tile-load-failed",{tile:N,tiledImage:P,time:J,message:oe,tileRequest:ie}),N.loading=!1,N.exists=!1;return}if(J<P.lastResetTime){e.console.log("Ignoring tile %s loaded before reset: %s",N,N.url),N.loading=!1;return}var me=function(){var we=P.source.getClosestLevel();g(P,N,K,we,ie)};P._midDraw?window.setTimeout(me,1):me()}function g(P,N,J,K,oe){var ie=0;function me(){return ie++,we}function we(){ie--,ie===0&&(N.loading=!1,N.loaded=!0,N.context2D||P._tileCache.cacheTile({image:J,tile:N,cutoff:K,tiledImage:P}),P._needsDraw=!0)}P.viewer.raiseEvent("tile-loaded",{tile:N,tiledImage:P,tileRequest:oe,image:J,getCompletionCallback:me}),me()()}function v(P,N,J,K,oe,ie){var me=P.bounds.getTopLeft();me.x*=ie._scaleSpring.current.value,me.y*=ie._scaleSpring.current.value,me.x+=ie._xSpring.current.value,me.y+=ie._ySpring.current.value;var we=P.bounds.getSize();we.x*=ie._scaleSpring.current.value,we.y*=ie._scaleSpring.current.value;var De=J.pixelFromPointNoRotate(me,!0),Be=J.pixelFromPointNoRotate(me,!1),Oe=J.deltaPixelsFromPointsNoRotate(we,!0),Ue=J.deltaPixelsFromPointsNoRotate(we,!1),Ve=Be.plus(Ue.divide(2)),et=K.squaredDistanceTo(Ve);N||(Oe=Oe.plus(new e.Point(1,1))),P.isRightMost&&ie.wrapHorizontal&&(Oe.x+=.75),P.isBottomMost&&ie.wrapVertical&&(Oe.y+=.75),P.position=De,P.size=Oe,P.squaredDistance=et,P.visibility=oe}function E(P,N,J,K,oe,ie,me){var we=1e3*P.blendTime,De,Be;if(N.blendStart||(N.blendStart=me),De=me-N.blendStart,Be=we?Math.min(1,De/we):1,P.alwaysBlend&&(Be*=ie),N.opacity=Be,P.lastDrawn.push(N),Be===1)k(P.coverage,oe,J,K,!0),P._hasOpaqueTile=!0;else if(De<we)return!0;return!1}function _(P,N,J,K){var oe,ie,me,we;if(!P[N])return!1;if(J===void 0||K===void 0){oe=P[N];for(me in oe)if(Object.prototype.hasOwnProperty.call(oe,me)){ie=oe[me];for(we in ie)if(Object.prototype.hasOwnProperty.call(ie,we)&&!ie[we])return!1}return!0}return P[N][J]===void 0||P[N][J][K]===void 0||P[N][J][K]===!0}function C(P,N,J,K){return J===void 0||K===void 0?_(P,N+1):_(P,N+1,2*J,2*K)&&_(P,N+1,2*J,2*K+1)&&_(P,N+1,2*J+1,2*K)&&_(P,N+1,2*J+1,2*K+1)}function k(P,N,J,K,oe){if(!P[N]){e.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",N);return}P[N][J]||(P[N][J]={}),P[N][J][K]=oe}function I(P,N){P[N]={}}function X(P,N){return!P||N.visibility>P.visibility||N.visibility===P.visibility&&N.squaredDistance<P.squaredDistance?N:P}function U(P,N){if(!(P.opacity===0||N.length===0&&!P.placeholderFillStyle)){var J=N[0],K;J&&(K=P.opacity<1||P.compositeOperation&&P.compositeOperation!=="source-over"||!P._isBottomItem()&&J._hasTransparencyChannel());var oe,ie,me=P.viewport.getZoom(!0),we=P.viewportToImageZoom(me);N.length>1&&we>P.smoothTileEdgesMinZoom&&!P.iOSDevice&&P.getRotation(!0)%360===0&&e.supportsCanvas&&(K=!0,oe=J.getScaleForEdgeSmoothing(),ie=J.getTranslationForEdgeSmoothing(oe,P._drawer.getCanvasSize(!1),P._drawer.getCanvasSize(!0)));var De;K&&(oe||(De=P.viewport.viewportToViewerElementRectangle(P.getClippedBounds(!0)).getIntegerBoundingBox(),P._drawer.viewer.viewport.getFlip()&&(P.viewport.degrees!==0||P.getRotation(!0)%360!==0)&&(De.x=P._drawer.viewer.container.clientWidth-(De.x+De.width)),De=De.times(e.pixelDensityRatio)),P._drawer._clear(!0,De)),oe||(P.viewport.degrees!==0&&P._drawer._offsetForRotation({degrees:P.viewport.degrees,useSketch:K}),P.getRotation(!0)%360!==0&&P._drawer._offsetForRotation({degrees:P.getRotation(!0),point:P.viewport.pixelFromPointNoRotate(P._getRotationPoint(!0),!0),useSketch:K}),P.viewport.degrees===0&&P.getRotation(!0)%360===0&&P._drawer.viewer.viewport.getFlip()&&P._drawer._flip());var Be=!1;if(P._clip){P._drawer.saveContext(K);var Oe=P.imageToViewportRectangle(P._clip,!0);Oe=Oe.rotate(-P.getRotation(!0),P._getRotationPoint(!0));var Ue=P._drawer.viewportToDrawerRectangle(Oe);oe&&(Ue=Ue.times(oe)),ie&&(Ue=Ue.translate(ie)),P._drawer.setClip(Ue,K),Be=!0}if(P._croppingPolygons){P._drawer.saveContext(K);try{var Ve=P._croppingPolygons.map(function(dt){return dt.map(function(At){var Le=P.imageToViewportCoordinates(At.x,At.y,!0).rotate(-P.getRotation(!0),P._getRotationPoint(!0)),gt=P._drawer.viewportCoordToDrawerCoord(Le);return oe&&(gt=gt.times(oe)),gt})});P._drawer.clipWithPolygons(Ve,K)}catch(dt){e.console.error(dt)}Be=!0}if(P.placeholderFillStyle&&P._hasOpaqueTile===!1){var et=P._drawer.viewportToDrawerRectangle(P.getBounds(!0));oe&&(et=et.times(oe)),ie&&(et=et.translate(ie));var $e=null;typeof P.placeholderFillStyle=="function"?$e=P.placeholderFillStyle(P,P._drawer.context):$e=P.placeholderFillStyle,P._drawer.drawRectangle(et,$e,K)}for(var lt=N.length-1;lt>=0;lt--)J=N[lt],P._drawer.drawTile(J,P._drawingHandler,K,oe,ie),J.beingDrawn=!0,P.viewer&&P.viewer.raiseEvent("tile-drawn",{tiledImage:P,tile:J});Be&&P._drawer.restoreContext(K),oe||(P.getRotation(!0)%360!==0&&P._drawer._restoreRotationChanges(K),P.viewport.degrees!==0&&P._drawer._restoreRotationChanges(K)),K&&(oe&&(P.viewport.degrees!==0&&P._drawer._offsetForRotation({degrees:P.viewport.degrees,useSketch:!1}),P.getRotation(!0)%360!==0&&P._drawer._offsetForRotation({degrees:P.getRotation(!0),point:P.viewport.pixelFromPointNoRotate(P._getRotationPoint(!0),!0),useSketch:!1})),P._drawer.blendSketch({opacity:P.opacity,scale:oe,translate:ie,compositeOperation:P.compositeOperation,bounds:De}),oe&&(P.getRotation(!0)%360!==0&&P._drawer._restoreRotationChanges(!1),P.viewport.degrees!==0&&P._drawer._restoreRotationChanges(!1))),oe||P.viewport.degrees===0&&P.getRotation(!0)%360===0&&P._drawer.viewer.viewport.getFlip()&&P._drawer._flip(),$(P,N)}}function $(P,N){if(P.debugMode)for(var J=N.length-1;J>=0;J--){var K=N[J];try{P._drawer.drawDebugInfo(K,N.length,J,P)}catch(oe){e.console.error(oe)}}}}(r),function(e){var n=function(l){e.console.assert(l,"[TileCache.cacheTile] options is required"),e.console.assert(l.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(l.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=l.tile,this.tiledImage=l.tiledImage},o=function(l){e.console.assert(l,"[ImageRecord] options is required"),e.console.assert(l.image,"[ImageRecord] options.image is required"),this._image=l.image,this._tiles=[]};o.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){if(!this._renderedContext){var l=document.createElement("canvas");l.width=this._image.width,l.height=this._image.height,this._renderedContext=l.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null}return this._renderedContext},setRenderedContext:function(l){e.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=l},addTile:function(l){e.console.assert(l,"[ImageRecord.addTile] tile is required"),this._tiles.push(l)},removeTile:function(l){for(var h=0;h<this._tiles.length;h++)if(this._tiles[h]===l){this._tiles.splice(h,1);return}e.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",l)},getTileCount:function(){return this._tiles.length}},e.TileCache=function(l){l=l||{},this._maxImageCacheCount=l.maxImageCacheCount||e.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},e.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(l){e.console.assert(l,"[TileCache.cacheTile] options is required"),e.console.assert(l.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(l.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),e.console.assert(l.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var h=l.cutoff||0,f=this._tilesLoaded.length,g=this._imagesLoaded[l.tile.cacheKey];if(g||(e.console.assert(l.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),g=this._imagesLoaded[l.tile.cacheKey]=new o({image:l.image}),this._imagesLoadedCount++),g.addTile(l.tile),l.tile.cacheImageRecord=g,this._imagesLoadedCount>this._maxImageCacheCount){for(var v=null,E=-1,_=null,C,k,I,X,U,$,P=this._tilesLoaded.length-1;P>=0;P--)if($=this._tilesLoaded[P],C=$.tile,!(C.level<=h||C.beingDrawn)){if(!v){v=C,E=P,_=$;continue}X=C.lastTouchTime,k=v.lastTouchTime,U=C.level,I=v.level,(X<k||X===k&&U>I)&&(v=C,E=P,_=$)}v&&E>=0&&(this._unloadTile(_),f=E)}this._tilesLoaded[f]=new n({tile:l.tile,tiledImage:l.tiledImage})},clearTilesFor:function(l){e.console.assert(l,"[TileCache.clearTilesFor] tiledImage is required");for(var h,f=0;f<this._tilesLoaded.length;++f)h=this._tilesLoaded[f],h.tiledImage===l&&(this._unloadTile(h),this._tilesLoaded.splice(f,1),f--)},getImageRecord:function(l){return e.console.assert(l,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[l]},_unloadTile:function(l){e.console.assert(l,"[TileCache._unloadTile] tileRecord is required");var h=l.tile,f=l.tiledImage;h.unload(),h.cacheImageRecord=null;var g=this._imagesLoaded[h.cacheKey];g.removeTile(h),g.getTileCount()||(g.destroy(),delete this._imagesLoaded[h.cacheKey],this._imagesLoadedCount--),f.viewer.raiseEvent("tile-unloaded",{tile:h,tiledImage:f})}}}(r),function(e){e.World=function(n){var o=this;e.console.assert(n.viewer,"[World] options.viewer is required"),e.EventSource.call(this),this.viewer=n.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(l){o._autoRefigureSizes?o._figureSizes():o._needsSizesFigured=!0},this._figureSizes()},e.extend(e.World.prototype,e.EventSource.prototype,{addItem:function(n,o){if(e.console.assert(n,"[World.addItem] item is required"),e.console.assert(n instanceof e.TiledImage,"[World.addItem] only TiledImages supported at this time"),o=o||{},o.index!==void 0){var l=Math.max(0,Math.min(this._items.length,o.index));this._items.splice(l,0,n)}else this._items.push(n);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,n.addHandler("bounds-change",this._delegatedFigureSizes),n.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:n})},getItemAt:function(n){return e.console.assert(n!==void 0,"[World.getItemAt] index is required"),this._items[n]},getIndexOfItem:function(n){return e.console.assert(n,"[World.getIndexOfItem] item is required"),e.indexOf(this._items,n)},getItemCount:function(){return this._items.length},setItemIndex:function(n,o){e.console.assert(n,"[World.setItemIndex] item is required"),e.console.assert(o!==void 0,"[World.setItemIndex] index is required");var l=this.getIndexOfItem(n);if(o>=this._items.length)throw new Error("Index bigger than number of layers.");o===l||l===-1||(this._items.splice(l,1),this._items.splice(o,0,n),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:n,previousIndex:l,newIndex:o}))},removeItem:function(n){e.console.assert(n,"[World.removeItem] item is required");var o=e.indexOf(this._items,n);o!==-1&&(n.removeHandler("bounds-change",this._delegatedFigureSizes),n.removeHandler("clip-change",this._delegatedFigureSizes),n.destroy(),this._items.splice(o,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(n))},removeAll:function(){this.viewer._cancelPendingImages();var n,o;for(o=0;o<this._items.length;o++)n=this._items[o],n.removeHandler("bounds-change",this._delegatedFigureSizes),n.removeHandler("clip-change",this._delegatedFigureSizes),n.destroy();var l=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,o=0;o<l.length;o++)n=l[o],this._raiseRemoveItem(n)},resetItems:function(){for(var n=0;n<this._items.length;n++)this._items[n].reset()},update:function(){for(var n=!1,o=0;o<this._items.length;o++)n=this._items[o].update()||n;return n},draw:function(){for(var n=0;n<this._items.length;n++)this._items[n].draw();this._needsDraw=!1},needsDraw:function(){for(var n=0;n<this._items.length;n++)if(this._items[n].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(n){this._autoRefigureSizes=n,n&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(n){n=n||{};var o=n.immediately||!1,l=n.layout||e.DEFAULT_SETTINGS.collectionLayout,h=n.rows||e.DEFAULT_SETTINGS.collectionRows,f=n.columns||e.DEFAULT_SETTINGS.collectionColumns,g=n.tileSize||e.DEFAULT_SETTINGS.collectionTileSize,v=n.tileMargin||e.DEFAULT_SETTINGS.collectionTileMargin,E=g+v,_;!n.rows&&f?_=f:_=Math.ceil(this._items.length/h);var C=0,k=0,I,X,U,$,P;this.setAutoRefigureSizes(!1);for(var N=0;N<this._items.length;N++)N&&N%_===0&&(l==="horizontal"?(k+=E,C=0):(C+=E,k=0)),I=this._items[N],X=I.getBounds(),X.width>X.height?U=g:U=g*(X.width/X.height),$=U*(X.height/X.width),P=new e.Point(C+(g-U)/2,k+(g-$)/2),I.setPosition(P,o),I.setWidth(U,o),l==="horizontal"?C+=E:k+=E;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var n=this._homeBounds?this._homeBounds.clone():null,o=this._contentSize?this._contentSize.clone():null,l=this._contentFactor||0;if(!this._items.length)this._homeBounds=new e.Rect(0,0,1,1),this._contentSize=new e.Point(1,1),this._contentFactor=1;else{var h=this._items[0],f=h.getBounds();this._contentFactor=h.getContentSize().x/f.width;for(var g=h.getClippedBounds().getBoundingBox(),v=g.x,E=g.y,_=g.x+g.width,C=g.y+g.height,k=1;k<this._items.length;k++)h=this._items[k],f=h.getBounds(),this._contentFactor=Math.max(this._contentFactor,h.getContentSize().x/f.width),g=h.getClippedBounds().getBoundingBox(),v=Math.min(v,g.x),E=Math.min(E,g.y),_=Math.max(_,g.x+g.width),C=Math.max(C,g.y+g.height);this._homeBounds=new e.Rect(v,E,_-v,C-E),this._contentSize=new e.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}(this._contentFactor!==l||!this._homeBounds.equals(n)||!this._contentSize.equals(o))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(n){this.raiseEvent("remove-item",{item:n})}})}(r)})(Eg);var ii=Eg.exports;const ct="http://www.w3.org/2000/svg",du=t=>{const r=t.getAttribute("class");return r?new Set(r.split(" ")):new Set},ri=(t,r)=>{const e=du(t);e.add(r),t.setAttribute("class",Array.from(e).join(" "))},Us=(t,r)=>{const e=du(t);e.delete(r),e.size===0?t.removeAttribute("class"):t.setAttribute("class",Array.from(e).join(" "))},pu=(t,r)=>du(t).has(r),yi=(t,r)=>{const e=t.selector("FragmentSelector");if(e!=null&&e.conformsTo.startsWith("http://www.w3.org/TR/media-frags")){const{value:n}=e,o=n.includes(":")?n.substring(n.indexOf("=")+1,n.indexOf(":")):"pixel",l=n.includes(":")?n.substring(n.indexOf(":")+1):n.substring(n.indexOf("=")+1);let[h,f,g,v]=l.split(",").map(parseFloat);return o.toLowerCase()==="percent"&&(h=h*r.naturalWidth/100,f=f*r.naturalHeight/100,g=g*r.naturalWidth/100,v=v*r.naturalHeight/100),{x:h,y:f,w:g,h:v}}},RP=(t,r,e,n,o)=>({source:o==null?void 0:o.src,selector:{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:`xywh=pixel:${t},${r},${e},${n}`}}),AP=(t,r,e,n,o)=>{const l=t/o.naturalWidth*100,h=r/o.naturalHeight*100,f=e/o.naturalWidth*100,g=n/o.naturalHeight*100;return{source:o.src,selector:{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:`xywh=percent:${l},${h},${f},${g}`}}},yr=(t,r,e,n,o,l)=>(l==null?void 0:l.toLowerCase())==="percent"?AP(t,r,e,n,o):RP(t,r,e,n,o),Vs=(t,r,e,n,o)=>{t.setAttribute("x",r),t.setAttribute("y",e),t.setAttribute("width",n),t.setAttribute("height",o)},Ws=(t,r,e)=>{t.setAttribute("cx",r),t.setAttribute("cy",e),t.setAttribute("r",7)},xg=(t,r,e,n,o)=>{const l=document.createElementNS(ct,"path");l.setAttribute("fill-rule","evenodd");const{naturalWidth:h,naturalHeight:f}=t;return l.setAttribute("d",`M0 0 h${h} v${f} h-${h} z M${r} ${e} h${n} v${o} h-${n} z`),l},bg=(t,r,e,n,o,l)=>{const{naturalWidth:h,naturalHeight:f}=r;t.setAttribute("d",`M0 0 h${h} v${f} h-${h} z M${e} ${n} h${o} v${l} h-${o} z`)},fu=(t,r,e,n)=>{const{x:o,y:l,w:h,h:f}=t.type==="Annotation"||t.type==="Selection"?yi(t,r):{x:t,y:r,w:e,h:n},g=document.createElementNS(ct,"g");if(h===0&&f===0){ri(g,"a9s-point"),ri(g,"a9s-non-scaling"),g.setAttribute("transform-origin",`${o} ${l}`);const v=document.createElementNS(ct,"circle"),E=document.createElementNS(ct,"circle");E.setAttribute("class","a9s-inner"),Ws(E,o,l),v.setAttribute("class","a9s-outer"),Ws(v,o,l),g.appendChild(v),g.appendChild(E)}else{const v=document.createElementNS(ct,"rect"),E=document.createElementNS(ct,"rect");E.setAttribute("class","a9s-inner"),Vs(E,o,l,h,f),v.setAttribute("class","a9s-outer"),Vs(v,o,l,h,f),g.appendChild(v),g.appendChild(E)}return g},gu=t=>{const r=t.querySelector(".a9s-outer");if(r.nodeName==="rect"){const e=parseFloat(r.getAttribute("x")),n=parseFloat(r.getAttribute("y")),o=parseFloat(r.getAttribute("width")),l=parseFloat(r.getAttribute("height"));return{x:e,y:n,w:o,h:l}}else{const e=parseFloat(r.getAttribute("cx")),n=parseFloat(r.getAttribute("cy"));return{x:e,y:n,w:0,h:0}}},Sg=(t,r,e,n,o)=>{const l=t.querySelector(".a9s-inner"),h=t.querySelector(".a9s-outer");h.nodeName==="rect"?(Vs(l,r,e,n,o),Vs(h,r,e,n,o)):(Ws(l,r,e),Ws(h,r,e))},DP=(t,r)=>{const{w:e,h:n}=yi(t,r);return e*n};class OP{constructor(r,e,n,o,l){i(this,"dragTo",(h,f)=>{this.group.style.display=null,this.opposite=[h,f];const{x:g,y:v,w:E,h:_}=this.bbox;bg(this.mask,this.env.image,g,v,E,_),Sg(this.rect,g,v,E,_)}),i(this,"getBoundingClientRect",()=>this.rect.getBoundingClientRect()),i(this,"toSelection",()=>{const{x:h,y:f,w:g,h:v}=this.bbox;return new go(yr(h,f,g,v,this.env.image,this.config.fragmentUnit))}),i(this,"destroy",()=>{this.group.parentNode.removeChild(this.group),this.mask=null,this.rect=null,this.group=null}),this.anchor=[r,e],this.opposite=[r,e],this.config=o,this.env=l,this.group=document.createElementNS(ct,"g"),this.mask=xg(l.image,r,e,2,2),this.mask.setAttribute("class","a9s-selection-mask"),this.rect=fu(r,e,2,2),this.rect.setAttribute("class","a9s-selection"),this.group.style.pointerEvents="none",this.group.style.display="none",this.group.appendChild(this.mask),this.group.appendChild(this.rect),n.appendChild(this.group)}get bbox(){const r=this.opposite[0]-this.anchor[0],e=this.opposite[1]-this.anchor[1];return{x:r>0?this.anchor[0]:this.opposite[0],y:e>0?this.anchor[1]:this.opposite[1],w:Math.max(1,Math.abs(r)),h:Math.max(1,Math.abs(e))}}get element(){return this.rect}}const kP={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"},mu=()=>"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,BP=t=>{let r=null;const e=(o,l)=>new MouseEvent(o,{screenX:l.screenX,screenY:l.screenY,clientX:l.clientX,clientY:l.clientY,pageX:l.pageX,pageY:l.pageY,bubbles:!0}),n=o=>{const l=o.changedTouches[0],h=e(kP[o.type],l);l.target.dispatchEvent(h),o.preventDefault(),(o.type==="touchstart"||o.type==="touchmove")&&(r&&clearTimeout(r),r=setTimeout(()=>{const f=e("dblclick",l);l.target.dispatchEvent(f)},800)),o.type==="touchend"&&r&&clearTimeout(r)};t.addEventListener("touchstart",n,!0),t.addEventListener("touchmove",n,!0),t.addEventListener("touchend",n,!0),t.addEventListener("touchcancel",n,!0)},Gs="An implementation is missing",MP=mu();class _g extends Uo{constructor(r,e,n){super(),i(this,"enableResponsive",()=>{window.ResizeObserver&&(this.resizeObserver=new ResizeObserver(()=>{const l=this.svg.getBoundingClientRect(),{width:h,height:f}=this.svg.viewBox.baseVal;this.scale=Math.max(h/l.width,f/l.height),this.onScaleChanged&&this.onScaleChanged(this.scale)}),this.resizeObserver.observe(this.svg.parentNode))}),i(this,"getSVGPoint",l=>{const h=this.svg.createSVGPoint();if(MP){const f=this.svg.getBoundingClientRect(),g=l.clientX-f.x,v=l.clientY-f.y,{left:E,top:_}=this.svg.getBoundingClientRect();return h.x=g+E,h.y=v+_,h.matrixTransform(this.g.getScreenCTM().inverse())}else return h.x=l.offsetX,h.y=l.offsetY,h.matrixTransform(this.g.getCTM().inverse())}),i(this,"drawHandle",(l,h)=>{const f=document.createElementNS(ct,"g");f.setAttribute("class","a9s-handle");const g=document.createElementNS(ct,"g"),v=k=>{const I=document.createElementNS(ct,"circle");return I.setAttribute("cx",l),I.setAttribute("cy",h),I.setAttribute("r",k),I.setAttribute("transform-origin",`${l} ${h}`),I},E=this.config.handleRadius||6,_=v(E);_.setAttribute("class","a9s-handle-inner");const C=v(E+1);return C.setAttribute("class","a9s-handle-outer"),g.appendChild(C),g.appendChild(_),f.appendChild(g),f}),i(this,"setHandleXY",(l,h,f)=>{const g=l.querySelector(".a9s-handle-inner");g.setAttribute("cx",h),g.setAttribute("cy",f),g.setAttribute("transform-origin",`${h} ${f}`);const v=l.querySelector(".a9s-handle-outer");v.setAttribute("cx",h),v.setAttribute("cy",f),v.setAttribute("transform-origin",`${h} ${f}`)}),i(this,"getHandleXY",l=>{const h=l.querySelector(".a9s-handle-outer");return{x:parseFloat(h.getAttribute("cx")),y:parseFloat(h.getAttribute("cy"))}}),i(this,"scaleHandle",l=>{const h=l.querySelector(".a9s-handle-inner"),f=l.querySelector(".a9s-handle-outer"),g=this.scale*(this.config.handleRadius||6);h.setAttribute("r",g),f.setAttribute("r",g)}),this.svg=r.closest("svg"),this.g=r,this.config=e,this.env=n,this.scale=1;const{image:o}=n;(o instanceof Element||o instanceof HTMLDocument)&&this.enableResponsive()}destroy(){this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=null}}class vu extends _g{constructor(r,e,n){super(r,e,n),i(this,"attachListeners",({mouseMove:o,mouseUp:l,dblClick:h})=>{o&&(this.mouseMove=f=>{const{x:g,y:v}=this.getSVGPoint(f);this.started||(this.emit("startSelection",{x:g,y:v}),this.started=!0),o(g,v,f)},this.svg.addEventListener("mousemove",this.mouseMove)),l&&(this.mouseUp=f=>{if(f.button!==0)return;const{x:g,y:v}=this.getSVGPoint(f);l(g,v,f)},document.addEventListener("mouseup",this.mouseUp)),h&&(this.dblClick=f=>{const{x:g,y:v}=this.getSVGPoint(f);h(g,v,f)},document.addEventListener("dblclick",this.dblClick))}),i(this,"detachListeners",()=>{this.mouseMove&&this.svg.removeEventListener("mousemove",this.mouseMove),this.mouseUp&&document.removeEventListener("mouseup",this.mouseUp),this.dblClick&&document.removeEventListener("dblclick",this.dblClick)}),i(this,"start",(o,l)=>{const{x:h,y:f}=this.getSVGPoint(o),{naturalWidth:g,naturalHeight:v}=this.env.image,E=h<0?0:h>g?g:h,_=f<0?0:f>v?v:f;this.startDrawing(E,_,l,o)}),i(this,"startDrawing",o=>{throw new Error(Gs)}),i(this,"createEditableShape",(o,l)=>{throw new Error(Gs)}),this.started=!1}get isDrawing(){throw new Error(Gs)}}vu.supports=t=>{throw new Error(Gs)};const Tg="An implementation is missing";class Cg extends _g{constructor(r,e,n,o){super(e,n,o),i(this,"updateState",l=>{throw new Error(Tg)}),this.annotation=r}get element(){throw new Error(Tg)}}const FP=/firefox/i.test(navigator.userAgent),Pg=(t,r,e,n,o)=>{t.setAttribute("width",n),t.setAttribute("height",o),FP?(t.setAttribute("x",0),t.setAttribute("y",0),t.setAttribute("transform",`translate(${r}, ${e})`)):(t.setAttribute("x",r),t.setAttribute("y",e))},IP=(t,r)=>{const{x:e,y:n,width:o,height:l}=r.getBBox(),h=document.createElementNS(ct,"svg");h.setAttribute("class","a9s-formatter-el"),Pg(h,e,n,o,l);const f=document.createElementNS(ct,"g");f.appendChild(t),h.appendChild(f),r.append(h)},qs=(t,r,e)=>{if(!e)return t;const n=e.reduce((f,g)=>{const v=g(r);if(!v)return f;if(typeof v=="string"||v instanceof String)f.className=f.className?`${f.className} ${v}`:v;else if(v.nodeType===Node.ELEMENT_NODE)f.elements=f.elements?[...f.elements,v]:[v];else{const{className:E,style:_,element:C}=v;E&&(f.className=f.className?`${f.className} ${E}`:E),_&&(f.style=f.style?`${f.style} ${_}`:_),C&&(f.elements=f.elements?[...f.elements,C]:[C])}for(const E in v)v.hasOwnProperty(E)&&E.startsWith("data-")&&(f[E]=v[E]);return f},{}),{className:o,style:l,elements:h}=n;if(o&&ri(t,o),l){const f=t.querySelector(".a9s-outer"),g=t.querySelector(".a9s-inner");f&&g?(f.setAttribute("style","display:none"),g.setAttribute("style",l)):t.setAttribute("style",l)}h&&h.forEach(f=>IP(f,t));for(const f in n)n.hasOwnProperty(f)&&f.startsWith("data-")&&t.setAttribute(f,n[f])},Rg=(t,r,e,n,o)=>{const l=t.querySelector(".a9s-formatter-el");l&&Pg(l,r,e,n,o)},mo="corner",Zs="edge";class LP extends Cg{constructor(r,e,n,o){super(r,e,n,o),i(this,"onScaleChanged",()=>this.handles.map(this.scaleHandle)),i(this,"setSize",(E,_,C,k)=>{Sg(this.rectangle,E,_,C,k),bg(this.mask,this.env.image,E,_,C,k),Rg(this.elementGroup,E,_,C,k);const[I,X,U,$,P,N,J,K]=this.handles;this.setHandleXY(I,E,_),this.setHandleXY(X,E+C,_),this.setHandleXY(U,E+C,_+k),this.setHandleXY($,E,_+k),this.enableEdgeControls&&(this.setHandleXY(P,E+C/2,_),this.setHandleXY(N,E+C,_+k/2),this.setHandleXY(J,E+C/2,_+k),this.setHandleXY(K,E,_+k/2))}),i(this,"stretchCorners",(E,_,C)=>{const k=this.getHandleXY(_),I=C.x-k.x,X=C.y-k.y,U=I>0?k.x:C.x,$=X>0?k.y:C.y,P=Math.abs(I),N=Math.abs(X);return this.setSize(U,$,P,N),{x:U,y:$,w:P,h:N}}),i(this,"stretchEdge",(E,_,C)=>{const k=this.getHandleXY(_),I=gu(this.rectangle),X=E%2===0,U=X?I.w:C.x-k.x,$=X?C.y-k.y:I.h,P=X?I.x:U>0?k.x:C.x,N=X?$>0?k.y:C.y:I.y,J=Math.abs(U),K=Math.abs($);return this.setSize(P,N,J,K),{x:P,y:N,w:J,h:K}}),i(this,"onGrab",(E,_)=>C=>{if(C.button!==0)return;this.grabbedElem=E,this.grabbedType=_;const k=this.getSVGPoint(C),{x:I,y:X}=gu(this.rectangle);this.mouseOffset={x:k.x-I,y:k.y-X}}),i(this,"onMouseMove",E=>{if(E.button!==0)return;const _=(C,k)=>C<0?0:C>k?k:C;if(this.grabbedElem){const C=this.getSVGPoint(E);if(this.grabbedElem===this.rectangle){const{w:k,h:I}=gu(this.rectangle),{naturalWidth:X,naturalHeight:U}=this.env.image,$=_(C.x-this.mouseOffset.x,X-k),P=_(C.y-this.mouseOffset.y,U-I);this.setSize($,P,k,I),this.emit("update",yr($,P,k,I,this.env.image,this.config.fragmentUnit))}else{const k=this.handles.indexOf(this.grabbedElem),I=this.handles[k^2],{x:X,y:U,w:$,h:P}=this.grabbedType===mo?this.stretchCorners(k,I,C):this.stretchEdge(k,I,C);this.emit("update",yr(X,U,$,P,this.env.image,this.config.fragmentUnit))}}}),i(this,"onMouseUp",E=>{this.grabbedElem=null,this.grabbedType=null,this.mouseOffset=null}),i(this,"updateState",E=>{const{x:_,y:C,w:k,h:I}=yi(E,this.env.image);this.setSize(_,C,k,I)}),this.svg.addEventListener("mousemove",this.onMouseMove),this.svg.addEventListener("mouseup",this.onMouseUp);const{x:l,y:h,w:f,h:g}=yi(r,o.image);this.containerGroup=document.createElementNS(ct,"g"),this.mask=xg(o.image,l,h,f,g),this.mask.setAttribute("class","a9s-selection-mask"),this.containerGroup.appendChild(this.mask),this.elementGroup=document.createElementNS(ct,"g"),this.elementGroup.setAttribute("class","a9s-annotation editable selected"),this.elementGroup.setAttribute("data-id",r.id),this.rectangle=fu(l,h,f,g),this.rectangle.querySelector(".a9s-inner").addEventListener("mousedown",this.onGrab(this.rectangle)),this.elementGroup.appendChild(this.rectangle),this.enableEdgeControls=n.enableEdgeControls;const v=this.enableEdgeControls?[[l+f/2,h,Zs],[l+f,h+g/2,Zs],[l+f/2,h+g,Zs],[l,h+g/2,Zs]]:[];this.handles=[[l,h,mo],[l+f,h,mo],[l+f,h+g,mo],[l,h+g,mo],...v].map(E=>{const[_,C,k]=E,I=this.drawHandle(_,C);return I.addEventListener("mousedown",this.onGrab(I,k)),this.elementGroup.appendChild(I),I}),this.containerGroup.appendChild(this.elementGroup),e.appendChild(this.containerGroup),qs(this.rectangle,r,n.formatters),this.grabbedElem=null,this.grabbedType=null,this.mouseOffset=null}get element(){return this.elementGroup}destroy(){this.containerGroup.parentNode.removeChild(this.containerGroup),super.destroy()}}class Xs extends vu{constructor(r,e,n){super(r,e,n),i(this,"startDrawing",(o,l)=>{this.attachListeners({mouseMove:this.onMouseMove,mouseUp:this.onMouseUp}),this.rubberband=new OP(o,l,this.g,this.config,this.env)}),i(this,"stop",()=>{this.rubberband&&(this.rubberband.destroy(),this.rubberband=null)}),i(this,"onMouseMove",(o,l)=>{const{naturalWidth:h,naturalHeight:f}=this.env.image,g=Math.min(Math.max(o,0),h),v=Math.min(Math.max(l,0),f);this.rubberband.dragTo(g,v)}),i(this,"onMouseUp",()=>{this.detachListeners(),this.started=!1;const{width:o,height:l}=this.rubberband.getBoundingClientRect(),h=this.config.minSelectionWidth||4,f=this.config.minSelectionHeight||4;if(o>=h&&l>=f){const{element:g}=this.rubberband;g.annotation=this.rubberband.toSelection(),this.emit("complete",g)}else this.emit("cancel");this.stop()}),i(this,"createEditableShape",(o,l)=>new LP(o,this.g,{...this.config,formatters:l},this.env)),this.rubberband=null}get isDrawing(){return this.rubberband!=null}}Xs.identifier="rect",Xs.supports=t=>{const r=t.selector("FragmentSelector");return r==null?void 0:r.conformsTo.startsWith("http://www.w3.org/TR/media-frags")};const Ys=t=>{let r=0,e=t.length-1;for(let n=0;n<t.length;n++)r+=(t[e][0]+t[n][0])*(t[e][1]-t[n][1]),e=n;return Math.abs(.5*r)},HP=(t,r,e,n)=>{const o=t[0]-r,l=t[1]-e;return Math.sqrt(o*o+l*l)<=n},NP=(t,r,e,n,o,l)=>{const h=l||0,f=Math.cos(h),g=Math.sin(h),v=t[0]-r,E=t[1]-e,_=f*v+g*E,C=g*v-f*E;return _*_/(n*n)+C*C/(o*o)<=1},yu=(t,r)=>{const e=t[0],n=t[1];let o=!1;for(let l=0,h=r.length-1;l<r.length;h=l++){const f=r[l][0],g=r[l][1],v=r[h][0],E=r[h][1];g>n!=E>n&&e<(v-f)*(n-g)/(E-g)+f&&(o=!o)}return o},zP=(t,r)=>{for(let e of t)if(!yu(e,r))return!1;return!0},jP=(t,r,e,n,o,l)=>{const h=t[0],f=t[1],g=n-r,v=o-e,E=Math.sqrt(g*g+v*v);return Math.abs((h-r)*v-(f-e)*g)/E<=l},Ag=t=>{const r=t.getAttribute("d").split(/(?=M|m|L|l|H|h|V|v|Z|z)/g).map(o=>o.trim()),e=[];let n=[];for(let o of r){const l=o.substring(0,1);if(l.toLowerCase()==="z")e.push([...n]),n=[];else{const h=o.substring(1).split(" ").map(E=>parseFloat(E.trim())),f=l===l.toUpperCase(),g=f?h[0]:h[0]+n[n.length-1][0],v=f?h[1]:h[1]+n[n.length-1][1];n.push([g,v])}}return n.length>0&&e.push([...n]),e},UP=t=>{const r=new XMLSerializer().serializeToString(t.documentElement).replace("<svg>",`<svg xmlns="${ct}">`);return new DOMParser().parseFromString(r,"image/svg+xml").documentElement},Dg=t=>{const r=n=>{Array.from(n.attributes).forEach(o=>{o.name.startsWith("on")&&n.removeAttribute(o.name)})},e=t.getElementsByTagName("script");return Array.from(e).reverse().forEach(n=>n.parentNode.removeChild(n)),r(t),Array.from(t.querySelectorAll("*")).forEach(r),t},Ni=t=>{const r=t.selector("SvgSelector");if(r){const e=new DOMParser,{value:n}=r,o=e.parseFromString(n,"image/svg+xml"),l=o.lookupPrefix(ct),h=o.lookupNamespaceURI(null);return l||h?Dg(o).firstChild:Dg(UP(o)).firstChild}},Og=t=>{const r=Ni(t),e=document.createElementNS(ct,"g"),n=r.cloneNode(!0);n.setAttribute("class","a9s-inner");const o=r.cloneNode(!0);return o.setAttribute("class","a9s-outer"),e.appendChild(o),e.appendChild(n),e},wu=(t,r)=>{const e=t.querySelector(".a9s-inner").cloneNode(!0);e.removeAttribute("class"),e.removeAttribute("xmlns");let n=e.outerHTML||new XMLSerializer().serializeToString(e);return n=n.replace(` xmlns="${ct}"`,""),{source:r==null?void 0:r.src,selector:{type:"SvgSelector",value:`<svg>${n}</svg>`}}},VP=t=>{const r=Ni(t),e=r.nodeName.toLowerCase();if(e==="polygon")return WP(r);if(e==="circle")return GP(r);if(e==="ellipse")return qP(r);if(e=="path")return ZP(r);if(e=="line")return 0;throw`Unsupported SVG shape type: ${e}`},WP=t=>{const r=t.getAttribute("points").trim().split(" ").map(e=>e.split(",").map(n=>parseFloat(n.trim())));return Ys(r)},GP=t=>{const r=t.getAttribute("r");return r*r*Math.PI},qP=t=>{const r=t.getAttribute("rx"),e=t.getAttribute("ry");return r*e*Math.PI},ZP=t=>{const r=Ag(t);if(r.length==1)return Ys(r[0]);{const e=o=>r.find(l=>{if(o!==l)return zP(o,l)});let n=0;for(let o of r)e(o)?n-=Ys(o):n+=Ys(o);return n}};class kg{constructor(r,e){i(this,"redraw",()=>{this.mask.setAttribute("d",`M0 0 h${this.w} v${this.h} h-${this.w} z M${this.polygon.getAttribute("points")} z`)}),i(this,"destroy",()=>this.mask.parentNode.removeChild(this.mask)),this.w=r.naturalWidth,this.h=r.naturalHeight,this.polygon=e,this.mask=document.createElementNS(ct,"path"),this.mask.setAttribute("fill-rule","evenodd"),this.mask.setAttribute("class","a9s-selection-mask"),this.mask.setAttribute("d",`M0 0 h${this.w} v${this.h} h-${this.w} z M${this.polygon.getAttribute("points")} z`)}get element(){return this.mask}}class XP{constructor(r,e,n){i(this,"setPoints",o=>{const l=o.map(h=>`${h[0]},${h[1]}`).join(" ");this.outer.setAttribute("points",l),this.inner.setAttribute("points",l)}),i(this,"getBoundingClientRect",()=>this.outer.getBoundingClientRect()),i(this,"dragTo",o=>{this.group.style.display=null,this.mousepos=o;const l=[...this.points,o];this.setPoints(l),this.mask.redraw()}),i(this,"addPoint",()=>{const[o,l]=this.mousepos,h=this.points[this.points.length-1];Math.pow(o-h[0],2)+Math.pow(l-h[1],2)>4&&(this.points=[...this.points,this.mousepos],this.setPoints(this.points),this.mask.redraw())}),i(this,"destroy",()=>{this.group.parentNode.removeChild(this.group),this.polygon=null,this.group=null}),i(this,"toSelection",()=>new go(wu(this.group,this.env.image))),this.points=[r],this.env=n,this.mousepos=r,this.group=document.createElementNS(ct,"g"),this.polygon=document.createElementNS(ct,"g"),this.polygon.setAttribute("class","a9s-selection"),this.outer=document.createElementNS(ct,"polygon"),this.outer.setAttribute("class","a9s-outer"),this.inner=document.createElementNS(ct,"polygon"),this.inner.setAttribute("class","a9s-inner"),this.setPoints(this.points),this.mask=new kg(n.image,this.inner),this.polygon.appendChild(this.outer),this.polygon.appendChild(this.inner),this.group.style.display="none",this.group.appendChild(this.mask.element),this.group.appendChild(this.polygon),e.appendChild(this.group)}get element(){return this.polygon}}const Eu=t=>{const r=t.querySelector(".a9s-inner").points,e=[];for(let n=0;n<r.numberOfItems;n++)e.push(r.getItem(n));return e},YP=t=>t.querySelector(".a9s-inner").getBBox();class KP extends Cg{constructor(r,e,n,o){super(r,e,n,o),i(this,"onScaleChanged",()=>this.handles.map(this.scaleHandle)),i(this,"setPoints",l=>{const h=k=>Math.round(10*k)/10,f=l.map(k=>`${h(k.x)},${h(k.y)}`).join(" ");this.shape.querySelector(".a9s-inner").setAttribute("points",f);const g=this.shape.querySelector(".a9s-outer");g.setAttribute("points",f),this.mask.redraw();const{x:v,y:E,width:_,height:C}=g.getBBox();Rg(this.elementGroup,v,E,_,C)}),i(this,"onGrab",l=>h=>{h.button===0&&(this.grabbedElem=l,this.grabbedAt=this.getSVGPoint(h))}),i(this,"onMouseMove",l=>{const h=(f,g,v)=>f+g<0?-f:f+g>v?v-f:g;if(this.grabbedElem){const f=this.getSVGPoint(l);if(this.grabbedElem===this.shape){const{x:g,y:v,width:E,height:_}=YP(this.shape),{naturalWidth:C,naturalHeight:k}=this.env.image,I=h(g,f.x-this.grabbedAt.x,C-E),X=h(v,f.y-this.grabbedAt.y,k-_),U=Eu(this.shape).map($=>({x:$.x+I,y:$.y+X}));this.grabbedAt=f,this.setPoints(U),U.forEach(($,P)=>this.setHandleXY(this.handles[P],$.x,$.y)),this.emit("update",wu(this.shape,this.env.image))}else{const g=this.handles.indexOf(this.grabbedElem),v=Eu(this.shape).map((E,_)=>_===g?f:E);this.setPoints(v),this.setHandleXY(this.handles[g],f.x,f.y),this.emit("update",wu(this.shape,this.env.image))}}}),i(this,"onMouseUp",l=>{this.grabbedElem=null,this.grabbedAt=null}),i(this,"updateState",l=>{const h=Ni(l).getAttribute("points").split(" ").map(f=>{const[g,v]=f.split(",").map(E=>parseFloat(E.trim()));return{x:g,y:v}});this.setPoints(h),h.forEach((f,g)=>this.setHandleXY(this.handles[g],f.x,f.y))}),i(this,"destroy",()=>{this.containerGroup.parentNode.removeChild(this.containerGroup),super.destroy()}),this.svg.addEventListener("mousemove",this.onMouseMove),this.svg.addEventListener("mouseup",this.onMouseUp),this.containerGroup=document.createElementNS(ct,"g"),this.shape=Og(r),this.shape.querySelector(".a9s-inner").addEventListener("mousedown",this.onGrab(this.shape)),this.mask=new kg(o.image,this.shape.querySelector(".a9s-inner")),this.containerGroup.appendChild(this.mask.element),this.elementGroup=document.createElementNS(ct,"g"),this.elementGroup.setAttribute("class","a9s-annotation editable selected"),this.elementGroup.setAttribute("data-id",r.id),this.elementGroup.appendChild(this.shape),this.handles=Eu(this.shape).map(l=>{const h=this.drawHandle(l.x,l.y);return h.addEventListener("mousedown",this.onGrab(h)),this.elementGroup.appendChild(h),h}),this.containerGroup.appendChild(this.elementGroup),e.appendChild(this.containerGroup),qs(this.shape,r,n.formatters),this.grabbedElem=null,this.grabbedAt=null}get element(){return this.elementGroup}}class xu extends vu{constructor(r,e,n){super(r,e,n),i(this,"startDrawing",(o,l,h)=>{this._isDrawing=!0,this._startOnSingleClick=h,this.attachListeners({mouseMove:this.onMouseMove,mouseUp:this.onMouseUp,dblClick:this.onDblClick}),this.rubberband=new XP([o,l],this.g,this.env)}),i(this,"stop",()=>{this.detachListeners(),this._isDrawing=!1,this.rubberband&&(this.rubberband.destroy(),this.rubberband=null)}),i(this,"onMouseMove",(o,l)=>this.rubberband.dragTo([o,l])),i(this,"onMouseUp",()=>{const{width:o,height:l}=this.rubberband.getBoundingClientRect(),h=this.config.minSelectionWidth||4,f=this.config.minSelectionHeight||4;o>=h||l>=f?this.rubberband.addPoint():this._startOnSingleClick||(this.emit("cancel"),this.stop())}),i(this,"onDblClick",()=>{this._isDrawing=!1;const o=this.rubberband.element;o.annotation=this.rubberband.toSelection(),this.emit("complete",o),this.stop()}),i(this,"createEditableShape",(o,l)=>new KP(o,this.g,{...this.config,formatters:l},this.env)),this._isDrawing=!1,this._startOnSingleClick=!1}get isDrawing(){return this._isDrawing}}xu.identifier="polygon",xu.supports=t=>{var r;const e=t.selector("SvgSelector");if(e)return(r=e.value)==null?void 0:r.match(/^<svg.*<polygon/g)};class JP extends Uo{constructor(r,e,n){super(),i(this,"listTools",()=>this._registered.map(o=>o.identifier)),i(this,"registerTool",o=>{const l=o.identifier;this.listTools().includes(l)&&this.unregisterTool(l),this._registered.unshift(o)}),i(this,"unregisterTool",o=>this._registered=this._registered.filter(l=>l.identifier!==o)),i(this,"setCurrent",o=>{this._current&&this._current.destroy();const l=typeof o=="string"||o instanceof String?this._registered.find(h=>h.identifier===o):o;this._current=new l(this._g,this._config,this._env),this._current.on("startSelection",h=>this.emit("startSelection",h)),this._current.on("complete",h=>this.emit("complete",h)),this._current.on("cancel",h=>this.emit("cancel",h))}),i(this,"forAnnotation",o=>{var l;const[h,...f]=o.targets,g=(l=h.renderedVia)==null?void 0:l.name,v=g?this._registered.find(E=>E.identifier===g):this._registered.find(E=>E.supports(o));return v?new v(this._g,this._config,this._env):null}),this._g=r,this._config=e,this._env=n,this._registered=[Xs,xu],this.setCurrent(Xs)}get current(){return this._current}}const QP={FragmentSelector:fu,SvgSelector:Og},$P={FragmentSelector:DP,SvgSelector:VP},Bg=t=>{const r=t.targets[0];if(r)return Array.isArray(r.selector)?r.selector[0]:r.selector},bu=(t,r)=>QP[Bg(t).type](t,r),Mg=(t,r)=>$P[Bg(t).type](t,r);class eR{constructor(r){const e=document.createElementNS(ct,"svg");e.setAttribute("class","a9s-osd-crosshair-container");const n=document.createElementNS(ct,"g");n.setAttribute("class","a9s-crosshair"),e.appendChild(n);const o=document.createElementNS(ct,"line"),l=document.createElementNS(ct,"line");n.appendChild(o),n.appendChild(l),r.parentElement.appendChild(e);const h=f=>{const{offsetX:g,offsetY:v}=f,E=r.parentElement.offsetWidth,_=r.parentElement.offsetHeight;o.setAttribute("x1",0),o.setAttribute("y1",v),o.setAttribute("x2",E),o.setAttribute("y2",v),l.setAttribute("x1",g),l.setAttribute("y1",0),l.setAttribute("x2",g),l.setAttribute("y2",_)};r.addEventListener("pointermove",h),r.parentElement.addEventListener("pointermove",h)}}function tR(t,r,e,n,o){Fg(t,r,e||0,n||t.length-1,o||nR)}function Fg(t,r,e,n,o){for(;n>e;){if(n-e>600){var l=n-e+1,h=r-e+1,f=Math.log(l),g=.5*Math.exp(2*f/3),v=.5*Math.sqrt(f*g*(l-g)/l)*(h-l/2<0?-1:1),E=Math.max(e,Math.floor(r-h*g/l+v)),_=Math.min(n,Math.floor(r+(l-h)*g/l+v));Fg(t,r,E,_,o)}var C=t[r],k=e,I=n;for(vo(t,e,r),o(t[n],C)>0&&vo(t,e,n);k<I;){for(vo(t,k,I),k++,I--;o(t[k],C)<0;)k++;for(;o(t[I],C)>0;)I--}o(t[e],C)===0?vo(t,e,I):(I++,vo(t,I,n)),I<=r&&(e=I+1),r<=I&&(n=I-1)}}function vo(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function nR(t,r){return t<r?-1:t>r?1:0}class iR{constructor(r=9){this._maxEntries=Math.max(4,r),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(r){let e=this.data;const n=[];if(!Js(r,e))return n;const o=this.toBBox,l=[];for(;e;){for(let h=0;h<e.children.length;h++){const f=e.children[h],g=e.leaf?o(f):f;Js(r,g)&&(e.leaf?n.push(f):_u(r,g)?this._all(f,n):l.push(f))}e=l.pop()}return n}collides(r){let e=this.data;if(!Js(r,e))return!1;const n=[];for(;e;){for(let o=0;o<e.children.length;o++){const l=e.children[o],h=e.leaf?this.toBBox(l):l;if(Js(r,h)){if(e.leaf||_u(r,h))return!0;n.push(l)}}e=n.pop()}return!1}load(r){if(!(r&&r.length))return this;if(r.length<this._minEntries){for(let n=0;n<r.length;n++)this.insert(r[n]);return this}let e=this._build(r.slice(),0,r.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const n=this.data;this.data=e,e=n}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(r){return r&&this._insert(r,this.data.height-1),this}clear(){return this.data=Er([]),this}remove(r,e){if(!r)return this;let n=this.data;const o=this.toBBox(r),l=[],h=[];let f,g,v;for(;n||l.length;){if(n||(n=l.pop(),g=l[l.length-1],f=h.pop(),v=!0),n.leaf){const E=rR(r,n.children,e);if(E!==-1)return n.children.splice(E,1),l.push(n),this._condense(l),this}!v&&!n.leaf&&_u(n,o)?(l.push(n),h.push(f),f=0,g=n,n=n.children[0]):g?(f++,n=g.children[f],v=!1):n=null}return this}toBBox(r){return r}compareMinX(r,e){return r.minX-e.minX}compareMinY(r,e){return r.minY-e.minY}toJSON(){return this.data}fromJSON(r){return this.data=r,this}_all(r,e){const n=[];for(;r;)r.leaf?e.push(...r.children):n.push(...r.children),r=n.pop();return e}_build(r,e,n,o){const l=n-e+1;let h=this._maxEntries,f;if(l<=h)return f=Er(r.slice(e,n+1)),wr(f,this.toBBox),f;o||(o=Math.ceil(Math.log(l)/Math.log(h)),h=Math.ceil(l/Math.pow(h,o-1))),f=Er([]),f.leaf=!1,f.height=o;const g=Math.ceil(l/h),v=g*Math.ceil(Math.sqrt(h));Ig(r,e,n,v,this.compareMinX);for(let E=e;E<=n;E+=v){const _=Math.min(E+v-1,n);Ig(r,E,_,g,this.compareMinY);for(let C=E;C<=_;C+=g){const k=Math.min(C+g-1,_);f.children.push(this._build(r,C,k,o-1))}}return wr(f,this.toBBox),f}_chooseSubtree(r,e,n,o){for(;o.push(e),!(e.leaf||o.length-1===n);){let l=1/0,h=1/0,f;for(let g=0;g<e.children.length;g++){const v=e.children[g],E=Su(v),_=aR(r,v)-E;_<h?(h=_,l=E<l?E:l,f=v):_===h&&E<l&&(l=E,f=v)}e=f||e.children[0]}return e}_insert(r,e,n){const o=n?r:this.toBBox(r),l=[],h=this._chooseSubtree(o,this.data,e,l);for(h.children.push(r),wo(h,o);e>=0&&l[e].children.length>this._maxEntries;)this._split(l,e),e--;this._adjustParentBBoxes(o,l,e)}_split(r,e){const n=r[e],o=n.children.length,l=this._minEntries;this._chooseSplitAxis(n,l,o);const h=this._chooseSplitIndex(n,l,o),f=Er(n.children.splice(h,n.children.length-h));f.height=n.height,f.leaf=n.leaf,wr(n,this.toBBox),wr(f,this.toBBox),e?r[e-1].children.push(f):this._splitRoot(n,f)}_splitRoot(r,e){this.data=Er([r,e]),this.data.height=r.height+1,this.data.leaf=!1,wr(this.data,this.toBBox)}_chooseSplitIndex(r,e,n){let o,l=1/0,h=1/0;for(let f=e;f<=n-e;f++){const g=yo(r,0,f,this.toBBox),v=yo(r,f,n,this.toBBox),E=lR(g,v),_=Su(g)+Su(v);E<l?(l=E,o=f,h=_<h?_:h):E===l&&_<h&&(h=_,o=f)}return o||n-e}_chooseSplitAxis(r,e,n){const o=r.leaf?this.compareMinX:oR,l=r.leaf?this.compareMinY:sR,h=this._allDistMargin(r,e,n,o),f=this._allDistMargin(r,e,n,l);h<f&&r.children.sort(o)}_allDistMargin(r,e,n,o){r.children.sort(o);const l=this.toBBox,h=yo(r,0,e,l),f=yo(r,n-e,n,l);let g=Ks(h)+Ks(f);for(let v=e;v<n-e;v++){const E=r.children[v];wo(h,r.leaf?l(E):E),g+=Ks(h)}for(let v=n-e-1;v>=e;v--){const E=r.children[v];wo(f,r.leaf?l(E):E),g+=Ks(f)}return g}_adjustParentBBoxes(r,e,n){for(let o=n;o>=0;o--)wo(e[o],r)}_condense(r){for(let e=r.length-1,n;e>=0;e--)r[e].children.length===0?e>0?(n=r[e-1].children,n.splice(n.indexOf(r[e]),1)):this.clear():wr(r[e],this.toBBox)}}function rR(t,r,e){if(!e)return r.indexOf(t);for(let n=0;n<r.length;n++)if(e(t,r[n]))return n;return-1}function wr(t,r){yo(t,0,t.children.length,r,t)}function yo(t,r,e,n,o){o||(o=Er(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(let l=r;l<e;l++){const h=t.children[l];wo(o,t.leaf?n(h):h)}return o}function wo(t,r){return t.minX=Math.min(t.minX,r.minX),t.minY=Math.min(t.minY,r.minY),t.maxX=Math.max(t.maxX,r.maxX),t.maxY=Math.max(t.maxY,r.maxY),t}function oR(t,r){return t.minX-r.minX}function sR(t,r){return t.minY-r.minY}function Su(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Ks(t){return t.maxX-t.minX+(t.maxY-t.minY)}function aR(t,r){return(Math.max(r.maxX,t.maxX)-Math.min(r.minX,t.minX))*(Math.max(r.maxY,t.maxY)-Math.min(r.minY,t.minY))}function lR(t,r){const e=Math.max(t.minX,r.minX),n=Math.max(t.minY,r.minY),o=Math.min(t.maxX,r.maxX),l=Math.min(t.maxY,r.maxY);return Math.max(0,o-e)*Math.max(0,l-n)}function _u(t,r){return t.minX<=r.minX&&t.minY<=r.minY&&r.maxX<=t.maxX&&r.maxY<=t.maxY}function Js(t,r){return r.minX<=t.maxX&&r.minY<=t.maxY&&r.maxX>=t.minX&&r.maxY>=t.minY}function Er(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ig(t,r,e,n,o){const l=[r,e];for(;l.length;){if(e=l.pop(),r=l.pop(),e-r<=n)continue;const h=r+Math.ceil((e-r)/n/2)*n;tR(t,h,r,e,o),l.push(r,h,h,e)}}const Tu=(t,r)=>{if(t.targets[0].selector.type==="FragmentSelector"){const{x:e,y:n,w:o,h:l}=yi(t,r);return{minX:e,minY:n,maxX:e+o,maxY:n+l}}else{const e=bu(t,r),n=document.createElementNS(ct,"svg");n.style.position="absolute",n.style.opacity=0,n.style.top=0,n.style.left=0,n.appendChild(e),document.body.appendChild(n);const{x:o,y:l,width:h,height:f}=e.getBBox();return document.body.removeChild(n),{minX:o,minY:l,maxX:o+h,maxY:l+f}}},uR=t=>{var r;const e=t.targets[0];return Array.isArray(e.selector)?e.selector[0].type:(r=e.selector)==null?void 0:r.type},cR=(t,r,e,n)=>{const o=Ni(e),l=o.nodeName.toLowerCase(),h=[t,r];if(l==="polygon"){const f=Array.from(o.points).map(g=>[g.x,g.y]);return yu(h,f)}else if(l==="circle"){const f=o.getAttribute("cx"),g=o.getAttribute("cy"),v=o.getAttribute("r");return HP(h,f,g,v)}else if(l==="ellipse"){const f=o.getAttribute("cx"),g=o.getAttribute("cy"),v=o.getAttribute("rx"),E=o.getAttribute("ry");return NP(h,f,g,v,E)}else{if(l==="path")return Ag(o).find(f=>yu(h,f));if(l==="line"){const f=parseInt(o.getAttribute("x1")),g=parseInt(o.getAttribute("y1")),v=parseInt(o.getAttribute("x2")),E=parseInt(o.getAttribute("y2"));return jP(h,f,g,v,E,n)}else throw`Unsupported SVG shape type: ${l}`}};class hR{constructor(r){i(this,"clear",()=>this.spatial_index.clear()),i(this,"getAnnotationAt",(e,n,o)=>{const l=o?5/o:5,h=this.spatial_index.search({minX:e-l,minY:n-l,maxX:e+l,maxY:n+l}).map(f=>f.annotation).filter(f=>{const g=uR(f);if(g==="FragmentSelector")return!0;if(g==="SvgSelector")return cR(e,n,f,l);throw`Unsupported selector type: ${g}`});if(h.length>0)return h.sort((f,g)=>Mg(f,this.env.image)-Mg(g,this.env.image)),h[0]}),i(this,"getAnnotationsIntersecting",e=>{const n=e.minX,o=n?e:Tu(e,this.env.image),l=this.spatial_index.search(o).map(h=>h.annotation);return n?l:l.filter(h=>!h.isEqual(e))}),i(this,"insert",e=>{(Array.isArray(e)?e:[e]).forEach(n=>{this.spatial_index.insert({...Tu(n,this.env.image),annotation:n})})}),i(this,"getBounds",e=>this.getBounds(e,this.env.image)),i(this,"remove",e=>{const n={...Tu(e,this.env.image),annotation:e};this.spatial_index.remove(n,(o,l)=>o.annotation.id===l.annotation.id)}),this.env=r,r.store=this,this.spatial_index=new iR}}const Lg=(t,r)=>{const e=(pu(r,".a9s-annotation")?r:r.closest(".a9s-annotation")).querySelector(".a9s-outer").getBoundingClientRect(),{canvas:n}=t.drawer,o=n.getBoundingClientRect(),l=n.width/o.width,h=n.height/o.height,f=e.x-o.x,g=e.y-o.y,{width:v,height:E}=e,_=document.createElement("CANVAS"),C=_.getContext("2d");_.width=v,_.height=E,C.drawImage(n,f*l,g*h,v*l,E*h,0,0,v,E);const k=t.viewport.viewerElementToImageCoordinates(new ii.Point(f,g)),I=t.viewport.viewportToImageZoom(t.viewport.getZoom());return{snippet:_,transform:X=>{const U=k.x+X[0]/l/I,$=k.y+X[1]/h/I;return[U,$]}}},dR=mu();class Hg extends Uo{constructor(r){super(),i(this,"_getShapeAt",n=>{const o=g=>{const v=this.svg.createSVGPoint();if(window.TouchEvent&&g instanceof TouchEvent){const E=this.svg.getBoundingClientRect(),_=g.touches[0],C=_.clientX-E.x,k=_.clientY-E.y,{left:I,top:X}=this.svg.getBoundingClientRect();return v.x=C+I,v.y=k+X,v.matrixTransform(this.g.getScreenCTM().inverse())}else return v.x=g.offsetX,v.y=g.offsetY,v.matrixTransform(this.g.getCTM().inverse())},{x:l,y:h}=o(n),f=this.store.getAnnotationAt(l,h,this.currentScale());if(f)return this.findShape(f)}),i(this,"_initDrawingTools",n=>{var o;let l=!1,h=!1,f=!1;this.tools=new JP(this.g,this.config,this.env),this.tools.on("complete",E=>{h=!1,this.onDrawingComplete(E)}),this.mouseTracker=new ii.MouseTracker({element:this.svg,preProcessEventHandler:E=>{this.mouseTracker.enabled||(E.preventDefault=!1,E.preventGesture=!0),this.selectedShape&&E.eventType==="wheel"&&(E.preventDefault=!1,this.viewer.canvas.dispatchEvent(new E.originalEvent.constructor(E.eventType,E.originalEvent)))},pressHandler:E=>{this.tools.current.isDrawing||(this.tools.current.start(E.originalEvent,this.drawOnSingleClick&&!this.hoveredShape),n||this.scaleTool(this.tools.current))},moveHandler:E=>{if(this.tools.current.isDrawing){const{x:_,y:C}=this.tools.current.getSVGPoint(E.originalEvent);h||E.originalEvent.stopPropagation(),this.tools.current.onMouseMove(_,C,E.originalEvent),l||(this.emit("startSelection",{x:_,y:C}),l=!0),!f&&this.tools.current.onDragStart&&(this.tools.current.onDragStart(_,C,E.originalEvent),f=!0)}},releaseHandler:E=>{if(this.tools.current.isDrawing){const{x:_,y:C}=this.tools.current.getSVGPoint(E.originalEvent);l&&(this.emit("endSelection",{x:_,y:C}),h=!0),this.tools.current.onMouseUp(_,C,E.originalEvent),f&&this.tools.current.onDragEnd&&this.tools.current.onDragEnd()}l=!1,f=!1}});const g=this.config.hotkey?this.config.hotkey.key?this.config.hotkey.key.toLowerCase():this.config.hotkey.toLowerCase():"shift",v=(o=this.config.hotkey)==null?void 0:o.inverted;this.mouseTracker.enabled=v,this.onKeyDown&&document.removeEventListener("keydown",this.onKeyDown),this.onKeyUp&&document.removeEventListener("keydown",this.onKeyDown),this.onKeyDown=E=>{if(E.key.toLowerCase()===g&&!this.selectedShape){const _=!this.readOnly&&!v;this.mouseTracker.enabled=_,this.tools.current.enabled=_}},this.onKeyUp=E=>{E.key.toLowerCase()===g&&!this.tools.current.isDrawing&&(this.mouseTracker.enabled=v,this.tools.current.enabled=v,h=!1)},document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp)}),i(this,"_initMouseEvents",()=>{this.svg.addEventListener("mousemove",o=>{var l,h;if(!((l=this.tools)!=null&&l.current.isDrawing)&&!o.target.closest(".a9s-annotation.editable.selected")){const f=this._getShapeAt(o);if((f==null?void 0:f.annotation)!==((h=this.hoveredShape)==null?void 0:h.annotation)){if(this.hoveredShape){const g=this.hoveredShape.element||this.hoveredShape;Us(g,"hover"),this.emit("mouseLeaveAnnotation",this.hoveredShape.annotation,this.hoveredShape)}f&&(ri(f,"hover"),this.emit("mouseEnterAnnotation",f.annotation,f))}this.hoveredShape=f}}),this.svg.parentElement.addEventListener("mouseleave",()=>{this.hoveredShape&&(Us(this.hoveredShape,"hover"),this.emit("mouseLeaveAnnotation",this.hoveredShape.annotation,this.hoveredShape),this.hoveredShape=null)});let n=null;this.viewer.addHandler("canvas-press",()=>n=new Date().getTime()),this.viewer.addHandler("canvas-click",o=>{var l;const{originalEvent:h}=o;if(!((l=this.tools.current)!=null&&l.isDrawing||this.disableSelect)&&new Date().getTime()-n<250){const f=h.target.closest(".a9s-annotation.editable.selected")?this.selectedShape:this._getShapeAt(h);f?(o.preventDefaultAction=!0,this.selectShape(f)):f||(this.deselect(),this.emit("select",{}))}this.disableSelect&&this.hoveredShape&&this.emit("clickAnnotation",this.hoveredShape.annotation,this.hoveredShape)})}),i(this,"_lazy",n=>{if(this.viewer.world.getItemAt(0))n();else{const o=()=>{n(),this.viewer.removeHandler("open",o),this.viewer.world.removeHandler("add-item",o)};this.viewer.addHandler("open",o),this.viewer.world.addHandler("add-item",o)}}),i(this,"_refreshNonScalingAnnotations",()=>{const n=this.currentScale();Array.from(this.svg.querySelectorAll(".a9s-non-scaling")).forEach(o=>o.setAttribute("transform",`scale(${1/n})`))}),i(this,"addAnnotation",(n,o)=>{const l=o||this.g,h=bu(n,this.env.image);return ri(h,"a9s-annotation"),h.setAttribute("data-id",n.id),h.annotation=n,l.appendChild(h),qs(h,n,this.formatters),this.scaleFormatterElements(h),h}),i(this,"addDrawingTool",n=>this.tools.registerTool(n)),i(this,"addOrUpdateAnnotation",(n,o)=>{var l;const h=(l=this.selectedShape)==null?void 0:l.annotation;(h===n||h!=null&&h.isSelection||h==o)&&this.deselect(),o&&this.removeAnnotation(n),this.removeAnnotation(n);const f=this.addAnnotation(n);pu(f,"a9s-non-scaling")&&f.setAttribute("transform",`scale(${1/this.currentScale()})`),this.store.insert(n)}),i(this,"currentScale",()=>{const n=this.viewer.viewport.getContainerSize().x;return this.viewer.viewport.getZoom(!0)*n/this.viewer.world.getContentFactor()}),i(this,"deselect",()=>{var n;if((n=this.tools)==null||n.current.stop(),this.selectedShape){const{annotation:o}=this.selectedShape;if(this.selectedShape.destroy){if(this.selectedShape.mouseTracker.destroy(),this.selectedShape.destroy(),!o.isSelection){const l=this.addAnnotation(o);pu(l,"a9s-non-scaling")&&l.setAttribute("transform",`scale(${1/this.currentScale()})`)}}else Us(this.selectedShape,"selected");this.selectedShape=null}}),i(this,"destroy",()=>{this.deselect(),this.svg.parentNode.removeChild(this.svg)}),i(this,"findShape",n=>{const o=n!=null&&n.id?n.id:n;return this.g.querySelector(`.a9s-annotation[data-id="${o}"]`)}),i(this,"_fit",(n,o,l)=>{const h=this.findShape(n);if(h){const f=o?typeof o=="boolean"?o:o.immediately:!1,g=(o==null?void 0:o.padding)||0,v=this.viewer.container.getBoundingClientRect(),E=Math.min(2*g/v.width,2*g/v.height),{x:_,y:C,width:k,height:I}=h.getBBox(),X=_-E*k,U=C-E*I,$=k+2*E*k,P=I+2*E*I,N=this.viewer.viewport.imageToViewportRectangle(X,U,$,P);this.viewer.viewport[l](N,f)}}),i(this,"fitBounds",(n,o)=>this._fit(n,o,"fitBounds")),i(this,"fitBoundsWithConstraints",(n,o)=>this._fit(n,o,"fitBoundsWithConstraints")),i(this,"getAnnotations",()=>Array.from(this.g.querySelectorAll(".a9s-annotation")).map(n=>n.annotation)),i(this,"getAnnotationsIntersecting",n=>{const o=n.id?n:this.findShape(n).annotation;return this.store.getAnnotationsIntersecting(o)}),i(this,"getImageSnippetById",n=>{const o=this.findShape(n);if(o)return Lg(this.viewer,o)}),i(this,"getSelectedImageSnippet",()=>{var n;if(this.selectedShape){const o=(n=this.selectedShape.element)!=null?n:this.selectedShape;return Lg(this.viewer,o)}}),i(this,"init",n=>{this.deselect(),Array.from(this.g.querySelectorAll(".a9s-annotation")).forEach(o=>this.g.removeChild(o)),this.store.clear(),this._lazy(()=>{console.time("Took"),console.log("Drawing..."),this.loaded||(this.g.style.display="none"),n.forEach(o=>this.addAnnotation(o)),console.log("Indexing..."),this.store.insert(n),console.timeEnd("Took"),this.resize()})}),i(this,"listDrawingTools",()=>this.tools.listTools()),i(this,"overrideId",(n,o)=>{const l=this.findShape(n);l.setAttribute("data-id",o);const{annotation:h}=l,f=h.clone({id:o});return l.annotation=f,this.store.remove(h),this.store.insert(f),f}),i(this,"panTo",(n,o)=>{const l=this.findShape(n);if(l){const{top:h,left:f,width:g,height:v}=l.getBoundingClientRect(),E=f+g/2+window.scrollX,_=h+v/2+window.scrollY,C=this.viewer.viewport.windowToViewportCoordinates(new ii.Point(E,_));this.viewer.viewport.panTo(C,o)}}),i(this,"removeAnnotation",n=>{var o,l;const h=n.type?n.id:n;((o=this.selectedShape)==null?void 0:o.annotation.id)===h&&this.deselect();const f=this.findShape(n);if(f){const{annotation:g}=f;((l=this.selectedShape)==null?void 0:l.annotation)===g&&this.deselect(),f.parentNode.removeChild(f),this.store.remove(g)}}),i(this,"removeDrawingTool",n=>{var o;return(o=this.tools)==null?void 0:o.unregisterTool(n)}),i(this,"scaleFormatterElements",n=>{const o=1/this.currentScale();if(n){const l=n.querySelector(".a9s-annotation:not(.a9s-non-scaling) .a9s-formatter-el");l&&l.firstChild.setAttribute("transform",`scale(${o})`)}else Array.from(this.g.querySelectorAll(".a9s-annotation:not(.a9s-non-scaling) .a9s-formatter-el")).forEach(l=>l.firstChild.setAttribute("transform",`scale(${o})`))}),i(this,"scaleTool",n=>{if(n){const o=1/this.currentScale();n.scale=o,n.onScaleChanged&&n.onScaleChanged(o)}}),i(this,"selectAnnotation",(n,o)=>{this.selectedShape&&this.deselect();const l=this.findShape(n);if(l){this.selectShape(l,o);const h=this.selectedShape.element?this.selectedShape.element:this.selectedShape;return{annotation:l.annotation,element:h}}else this.deselect()}),i(this,"selectShape",(n,o)=>{var l;if(!o&&!n.annotation.isSelection&&this.emit("clickAnnotation",n.annotation,n),((l=this.selectedShape)==null?void 0:l.annotation)===n.annotation)return;this.selectedShape&&this.selectedShape.annotation!==n.annotation&&this.deselect();const{annotation:h}=n;if(this.readOnly||h.readOnly||this.headless)this.selectedShape=n,ri(n,"selected"),o||this.emit("select",{annotation:h,element:n,skipEvent:o});else{const f=this.tools.forAnnotation(h);if(f){setTimeout(()=>{n.parentNode.removeChild(n),o||this.emit("select",{annotation:h,element:this.selectedShape.element})},1),this.selectedShape=f.createEditableShape(h,this.formatters),this.scaleTool(this.selectedShape),this.scaleFormatterElements(this.selectedShape.element),this.selectedShape.element.annotation=h;const g=new ii.MouseTracker({element:this.svg,preProcessEventHandler:v=>{v.stopPropagation=!0,v.preventDefault=!1,v.preventGesture=!0}}).setTracking(!1);this.selectedShape.element.addEventListener("mouseenter",()=>{this.hoveredShape=this.selectedShape,g.setTracking(!0)}),this.selectedShape.element.addEventListener("mouseleave",()=>{this.hoveredShape=null,g.setTracking(!1)}),this.selectedShape.mouseTracker=g,this.selectedShape.on("update",v=>this.emit("updateTarget",this.selectedShape.element,v))}else this.selectedShape=n,o||this.emit("select",{annotation:h,element:this.selectedShape})}}),i(this,"setDrawingEnabled",n=>{if(this.mouseTracker){const o=n&&!this.readOnly;this.mouseTracker.enabled=o,this.mouseTracker.setTracking(o),this.tools.current&&(this.tools.current.enabled=o)}}),i(this,"setDrawingTool",n=>{var o;this.tools&&((o=this.tools.current)==null||o.stop(),this.tools.setCurrent(n))}),i(this,"setVisible",n=>{n?this.svg.style.display=null:(this.deselect(),this.svg.style.display="none")}),i(this,"stopDrawing",()=>{var n;(n=this.tools)!=null&&n.current&&(this.tools.current.isDrawing&&this.tools.current.stop(),this.mouseTracker.enabled=!1,this.tools.current.enabled=!1)}),this.viewer=r.viewer,this.config=r.config,this.env=r.env,this.readOnly=r.config.readOnly,this.headless=r.config.headless,r.config.formatter?this.formatters=[r.config.formatter]:r.config.formatters&&(this.formatters=Array.isArray(r.config.formatters)?r.config.formatters:[r.config.formatters]),this.disableSelect=r.config.disableSelect,this.drawOnSingleClick=r.config.drawOnSingleClick,this.svg=document.createElementNS(ct,"svg"),dR?(this.svg.setAttribute("class","a9s-annotationlayer a9s-osd-annotationlayer touch"),BP(this.svg)):this.svg.setAttribute("class","a9s-annotationlayer a9s-osd-annotationlayer"),this.g=document.createElementNS(ct,"g"),this.svg.appendChild(this.g),this.viewer.canvas.appendChild(this.svg),this.viewer.addHandler("animation",()=>this.resize()),this.viewer.addHandler("rotate",()=>this.resize()),this.viewer.addHandler("resize",()=>this.resize()),this.viewer.addHandler("flip",()=>this.resize()),this.loaded=!1;const e=()=>{const{x:n,y:o}=this.viewer.world.getItemAt(0).source.dimensions,l=this.viewer.world.getItemAt(0).source["@id"]||new URL(this.viewer.world.getItemAt(0).source.url,document.baseURI).href;this.env.image={src:l,naturalWidth:n,naturalHeight:o},r.config.crosshair&&(this.crosshair||(this.crosshair=new eR(this.svg),ri(this.svg,"no-cursor"))),this.loaded||this.emit("load",l),this.loaded=!0,this.g.style.display="inline",this.resize()};this.viewer.addHandler("open",e),this.viewer.world.addHandler("add-item",e),this.viewer.world.getItemAt(0)&&e(),this.store=new hR(this.env),this.selectedShape=null,this.hoveredShape=null,this._initMouseEvents()}resize(){var r;const e=this.viewer.viewport.getFlip(),n=this.viewer.viewport.pixelFromPoint(new ii.Point(0,0),!0);e&&(n.x=this.viewer.viewport._containerInnerSize.x-n.x);const o=this.currentScale(),l=e?-o:o,h=this.viewer.viewport.getRotation();this.g.setAttribute("transform",`translate(${n.x}, ${n.y}) scale(${l}, ${o}) rotate(${h})`),this._refreshNonScalingAnnotations(),this.scaleFormatterElements(),this.selectedShape&&(this.selectedShape.element?(this.scaleTool(this.selectedShape),this.emit("viewportChange",this.selectedShape.element)):this.emit("viewportChange",this.selectedShape)),(r=this.tools)!=null&&r.current&&this.scaleTool(this.tools.current)}}class pR extends Hg{constructor(r){super(r),i(this,"onDrawingComplete",e=>{var n;this.mouseTracker.enabled=(n=this.config.hotkey)==null?void 0:n.inverted,this.selectShape(e),this.emit("createSelection",e.annotation)}),this._initDrawingTools()}}const Cu=t=>{const r=t.viewport.viewportToImageRectangle(t.viewport.getBounds(!0)),e=t.viewport.getContainerSize().x,n=t.viewport.getZoom(!0)*e/t.world.getContentFactor();return{extent:r,scale:n}},fR=t=>{var r;const e=t.targets[0];return e?Array.isArray(e.selector)?e.selector[0].type:(r=e.selector)==null?void 0:r.type:null},Ng=(t,r)=>{const{extent:e,scale:n}=Cu(t),{selector:o}=r,l=Hi.create({target:r});if(o.type==="SvgSelector"){const h=Ni(l),f=h.nodeName.toLowerCase();let g=null;if(f==="polygon")g=gR(h,e,n);else if(f==="circle")g=mR(h,e,n);else if(f==="ellipse")g=vR(h,e,n);else if(f==="path")g=yR(h,e,n);else throw`Unsupported SVG shape type: ${f}`;let v=g.outerHTML||new XMLSerializer().serializeToString(g);return v=v.replace(` xmlns="${ct}"`,""),{...r,selector:{type:"SvgSelector",value:`<svg>${v}</svg>`}}}else if(o.type==="FragmentSelector"){const{x:h,y:f,w:g,h:v}=yi(l),E=e.x+h/n,_=e.y+f/n,C=g/n,k=v/n;return g===0&&v===0?{...yr(E,_,C,k),renderedVia:{name:"point"}}:yr(E,_,C,k)}else throw`Unsupported selector type: ${o.type}`},gR=(t,r,e)=>{const n=Array.from(t.points).map(o=>{const l=r.x+o.x/e,h=r.y+o.y/e;return l+","+h}).join(" ");return t.setAttribute("points",n),t},mR=(t,r,e)=>{const n=parseFloat(t.getAttribute("cx")),o=parseFloat(t.getAttribute("cy")),l=parseFloat(t.getAttribute("r"));return t.setAttribute("cx",r.x+n/e),t.setAttribute("cy",r.y+o/e),t.setAttribute("r",l/e),t},vR=(t,r,e)=>{const n=parseFloat(t.getAttribute("cx")),o=parseFloat(t.getAttribute("cy")),l=parseFloat(t.getAttribute("rx")),h=parseFloat(t.getAttribute("ry"));return t.setAttribute("cx",r.x+n/e),t.setAttribute("cy",r.y+o/e),t.setAttribute("rx",l/e),t.setAttribute("ry",h/e),t},yR=(t,r,e)=>{const n=t.getAttribute("d").split(/(?=M|m|L|l|H|h|V|v|Z|z)/g).map(o=>o.trim()).map(o=>{const l=o.substring(0,1);if(l.toLowerCase()==="z")return l;{const h=o.substring(1).split(" ").map(E=>parseFloat(E.trim())),f=l===l.toUpperCase(),g=f?r.x+h[0]/e:h[0]/e,v=f?r.y+h[1]/e:h[1]/e;return l+" "+g+" "+v}}).join(" ");return t.setAttribute("d",n),t},zg=(t,r)=>{const{extent:e,scale:n}=Cu(t),o=r.selector("FragmentSelector");if(r.selector("SvgSelector")){const l=Ni(r),h=l.nodeName.toLowerCase();let f=null;if(h==="polygon")f=wR(l,e,n);else if(h==="circle")f=ER(l,e,n);else if(h==="ellipse")f=xR(l,e,n);else if(h==="path")f=bR(l,e,n);else throw`Unsupported SVG shape type: ${h}`;let g=f.outerHTML||new XMLSerializer().serializeToString(f);g=g.replace(` xmlns="${ct}"`,"");const v={selector:{type:"SvgSelector",value:`<svg>${g}</svg>`}};return r.clone({target:v})}else if(o){const{x:l,y:h,w:f,h:g}=yi(r),v=(l-e.x)*n,E=(h-e.y)*n,_=yr(v,E,f*n,g*n);return r.clone({target:_})}},wR=(t,r,e)=>{const n=Array.from(t.points).map(o=>{const l=e*(o.x-r.x),h=e*(o.y-r.y);return l+","+h}).join(" ");return t.setAttribute("points",n),t},ER=(t,r,e)=>{const n=t.getAttribute("cx"),o=t.getAttribute("cy"),l=t.getAttribute("r");return t.setAttribute("cx",e*(n-r.x)),t.setAttribute("cy",e*(o-r.y)),t.setAttribute("r",l*e),t},xR=(t,r,e)=>{const n=t.getAttribute("cx"),o=t.getAttribute("cy"),l=t.getAttribute("rx"),h=t.getAttribute("ry");return t.setAttribute("cx",e*(n-r.x)),t.setAttribute("cy",e*(o-r.y)),t.setAttribute("rx",l*e),t.setAttribute("ry",h*e),t},bR=(t,r,e)=>{const n=t.getAttribute("d").split(/(?=M|m|L|l|H|h|V|v|Z|z)/g).map(o=>o.trim()).map(o=>{const l=o.substring(0,1);if(l.toLowerCase()==="z")return l;{const h=o.substring(1).split(" ").filter(E=>E).map(E=>parseFloat(E.trim())),f=l===l.toUpperCase(),g=f?e*(h[0]-r.x):e*h[0],v=f?e*(h[1]-r.y):e*h[1];return l+" "+g+" "+v}}).join(" ");return t.setAttribute("d",n),t},jg=(t,r)=>{const{extent:e,scale:n}=Cu(t),o=fR(r.annotation);if(o==="FragmentSelector")SR(r,e,n);else if(o==="SvgSelector")_R(r,e,n);else throw`Unsupported selector type type: ${o}`;const l=r.querySelector(".a9s-formatter-el");if(l){const{x:h,y:f}=r.querySelector(".a9s-inner").getBBox();l.setAttribute("x",h),l.setAttribute("y",f)}},SR=(t,r,e)=>{const{x:n,y:o,w:l,h}=yi(t.annotation),f=t.querySelector(".a9s-outer"),g=t.querySelector(".a9s-inner"),v=e*(n-r.x),E=e*(o-r.y);l===0&&h===0?[f,g].forEach(_=>{_.setAttribute("cx",v),_.setAttribute("cy",E)}):[f,g].forEach(_=>{_.setAttribute("x",v),_.setAttribute("y",E),_.setAttribute("width",l*e),_.setAttribute("height",h*e)})},_R=(t,r,e)=>{const n=Ni(t.annotation),o=n.nodeName.toLowerCase();if(o==="polygon")TR(t,n,r,e);else if(o==="circle")CR(t,n,r,e);else if(o==="ellipse")PR(t,n,r,e);else if(o==="path")RR(t,n,r,e);else throw`Unsupported SVG shape type: ${o}`},TR=(t,r,e,n)=>{const o=Array.from(r.points).map(l=>{const h=n*(l.x-e.x),f=n*(l.y-e.y);return h+","+f}).join(" ");t.querySelector(".a9s-outer").setAttribute("points",o),t.querySelector(".a9s-inner").setAttribute("points",o)},CR=(t,r,e,n)=>{const o=n*(r.getAttribute("cx")-e.x),l=n*(r.getAttribute("cy")-e.y),h=n*r.getAttribute("r"),f=t.querySelector(".a9s-outer");f.setAttribute("cx",o),f.setAttribute("cy",l),f.setAttribute("r",h);const g=t.querySelector(".a9s-inner");g.setAttribute("cx",o),g.setAttribute("cy",l),g.setAttribute("r",h)},PR=(t,r,e,n)=>{const o=n*(r.getAttribute("cx")-e.x),l=n*(r.getAttribute("cy")-e.y),h=n*r.getAttribute("rx"),f=n*r.getAttribute("ry"),g=t.querySelector(".a9s-outer");g.setAttribute("cx",o),g.setAttribute("cy",l),g.setAttribute("rx",h),g.setAttribute("ry",f);const v=t.querySelector(".a9s-inner");v.setAttribute("cx",o),v.setAttribute("cy",l),v.setAttribute("rx",h),v.setAttribute("ry",f)},RR=(t,r,e,n)=>{const o=r.getAttribute("d").split(/(?=M|m|L|l|H|h|V|v|Z|z)/g).map(l=>l.trim()).map(l=>{const h=l.substring(0,1);if(h.toLowerCase()==="z")return h;{const f=l.substring(1).split(" ").filter(_=>_).map(_=>parseFloat(_.trim())),g=h===h.toUpperCase(),v=g?n*(f[0]-e.x):n*f[0],E=g?n*(f[1]-e.y):n*f[1];return h+" "+v+" "+E}}).join(" ");t.querySelector(".a9s-inner").setAttribute("d",o),t.querySelector(".a9s-outer").setAttribute("d",o)},AR=mu();class DR extends Hg{constructor(r){super(r),i(this,"_fit",(e,n,o)=>{const l=n?typeof n=="boolean"?n:n.immediately:!1,h=(n==null?void 0:n.padding)||0,f=this.findShape(e);if(f){const g=this.viewer.container.getBoundingClientRect(),v=f.getBoundingClientRect(),E=v.x-g.x,_=v.y-g.y,{width:C,height:k}=v,I=E-h,X=_-h,U=C+2*h,$=k+2*h,P=this.viewer.viewport.viewerElementToViewportRectangle(new ii.Rect(I,X,U,$));this.viewer.viewport[o](P,l)}}),i(this,"_getShapeAt",e=>{const n=g=>{if(AR){const v=this.svg.getBoundingClientRect(),E=g.clientX-v.x,_=g.clientY-v.y;return new ii.Point(E,_)}else return new ii.Point(g.offsetX,g.offsetY)},o=this.viewer.viewport.viewerElementToViewportCoordinates(n(e)),{x:l,y:h}=this.viewer.viewport.viewportToImageCoordinates(o.x,o.y),f=this.store.getAnnotationAt(l,h,this.currentScale());if(f)return this.findShape(f)}),i(this,"_refreshNonScalingAnnotations",()=>{}),i(this,"addAnnotation",(e,n)=>{const o=n||this.g,l=bu(e,this.env.image);return ri(l,"a9s-annotation"),l.setAttribute("data-id",e.id),l.annotation=e,jg(this.viewer,l),o.appendChild(l),qs(l,e,this.formatters),l}),i(this,"addOrUpdateAnnotation",(e,n)=>{var o;const l=(o=this.selectedShape)==null?void 0:o.annotation;(l===e||l!=null&&l.isSelection||l==n)&&this.deselect(),n&&this.removeAnnotation(e),this.removeAnnotation(e),this.addAnnotation(e),this.store.insert(e)}),i(this,"deselect",()=>{var e;if((e=this.tools)==null||e.current.stop(),this.selectedShape){const{annotation:n}=this.selectedShape;this.selectedShape.destroy?(this.selectedShape.mouseTracker.destroy(),this.selectedShape.destroy(),n.isSelection||this.addAnnotation(n)):Us(this.selectedShape,"selected"),this.selectedShape=null}}),i(this,"onDrawingComplete",e=>{const n=e.annotation.clone({target:Ng(this.viewer,e.annotation.target)});e.annotation=n,this.selectShape(e),this.emit("createSelection",e.annotation),this.mouseTracker.enabled=!1}),i(this,"selectShape",(e,n)=>{var o;if(!n&&!e.annotation.isSelection&&this.emit("clickAnnotation",e.annotation,e),((o=this.selectedShape)==null?void 0:o.annotation)===e.annotation)return;this.selectedShape&&this.selectedShape.annotation!==e.annotation&&this.deselect(!0);const{annotation:l}=e;if(this.readOnly||l.readOnly||this.headless)this.selectedShape=e,ri(e,"selected"),n||this.emit("select",{annotation:l,element:e,skipEvent:n});else{setTimeout(()=>{e.parentNode.removeChild(e),n||this.emit("select",{annotation:l,element:this.selectedShape.element})},1);const h=this.tools.forAnnotation(l);this.selectedShape=h.createEditableShape(l),this.selectedShape.element.annotation=l;const f=zg(this.viewer,l);this.selectedShape.updateState(f);const g=new ii.MouseTracker({element:this.svg,preProcessEventHandler:v=>{v.stopPropagation=!0,v.preventDefault=!1,v.preventGesture=!0}}).setTracking(!1);this.selectedShape.element.addEventListener("mouseenter",()=>{this.hoveredShape=this.selectedShape,g.setTracking(!0)}),this.selectedShape.element.addEventListener("mouseleave",()=>{this.hoveredShape=null,g.setTracking(!1)}),this.selectedShape.mouseTracker=g,this.selectedShape.on("update",v=>{const E=Ng(this.viewer,v);this.selectedShape.element.annotation=this.selectedShape.annotation.clone({target:E}),this.emit("updateTarget",this.selectedShape.element,E)})}}),this._initDrawingTools(!0)}resize(){if(this.store&&(Array.from(this.g.querySelectorAll(".a9s-annotation:not(.selected)")).forEach(r=>jg(this.viewer,r)),this.selectedShape))if(this.selectedShape.element){const r=zg(this.viewer,this.selectedShape.element.annotation);this.selectedShape.updateState&&this.selectedShape.updateState(r),this.emit("viewportChange",this.selectedShape.element)}else this.emit("viewportChange",this.selectedShape)}}var OR=0;function Ug(t,r,e,n,o){var l,h,f={};for(h in r)h=="ref"?l=r[h]:f[h]=r[h];var g={type:t,props:f,key:e,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--OR,__source:n,__self:o};if(typeof t=="function"&&(l=t.defaultProps))for(h in l)f[h]===void 0&&(f[h]=l[h]);return u.vnode&&u.vnode(g),g}class kR extends se{constructor(r){super(r),i(this,"clearState",e=>this.setState({selectedAnnotation:null,selectedDOMElement:null,modifiedTarget:null,beforeHeadlessModify:null},e)),i(this,"forwardEvent",(e,n)=>{this.annotationLayer.on(e,(o,l)=>{this.props[n](o.clone(),l)})}),i(this,"onKeyUp",e=>{if(e.which===27){this.annotationLayer.stopDrawing();const{selectedAnnotation:n}=this.state;n&&(this.cancelSelected(),this.props.onCancelSelected(n))}else if(e.which===46){const{disableDeleteKey:n}=this.props.config;if(!n){const{selectedAnnotation:o}=this.state;o&&(o.isSelection?this.onCancelAnnotation(o):this.onDeleteAnnotation(o))}}}),i(this,"handleStartSelect",e=>this.props.onSelectionStarted(e)),i(this,"handleEndSelect",e=>this.props.onSelectionEnded(e)),i(this,"handleSelect",(e,n)=>{this.state.editorDisabled?this.onHeadlessSelect(e,n):this.onNormalSelect(e,n)}),i(this,"onNormalSelect",(e,n)=>{const{annotation:o,element:l}=e;if(o){const h=()=>{this.setState({selectedAnnotation:o,selectedDOMElement:l,modifiedTarget:null},()=>{n||(o.isSelection?this.props.onSelectionCreated(o.clone()):this.props.onAnnotationSelected(o.clone(),l))})},{selectedAnnotation:f}=this.state;f&&!f.isEqual(o)?this.clearState(()=>{this.props.onCancelSelected(f),h()}):h()}else{const{selectedAnnotation:h}=this.state;h?this.clearState(()=>this.props.onCancelSelected(h)):this.clearState()}}),i(this,"onHeadlessSelect",(e,n)=>{this.saveSelected().then(()=>{this.onNormalSelect(e,n)})}),i(this,"handleUpdateTarget",(e,n)=>{this.setState({selectedDOMElement:e,modifiedTarget:n});const o=JSON.parse(JSON.stringify(n));this.props.onSelectionTargetChanged(o)}),i(this,"handleViewportChange",e=>this.setState({selectedDOMElement:e})),i(this,"overrideAnnotationId",e=>n=>{const{id:o}=e;this.state.selectedAnnotation?this.setState({selectedAnnotation:null,selectedDOMElement:null,modifiedTarget:null},()=>{this.annotationLayer.overrideId(o,n)}):this.annotationLayer.overrideId(o,n)}),i(this,"onCreateOrUpdateAnnotation",(e,n)=>(o,l)=>{let h=o.isSelection?o.toAnnotation():o;h=this.state.modifiedTarget?h.clone({target:this.state.modifiedTarget}):h.clone(),this.clearState(()=>{this.annotationLayer.addOrUpdateAnnotation(h,l),l?this.props[e](h,l.clone()):this.props[e](h,this.overrideAnnotationId(h)),n&&n()})}),i(this,"onDeleteAnnotation",e=>{this.clearState(),this.annotationLayer.removeAnnotation(e),this.props.onAnnotationDeleted(e)}),i(this,"onCancelAnnotation",(e,n)=>{this.state.editorDisabled||this.annotationLayer.deselect(),this.props.onCancelSelected(e),this.clearState(n)}),i(this,"addAnnotation",e=>{var n;e.id===((n=this.state.selectedAnnotation)==null?void 0:n.id)&&(this.annotationLayer.deselect(),this.clearState()),this.annotationLayer.addOrUpdateAnnotation(e.clone())}),i(this,"addDrawingTool",e=>this.annotationLayer.addDrawingTool(e)),i(this,"cancelSelected",()=>new Promise(e=>{this.annotationLayer.deselect(),this.state.selectedAnnotation?this.clearState(e):e()})),i(this,"fitBounds",(e,n)=>this.annotationLayer.fitBounds(e,n)),i(this,"fitBoundsWithConstraints",(e,n)=>this.annotationLayer.fitBoundsWithConstraints(e,n)),i(this,"getAnnotationById",e=>{var n;return(n=this.annotationLayer.findShape(e))==null?void 0:n.annotation}),i(this,"getAnnotations",()=>this.annotationLayer.getAnnotations().map(e=>e.clone())),i(this,"getAnnotationsIntersecting",e=>this.annotationLayer.getAnnotationsIntersecting(e)),i(this,"getImageSnippetById",e=>this.annotationLayer.getImageSnippetById(e)),i(this,"getSelected",()=>{var e;if(this.state.selectedAnnotation)return this.state.editorDisabled?this.state.selectedAnnotation:(e=this._editor.current)==null?void 0:e.getCurrentAnnotation()}),i(this,"getSelectedImageSnippet",()=>this.annotationLayer.getSelectedImageSnippet()),i(this,"listDrawingTools",()=>this.annotationLayer.listDrawingTools()),i(this,"panTo",(e,n)=>this.annotationLayer.panTo(e,n)),i(this,"removeAnnotation",e=>this.annotationLayer.removeAnnotation(e)),i(this,"removeDrawingTool",e=>this.annotationLayer.removeDrawingTool(e)),i(this,"saveSelected",()=>new Promise(e=>{const n=this.state.selectedAnnotation;if(n)if(this._editor.current)this._editor.current.onOk(),e();else if(n.isSelection)n.bodies.length>0||this.props.config.allowEmpty?this.onCreateOrUpdateAnnotation("onAnnotationCreated",e)(n):(this.annotationLayer.deselect(),e());else{const{beforeHeadlessModify:o,modifiedTarget:l}=this.state;o?this.onCreateOrUpdateAnnotation("onAnnotationUpdated",e)(n,o):l?this.onCreateOrUpdateAnnotation("onAnnotationUpdated",e)(n,n):this.onCancelAnnotation(n,e)}else e()})),i(this,"selectAnnotation",e=>{const n=this.annotationLayer.selectAnnotation(e,!0);if(n)return this.handleSelect(n,!0),n.annotation.clone();this.clearState()}),i(this,"setAnnotations",e=>this.annotationLayer.init(e.map(n=>n.clone()))),i(this,"setDrawingEnabled",e=>this.annotationLayer.setDrawingEnabled(e)),i(this,"setDrawingTool",e=>this.annotationLayer.setDrawingTool(e)),i(this,"setVisible",e=>{this.annotationLayer.setVisible(e),e||this.clearState()}),i(this,"updateSelected",(e,n)=>new Promise(o=>{this.state.selectedAnnotation&&(n?this.state.selectedAnnotation.isSelection?this.onCreateOrUpdateAnnotation("onAnnotationCreated",o)(e):this.onCreateOrUpdateAnnotation("onAnnotationUpdated",o)(e,this.state.selectedAnnotation):this.setState({selectedAnnotation:e,beforeHeadlessModify:this.state.beforeHeadlessModify||this.state.selectedAnnotation},o))})),this.state={selectedAnnotation:null,selectedDOMElement:null,modifiedTarget:null,readOnly:r.config.readOnly,editorDisabled:r.config.disableEditor,widgets:r.config.widgets,beforeHeadlessModify:null},this._editor=fe.createRef()}componentDidMount(){this.annotationLayer=this.props.config.gigapixelMode?new DR(this.props):new pR(this.props),this.annotationLayer.on("load",this.props.onLoad),this.annotationLayer.on("startSelection",this.handleStartSelect),this.annotationLayer.on("endSelection",this.handleEndSelect),this.annotationLayer.on("select",this.handleSelect),this.annotationLayer.on("updateTarget",this.handleUpdateTarget),this.annotationLayer.on("viewportChange",this.handleViewportChange),this.forwardEvent("clickAnnotation","onClickAnnotation"),this.forwardEvent("mouseEnterAnnotation","onMouseEnterAnnotation"),this.forwardEvent("mouseLeaveAnnotation","onMouseLeaveAnnotation"),document.addEventListener("keyup",this.onKeyUp)}componentWillUnmount(){this.annotationLayer.destroy(),document.removeEventListener("keyup",this.onKeyUp)}get disableEditor(){return this.state.editorDisabled}set disableEditor(r){this.setState({editorDisabled:r})}get disableSelect(){return this.annotationLayer.disableSelect}set disableSelect(r){this.annotationLayer.disableSelect=r}get formatters(){return this.annotationLayer.formatters}set formatters(r){this.annotationLayer.formatters=r}get readOnly(){return this.state.readOnly}set readOnly(r){this.annotationLayer.readOnly=r,this.setState({readOnly:r})}get widgets(){return this.state.widgets}set widgets(r){this.setState({widgets:r})}render(){var r;const e=this.state.selectedAnnotation&&!this.state.editorDisabled,n=this.state.readOnly||((r=this.state.selectedAnnotation)==null?void 0:r.readOnly);return e&&Ug(wP,{ref:this._editor,detachable:!0,wrapperEl:this.props.wrapperEl,annotation:this.state.selectedAnnotation,modifiedTarget:this.state.modifiedTarget,selectedElement:this.state.selectedDOMElement,readOnly:n,allowEmpty:this.props.config.allowEmpty,widgets:this.state.widgets,env:this.props.env,onAnnotationCreated:this.onCreateOrUpdateAnnotation("onAnnotationCreated"),onAnnotationUpdated:this.onCreateOrUpdateAnnotation("onAnnotationUpdated"),onAnnotationDeleted:this.onDeleteAnnotation,onCancel:this.onCancelAnnotation})}}class BR{constructor(r,e){i(this,"handleAnnotationCreated",(o,l)=>this._emitter.emit("createAnnotation",o.underlying,l)),i(this,"handleAnnotationDeleted",o=>this._emitter.emit("deleteAnnotation",o.underlying)),i(this,"handleAnnotationSelected",(o,l)=>this._emitter.emit("selectAnnotation",o.underlying,l)),i(this,"handleAnnotationUpdated",(o,l)=>this._emitter.emit("updateAnnotation",o.underlying,l.underlying)),i(this,"handleCancelSelected",o=>this._emitter.emit("cancelSelected",o.underlying)),i(this,"handleClickAnnotation",(o,l)=>this._emitter.emit("clickAnnotation",o.underlying,l)),i(this,"handleLoad",o=>this._emitter.emit("load",o)),i(this,"handleSelectionCreated",o=>this._emitter.emit("createSelection",o.underlying)),i(this,"handleSelectionStarted",o=>this._emitter.emit("startSelection",o)),i(this,"handleSelectionEnded",o=>this._emitter.emit("endSelection",o)),i(this,"handleSelectionTargetChanged",o=>this._emitter.emit("changeSelectionTarget",o)),i(this,"handleMouseEnterAnnotation",(o,l)=>this._emitter.emit("mouseEnterAnnotation",o.underlying,l)),i(this,"handleMouseLeaveAnnotation",(o,l)=>this._emitter.emit("mouseLeaveAnnotation",o.underlying,l)),i(this,"_wrap",o=>(o==null?void 0:o.type)==="Annotation"?new Hi(o):o),i(this,"addAnnotation",o=>this._app.current.addAnnotation(new Hi(o))),i(this,"addDrawingTool",o=>this._app.current.addDrawingTool(o)),i(this,"cancelSelected",()=>this._app.current.cancelSelected()),i(this,"clearAnnotations",()=>this.setAnnotations([])),i(this,"clearAuthInfo",()=>this._env.user=null),i(this,"destroy",()=>fe.unmountComponentAtNode(this.appContainerEl)),i(this,"fitBounds",(o,l)=>this._app.current.fitBounds(this._wrap(o),l)),i(this,"fitBoundsWithConstraints",(o,l)=>this._app.current.fitBoundsWithConstraints(this._wrap(o),l)),i(this,"getAnnotationById",o=>{const l=this._app.current.getAnnotationById(o);return l==null?void 0:l.underlying}),i(this,"getAnnotations",()=>this._app.current.getAnnotations().map(o=>o.underlying)),i(this,"getAnnotationsIntersecting",o=>this._app.current.getAnnotationsIntersecting(this._wrap(o))),i(this,"getImageSnippetById",o=>this._app.current.getImageSnippetById(o)),i(this,"getSelected",()=>{const o=this._app.current.getSelected();return o==null?void 0:o.underlying}),i(this,"getSelectedImageSnippet",()=>this._app.current.getSelectedImageSnippet()),i(this,"listDrawingTools",()=>this._app.current.listDrawingTools()),i(this,"loadAnnotations",o=>fetch(o).then(l=>l.json()).then(l=>(this.setAnnotations(l),l))),i(this,"off",(o,l)=>this._emitter.off(o,l)),i(this,"on",(o,l)=>this._emitter.on(o,l)),i(this,"once",(o,l)=>this._emitter.once(o,l)),i(this,"panTo",(o,l)=>this._app.current.panTo(this._wrap(o),l)),i(this,"removeAnnotation",o=>this._app.current.removeAnnotation(this._wrap(o))),i(this,"removeDrawingTool",o=>this._app.current.removeDrawingTool(o)),i(this,"saveSelected",()=>this._app.current.saveSelected()),i(this,"selectAnnotation",o=>{const l=this._app.current.selectAnnotation(this._wrap(o));return l==null?void 0:l.underlying}),i(this,"setAnnotations",o=>{const l=(o||[]).map(h=>new Hi(h));this._app.current.setAnnotations(l)}),i(this,"setAuthInfo",o=>this._env.user=o),i(this,"setDrawingEnabled",o=>this._app.current.setDrawingEnabled(o)),i(this,"setDrawingTool",o=>this._app.current.setDrawingTool(o)),i(this,"setServerTime",o=>this._env.setServerTime(o)),i(this,"setVisible",o=>this._app.current.setVisible(o)),i(this,"updateSelected",(o,l)=>{let h=null;o.type==="Annotation"?h=new Hi(o):o.type==="Selection"&&(h=new go(o.target,o.body)),h&&this._app.current.updateSelected(h,l)});const n=e||{};this._app=fe.createRef(),this._emitter=new Uo,this._env=CP(),this._element=r.element,window.getComputedStyle(this._element).getPropertyValue("position")==="static"&&(this._element.style.position="relative"),PP(n.locale,n.messages),this.appContainerEl=document.createElement("DIV"),this._element.appendChild(this.appContainerEl),fe.render(Ug(kR,{ref:this._app,viewer:r,wrapperEl:this._element,config:n,env:this._env,onSelectionStarted:this.handleSelectionStarted,onSelectionEnded:this.handleSelectionEnded,onSelectionCreated:this.handleSelectionCreated,onSelectionTargetChanged:this.handleSelectionTargetChanged,onAnnotationCreated:this.handleAnnotationCreated,onAnnotationSelected:this.handleAnnotationSelected,onAnnotationUpdated:this.handleAnnotationUpdated,onAnnotationDeleted:this.handleAnnotationDeleted,onCancelSelected:this.handleCancelSelected,onClickAnnotation:this.handleClickAnnotation,onLoad:this.handleLoad,onMouseEnterAnnotation:this.handleMouseEnterAnnotation,onMouseLeaveAnnotation:this.handleMouseLeaveAnnotation}),this.appContainerEl)}get disableEditor(){return this._app.current.disableEditor}set disableEditor(r){this._app.current.disableEditor=r}get disableSelect(){return this._app.current.disableSelect}set disableSelect(r){this._app.current.disableSelect=r}get formatters(){return this._app.current.formatters||[]}set formatters(r){if(r){const e=Array.isArray(r)?r:[r];this._app.current.formatters=e}else this._app.current.formatters=null}get readOnly(){return this._app.current.readOnly}set readOnly(r){this._app.current.readOnly=r}get widgets(){return this._app.current.widgets}set widgets(r){this._app.current.widgets=r}}var MR=(t,r)=>new BR(t,r);return MR}),Nu={hasIntersectionXYWH(s,c){const i=s[0],a=s[1],u=s[2],d=s[3],w=c[0],p=c[1],m=c[2],y=c[3];return Math.max(i,w)<=Math.min(i+u,w+m)&&Math.max(a,p)<=Math.min(a+d,p+y)},getXYWHFromTarget(s){const c=s.selector.value;let i=[0,0,0,0];return c.replace(/^xywh=pixel:([\d\.]+),([\d\.]+),([\d\.]+),([\d\.]+)$/,(a,...u)=>{i=u.slice(0,4).map(d=>parseFloat(d))}),i}},xO=["","","","","","","","","",""];function bO(s){const c=document.createElement("div");return s.annotation.bodies.filter(i=>{(i.purpose=="commenting"||i.purpose=="replying"||!i.purpose)&&c.insertAdjacentHTML("beforeend",`<p>${i.value}</p>`)}),c}function SO(s){const c=document.createElement("div");return s.annotation.id&&(c.innerText=s.annotation.id,c.style.cssText=`
      font-size:x-small;
      color:#666;
      background-color:#ccc;
      padding-left:15px;
      line-height:1.8em;
    `),c}function sv(s,c){const i=document.createElement("div");i.style.cssText=`
    display:flex;
    flex-direction:row;
  `;const[a,u]=[s,c].map(p=>{const m=document.createElement("div");return m.innerText=p.label,m.style.cssText=p.labelCSS||`
      width:80px;
      background-color:#666;
      color:#fff;
      display:flex;
      justify-content:center;
      align-items:center;
    `,m}),[d,w]=[s,c].map(p=>{const m=document.createElement("input");return m.setAttribute("type","text"),m.value=p.value,m.className="r6o-editable-text",m.style.backgroundColor="rgba(0,0,255,0.1)",m.addEventListener("change",p.onChange),m.addEventListener("keyup",y=>y.key=="Delete"&&y.stopPropagation()),m});return i.append(a,d,u,w),{container:i,input1:d,input2:w}}function _O(s){return function(i){const a=i.annotation.underlying,u=document.createElement("div");u.className="r6o-widget comment editable";const d=i.annotation?i.annotation.bodies.find(S=>S.purpose=="tagging"):null,w=!!d||a._type=="tagging",p=w?d.value:"",m=!!i.annotation&&i.annotation.bodies.some(S=>S.purpose=="describing")||a._type=="describing",y=w?d._bango||p.split("-")[0]:"",x=w?d._bango_eda||(/.+?\-(.+)/.test(p)?RegExp.$1:""):"";if(w||!m&&s.is_taggingmode&&a._type!="ocrtext"){a._type!="tagging"&&i.onSetProperty("_type","tagging");const S=function(se,Te){return{type:"TextualBody",motivation:"commenting",purpose:"tagging",value:se+(Te?"-"+Te:""),_bango:se,_bango_eda:Te}},T=function(){const se=V.value,Te=G.value;i.onUpdateBody(d,S(se,Te))};w||i.onAppendBody(S(y,x));const B=document.createElement("div");B.innerText="",B.style.cssText=`
        background-color:#666;
        color:#fff;
      `;const L=`
      width:80px;
      display:flex;
      justify-content:center;
      align-items:center;`,q=sv({label:":",labelCSS:L,value:y,onChange:T},{label:":",labelCSS:L,value:x,onChange:T}),V=q.input1,G=q.input2,te=q.container;u.append(B,te)}else a._type||i.onSetProperty("_type","describing"),u.style.display="none";return u}}function Ur(s,c){return{type:"TextualBody",purpose:"describing",value:`${s}: ${c}`}}function Rr(s,c){return function(a){const u=s||"",d=new RegExp(`^${u}: ([\\s\\S]*)$`),w=a.annotation.underlying,p=a.annotation?a.annotation.bodies.find(te=>te.purpose=="describing"&&d.test(te.value)):null,m=p&&d.exec(p.value)?RegExp.$1:"",y=!!a.annotation&&a.annotation.bodies.some(te=>te.purpose=="tagging");a.annotation&&a.annotation.bodies.some(te=>te.purpose=="describing");const x=function(te){p?a.onUpdateBody(p,Ur(u,te.target.value)):a.onAppendBody(Ur(u,te.target.value))},S=document.createElement("div");if(S.className="r6o-widget comment editable ii-comment",S.style.cssText=`
      display:flex;
      flex-direction:row;
    `,y||w._type=="ocrtext")return S.style.display="none",S;const T=document.createElement("div");T.innerText=u,T.style.cssText=`
      width:80px;
      background-color:#666;
      color:#fff;
      display:flex;
      justify-content:center;
      align-items:center;
    `;const B=document.createElement("textarea");B.className="r6o-editable-text",B.rows="1",B.value=m;const L=function(te){te.style.height="46px"},q=function(te){te.style.height=te.scrollHeight+"px"};B.addEventListener("change",x),B.addEventListener("input",te=>q(te.target)),B.addEventListener("focus",te=>q(te.target)),B.addEventListener("blur",te=>L(te.target)),B.addEventListener("keyup",te=>te.key=="Delete"&&te.stopPropagation()),L(B);const V=document.createElement("div");V.style.cssText=`
      width:30px;
      display:flex;
      justify-content:center;
      align-items:center;
    `;const G=document.createElement("button");return G.setAttribute("type","button"),G.innerHTML="&#xFE0E;",G.title="",G.addEventListener("click",te=>{const se=B.value,Te="https://wwwap.hi.u-tokyo.ac.jp/ships/w30/search",Ie=`?keyword=${se}&book=&searchtarget=&expand=true&type=2&page=1&itemsperpage=200&sortby=title_word roll_page&sortdesc=false&sortitem=`,Ce=Te+encodeURI(Ie);window.open(Ce)}),V.append(G),S.append(T,B,V),S}}function av(s,c=function(a,u,d){},i){return s=s||["",""],function(u){const d=!!u.annotation&&u.annotation.bodies.some(G=>G.purpose=="tagging"),w=u.annotation.underlying;if(d||w._type=="ocrtext"){const G=document.createElement("div");return G.style.display="none",G}const p=function(G,te,se,Te){const Ie=[];se.forEach((Ce,Ne)=>{const je=te[Ne];je?Ie.push({action:"update",previous:je,updated:Ur(Ce,V[Ne].value)}):Ie.push({action:"append",body:Ur(Ce,V[Ne].value)})}),u.onBatchModify(Ie)},m=s.map(G=>new RegExp(`^${G}: ([\\s\\S]*)`)),y=[null,null];let x=["",""];u.annotation&&u.annotation.bodies.forEach(G=>{G.purpose=="describing"&&m.forEach((te,se)=>{te.test(G.value)&&(y[se]=G,x[se]=RegExp.$1)})});let S=!1;const T=c(u,y,x);T&&(T.forEach((G,te)=>x[te]=G),S=!0);const B=s.map((G,te)=>({label:G,value:x[te],onChange:se=>{p(se,y,s)}})),L=sv(...B),q=L.container;q.className="r6o-widget comment editable ii-comment";const V=[L.input1,L.input2];return S&&p(null,y,s),q}}function TO(s){return av(["",""],function(a,u,d){if(!d[0]&&!d[1]){const w=a.annotation.target;if(!w)return;const p=Nu.getXYWHFromTarget(w),m=s.currentAnnotations,y=m.length;for(let x=0;x<y;x++){const S=m[x],T=S.body.length?S.body.find(B=>B.purpose=="tagging"):"";if(T){const B=Nu.getXYWHFromTarget(S.target);if(Nu.hasIntersectionXYWH(p,B)){const L=T._bango||T.value.split("-")[0],q=T._bango_eda||(/.+?\-(.+)/.test(T.value)?RegExp.$1:"");return[L,q]}}}}})}function CO(s){return av(["",""],function(a,u,d){if(!d[0]&&!d[1]&&!s.is_taggingmode){const w=parseInt(s.currentPage,10)+"";return[s.meta.volume,w]}})}function PO(s){const c=document.createElement("div"),i=s.annotation.bodies.find(a=>a.purpose=="linking");if(i){const a=document.createElement("a");a.href=i.value,a.target="_blank",a.innerText="";const u=document.createElement("div");u.append("",a),u.style.fontSize="small",c.append(u)}return c}function RO(s,c){const i=s.annotation.underlying,a=[];if(xO.forEach(u=>{const d=c.data[u];if(i._type=="describing"||s.annotation.bodies.every(w=>w.purpose!="tagging")){const w=s.annotation.bodies.find(p=>p.purpose=="describing"&&new RegExp(`^${u}: `).test(p.value));w?a.push({action:"update",previous:w,updated:Ur(u,d)}):a.push({action:"append",body:Ur(u,d)})}}),c.data["DB-ID"]){const u={type:"TextualBody",purpose:"linking",value:`https://wwwap.hi.u-tokyo.ac.jp/ships/w30/detail/3001${c.data["DB-ID"]}?dispid=disp02&type=2`},d=s.annotation.bodies.find(w=>w.purpose=="linking");d?a.push({action:"update",previous:d,updated:u}):a.push({action:"append",body:u})}a.length>0&&s.onBatchModify(a)}function AO(s){const c=document.createElement("div"),i=s.annotation.underlying;return i._candidate&&i._candidate.length>0&&i._candidate.forEach(a=>{const u=document.createElement("div");u.style.cssText=`
        display:flex;
        flex-direction:row;
      `;const d=document.createElement("details");d.style.fontSize="small";const w=document.createElement("summary");w.innerText=a.title;const p=document.createElement("ul");for(const[x,S]of Object.entries(a.data)){const T=document.createElement("li");T.innerText=`${x}: ${S}`,p.append(T)}d.append(w,p);const m=document.createElement("div"),y=document.createElement("button");y.setAttribute("type","button"),y.innerText="Apply",y.addEventListener("click",()=>RO(s,a)),m.append(y),u.append(d,m),c.append(u)}),c}function DO(s){return[SO,_O(s),Rr(""),Rr(""),Rr(""),Rr(""),Rr(""),Rr(""),TO(s),CO(s),PO,bO,AO]}function OO(s){return s.replace(/</g,"&lt;").replace(/>/g,"&lt;").replace(/&/g,"&amp;")}function kO(s){return function(c){const i=c.underlying;let a="";const u=c.bodies.find(w=>w.purpose=="tagging"&&(a=w.value)&&!0)||i._type=="tagging";if(i._type=="ocrtext")return{className:"ii-annotation-ocrtext",style:"stroke: #B0C5A4"};if(u){const w=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return w.setAttribute("width","100px"),w.setAttribute("height","1px"),w.innerHTML=`
      <div xmlns="http://www.w3.org/1999/xhtml" class="a9s-shape-label-wrapper">
        <div class="a9s-shape-label">
          ${OO(a)}
        </div>
      </div>
      `,{element:w,className:"ii-annotation-tagging",style:"stroke: blue"}}else return{className:"ii-annotation-box",style:"stroke: red"}}}const BO={hasIntersectionXYWH(s,c){const i=s[0],a=s[1],u=s[2],d=s[3],w=c[0],p=c[1],m=c[2],y=c[3];return Math.max(i,w)<=Math.min(i+u,w+m)&&Math.max(a,p)<=Math.min(a+d,p+y)},getXYWHFromTarget(s){const c=s.selector.value;let i=[0,0,0,0];return c.replace(/^xywh=pixel:([\d\.]+),([\d\.]+),([\d\.]+),([\d\.]+)$/,(a,...u)=>{i=u.slice(0,4).map(d=>parseFloat(d))}),i}},MO=["","","","","","","","","",""],lv={};MO.forEach((s,c)=>lv[s]=c);function FO({annotations:s=[],bookid:c="",strict:i=!1,iiifserver:a="http://localhost:5173/",iiifprefix:u="iiif/"}){if(!c)return;const d=jr.list.find(T=>T.bookid==c),w=a+u,p=d.imageUrl.server+d.imageUrl.prefix+encodeURIComponent(d.identifier)+d.imageUrl.suffix,m=s.filter(T=>(T._type=="describing"||!T._type&&!i&&T.body.some(B=>B.purpose=="describing"))&&(T._bookid==c||!T._bookid&&!i&&(T._identifier==d.identifier||!T._identifier&&new RegExp(`^${p}`).test(T.target.source))));if(m.length<1)return;const y={},x=d.pages.map((T,B)=>{y[T]=B;const L=w+c+"/canvas/"+B;return{type:"Canvas",id:L,label:{none:[T]},width:d.width,height:d.height,items:[{type:"AnnotationPage",id:L+"/page",items:[{type:"Annotation",id:L+"/page/imageanno",motivation:"painting",target:L,body:{type:"Image",width:d.width,height:d.height,id:p+T+".jpg"}}]}],annotations:[{type:"AnnotationPage",id:L+"/annos",items:[]}]}});return m.forEach(T=>{const B=T._page||(i?"":new RegExp(`^${p}(.+)${d.imageUrl.extension}$`).exec(T.target.source)?RegExp.$1:"");if(!B)return;const L=y[B];if(typeof L!="number")return;const q=w+c+"/canvas/"+L,V=x[L].annotations[0].items.length;x[L].annotations[0].items.push({type:"Annotation",id:q+"/annos/"+V,motivation:"commenting",target:q+"#xywh="+BO.getXYWHFromTarget(T.target).join(","),body:T.body.filter(G=>G.purpose=="describing"||G.purpose=="linking").map(G=>({type:"TextualBody",purpose:G.purpose,value:G.value})).sort((G,te)=>{const[se,Te]=[G,te].map(Ie=>lv[/^(.+?): /.test(Ie.value)?RegExp.$1:""]+1||9999);return se-Te})})}),{"@context":"http://iiif.io/api/presentation/3/context.json",type:"Manifest",id:w+c+"/manifest.json",label:{ja:[d.title]},items:x}}const IO={data(){return{is_taggingmode:!1,is_annotating:!1,is_internal_routing:!1,is_sidepane_shown:!1,currentPage:"",viewer:null,anno:null,metalist:jr}},computed:{nextPage(){const s=this.meta.pages,c=s.indexOf(this.currentPage)+1;return c!=0&&c<s.length?s[c]:""},prevPage(){const s=this.meta.pages,c=s.indexOf(this.currentPage)-1;return c>=0?s[c]:""},bookid(){return this.$route.params.bookid},routerpage(){return this.$route.params.page},meta(){const s=this.bookid,c=jr.list.find(i=>i.bookid==s);return this.currentPage||(this.currentPage=c.pages[0]),c},annotations(){return this.$store.state.annotations},jsonUrlRoot(){return this.meta.jsonUrl.server+this.meta.jsonUrl.prefix+this.meta.identifier+this.meta.jsonUrl.suffix},imageUrlBase(){return this.meta.imageUrl.server+this.meta.imageUrl.prefix},imageUrlRoot(){return this.imageUrlBase+this.meta.identifier+this.meta.imageUrl.suffix},currentImageUrl(){return this.imageUrlRoot+this.currentPage+this.meta.imageUrl.extension},currentPageUrl(){return this.jsonUrlRoot+this.currentPage+this.meta.jsonUrl.extension},currentAnnotations(){return this.annotations.filter(s=>new RegExp("^"+this.currentImageUrl).test(s.target.source))}},methods:{exportAnnotationToJSON(){if(this.annotations.length<=0)return;const s=new Blob([JSON.stringify(this.annotations)],{type:"application/json"}),c=document.createElement("a");c.download=`annotation-${Date.now()}.json`,c.href=URL.createObjectURL(s),c.click(),URL.revokeObjectURL(s)},generateManifest(){return this.annotations.length<=0?void 0:FO({annotations:this.annotations,bookid:this.bookid,iiifserver:"https://c-kikuchi.github.io/",iiifprefix:"iiif/"})},exportManifest(){const s=this.generateManifest();if(!s)return;const c=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),i=document.createElement("a");i.download=`manifest-${Date.now()}.json`,i.href=URL.createObjectURL(c),i.click(),URL.revokeObjectURL(c)},openManifest(){const s=this.generateManifest();if(!s)return;const c=new Blob([JSON.stringify(s,null,2)],{type:"application/json"});window.open(URL.createObjectURL(c))},async loadAnnotationFromJSON(s){const i=await s.target.files[0].text(),a=JSON.parse(i);a.length>0&&(this.$store.commit("addAnnotationByList",a),this.setPage())},async openViewer(){const s=this.currentPageUrl,c=await fetch(s).then(a=>a.json()),i=c.data?c.data:c;this.viewer.open(i)},setPage(){this.openViewer(),this.is_internal_routing=!0,this.$router.replace({path:`/viewer/${this.bookid}/${this.currentPage}`}),this.anno.setAnnotations(this.currentAnnotations)},gotoPage(s){this.currentPage=s,this.setPage()},getIdentifierFromAnnotation(s){return new RegExp(`^${this.imageUrlBase}(.+?)${this.meta.imageUrl.suffix}`).test(s.target.source)?RegExp.$1:""},getPageFromAnnotation(s){return new RegExp(`^${this.imageUrlRoot}(.+?)${this.meta.imageUrl.extension}`).test(s.target.source)?RegExp.$1:""},insertIdentifierAndPage(s){s._identifier||(s._identifier=this.meta.identifier),s._page||(s._page=this.currentPage),s._bookid||(s._bookid=this.meta.bookid),new RegExp(`^${this.meta.imageUrlBase}`).test(s.target.source)||(s.target.source=this.currentImageUrl)},addAnnotation(s){this.insertIdentifierAndPage(s),this.$store.commit("addAnnotation",s)},updateAnnotation(s,c){this.insertIdentifierAndPage(s),this.$store.commit("updateAnnotation",{annotation:s,previous:c})},deleteAnnotation(s){this.$store.commit("deleteAnnotation",s)},startAnnotationMode(){this.is_annotating&&this.anno.setDrawingEnabled(!0)},startTagAnnotationMode(){this.is_taggingmode&&this.anno.setDrawingEnabled(!0)},getPageDimension(){const s=this.viewer.source.dimensions;console.log("dimensions |",s.x,s.y)}},watch:{$route(s,c){if(this.is_internal_routing){this.is_internal_routing=!1;return}s.params.page!=c.params.page&&(this.currentPage=s.params.page),s.params.bookid!=c.params.bookid&&(this.currentPage=s.params.page||this.meta.pages[0]),this.setPage()}},async mounted(){const s=this,c={get is_taggingmode(){return s.is_taggingmode},get currentAnnotations(){return s.currentAnnotations},get meta(){return s.meta},get currentPage(){return s.currentPage}};this.routerpage&&(this.currentPage=this.routerpage),this.viewer=wO({element:this.$refs.osd_elm,zoomInButton:this.$refs.zoominbutton,zoomOutButton:this.$refs.zoomoutbutton,homeButton:this.$refs.homebutton,fullPageButton:this.$refs.fullpagebutton,toolbar:this.$refs.toolbar_elm});const i=EO(this.viewer,{widgets:DO(c),formatter:kO()});i.on("createSelection",a=>{console.log(a)}),i.on("createAnnotation",a=>{this.addAnnotation(a),this.is_annotating=!1,this.is_taggingmode=!1}),i.on("updateAnnotation",(a,u)=>{this.updateAnnotation(a,u)}),i.on("deleteAnnotation",a=>{this.deleteAnnotation(a),console.log("delete annotation")}),i.on("cancelSelected",()=>{this.is_annotating=!1,this.is_taggingmode=!1}),this.anno=i,this.setPage(),window.app=this}},LO={class:"ii-root"},HO={class:"ii-main-pane"},NO={class:"ii-header"},zO={style:{float:"left"}},jO=Qe("strong",null,"<Home",-1),UO={style:{"text-align":"center","font-size":"large"}},VO={ref:"toolbar_elm",class:"ii-toolbar"},WO={class:"ii-toolbar-controls"},GO={class:"ii-zoom-control"},qO={ref:"zoominbutton",title:"zoom in"},ZO={ref:"zoomoutbutton",title:"zoom out"},XO={ref:"homebutton",title:"reset zoom"},YO={ref:"fullpagebutton",title:"full screen"},KO={class:"ii-page-control"},JO=["disabled"],QO=["disabled"],$O={class:"ii-tag-control"},e3={role:"button","aria-role":"button"},t3=Qe("span",null,"",-1),n3={role:"button","aria-role":"button"},i3=Qe("span",null,"",-1),r3={ref:"osd_elm",style:{width:"100%",height:"800px","background-color":"#ccc"}},o3=Qe("br",null,null,-1);function s3(s,c,i,a,u,d){const w=DA("RouterLink");return Kn(),ai("main",LO,[Qe("div",HO,[Qe("div",NO,[Qe("div",zO,[mn(w,{to:"/"},{default:bc(()=>[jO]),_:1})]),Qe("h1",UO,Mn(d.meta.title),1)]),Qe("div",VO,[Qe("div",WO,[Qe("div",GO,[Qe("button",qO,"+",512),Qe("button",ZO,"-",512),Qe("button",XO,"",512),Qe("button",YO,"",512)]),Qe("div",KO,[Qe("button",{disabled:!this.nextPage,onClick:c[0]||(c[0]=p=>{this.currentPage=this.nextPage,d.setPage()})},"next",8,JO),Du(Qe("select",{"onUpdate:modelValue":c[1]||(c[1]=p=>u.currentPage=p),onChange:c[2]||(c[2]=p=>d.setPage())},[(Kn(!0),ai(Pn,null,qu(d.meta.pages,p=>(Kn(),ai("option",null,Mn(p),1))),256))],544),[[K2,u.currentPage]]),Qe("button",{disabled:!this.prevPage,onClick:c[3]||(c[3]=p=>{this.currentPage=this.prevPage,d.setPage()})},"prev",8,QO)]),Qe("div",$O,[Qe("label",e3,[Du(Qe("input",{class:"togglebutton",type:"checkbox","onUpdate:modelValue":c[4]||(c[4]=p=>u.is_annotating=p),onChange:c[5]||(c[5]=p=>d.startAnnotationMode())},null,544),[[_m,u.is_annotating]]),t3]),Qe("label",n3,[Du(Qe("input",{class:"togglebutton",type:"checkbox","onUpdate:modelValue":c[6]||(c[6]=p=>u.is_taggingmode=p),onChange:c[7]||(c[7]=p=>d.startTagAnnotationMode())},null,544),[[_m,u.is_taggingmode]]),i3])])])],512),Qe("div",r3,null,512),Qe("div",null,[Qe("div",null,[Mo(Mn(d.currentPageUrl),1),o3,Mo(" "+Mn(d.currentImageUrl),1)]),Qe("div",null,[Qe("button",{onClick:c[8]||(c[8]=(...p)=>d.exportAnnotationToJSON&&d.exportAnnotationToJSON(...p))},"Export JSON"),Qe("button",{onClick:c[9]||(c[9]=(...p)=>d.exportManifest&&d.exportManifest(...p))},"Export Manifest"),Qe("button",{onClick:c[10]||(c[10]=(...p)=>d.openManifest&&d.openManifest(...p))},"Open Manifest"),Qe("input",{type:"file",onChange:c[11]||(c[11]=(...p)=>d.loadAnnotationFromJSON&&d.loadAnnotationFromJSON(...p))},null,32),Qe("button",{onClick:c[12]||(c[12]=(...p)=>d.getPageDimension&&d.getPageDimension(...p))},"page size")])]),Qe("div",null,[Qe("div",null,"Annotations: "+Mn(this.annotations.length)+" (in this page: "+Mn(this.currentAnnotations.length)+")",1),(Kn(!0),ai(Pn,null,qu(d.annotations,p=>(Kn(),ai("div",{key:p.id},[Qe("details",null,[Qe("summary",null,Mn(p.id),1),Qe("pre",null,Mn(JSON.stringify(p,null,2)),1)])]))),128))])]),Qe("div",{class:Ea(["ii-side-pane",{show:u.is_sidepane_shown}])},null,2)])}const a3=Ac(IO,[["render",s3]]),l3={computed:{bookid(){return this.$route.params.bookid},currentMeta(){const s=this.bookid;return jr.list.find(c=>c.bookid==s)}},beforeRouteUpdate(s,c,i){console.log(s,c);const a=s.params.bookid;jr.list.findIndex(u=>u.bookid==a)!=-1?i():(console.log("!"),i(!1))}};function u3(s,c,i,a,u,d){return Kn(),ai(Pn,null,[Qe("div",null,"bookid: "+Mn(d.bookid),1),Qe("div",null,[Qe("pre",null,Mn(JSON.stringify(d.currentMeta,null,2)),1)])],64)}const c3=Ac(l3,[["render",u3]]),h3=uO({history:zD("/iike"),routes:[{path:"/",name:"home",component:gO},{path:"/viewer/:bookid/:page?",name:"viewer",component:a3,beforeEnter(s,c,i){i()}},{path:"/meta/:bookid",name:"meta",component:c3}]});/*!
 * vuex v4.0.2
 * (c) 2021 Evan You
 * @license MIT
 */var d3="store";function Gr(s,c){Object.keys(s).forEach(function(i){return c(s[i],i)})}function p3(s){return s!==null&&typeof s=="object"}function f3(s){return s&&typeof s.then=="function"}function g3(s,c){return function(){return s(c)}}function uv(s,c,i){return c.indexOf(s)<0&&(i&&i.prepend?c.unshift(s):c.push(s)),function(){var a=c.indexOf(s);a>-1&&c.splice(a,1)}}function cv(s,c){s._actions=Object.create(null),s._mutations=Object.create(null),s._wrappedGetters=Object.create(null),s._modulesNamespaceMap=Object.create(null);var i=s.state;Da(s,i,[],s._modules.root,!0),Dc(s,i,c)}function Dc(s,c,i){var a=s._state;s.getters={},s._makeLocalGettersCache=Object.create(null);var u=s._wrappedGetters,d={};Gr(u,function(w,p){d[p]=g3(w,s),Object.defineProperty(s.getters,p,{get:function(){return d[p]()},enumerable:!0})}),s._state=zo({data:c}),s.strict&&E3(s),a&&i&&s._withCommit(function(){a.data=null})}function Da(s,c,i,a,u){var d=!i.length,w=s._modules.getNamespace(i);if(a.namespaced&&(s._modulesNamespaceMap[w],s._modulesNamespaceMap[w]=a),!d&&!u){var p=Oc(c,i.slice(0,-1)),m=i[i.length-1];s._withCommit(function(){p[m]=a.state})}var y=a.context=m3(s,w,i);a.forEachMutation(function(x,S){var T=w+S;v3(s,T,x,y)}),a.forEachAction(function(x,S){var T=x.root?S:w+S,B=x.handler||x;y3(s,T,B,y)}),a.forEachGetter(function(x,S){var T=w+S;w3(s,T,x,y)}),a.forEachChild(function(x,S){Da(s,c,i.concat(S),x,u)})}function m3(s,c,i){var a=c==="",u={dispatch:a?s.dispatch:function(d,w,p){var m=ma(d,w,p),y=m.payload,x=m.options,S=m.type;return(!x||!x.root)&&(S=c+S),s.dispatch(S,y)},commit:a?s.commit:function(d,w,p){var m=ma(d,w,p),y=m.payload,x=m.options,S=m.type;(!x||!x.root)&&(S=c+S),s.commit(S,y,x)}};return Object.defineProperties(u,{getters:{get:a?function(){return s.getters}:function(){return hv(s,c)}},state:{get:function(){return Oc(s.state,i)}}}),u}function hv(s,c){if(!s._makeLocalGettersCache[c]){var i={},a=c.length;Object.keys(s.getters).forEach(function(u){if(u.slice(0,a)===c){var d=u.slice(a);Object.defineProperty(i,d,{get:function(){return s.getters[u]},enumerable:!0})}}),s._makeLocalGettersCache[c]=i}return s._makeLocalGettersCache[c]}function v3(s,c,i,a){var u=s._mutations[c]||(s._mutations[c]=[]);u.push(function(w){i.call(s,a.state,w)})}function y3(s,c,i,a){var u=s._actions[c]||(s._actions[c]=[]);u.push(function(w){var p=i.call(s,{dispatch:a.dispatch,commit:a.commit,getters:a.getters,state:a.state,rootGetters:s.getters,rootState:s.state},w);return f3(p)||(p=Promise.resolve(p)),s._devtoolHook?p.catch(function(m){throw s._devtoolHook.emit("vuex:error",m),m}):p})}function w3(s,c,i,a){s._wrappedGetters[c]||(s._wrappedGetters[c]=function(d){return i(a.state,a.getters,d.state,d.getters)})}function E3(s){Fr(function(){return s._state.data},function(){},{deep:!0,flush:"sync"})}function Oc(s,c){return c.reduce(function(i,a){return i[a]},s)}function ma(s,c,i){return p3(s)&&s.type&&(i=c,c=s,s=s.type),{type:s,payload:c,options:i}}var x3="vuex bindings",Wm="vuex:mutations",zu="vuex:actions",Ar="vuex",b3=0;function S3(s,c){uD({id:"org.vuejs.vuex",app:s,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[x3]},function(i){i.addTimelineLayer({id:Wm,label:"Vuex Mutations",color:Gm}),i.addTimelineLayer({id:zu,label:"Vuex Actions",color:Gm}),i.addInspector({id:Ar,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),i.on.getInspectorTree(function(a){if(a.app===s&&a.inspectorId===Ar)if(a.filter){var u=[];gv(u,c._modules.root,a.filter,""),a.rootNodes=u}else a.rootNodes=[fv(c._modules.root,"")]}),i.on.getInspectorState(function(a){if(a.app===s&&a.inspectorId===Ar){var u=a.nodeId;hv(c,u),a.state=C3(R3(c._modules,u),u==="root"?c.getters:c._makeLocalGettersCache,u)}}),i.on.editInspectorState(function(a){if(a.app===s&&a.inspectorId===Ar){var u=a.nodeId,d=a.path;u!=="root"&&(d=u.split("/").filter(Boolean).concat(d)),c._withCommit(function(){a.set(c._state.data,d,a.state.value)})}}),c.subscribe(function(a,u){var d={};a.payload&&(d.payload=a.payload),d.state=u,i.notifyComponentUpdate(),i.sendInspectorTree(Ar),i.sendInspectorState(Ar),i.addTimelineEvent({layerId:Wm,event:{time:Date.now(),title:a.type,data:d}})}),c.subscribeAction({before:function(a,u){var d={};a.payload&&(d.payload=a.payload),a._id=b3++,a._time=Date.now(),d.state=u,i.addTimelineEvent({layerId:zu,event:{time:a._time,title:a.type,groupId:a._id,subtitle:"start",data:d}})},after:function(a,u){var d={},w=Date.now()-a._time;d.duration={_custom:{type:"duration",display:w+"ms",tooltip:"Action duration",value:w}},a.payload&&(d.payload=a.payload),d.state=u,i.addTimelineEvent({layerId:zu,event:{time:Date.now(),title:a.type,groupId:a._id,subtitle:"end",data:d}})}})})}var Gm=8702998,_3=6710886,T3=16777215,dv={label:"namespaced",textColor:T3,backgroundColor:_3};function pv(s){return s&&s!=="root"?s.split("/").slice(-2,-1)[0]:"Root"}function fv(s,c){return{id:c||"root",label:pv(c),tags:s.namespaced?[dv]:[],children:Object.keys(s._children).map(function(i){return fv(s._children[i],c+i+"/")})}}function gv(s,c,i,a){a.includes(i)&&s.push({id:a||"root",label:a.endsWith("/")?a.slice(0,a.length-1):a||"Root",tags:c.namespaced?[dv]:[]}),Object.keys(c._children).forEach(function(u){gv(s,c._children[u],i,a+u+"/")})}function C3(s,c,i){c=i==="root"?c:c[i];var a=Object.keys(c),u={state:Object.keys(s.state).map(function(w){return{key:w,editable:!0,value:s.state[w]}})};if(a.length){var d=P3(c);u.getters=Object.keys(d).map(function(w){return{key:w.endsWith("/")?pv(w):w,editable:!1,value:rc(function(){return d[w]})}})}return u}function P3(s){var c={};return Object.keys(s).forEach(function(i){var a=i.split("/");if(a.length>1){var u=c,d=a.pop();a.forEach(function(w){u[w]||(u[w]={_custom:{value:{},display:w,tooltip:"Module",abstract:!0}}),u=u[w]._custom.value}),u[d]=rc(function(){return s[i]})}else c[i]=rc(function(){return s[i]})}),c}function R3(s,c){var i=c.split("/").filter(function(a){return a});return i.reduce(function(a,u,d){var w=a[u];if(!w)throw new Error('Missing module "'+u+'" for path "'+c+'".');return d===i.length-1?w:w._children},c==="root"?s:s.root._children)}function rc(s){try{return s()}catch(c){return c}}var Nn=function(c,i){this.runtime=i,this._children=Object.create(null),this._rawModule=c;var a=c.state;this.state=(typeof a=="function"?a():a)||{}},mv={namespaced:{configurable:!0}};mv.namespaced.get=function(){return!!this._rawModule.namespaced};Nn.prototype.addChild=function(c,i){this._children[c]=i};Nn.prototype.removeChild=function(c){delete this._children[c]};Nn.prototype.getChild=function(c){return this._children[c]};Nn.prototype.hasChild=function(c){return c in this._children};Nn.prototype.update=function(c){this._rawModule.namespaced=c.namespaced,c.actions&&(this._rawModule.actions=c.actions),c.mutations&&(this._rawModule.mutations=c.mutations),c.getters&&(this._rawModule.getters=c.getters)};Nn.prototype.forEachChild=function(c){Gr(this._children,c)};Nn.prototype.forEachGetter=function(c){this._rawModule.getters&&Gr(this._rawModule.getters,c)};Nn.prototype.forEachAction=function(c){this._rawModule.actions&&Gr(this._rawModule.actions,c)};Nn.prototype.forEachMutation=function(c){this._rawModule.mutations&&Gr(this._rawModule.mutations,c)};Object.defineProperties(Nn.prototype,mv);var Yi=function(c){this.register([],c,!1)};Yi.prototype.get=function(c){return c.reduce(function(i,a){return i.getChild(a)},this.root)};Yi.prototype.getNamespace=function(c){var i=this.root;return c.reduce(function(a,u){return i=i.getChild(u),a+(i.namespaced?u+"/":"")},"")};Yi.prototype.update=function(c){vv([],this.root,c)};Yi.prototype.register=function(c,i,a){var u=this;a===void 0&&(a=!0);var d=new Nn(i,a);if(c.length===0)this.root=d;else{var w=this.get(c.slice(0,-1));w.addChild(c[c.length-1],d)}i.modules&&Gr(i.modules,function(p,m){u.register(c.concat(m),p,a)})};Yi.prototype.unregister=function(c){var i=this.get(c.slice(0,-1)),a=c[c.length-1],u=i.getChild(a);u&&u.runtime&&i.removeChild(a)};Yi.prototype.isRegistered=function(c){var i=this.get(c.slice(0,-1)),a=c[c.length-1];return i?i.hasChild(a):!1};function vv(s,c,i){if(c.update(i),i.modules)for(var a in i.modules){if(!c.getChild(a))return;vv(s.concat(a),c.getChild(a),i.modules[a])}}function A3(s){return new wn(s)}var wn=function(c){var i=this;c===void 0&&(c={});var a=c.plugins;a===void 0&&(a=[]);var u=c.strict;u===void 0&&(u=!1);var d=c.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new Yi(c),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._devtools=d;var w=this,p=this,m=p.dispatch,y=p.commit;this.dispatch=function(T,B){return m.call(w,T,B)},this.commit=function(T,B,L){return y.call(w,T,B,L)},this.strict=u;var x=this._modules.root.state;Da(this,x,[],this._modules.root),Dc(this,x),a.forEach(function(S){return S(i)})},kc={state:{configurable:!0}};wn.prototype.install=function(c,i){c.provide(i||d3,this),c.config.globalProperties.$store=this;var a=this._devtools!==void 0?this._devtools:!1;a&&S3(c,this)};kc.state.get=function(){return this._state.data};kc.state.set=function(s){};wn.prototype.commit=function(c,i,a){var u=this,d=ma(c,i,a),w=d.type,p=d.payload,m={type:w,payload:p},y=this._mutations[w];y&&(this._withCommit(function(){y.forEach(function(S){S(p)})}),this._subscribers.slice().forEach(function(x){return x(m,u.state)}))};wn.prototype.dispatch=function(c,i){var a=this,u=ma(c,i),d=u.type,w=u.payload,p={type:d,payload:w},m=this._actions[d];if(m){try{this._actionSubscribers.slice().filter(function(x){return x.before}).forEach(function(x){return x.before(p,a.state)})}catch{}var y=m.length>1?Promise.all(m.map(function(x){return x(w)})):m[0](w);return new Promise(function(x,S){y.then(function(T){try{a._actionSubscribers.filter(function(B){return B.after}).forEach(function(B){return B.after(p,a.state)})}catch{}x(T)},function(T){try{a._actionSubscribers.filter(function(B){return B.error}).forEach(function(B){return B.error(p,a.state,T)})}catch{}S(T)})})}};wn.prototype.subscribe=function(c,i){return uv(c,this._subscribers,i)};wn.prototype.subscribeAction=function(c,i){var a=typeof c=="function"?{before:c}:c;return uv(a,this._actionSubscribers,i)};wn.prototype.watch=function(c,i,a){var u=this;return Fr(function(){return c(u.state,u.getters)},i,Object.assign({},a))};wn.prototype.replaceState=function(c){var i=this;this._withCommit(function(){i._state.data=c})};wn.prototype.registerModule=function(c,i,a){a===void 0&&(a={}),typeof c=="string"&&(c=[c]),this._modules.register(c,i),Da(this,this.state,c,this._modules.get(c),a.preserveState),Dc(this,this.state)};wn.prototype.unregisterModule=function(c){var i=this;typeof c=="string"&&(c=[c]),this._modules.unregister(c),this._withCommit(function(){var a=Oc(i.state,c.slice(0,-1));delete a[c[c.length-1]]}),cv(this)};wn.prototype.hasModule=function(c){return typeof c=="string"&&(c=[c]),this._modules.isRegistered(c)};wn.prototype.hotUpdate=function(c){this._modules.update(c),cv(this,!0)};wn.prototype._withCommit=function(c){var i=this._committing;this._committing=!0,c(),this._committing=i};Object.defineProperties(wn.prototype,kc);const D3=A3({state(){return{annotations:[]}},mutations:{addAnnotation(s,c){s.annotations.push(c)},updateAnnotation(s,c){const{annotation:i,previous:a}=c,u=s.annotations.findIndex(d=>d.id==a.id);s.annotations[u]=i},deleteAnnotation(s,c){const i=s.annotations.findIndex(a=>a.id==c.id);s.annotations.splice(i,1)},addAnnotationByList(s,c){s.annotations.push(...c)}}}),Bc=$2(dO);Bc.use(h3);Bc.use(D3);Bc.mount("#app");
